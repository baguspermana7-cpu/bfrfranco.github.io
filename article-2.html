<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-GED7FX8RTV"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-GED7FX8RTV');
    </script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <!-- SEO Meta Tags -->
    <title>Alarm Fatigue Is Not a Human Problem | System Design | ResistanceZero</title>
    <meta name="description" content="Why alarm fatigue is a system design failure, not operator negligence. ISA-18.2 framework applied to data center BMS and DCIM alarm rationalization.">
    <meta name="keywords" content="Alarm Fatigue, Data Center Safety, ISA-18.2, EEMUA 191, IEC 62682, Alarm Rationalization, BMS Optimization, Critical Infrastructure, Cognitive Load, Human Factors, Operations Engineering">
    <meta name="author" content="Bagus Dwi Permana">
    <meta name="robots" content="index, follow">
    <meta name="theme-color" content="#1e3a5f">
    <link rel="canonical" href="https://resistancezero.com/article-2.html">

    <link rel="alternate" hreflang="en" href="https://resistancezero.com/article-2.html">

    <!-- Resource Hints -->
    <link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin>
    <link rel="preconnect" href="https://www.googletagmanager.com" crossorigin>
    <link rel="dns-prefetch" href="https://cdn.jsdelivr.net">
    <link rel="dns-prefetch" href="https://www.googletagmanager.com">
    <!-- Open Graph Meta Tags -->
    <meta property="og:type" content="article">
    <meta property="og:url" content="https://resistancezero.com/article-2.html">
    <meta property="og:title" content="Alarm Fatigue Is Not a Human Problem — It Is a System Design Failure">
    <meta property="og:description" content="Alarm fatigue is often misattributed to human negligence. In mission-critical environments, this interpretation is both inaccurate and dangerous. A systematic engineering approach to alarm management.">
    <meta property="og:image" content="https://resistancezero.com/assets/article-2-cover.jpg">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:image:alt" content="Alarm Fatigue Is Not a Human Problem - Operations Engineering Journal">
    <meta property="og:locale" content="en_US">
    <meta property="og:site_name" content="Bagus Dwi Permana Portfolio">
    <meta property="article:author" content="Bagus Dwi Permana">
    <meta property="article:published_time" content="2025-12-07T00:00:00Z">
    <meta property="article:modified_time" content="2026-02-17T00:00:00Z">
    <meta property="article:section" content="Operations Engineering Journal">
    <meta property="article:tag" content="Alarm Fatigue">
    <meta property="article:tag" content="System Design">
    <meta property="article:tag" content="Safety Engineering">
    <meta property="article:tag" content="ISA-18.2">

    <!-- Twitter Card Meta Tags -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@BagusDPermana">
    <meta name="twitter:creator" content="@BagusDPermana">
    <meta name="twitter:title" content="Alarm Fatigue Is Not a Human Problem — It Is a System Design Failure">
    <meta name="twitter:description" content="Alarm fatigue is a system design issue, not human negligence. ISA-18.2 rationalization achieving >90% alarm reduction.">
    <meta name="twitter:image" content="https://resistancezero.com/assets/article-2-cover.jpg">
    <meta name="twitter:image:alt" content="Alarm Fatigue to Alarm Intelligence - Data Center Monitoring">

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
    <link rel="icon" type="image/png" href="assets/Favicon.png">
    <link rel="apple-touch-icon" href="assets/Favicon.png">
    <link rel="stylesheet" href="styles.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="preload" as="image" href="assets/article-2-cover.jpg">


    <!-- Structured Data - TechnicalArticle -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "TechnicalArticle",
        "headline": "Alarm Fatigue Is Not a Human Problem — It Is a System Design Failure",
        "description": "Alarm fatigue in data centers is a system design issue, not human negligence. A rigorous analysis of ISA-18.2, EEMUA 191, cognitive load theory, and structured rationalization achieving >90% alarm reduction.",
        "image": "https://resistancezero.com/assets/article-2-cover.jpg",
        "author": {
            "@type": "Person",
            "name": "Bagus Dwi Permana",
            "jobTitle": "Engineering Operations Manager",
            "url": "https://resistancezero.com/"
        },
        "datePublished": "2025-12-07",
        "dateModified": "2026-02-13",
        "wordCount": "8500",
        "publisher": {
            "@type": "Person",
            "name": "Bagus Dwi Permana"
        },
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https://resistancezero.com/article-2.html"
        },
        "articleSection": "Operations Engineering Journal",
        "keywords": ["Alarm Fatigue", "Data Center Safety", "ISA-18.2", "EEMUA 191", "IEC 62682", "BMS Optimization", "Human Factors", "Cognitive Load"]
    }
    </script>

    <!-- Structured Data - BreadcrumbList -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "BreadcrumbList",
        "itemListElement": [
            { "@type": "ListItem", "position": 1, "name": "Home", "item": "https://resistancezero.com/" },
            { "@type": "ListItem", "position": 2, "name": "Articles", "item": "https://resistancezero.com/articles.html" },
            { "@type": "ListItem", "position": 3, "name": "Alarm Fatigue Is Not a Human Problem" }
        ]
    }
    </script>

    <!-- Structured Data - FAQPage -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "FAQPage",
        "mainEntity": [
            {
                "@type": "Question",
                "name": "What is alarm fatigue in data centers?",
                "acceptedAnswer": {
                    "@type": "Answer",
                    "text": "Alarm fatigue occurs when operators become desensitized to frequent BMS and DCIM alerts, leading to missed critical events. It is caused by poor alarm system design, not operator negligence."
                }
            },
            {
                "@type": "Question",
                "name": "What causes alarm fatigue in critical infrastructure?",
                "acceptedAnswer": {
                    "@type": "Answer",
                    "text": "Excessive nuisance alarms, misconfigured thresholds, lack of alarm rationalization per ISA-18.2, and systems designed without cognitive load considerations."
                }
            },
            {
                "@type": "Question",
                "name": "How does ISA-18.2 reduce alarm fatigue?",
                "acceptedAnswer": {
                    "@type": "Answer",
                    "text": "ISA-18.2 provides a structured alarm rationalization methodology that prioritizes alarms by consequence severity, eliminates redundant alerts, and typically achieves over 90% alarm reduction."
                }
            }
        ]
    }
    </script>

    <style>
        /* ============================================
           Article 2 - Enhanced Inline Styles
           Design System matching Article 15
           ============================================ */
        :root {
            --primary-blue: #1e3a5f;
            --accent-red: #ef4444;
            --accent-cyan: #06b6d4;
            --accent-emerald: #10b981;
            --accent-amber: #f59e0b;
            --accent-purple: #8b5cf6;
            --bg-dark: #0f172a;
            --bg-light: #f8fafc;
            --text-primary: #1e293b;
            --text-secondary: #64748b;
            --card-bg: #ffffff;
            --card-border: #e2e8f0;
            --section-bg: #f8fafc;
            --table-stripe: #f1f5f9;
        }

        [data-theme="dark"] {
            --text-primary: #e2e8f0;
            --text-secondary: #94a3b8;
            --card-bg: #1e293b;
            --card-border: #334155;
            --section-bg: #0f172a;
            --table-stripe: #1e293b;
            --bg-light: #0f172a;
        }

        /* Hero Section */
        .article-hero {
            background: linear-gradient(135deg, #0b1220 0%, #1e3a5f 50%, #2d5a87 100%);
            padding: 7rem 2rem 3.5rem;
            color: #fff;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .article-hero::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            background:
                radial-gradient(circle at 20% 80%, rgba(239, 68, 68, 0.15) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(6, 182, 212, 0.1) 0%, transparent 50%);
            z-index: 0;
        }

        .article-hero::after {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            background: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Ccircle cx='30' cy='30' r='2' fill='%23ef4444' fill-opacity='0.04'/%3E%3C/svg%3E");
            z-index: 0;
        }

        .article-hero > * { position: relative; z-index: 1; }
        .article-hero .container { max-width: 1000px; margin: 0 auto; }

        .article-badge {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            background: rgba(239, 68, 68, 0.2);
            color: #fca5a5;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
            margin-bottom: 1.5rem;
            border: 1px solid rgba(239, 68, 68, 0.3);
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .article-title {
            font-size: clamp(1.6rem, 3.2vw, 2.35rem);
            font-weight: 800;
            margin-bottom: 1.25rem;
            line-height: 1.25;
            color: #fff;
            letter-spacing: -0.01em;
        }

        .article-subtitle {
            font-size: clamp(0.95rem, 1.6vw, 1.15rem);
            color: #94a3b8;
            max-width: 800px;
            margin: 0 auto 2rem;
            line-height: 1.7;
        }

        .article-meta {
            display: flex;
            justify-content: center;
            gap: 2rem;
            flex-wrap: wrap;
            color: #94a3b8;
            font-size: 0.9rem;
        }

        .article-meta-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .back-link {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            color: #94a3b8;
            margin-bottom: 2rem;
            font-weight: 500;
            transition: color 0.3s ease;
            text-decoration: none;
        }
        .back-link:hover { color: #fff; }

        /* Table of Contents */
        .toc-section {
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            padding: 3rem 2rem;
            border-bottom: 1px solid #e2e8f0;
        }

        [data-theme="dark"] .toc-section {
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
            border-bottom-color: #334155;
        }

        .toc-container { max-width: 1100px; margin: 0 auto; }

        .toc-title {
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--primary-blue);
            margin-bottom: 1.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        [data-theme="dark"] .toc-title { color: var(--accent-red); }

        .toc-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 0.625rem;
        }

        .toc-item {
            background: var(--card-bg);
            padding: 0.75rem 1rem;
            border-radius: 10px;
            border-left: 4px solid var(--accent-red);
            transition: all 0.2s ease;
            text-decoration: none;
            color: var(--text-primary);
            display: block;
        }

        .toc-item:hover {
            transform: translateX(4px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        .toc-item-number {
            font-size: 0.7rem;
            color: var(--accent-red);
            font-weight: 700;
            text-transform: uppercase;
        }

        .toc-item-title {
            font-weight: 600;
            font-size: 0.88rem;
        }

        /* Article Content */
        .article-content {
            padding: 4rem 2rem;
            background: var(--card-bg);
        }

        [data-theme="dark"] .article-content {
            background: var(--bg-dark);
        }

        .article-content .container {
            max-width: 900px;
            margin: 0 auto;
        }

        .article-body {
            font-size: 0.95rem;
            line-height: 1.7;
            color: var(--text-primary);
        }

        .article-body p { margin-bottom: 1rem; }

        .article-body h2 {
            font-size: 1.4rem;
            color: var(--primary-blue);
            margin: 2rem 0 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 3px solid var(--accent-red);
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        [data-theme="dark"] .article-body h2 { color: #93c5fd; }

        .article-body h2 .section-number {
            background: var(--accent-red);
            color: #fff;
            width: 32px; height: 32px;
            border-radius: 8px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            font-size: 0.85rem;
            font-weight: 700;
            flex-shrink: 0;
        }

        .article-body h3 {
            font-size: 1.1rem;
            color: #334155;
            margin: 1.5rem 0 0.5rem;
        }

        .article-body h4 {
            font-size: 0.9rem;
            color: #475569;
            margin: 1rem 0 0.5rem;
        }

        [data-theme="dark"] .article-body h3 { color: #cbd5e1; }

        .article-body ul, .article-body ol {
            margin: 1rem 0;
            padding-left: 1.5rem;
        }

        .article-body li { margin-bottom: 0.35rem; font-size: 0.9rem; }

        .article-body blockquote {
            background: linear-gradient(135deg, #fef2f2 0%, #fee2e2 100%);
            border-left: 4px solid var(--accent-red);
            padding: 1.5rem 2rem;
            margin: 2rem 0;
            border-radius: 0 12px 12px 0;
            font-style: italic;
            color: #991b1b;
        }

        [data-theme="dark"] .article-body blockquote {
            background: rgba(239,68,68,0.04);
            color: #fca5a5;
        }

        /* Tooltip System */
        .tip {
            border-bottom: 1px dashed var(--accent-red);
            cursor: help;
            position: relative;
            font-weight: 500;
        }

        .tip::after {
            content: attr(data-tip);
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            background: #1e293b;
            color: #e2e8f0;
            padding: 0.6rem 0.9rem;
            border-radius: 8px;
            font-size: 0.78rem;
            font-weight: 400;
            font-style: normal;
            line-height: 1.5;
            width: max-content;
            max-width: 300px;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.2s ease;
            z-index: 100;
            box-shadow: 0 4px 12px rgba(0,0,0,0.25);
            white-space: normal;
        }

        .tip:hover::after {
            opacity: 1;
        }

        /* Source References */
        .src-ref {
            font-size: 0.7rem;
            vertical-align: super;
            color: var(--accent-cyan);
            text-decoration: none;
            font-weight: 700;
            cursor: pointer;
        }
        .src-ref:hover { text-decoration: underline; }

        /* Key Insight Box */
        .key-insight {
            background: rgba(239, 68, 68, 0.08);
            border-left: 4px solid var(--accent-red);
            padding: 1.25rem 1.5rem;
            border-radius: 0 12px 12px 0;
            margin: 1.5rem 0;
        }

        [data-theme="dark"] .key-insight {
            background: rgba(239, 68, 68, 0.04);
        }

        .key-insight strong {
            color: var(--accent-red);
            display: block;
            margin-bottom: 0.25rem;
        }

        /* Formula Box */
        .formula-box {
            background: linear-gradient(135deg, #1e3a5f 0%, #2d5a87 100%);
            color: #fff;
            padding: 2rem;
            border-radius: 12px;
            margin: 1.5rem 0;
            text-align: center;
        }

        .formula-box .formula {
            font-family: 'JetBrains Mono', monospace;
            font-size: 1.1rem;
            font-weight: 600;
            margin: 1rem 0;
            color: var(--accent-red);
        }

        .formula-box .formula-label {
            font-size: 0.85rem;
            color: #94a3b8;
        }

        /* Info Boxes */
        .info-box {
            background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
            border-left: 4px solid var(--accent-cyan);
            padding: 1.5rem;
            border-radius: 0 12px 12px 0;
            margin: 1.5rem 0;
        }

        .info-box.warning {
            background: linear-gradient(135deg, #fffbeb 0%, #fef3c7 100%);
            border-left-color: var(--accent-amber);
        }

        .info-box.critical {
            background: linear-gradient(135deg, #fef2f2 0%, #fecaca 100%);
            border-left-color: var(--accent-red);
        }

        .info-box.success {
            background: linear-gradient(135deg, #ecfdf5 0%, #d1fae5 100%);
            border-left-color: var(--accent-emerald);
        }

        [data-theme="dark"] .info-box {
            background: transparent;
        }
        [data-theme="dark"] .info-box.warning {
            background: transparent;
        }
        [data-theme="dark"] .info-box.critical {
            background: transparent;
        }
        [data-theme="dark"] .info-box.success {
            background: transparent;
        }
        [data-theme="dark"] .info-box-title {
            background: transparent;
        }

        .info-box-title {
            font-weight: 700;
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .info-box p { margin: 0; }

        /* Data Tables */
        .data-table-wrapper {
            overflow-x: auto;
            margin: 1.5rem 0;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.08);
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.9rem;
        }

        .data-table thead {
            background: linear-gradient(135deg, var(--primary-blue) 0%, #2d5a87 100%);
            color: #fff;
        }

        .data-table th {
            padding: 1rem;
            text-align: left;
            font-weight: 600;
            white-space: nowrap;
        }

        .data-table td {
            padding: 0.875rem 1rem;
            border-bottom: 1px solid var(--card-border);
        }

        .data-table tbody tr:hover {
            background: var(--table-stripe);
        }

        .data-table tbody tr:last-child td {
            border-bottom: none;
        }

        /* Conclusion Box */
        .conclusion-box {
            background: linear-gradient(135deg, #1e3a5f 0%, #2d5a87 100%);
            color: #fff;
            padding: 2.5rem;
            border-radius: 16px;
            margin: 2rem 0;
        }

        .conclusion-box h3 {
            color: var(--accent-red);
            margin-bottom: 1rem;
            font-size: 1.2rem;
        }

        .conclusion-box p {
            color: #cbd5e1;
            line-height: 1.7;
        }

        .conclusion-box ul {
            color: #cbd5e1;
            margin: 1rem 0;
            padding-left: 1.25rem;
        }

        .conclusion-box li { margin-bottom: 0.5rem; }

        /* Calculator Section */
        .calculator-section {
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
            padding: 3rem 2rem;
            margin: 2rem 0;
            border-radius: 16px;
            color: #e2e8f0;
        }

        .calculator-section h2 {
            color: #fff !important;
            border-bottom-color: var(--accent-red) !important;
        }

        .calculator-section h2 .section-number {
            background: var(--accent-red);
        }

        .calc-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 1.25rem;
            margin-bottom: 2rem;
        }

        .calc-group {
            display: flex;
            flex-direction: column;
        }

        .calc-group label {
            font-size: 0.75rem;
            font-weight: 600;
            color: #94a3b8;
            margin-bottom: 0.4rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .calc-group input,
        .calc-group select {
            padding: 0.7rem 1rem;
            border-radius: 8px;
            border: 1px solid #334155;
            background: rgba(255,255,255,0.05);
            color: #e2e8f0;
            font-size: 0.9rem;
            font-family: 'JetBrains Mono', monospace;
            backdrop-filter: blur(4px);
            transition: border-color 0.2s;
        }

        .calc-group input:focus,
        .calc-group select:focus {
            outline: none;
            border-color: var(--accent-red);
            box-shadow: 0 0 0 3px rgba(239,68,68,0.15);
        }

        .calc-group input[type="range"] {
            -webkit-appearance: none;
            height: 6px;
            background: #334155;
            border-radius: 3px;
            border: none;
            padding: 0;
            margin-top: 0.5rem;
        }

        .calc-group input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            background: var(--accent-red);
            cursor: pointer;
        }

        .range-value {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.85rem;
            color: var(--accent-red);
            font-weight: 600;
            margin-top: 0.25rem;
        }

        .calc-results-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
            gap: 1rem;
        }

        .result-card {
            background: rgba(255,255,255,0.05);
            border: 1px solid #334155;
            border-radius: 12px;
            padding: 1.25rem;
            backdrop-filter: blur(4px);
            transition: border-color 0.2s;
        }

        .result-card:hover {
            border-color: var(--accent-red);
        }

        .result-card-label {
            font-size: 0.72rem;
            font-weight: 600;
            color: #94a3b8;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 0.5rem;
        }

        .result-card-value {
            font-family: 'JetBrains Mono', monospace;
            font-size: 1.5rem;
            font-weight: 700;
            color: #fff;
        }

        .result-card-sub {
            font-size: 0.78rem;
            color: #64748b;
            margin-top: 0.25rem;
        }

        .result-card-value.green { color: #34d399; }
        .result-card-value.amber { color: #fbbf24; }
        .result-card-value.red { color: #f87171; }

        .grade-badge {
            display: inline-block;
            font-size: 0.85rem;
            font-weight: 700;
            padding: 0.15rem 0.6rem;
            border-radius: 6px;
            margin-left: 0.5rem;
        }
        .grade-A { background: #065f46; color: #34d399; }
        .grade-B { background: #164e63; color: #22d3ee; }
        .grade-C { background: #713f12; color: #fbbf24; }
        .grade-D { background: #7c2d12; color: #fb923c; }
        .grade-F { background: #7f1d1d; color: #f87171; }

        /* ═══ TOOLTIP SYSTEM ═══ */
        .tooltip-trigger {
            display: inline-flex; align-items: center; justify-content: center;
            width: 16px; height: 16px; background: rgba(245,158,11,0.15);
            border: 1px solid rgba(245,158,11,0.35); border-radius: 50%;
            font-size: 10px; color: #fbbf24; cursor: help; margin-left: 6px;
            transition: all 0.3s; flex-shrink: 0;
        }
        .tooltip-trigger:hover { background: rgba(245,158,11,0.3); transform: scale(1.15); }
        .tooltip-trigger .tooltip-content { display: none; }
        #alarm-tooltip-container {
            position: fixed; width: 320px; max-width: calc(100vw - 40px);
            padding: 14px; background: linear-gradient(135deg,#1e3a5f,#2d5a87);
            border: 1px solid rgba(255,255,255,0.2); border-radius: 12px;
            box-shadow: 0 15px 50px rgba(0,0,0,0.5); z-index: 999999;
            pointer-events: none; opacity: 0; visibility: hidden;
            transition: opacity 0.15s ease; color: white; font-size: 12px; line-height: 1.5;
        }
        #alarm-tooltip-container.visible { opacity: 1; visibility: visible; }
        #alarm-tooltip-container .tooltip-title { font-size: 13px; font-weight: 700; color: #fbbf24; margin-bottom: 8px; }
        #alarm-tooltip-container .tooltip-desc { color: rgba(255,255,255,0.9); margin-bottom: 6px; }
        #alarm-tooltip-container .tooltip-formula { font-family: 'JetBrains Mono', monospace; font-size: 11px; background: rgba(0,0,0,0.3); padding: 6px 10px; border-radius: 6px; margin-top: 6px; color: #22d3ee; }

        /* ═══ MODE TOGGLE ═══ */
        .alarm-mode-bar { display: flex; gap: 8px; margin-bottom: 0; }
        .alarm-toolbar-row { display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 0.75rem; margin-bottom: 1.5rem; }
        .alarm-toolbar-actions { display: flex; gap: 8px; align-items: center; }
        .alarm-mode-btn {
            padding: 8px 20px; border-radius: 8px; border: 1px solid rgba(255,255,255,0.2);
            background: rgba(255,255,255,0.06); color: #94a3b8; font-size: 0.82rem;
            font-weight: 600; cursor: pointer; transition: all 0.3s; display: flex;
            align-items: center; gap: 6px; font-family: inherit;
        }
        .alarm-mode-btn:hover { background: rgba(255,255,255,0.12); color: #e2e8f0; }
        .alarm-mode-btn.active { background: linear-gradient(135deg, #ef4444, #dc2626); color: #fff; border-color: #ef4444; box-shadow: 0 4px 15px rgba(239,68,68,0.4), 0 0 20px rgba(239,68,68,0.2); font-weight: 700; }
        .gated-badge { display: inline-block; background: linear-gradient(135deg,#7c3aed,#a855f7); color: #fff; font-size: 0.65rem; font-weight: 700; padding: 2px 8px; border-radius: 4px; margin-left: 6px; vertical-align: middle; text-transform: uppercase; letter-spacing: 0.5px; }

        /* ═══ PRO PANELS & GATING ═══ */
        .pro-panel { position: relative; margin-top: 1.5rem; }
        .pro-panel-inner { padding: 1.25rem; background: rgba(255,255,255,0.03); border: 1px solid rgba(255,255,255,0.08); border-radius: 14px; }
        .pro-panel-title { font-size: 0.95rem; font-weight: 700; color: #f87171; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 0.75rem; display: flex; align-items: center; gap: 8px; }
        .pro-panel-title i { font-size: 0.75rem; }
        .gated-overlay {
            position: absolute; inset: 0; background: rgba(15,23,42,0.7);
            backdrop-filter: blur(6px); -webkit-backdrop-filter: blur(6px);
            border-radius: 14px; display: flex; flex-direction: column;
            align-items: center; justify-content: center; z-index: 10; cursor: pointer;
        }
        .gated-overlay .gated-icon { font-size: 2rem; color: #fbbf24; margin-bottom: 8px; }
        .gated-overlay .gated-text { color: #e2e8f0; font-size: 0.85rem; font-weight: 600; }
        .gated-overlay .gated-sub { color: #94a3b8; font-size: 0.75rem; margin-top: 4px; }

        /* ═══ PRO INPUTS ═══ */
        #alarmProInputs { display: none; margin-top: 1.5rem; padding-top: 1.5rem; border-top: 1px solid rgba(255,255,255,0.1); }
        .pro-input-section-title { font-size: 0.72rem; font-weight: 700; color: #f87171; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 0.75rem; }

        /* ═══ ACTION TOOLBAR ═══ */
        .alarm-action-toolbar {
            display: flex; gap: 8px; justify-content: center; margin-top: 1.5rem; flex-wrap: wrap;
        }
        .alarm-action-btn {
            padding: 8px 18px; border-radius: 8px; border: 1px solid rgba(255,255,255,0.2);
            background: rgba(255,255,255,0.06); color: #e2e8f0; font-size: 0.8rem;
            font-weight: 600; cursor: pointer; transition: all 0.3s; display: flex;
            align-items: center; gap: 6px; font-family: inherit;
        }
        .alarm-action-btn:hover { background: rgba(255,255,255,0.12); transform: translateY(-1px); }
        .alarm-action-btn.primary { background: linear-gradient(135deg,#dc2626,#ef4444); border-color: transparent; color: white; }
        .alarm-action-btn.primary:hover { filter: brightness(1.1); }

        /* ═══ LOGIN MODAL ═══ */
        #alarmLoginModal {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.75); backdrop-filter: blur(8px); z-index: 99999;
            align-items: center; justify-content: center;
        }
        #alarmLoginModal.show { display: flex; }
        .alarm-login-box {
            background: white; border-radius: 20px; padding: 2.5rem; max-width: 420px;
            width: 90%; box-shadow: 0 25px 60px rgba(0,0,0,0.3); position: relative;
        }
        .alarm-login-box input {
            width: 100%; padding: 12px 14px; border: 1px solid #e2e8f0; border-radius: 10px;
            font-size: 0.95rem; font-family: inherit; outline: none; transition: border-color 0.3s;
            color: #1e293b; background: #f1f5f9;
        }
        .alarm-login-box input:focus { border-color: #ef4444; }

        /* ═══ NAVBAR AUTH ═══ */
        .nav-auth-wrap { position: relative; margin-left: 0.5rem; }
        .nav-login-btn {
            display: flex; align-items: center; gap: 6px; padding: 8px 18px;
            background: linear-gradient(135deg,#dc2626,#ef4444); border: none; border-radius: 8px;
            color: white; font-size: 0.82rem; font-weight: 600; font-family: inherit;
            cursor: pointer; transition: all 0.3s; box-shadow: 0 3px 10px rgba(239,68,68,0.3);
            white-space: nowrap;
        }
        .nav-login-btn:hover { transform: translateY(-1px); box-shadow: 0 5px 16px rgba(239,68,68,0.4); }
        .nav-user-btn {
            display: none; align-items: center; gap: 8px; padding: 6px 12px 6px 6px;
            background: rgba(239,68,68,0.08); border: 1px solid rgba(239,68,68,0.25);
            border-radius: 50px; cursor: pointer; transition: all 0.3s; font-family: inherit; color: #e2e8f0;
        }
        .nav-user-btn:hover { background: rgba(239,68,68,0.14); border-color: rgba(239,68,68,0.4); }
        .nav-user-avatar { width: 30px; height: 30px; border-radius: 50%; background: linear-gradient(135deg,#dc2626,#ef4444); display: flex; align-items: center; justify-content: center; color: white; font-size: 0.7rem; font-weight: 700; }
        .nav-user-email { font-size: 0.8rem; font-weight: 500; color: #94a3b8; max-width: 130px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
        .nav-user-dropdown {
            display: none; position: absolute; top: calc(100% + 8px); right: 0;
            background: #1e293b; border-radius: 12px; border: 1px solid #334155;
            box-shadow: 0 12px 40px rgba(0,0,0,0.3); min-width: 220px; z-index: 1000;
        }
        .nav-user-dropdown.show { display: block; }

        /* References Section */
        .ref-list {
            list-style: none;
            padding: 0;
            counter-reset: ref-counter;
        }

        .ref-list li {
            counter-increment: ref-counter;
            padding: 0.75rem 0 0.75rem 2.5rem;
            border-bottom: 1px solid var(--card-border);
            font-size: 0.88rem;
            line-height: 1.7;
            position: relative;
        }

        .ref-list li::before {
            content: "[" counter(ref-counter) "]";
            color: var(--accent-red);
            font-weight: 700;
            font-size: 0.8rem;
            position: absolute;
            left: 0;
            top: 0.75rem;
        }

        .ref-list a {
            color: var(--accent-cyan);
            text-decoration: none;
            word-break: break-all;
        }

        .ref-list a:hover { text-decoration: underline; }

        /* Author Bio — styled via styles.css */

        /* Article Nav */
        .article-nav {
            display: flex;
            justify-content: space-between;
            padding: 2rem 0;
            border-top: 1px solid var(--card-border);
            margin-top: 3rem;
        }

        .article-nav a {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: var(--primary-blue);
            font-weight: 600;
            transition: color 0.3s ease;
            text-decoration: none;
        }

        [data-theme="dark"] .article-nav a { color: #93c5fd; }
        .article-nav a:hover { color: var(--accent-red); }

        /* Print Styles */
        @media print {
            .navbar, .calculator-section, .toc-section, .share-buttons { display: none !important; }
            .article-hero { padding: 1.5rem 1rem; background: #1e3a5f !important; -webkit-print-color-adjust: exact; print-color-adjust: exact; }
            .article-hero .article-badge, .article-hero .article-meta { display: none; }
            .article-content { padding: 1rem; }
            body { font-size: 10pt; color: #000; }
            .key-insight, .formula-box, .conclusion-box, .info-box { break-inside: avoid; }
            .article-body h2 { break-after: avoid; }
            a { color: inherit; text-decoration: none; }
            footer { display: none !important; }
        }

        /* Responsive */
        @media (max-width: 900px) {
            .calc-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            .calc-results-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            .toc-grid {
                grid-template-columns: 1fr 1fr;
            }
        }

        /* ═══ TOC CALCULATOR HIGHLIGHT ═══ */
        .toc-item.toc-calculator {
            background: linear-gradient(135deg, rgba(239,68,68,0.06) 0%, rgba(234,88,12,0.04) 100%);
            border-left: 4px solid var(--accent-red);
            border: 2px solid rgba(239,68,68,0.2);
            border-left: 4px solid var(--accent-red);
            position: relative;
        }
        .toc-item.toc-calculator .toc-item-number {
            display: flex; align-items: center; gap: 6px;
        }
        .toc-item.toc-calculator .toc-calc-badge {
            display: inline-flex; align-items: center; gap: 3px;
            background: var(--accent-red); color: #fff;
            font-size: 0.55rem; font-weight: 700; text-transform: uppercase;
            letter-spacing: 0.5px; padding: 2px 6px; border-radius: 4px;
        }
        [data-theme="dark"] .toc-item.toc-calculator {
            background: linear-gradient(135deg, rgba(239,68,68,0.08) 0%, rgba(234,88,12,0.05) 100%);
            border-color: rgba(239,68,68,0.25);
            border-left-color: var(--accent-red);
        }

        /* ═══ EVIDENCE BLOCK ═══ */
        .evidence-block {
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
            border-radius: 16px; padding: 2rem; margin: 2.5rem 0;
            border: 1px solid rgba(239,68,68,0.15);
        }
        .evidence-block-title {
            font-size: 0.75rem; font-weight: 700; text-transform: uppercase;
            letter-spacing: 1.5px; color: #ef4444; margin-bottom: 1.25rem;
            display: flex; align-items: center; gap: 0.5rem;
        }
        .evidence-grid {
            display: grid; grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); gap: 1rem;
        }
        .evidence-card {
            background: rgba(255,255,255,0.04); border: 1px solid rgba(255,255,255,0.08);
            border-radius: 12px; padding: 1.25rem 1rem; text-align: center;
            transition: all 0.3s ease;
        }
        .evidence-card:hover { background: rgba(239,68,68,0.06); border-color: rgba(239,68,68,0.2); transform: translateY(-2px); }
        .evidence-card-value { font-size: 1.4rem; font-weight: 800; font-family: 'JetBrains Mono', monospace; margin-bottom: 4px; }
        .evidence-card-label { font-size: 0.72rem; color: #94a3b8; line-height: 1.4; }
        .evidence-card-sub { font-size: 0.65rem; color: #64748b; margin-top: 4px; }
        .evidence-source { margin-top: 1rem; font-size: 0.7rem; color: #64748b; text-align: center; font-style: italic; }

        /* ═══ PRIVACY & BENCHMARK META ═══ */
        .privacy-badge {
            display: flex; align-items: center; justify-content: center; gap: 6px;
            font-size: 0.72rem; color: #64748b; margin-top: 0.5rem; padding: 6px 0;
        }
        .privacy-badge i { color: #10b981; font-size: 0.8rem; }
        .benchmark-meta {
            display: flex; flex-wrap: wrap; gap: 0.75rem; margin-top: 0.75rem;
            padding-top: 0.75rem; border-top: 1px solid rgba(255,255,255,0.08);
        }
        .benchmark-meta-tag {
            font-size: 0.65rem; color: #64748b; background: rgba(255,255,255,0.04);
            padding: 3px 8px; border-radius: 4px; display: flex; align-items: center; gap: 4px;
        }
        .benchmark-meta-tag i { font-size: 0.6rem; }

        @media (max-width: 600px) {
            .evidence-grid { grid-template-columns: repeat(2, 1fr); }
            .evidence-card-value { font-size: 1.1rem; }
            .article-hero { padding: 6rem 1rem 3rem; }
            .article-meta { flex-direction: column; gap: 0.75rem; }
            .article-content { padding: 2rem 1rem; }
            .article-body { font-size: 0.95rem; }
            .calc-grid {
                grid-template-columns: 1fr;
            }
            .calc-results-grid {
                grid-template-columns: 1fr;
            }
            .toc-grid {
                grid-template-columns: 1fr;
            }
            .data-table { font-size: 0.8rem; }
            .data-table th, .data-table td { padding: 0.6rem; }
            .calculator-section { padding: 2rem 1rem; }
            .tip::after { left: 0; transform: none; max-width: 220px; }
            .article-nav { flex-direction: column; gap: 1rem; }
        }
    
        /* Result Card Tooltip System */
        .res-tip {
            display: inline-flex; align-items: center; justify-content: center;
            width: 14px; height: 14px;
            background: rgba(245,158,11,0.15); border: 1px solid rgba(245,158,11,0.3);
            border-radius: 50%; font-size: 0.6rem; font-weight: 700;
            color: #fbbf24; margin-left: 4px; cursor: help;
            position: relative; flex-shrink: 0; vertical-align: middle;
            line-height: 1;
        }
        .res-tip:hover { background: rgba(245,158,11,0.3); transform: scale(1.15); }
        .res-tip .res-tip-body {
            visibility: hidden; opacity: 0;
            position: absolute; bottom: calc(100% + 8px); left: 50%;
            transform: translateX(-50%);
            background: #1e293b; color: #e2e8f0;
            padding: 0.7rem 0.9rem; border-radius: 8px;
            font-size: 0.72rem; font-weight: 400; line-height: 1.5;
            width: 260px; z-index: 100;
            box-shadow: 0 8px 25px rgba(0,0,0,0.5);
            border: 1px solid rgba(245,158,11,0.2);
            transition: opacity 0.2s ease; pointer-events: none;
            text-transform: none; letter-spacing: normal;
        }
        .res-tip:hover .res-tip-body { visibility: visible; opacity: 1; }
        .res-tip-body .rtt { font-weight: 700; color: #fbbf24; margin-bottom: 3px; font-size: 0.75rem; }
        .res-tip-body .rtd { color: #cbd5e1; }
        .res-tip-body .rtf {
            font-family: 'JetBrains Mono', monospace; font-size: 0.68rem;
            background: rgba(0,0,0,0.3); padding: 3px 7px; border-radius: 4px;
            color: #67e8f9; margin-top: 4px; display: block;
        }

        /* ═══ Endsley SA Diagram ═══ */
        .sa-diagram {
            max-width: 600px;
            margin: 1.5rem auto 2rem;
            padding: 1.5rem;
            background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
            border-radius: 16px;
            border: 1px solid #bae6fd;
        }
        [data-theme="dark"] .sa-diagram {
            background: linear-gradient(135deg, #0c1929 0%, #172554 100%);
            border-color: #1e3a5f;
        }
        .sa-level {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 0.875rem 1.25rem;
            border-radius: 12px;
            border-left: 4px solid;
            position: relative;
        }
        .sa-level-3 {
            background: linear-gradient(135deg, rgba(239,68,68,0.08) 0%, rgba(239,68,68,0.03) 100%);
            border-left-color: #ef4444;
        }
        [data-theme="dark"] .sa-level-3 {
            background: linear-gradient(135deg, rgba(239,68,68,0.15) 0%, rgba(239,68,68,0.05) 100%);
        }
        .sa-level-2 {
            background: linear-gradient(135deg, rgba(245,158,11,0.08) 0%, rgba(245,158,11,0.03) 100%);
            border-left-color: #f59e0b;
        }
        [data-theme="dark"] .sa-level-2 {
            background: linear-gradient(135deg, rgba(245,158,11,0.15) 0%, rgba(245,158,11,0.05) 100%);
        }
        .sa-level-1 {
            background: linear-gradient(135deg, rgba(16,185,129,0.08) 0%, rgba(16,185,129,0.03) 100%);
            border-left-color: #10b981;
        }
        [data-theme="dark"] .sa-level-1 {
            background: linear-gradient(135deg, rgba(16,185,129,0.15) 0%, rgba(16,185,129,0.05) 100%);
        }
        .sa-badge {
            flex-shrink: 0;
            width: 42px;
            height: 42px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 800;
            font-size: 0.9rem;
            color: #fff;
        }
        .sa-level-3 .sa-badge { background: linear-gradient(135deg, #ef4444, #dc2626); }
        .sa-level-2 .sa-badge { background: linear-gradient(135deg, #f59e0b, #d97706); }
        .sa-level-1 .sa-badge { background: linear-gradient(135deg, #10b981, #059669); }
        .sa-info {
            flex: 1;
        }
        .sa-info strong {
            display: block;
            font-size: 0.95rem;
            color: var(--text-primary);
            margin-bottom: 0.15rem;
        }
        .sa-info span {
            font-size: 0.82rem;
            color: var(--text-secondary);
            line-height: 1.4;
        }
        .sa-alarm-state {
            flex-shrink: 0;
            font-size: 0.75rem;
            font-weight: 600;
            padding: 0.3rem 0.7rem;
            border-radius: 6px;
            white-space: nowrap;
        }
        .sa-level-3 .sa-alarm-state {
            background: rgba(239,68,68,0.12);
            color: #dc2626;
        }
        [data-theme="dark"] .sa-level-3 .sa-alarm-state { color: #fca5a5; background: rgba(239,68,68,0.2); }
        .sa-level-2 .sa-alarm-state {
            background: rgba(245,158,11,0.12);
            color: #b45309;
        }
        [data-theme="dark"] .sa-level-2 .sa-alarm-state { color: #fcd34d; background: rgba(245,158,11,0.2); }
        .sa-level-1 .sa-alarm-state {
            background: rgba(16,185,129,0.12);
            color: #047857;
        }
        [data-theme="dark"] .sa-level-1 .sa-alarm-state { color: #6ee7b7; background: rgba(16,185,129,0.2); }
        .sa-arrow {
            text-align: center;
            font-size: 1.2rem;
            color: var(--text-secondary);
            padding: 0.25rem 0;
            opacity: 0.6;
        }
        .sa-caption {
            text-align: center;
            font-size: 0.8rem;
            color: var(--text-secondary);
            margin-top: 1rem;
            margin-bottom: 0;
            font-style: italic;
            line-height: 1.5;
        }

        /* ═══ Operator Story (Real Scenario) ═══ */
        .operator-story {
            background: linear-gradient(135deg, #fef2f2 0%, #fff1f2 100%);
            border: 1px solid #fecaca;
            border-left: 4px solid #ef4444;
            border-radius: 12px;
            padding: 1.5rem;
            margin: 2rem 0;
        }
        [data-theme="dark"] .operator-story {
            background: linear-gradient(135deg, #1a0a0a 0%, #2d1010 100%);
            border-color: rgba(239,68,68,0.3);
            border-left-color: #ef4444;
        }
        .operator-story-label {
            font-weight: 700;
            font-size: 0.9rem;
            color: #991b1b;
            margin-bottom: 0.75rem;
        }
        [data-theme="dark"] .operator-story-label { color: #fca5a5; }
        .operator-story p {
            color: #374151 !important;
            font-size: 0.91rem !important;
            line-height: 1.7 !important;
        }
        [data-theme="dark"] .operator-story p {
            color: #cbd5e1 !important;
        }
        .article-body .operator-story blockquote {
            background: rgba(239,68,68,0.06) !important;
            border-left: 3px solid #ef4444 !important;
            border-color: #ef4444 !important;
            padding: 1rem 1.25rem;
            margin: 1rem 0 0;
            border-radius: 0 8px 8px 0;
            font-style: italic;
            color: #991b1b !important;
            font-size: 0.9rem;
        }
        [data-theme="dark"] .article-body .operator-story blockquote {
            background: rgba(239,68,68,0.1) !important;
            color: #fca5a5 !important;
            border-color: #ef4444 !important;
        }
        @media (max-width: 640px) {
            .sa-level { flex-wrap: wrap; gap: 0.5rem; }
            .sa-alarm-state { width: 100%; text-align: center; }
        }

        /* ═══ Monte Carlo Section ═══ */
        .mc-section {
            background: linear-gradient(135deg, #faf5ff 0%, #f3e8ff 100%);
            border: 1px solid #e9d5ff;
            border-radius: 16px;
            padding: 2rem;
        }
        [data-theme="dark"] .mc-section {
            background: linear-gradient(135deg, #1a0a2e 0%, #1e1145 100%);
            border-color: rgba(139,92,246,0.25);
        }
        .mc-header {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            margin-bottom: 0.75rem;
        }
        .mc-icon {
            font-size: 1.8rem;
            width: 48px;
            height: 48px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, #7c3aed, #a855f7);
            border-radius: 12px;
            flex-shrink: 0;
        }
        .mc-title {
            font-size: 1.15rem;
            font-weight: 800;
            color: #581c87;
        }
        [data-theme="dark"] .mc-title { color: #c4b5fd; }
        .mc-subtitle {
            font-size: 0.82rem;
            color: #7c3aed;
            margin-top: 0.1rem;
        }
        [data-theme="dark"] .mc-subtitle { color: #a78bfa; }
        .mc-controls {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 0.75rem;
            margin-bottom: 1rem;
        }
        .mc-control label {
            display: block;
            font-size: 0.8rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 0.35rem;
        }
        .mc-control input,
        .mc-control select {
            width: 100%;
            padding: 0.5rem 0.75rem;
            border-radius: 8px;
            border: 1px solid #d8b4fe;
            background: var(--card-bg);
            color: var(--text-primary);
            font-size: 0.85rem;
            transition: border-color 0.2s;
            box-sizing: border-box;
        }
        .mc-control input:focus,
        .mc-control select:focus {
            outline: none;
            border-color: #7c3aed;
            box-shadow: 0 0 0 3px rgba(124,58,237,0.15);
        }
        [data-theme="dark"] .mc-control input,
        [data-theme="dark"] .mc-control select {
            border-color: rgba(139,92,246,0.3);
            background: rgba(30,17,69,0.5);
        }
        .mc-run-btn {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.6rem 1.25rem;
            background: linear-gradient(135deg, #7c3aed, #9333ea);
            color: #fff;
            border: none;
            border-radius: 10px;
            font-size: 0.85rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.2s;
            box-shadow: 0 2px 8px rgba(124,58,237,0.3);
        }
        .mc-run-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 16px rgba(124,58,237,0.4);
        }
        .mc-run-btn:active { transform: translateY(0); }
        .mc-progress {
            margin-bottom: 1rem;
        }
        .mc-progress-bar {
            height: 4px;
            background: #e9d5ff;
            border-radius: 2px;
            overflow: hidden;
            margin-top: 0.35rem;
        }
        [data-theme="dark"] .mc-progress-bar { background: rgba(139,92,246,0.2); }
        .mc-progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #7c3aed, #a855f7);
            border-radius: 2px;
            transition: width 0.3s;
        }
        .mc-results-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 0.625rem;
            margin-bottom: 1rem;
        }
        .mc-stat {
            background: var(--card-bg);
            border: 1px solid #e9d5ff;
            border-radius: 10px;
            padding: 0.75rem;
            text-align: center;
        }
        [data-theme="dark"] .mc-stat {
            background: rgba(30,17,69,0.4);
            border-color: rgba(139,92,246,0.2);
        }
        .mc-stat-label {
            font-size: 0.68rem;
            color: var(--text-secondary);
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.3px;
            margin-bottom: 0.3rem;
        }
        .mc-stat-p50 {
            font-size: 1.3rem;
            font-weight: 800;
            color: #7c3aed;
            font-family: 'JetBrains Mono', monospace;
        }
        [data-theme="dark"] .mc-stat-p50 { color: #c4b5fd; }
        .mc-stat-range {
            font-size: 0.68rem;
            color: var(--text-secondary);
            margin-top: 0.15rem;
        }
        .chart-wrap {
            background: var(--card-bg);
            border: 1px solid #e9d5ff;
            border-radius: 12px;
            padding: 1rem 1.25rem;
        }
        [data-theme="dark"] .chart-wrap {
            background: rgba(30,17,69,0.3);
            border-color: rgba(139,92,246,0.2);
        }
        .chart-title {
            font-size: 0.85rem;
            font-weight: 700;
            color: #581c87;
            margin-bottom: 0.5rem;
        }
        [data-theme="dark"] .chart-title { color: #c4b5fd; }
        @media (max-width: 640px) {
            .mc-controls { grid-template-columns: 1fr; }
            .mc-results-grid { grid-template-columns: repeat(2, 1fr); }
        }

        /* ═══ Sankey Section ═══ */
        .sankey-section {
            background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
            border: 1px solid #e2e8f0;
            border-radius: 16px;
            padding: 2rem;
        }
        [data-theme="dark"] .sankey-section {
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
            border-color: #334155;
        }
        .sankey-header {
            margin-bottom: 1.25rem;
        }
        .sankey-title {
            font-size: 1.15rem;
            font-weight: 800;
            color: #1e3a5f;
            margin-bottom: 0.25rem;
        }
        [data-theme="dark"] .sankey-title { color: #e2e8f0; }
        .sankey-subtitle {
            font-size: 0.82rem;
            color: var(--text-secondary);
            line-height: 1.5;
        }
        #sankeyChart {
            display: block;
            width: 100%;
            background: var(--card-bg);
            border-radius: 12px;
            border: 1px solid var(--card-border);
        }
        [data-theme="dark"] #sankeyChart {
            background: rgba(15,23,42,0.5);
        }
        .sankey-legend {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem 1.25rem;
            margin-top: 1rem;
            padding: 0.75rem 1rem;
            background: var(--card-bg);
            border: 1px solid var(--card-border);
            border-radius: 10px;
        }
        [data-theme="dark"] .sankey-legend {
            background: rgba(15,23,42,0.4);
            border-color: #334155;
        }
        .sankey-legend-item {
            display: flex;
            align-items: center;
            gap: 0.4rem;
            font-size: 0.78rem;
            color: var(--text-primary);
            font-weight: 500;
        }
        .sankey-legend-dot {
            width: 10px;
            height: 10px;
            border-radius: 3px;
            flex-shrink: 0;
        }
        @media (max-width: 640px) {
            .mc-section, .sankey-section { padding: 1.25rem; }
            .sankey-legend { gap: 0.35rem 0.75rem; }
        }
</style>
    <link rel="preload" as="image" href="assets/article-2-cover.jpg">
    <!-- Chart.js for data visualizations -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-annotation@3.0.1/dist/chartjs-plugin-annotation.min.js"></script>
    <!-- D3.js + d3-sankey for alarm flow diagram -->
    <script src="https://cdn.jsdelivr.net/npm/d3@7.8.5/dist/d3.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/d3-sankey@0.12.3/dist/d3-sankey.min.js"></script>

    <script src="https://cdn.jsdelivr.net/npm/fuse.js@7.0.0" defer></script>
</head>
<body>
    <!-- Reading Progress Bar -->
    <div class="scroll-progress" id="scrollProgress"></div>

    <!-- Search Overlay & Modal -->
    <div class="search-overlay" id="searchOverlay"></div>
    <div class="search-modal" id="searchModal">
        <div class="search-input-wrap">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg>
            <input type="text" class="search-input" id="searchInput" placeholder="Search articles, calculators, tools..." autocomplete="off">
            <kbd class="search-kbd">ESC</kbd>
        </div>
        <div class="search-chips" id="searchChips">
            <button class="search-chip active" data-filter="all">All</button>
            <button class="search-chip" data-filter="articles">Articles</button>
            <button class="search-chip" data-filter="calculators">Calculators</button>
            <button class="search-chip" data-filter="tools">Tools</button>
        </div>
        <div class="search-results" id="searchResults">
            <div class="search-empty">Type to search across all content</div>
        </div>
        <div class="search-footer">
            <span><kbd class="search-kbd">&uarr;&darr;</kbd> Navigate</span>
            <span><kbd class="search-kbd">Enter</kbd> Open</span>
        </div>
    </div>
    <div class="search-preview" id="searchPreview"></div>

    <!-- TOC Sidebar (desktop, wide screens) -->
    <nav class="toc-sidebar" id="tocSidebar" aria-label="Table of Contents">
        <div class="toc-sidebar-label">On this page</div>
        <ul class="toc-sidebar-list" id="tocSidebarList"></ul>
    </nav>

    <!-- TOC Mobile Toggle -->
    <button class="toc-mobile-toggle" id="tocMobileToggle" aria-label="Table of contents">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="8" y1="6" x2="21" y2="6"/><line x1="8" y1="12" x2="21" y2="12"/><line x1="8" y1="18" x2="21" y2="18"/><line x1="3" y1="6" x2="3.01" y2="6"/><line x1="3" y1="12" x2="3.01" y2="12"/><line x1="3" y1="18" x2="3.01" y2="18"/></svg>
    </button>
    <div class="toc-mobile-backdrop" id="tocMobileBackdrop"></div>
    <div class="toc-mobile-drawer" id="tocMobileDrawer">
        <div class="toc-drawer-header">
            <span class="toc-drawer-title">Table of Contents</span>
            <button class="toc-drawer-close" id="tocDrawerClose" aria-label="Close">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>
            </button>
        </div>
        <ul class="toc-mobile-list" id="tocMobileList"></ul>
    </div>


    <a href="#main-content" class="skip-link">Skip to main content</a>
    <nav class="navbar">
        <div class="nav-container">
            <a href="index.html" class="nav-logo">
                <img loading="lazy" src="assets/profile-photo.jpg" alt="Bagus Dwi Permana" class="nav-avatar">
            </a>
            <ul class="nav-menu">
                <li><a href="index.html" class="nav-link">Home</a></li>
                <li class="nav-dropdown">
                    <a href="datacenter-solutions.html" class="nav-link">
                        DC Solutions
                        <svg class="dropdown-arrow" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polyline points="6 9 12 15 18 9"></polyline>
                        </svg>
                    </a>
                    <ul class="dropdown-menu">
                        <li><a href="datacenter-solutions.html" style="color: #06b6d4; font-weight: 600;">DC Solutions Hub</a></li>
                        <li style="border-bottom: 1px solid rgba(255,255,255,0.1); margin: 4px 0;"></li>
                        <li><a href="datahallAI.html" style="color: #8b5cf6;">DC AI/HPC</a></li>
                        <li><a href="dc-conventional.html">DC Conventional</a></li>
                        <li style="border-bottom: 1px solid rgba(255,255,255,0.1); margin: 4px 0;"></li>
                        <li><a href="capex-calculator.html" style="color: #f59e0b;">CAPEX Calculator</a></li>
                        <li><a href="opex-calculator.html" style="color: #10b981;">OPEX Calculator</a></li>
                        <li style="border-bottom: 1px solid rgba(255,255,255,0.1); margin: 4px 0;"></li>
                        <li><a href="dcmoc/" style="color: #ef4444; font-weight: 600;">DC MOC</a></li>
                    </ul>
                </li>
                <li><a href="index.html#metrics" class="nav-link">Results</a></li>
                <li><a href="index.html#case-studies" class="nav-link">Case Studies</a></li>
                <li><a href="articles.html" class="nav-link">Articles</a></li>
                <li><a href="index.html#faq" class="nav-link">FAQ</a></li>
                <li><a href="index.html#contact" class="nav-link">Contact</a></li>
            </ul>
                        <button class="nav-search-btn" id="navSearchBtn" aria-label="Search" title="Search (Ctrl+K)">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg>
            </button>
            <button class="theme-toggle" id="themeToggle" aria-label="Toggle dark mode" title="Toggle dark/light mode">
                <svg class="moon-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                </svg>
                <svg class="sun-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <circle cx="12" cy="12" r="5"></circle>
                    <line x1="12" y1="1" x2="12" y2="3"></line>
                    <line x1="12" y1="21" x2="12" y2="23"></line>
                    <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                    <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                    <line x1="1" y1="12" x2="3" y2="12"></line>
                    <line x1="21" y1="12" x2="23" y2="12"></line>
                    <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                    <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                </svg>
            </button>
            <div class="nav-auth-wrap" id="alarmNavAuthWrap">
                <button class="nav-login-btn" id="alarmNavLoginBtn" onclick="if(window._rzAuth)window._rzAuth.showModal();else alarmShowLogin()"><i class="fas fa-user-circle"></i> <span>Login</span></button>
                <button class="nav-user-btn" id="alarmNavUserBtn" onclick="alarmToggleDropdown()">
                    <span class="nav-user-avatar" id="alarmNavAvatar">U</span>
                    <span class="nav-user-email" id="alarmNavEmail">user@email.com</span>
                    <i class="fas fa-chevron-down" style="font-size:0.6rem;color:#64748b;"></i>
                </button>
                <div class="nav-user-dropdown" id="alarmNavDropdown">
                    <div style="padding:14px 16px;border-bottom:1px solid #334155;">
                        <div style="display:inline-block;padding:2px 8px;border-radius:4px;background:linear-gradient(135deg,#dc2626,#ef4444);color:white;font-size:0.6rem;font-weight:700;margin-bottom:6px;">PRO</div>
                        <div style="font-size:0.8rem;color:#94a3b8;" id="alarmDdEmail">user@email.com</div>
                    </div>
                    <button onclick="alarmLogout()" style="width:100%;text-align:left;padding:12px 16px;border:none;background:none;cursor:pointer;color:#ef4444;font-size:0.85rem;font-family:inherit;font-weight:500;">
                        <i class="fas fa-sign-out-alt" style="margin-right:8px;"></i>Logout
                    </button>
                </div>
            </div>
            <button class="hamburger" aria-label="Open navigation menu" aria-expanded="false">
                <span class="bar"></span>
                <span class="bar"></span>
                <span class="bar"></span>
            </button>
        </div>
    </nav>

    <main id="main-content">
    <!-- Hero Section -->
    <section class="article-hero">
        <div class="container">
            <a href="articles.html" class="back-link">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M19 12H5M12 19l-7-7 7-7"/></svg>
                Back to Articles
            </a>
            <span class="article-badge">Operations Engineering Journal #2</span>
            <h1 class="article-title">Alarm Fatigue Is Not a Human Problem &mdash; It Is a System Design Failure</h1>
            <p class="article-subtitle">When operators ignore alarms, the system has failed them &mdash; not the other way around. A rigorous engineering analysis of alarm management through ISA-18.2, cognitive load theory, and a structured rationalization that achieved &gt;90% alarm reduction in a live data center.</p>
            <div class="article-meta">
                <span class="article-meta-item">
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><path d="M12 6v6l4 2"/></svg>
                    25 min read
                </span>
                <span class="article-meta-item">
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>
                    December 7, 2025
                </span>
                <span class="article-meta-item">
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>
                    Bagus Dwi Permana
                </span>
            </div>
        </div>
    </section>
    <!-- Series Navigation -->
    <div class="series-nav" style="margin-top: 1rem;">
        <div class="series-badge">
            <span class="series-badge-icon">02</span>
            Engineering Journal &mdash; Article 2 of 18
        </div>
        <span class="series-title"></span>
        <div class="series-links">
            <a href="article-1.html" class="series-link"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="15 18 9 12 15 6"/></svg>Prev</a>
            <a href="article-3.html" class="series-link">Next<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="9 18 15 12 9 6"/></svg></a>
        </div>
    </div>


    <!-- Featured Image -->
    <figure style="margin: 2rem 0; text-align: center;">
        <img src="Article/Article_2 02.02.26/2.1.jpg" alt="Emergency power systems and generator operations in mission-critical data center facilities" loading="lazy" style="max-width: 100%; height: auto; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.1);" decoding="async">
    </figure>

    <!-- Table of Contents -->
    <section class="toc-section">
        <div class="toc-container">
            <div class="toc-title">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="8" y1="6" x2="21" y2="6"/><line x1="8" y1="12" x2="21" y2="12"/><line x1="8" y1="18" x2="21" y2="18"/><line x1="3" y1="6" x2="3.01" y2="6"/><line x1="3" y1="12" x2="3.01" y2="12"/><line x1="3" y1="18" x2="3.01" y2="18"/></svg>
                Table of Contents
            </div>
            <div class="toc-grid">
                <a href="#sec1" class="toc-item"><div class="toc-item-number">Section 1</div><div class="toc-item-title">Abstract</div></a>
                <a href="#sec2" class="toc-item"><div class="toc-item-number">Section 2</div><div class="toc-item-title">The Misattribution Problem</div></a>
                <a href="#sec3" class="toc-item"><div class="toc-item-number">Section 3</div><div class="toc-item-title">Human Factors & Cognitive Load Theory</div></a>
                <a href="#sec4" class="toc-item"><div class="toc-item-number">Section 4</div><div class="toc-item-title">Industry Standards: ISA-18.2, EEMUA 191, IEC 62682</div></a>
                <a href="#sec5" class="toc-item"><div class="toc-item-number">Section 5</div><div class="toc-item-title">Alarm System Design Failures &mdash; A Taxonomy</div></a>
                <a href="#sec6" class="toc-item"><div class="toc-item-number">Section 6</div><div class="toc-item-title">Quantifying the Problem &mdash; Alarm Flood Analysis</div></a>
                <a href="#sec7" class="toc-item"><div class="toc-item-number">Section 7</div><div class="toc-item-title">Operational Case Context &mdash; Pre-Intervention</div></a>
                <a href="#sec8" class="toc-item"><div class="toc-item-number">Section 8</div><div class="toc-item-title">Structured Intervention &mdash; Rationalization Process</div></a>
                <a href="#sec9" class="toc-item"><div class="toc-item-number">Section 9</div><div class="toc-item-title">Results & Verification</div></a>
                <a href="#sec10" class="toc-item toc-calculator"><div class="toc-item-number">Section 10 <span class="toc-calc-badge"><i class="fas fa-calculator" style="font-size:0.5rem;"></i> Interactive</span></div><div class="toc-item-title">Alarm Rationalization Calculator</div></a>
                <a href="#sec10mc" class="toc-item toc-calculator"><div class="toc-item-number">Section 10b <span class="toc-calc-badge" style="background:rgba(124,58,237,0.2);color:#a78bfa;">Monte Carlo</span></div><div class="toc-item-title">Risk Simulation &mdash; 10,000 Iterations</div></a>
                <a href="#sec10sk" class="toc-item toc-calculator"><div class="toc-item-number">Section 10c <span class="toc-calc-badge" style="background:rgba(6,182,212,0.15);color:#22d3ee;">Sankey</span></div><div class="toc-item-title">Alarm Flow Rationalization Diagram</div></a>
                <a href="#sec11" class="toc-item"><div class="toc-item-number">Section 11</div><div class="toc-item-title">Organizational Implications</div></a>
                <a href="#sec12" class="toc-item"><div class="toc-item-number">Section 12</div><div class="toc-item-title">Conclusion</div></a>
            </div>
        </div>
    </section>

    <!-- Article Content -->
    <article class="article-content">
        <div class="container">
            <div class="article-body">

                <!-- Section 1: Abstract -->
                <h2 id="sec1"><span class="section-number">1</span> Abstract</h2>

                <p><span class="tip" data-tip="A condition where operators become desensitized to alarms due to excessive frequency, leading to missed critical events.">Alarm fatigue</span> is one of the most dangerous conditions in mission-critical facility operations. It is also one of the most misunderstood. In data centers, industrial process control, healthcare, and nuclear facilities, operators who fail to respond to alarms are routinely blamed for negligence, inattention, or complacency. This attribution is not only incorrect &mdash; it is itself a failure of engineering judgment.</p>

                <p>This paper argues that alarm fatigue is fundamentally a <strong>system design failure</strong>, not a human performance failure. When an alarm system generates hundreds or thousands of notifications per shift, the inevitable result is that operators will stop responding to them. This is not a moral failing; it is a mathematical certainty, predicted by cognitive science and codified in international engineering standards. The solution lies not in more training or harsher discipline, but in rigorous alarm system engineering guided by <span class="tip" data-tip="ISA-18.2: International Society of Automation standard for Management of Alarm Systems for the Process Industries. Defines alarm management lifecycle.">ISA-18.2</span>, <span class="tip" data-tip="EEMUA Publication 191: Engineering Equipment and Materials Users Association guide to alarm system design, management and procurement. The foundational document for alarm management.">EEMUA 191</span>, and <span class="tip" data-tip="IEC 62682: International Electrotechnical Commission standard for management of alarm systems. The international equivalent of ISA-18.2.">IEC 62682</span>.</p>

                <blockquote>"When operators ignore alarms, the system has failed them &mdash; not the other way around."</blockquote>

                <p>This article presents a structured analysis of the alarm fatigue problem, including its cognitive foundations, its classification under industry standards, a taxonomy of common design failures, and a detailed case study of a structured rationalization intervention that achieved greater than 90% alarm reduction in a live data center environment. An interactive calculator is provided to allow readers to assess their own alarm system performance against ISA-18.2 benchmarks.</p>

                <!-- Executive Evidence Block -->
                <div class="evidence-block">
                    <div class="evidence-block-title">
                        <i class="fas fa-chart-line"></i> Documented Rationalization Outcomes
                    </div>
                    <div class="evidence-grid">
                        <div class="evidence-card">
                            <div class="evidence-card-value" style="color: #ef4444;">&gt;90%</div>
                            <div class="evidence-card-label">Alarm Reduction</div>
                            <div class="evidence-card-sub">From 800+ to &lt;80 alarms/day</div>
                        </div>
                        <div class="evidence-card">
                            <div class="evidence-card-value" style="color: #10b981;">12% &rarr; 89%</div>
                            <div class="evidence-card-label">ISA-18.2 Compliance</div>
                            <div class="evidence-card-sub">Post-rationalization score</div>
                        </div>
                        <div class="evidence-card">
                            <div class="evidence-card-value" style="color: #06b6d4;">75%</div>
                            <div class="evidence-card-label">Response Time Improvement</div>
                            <div class="evidence-card-sub">Faster operator acknowledgment</div>
                        </div>
                        <div class="evidence-card">
                            <div class="evidence-card-value" style="color: #f59e0b;">0</div>
                            <div class="evidence-card-label">Missed Critical Alarms</div>
                            <div class="evidence-card-sub">Post-intervention (6-month track)</div>
                        </div>
                        <div class="evidence-card">
                            <div class="evidence-card-value" style="color: #8b5cf6;">&le;1.0</div>
                            <div class="evidence-card-label">Alarms / Op / 10 min</div>
                            <div class="evidence-card-sub">Achieved ISA-18.2 target rate</div>
                        </div>
                    </div>
                    <div class="evidence-source">Based on structured rationalization of a live data center BMS — see Sections 7-9 for full methodology &amp; verification</div>
                </div>

                <!-- Quick Assessment CTA -->
                <div style="background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%); border-radius: 16px; padding: 1.5rem 2rem; margin: 2rem 0; display: flex; align-items: center; justify-content: space-between; gap: 1.5rem; flex-wrap: wrap;">
                    <div>
                        <div style="font-size: 1.1rem; font-weight: 700; color: #e2e8f0; margin-bottom: 4px;">
                            <i class="fas fa-bell" style="color: #ef4444; margin-right: 6px;"></i>Find Out If Your Alarm System Is Overloading Your Operators
                        </div>
                        <div style="font-size: 0.82rem; color: #94a3b8;">Enter 6 alarm metrics &rarr; ISA-18.2 compliance score + cognitive load index + flood probability + reduction targets. Results in under 60 seconds.</div>
                    </div>
                    <a href="#sec10" style="display: inline-flex; align-items: center; gap: 8px; padding: 10px 24px; background: linear-gradient(135deg, #ef4444, #dc2626); color: #fff; border-radius: 10px; font-size: 0.85rem; font-weight: 600; text-decoration: none; white-space: nowrap; transition: transform 0.2s;" onmouseover="this.style.transform='translateY(-2px)'" onmouseout="this.style.transform='none'">
                        <i class="fas fa-chart-line"></i> Start Assessment
                    </a>
                </div>

                <!-- Section 2: The Misattribution Problem -->
                <h2 id="sec2"><span class="section-number">2</span> The Misattribution Problem</h2>

                <p>When a critical alarm is missed and an incident occurs, the organizational response follows a predictable pattern: investigate the operator, check training records, issue corrective actions, increase supervision. This approach feels intuitively correct. An alarm sounded, a person failed to respond, therefore the person is the problem. But this reasoning commits a well-known cognitive error &mdash; the <strong>fundamental attribution error</strong> &mdash; the tendency to attribute behavior to personal characteristics while underestimating situational factors.<a href="#ref1" class="src-ref" title="Reason, J. (1997). Managing the Risks of Organizational Accidents.">[1]</a></p>

                <p>James Reason's <span class="tip" data-tip="Swiss Cheese Model: A model of accident causation by James Reason showing how multiple layers of defense can be penetrated when their individual weaknesses align, like holes in Swiss cheese slices.">Swiss cheese model</span> of organizational accidents demonstrates that incidents are never caused by a single human error at the sharp end. They result from the alignment of latent conditions &mdash; system design decisions, management choices, and organizational cultures that create the conditions for error.<a href="#ref1" class="src-ref" title="Reason (1997)">[1]</a> When 800 alarms arrive per day and 95% are known nuisance conditions, the operator who stops investigating each one is not being negligent. They are adapting rationally to an irrational system.</p>

                <p>Erik Hollnagel's Safety-II perspective, which forms the foundation of <a href="article-1.html">proactive data center operations</a>, extends this further: human variability is not the enemy of safety but the source of it.<a href="#ref2" class="src-ref" title="Hollnagel, E. (2014). Safety-I and Safety-II.">[2]</a> Operators who learn to filter noise and focus on what matters are performing a necessary cognitive function that the alarm system has failed to perform for them. The problem is that this human filtering is unreliable, imprecise, and degrades with fatigue &mdash; which is exactly why it should have been an engineering function in the first place.</p>

                <div class="key-insight">
                    <strong>Key Insight: The Attribution Trap</strong>
                    Organizations that blame operators for alarm fatigue will never solve it. They are treating a symptom while reinforcing the root cause. Every disciplinary action for a "missed alarm" sends the message that the system is fine and the people are broken. The opposite is true.
                </div>

                <p>The UK Health and Safety Executive explicitly warns against this pattern in HSG48, noting that "human error" is almost always a consequence of system design, organizational factors, or task demands &mdash; not individual moral failure.<a href="#ref14" class="src-ref" title="UK HSE (2003). HSG48: Reducing Error and Influencing Behaviour.">[14]</a></p>


                <!-- Operator Narrative -->
                <div class="operator-story">
                    <div class="operator-story-label">&#9654; Real Scenario &mdash; Pre-Intervention, 06:47 Local Time</div>
                    <p style="margin-bottom:0.75rem;">
                        An operator sits down to begin his 12-hour shift. Before he can take off his jacket, the BMS console is already showing <strong style="color:#ef4444;">847 active alarms</strong>. By 07:00, 63 new alarms have arrived. He acknowledges them in batches &mdash; not because he has assessed them, but because the screen is full and new alarms stop appearing when the queue is at capacity. At 07:23, a <strong>genuine chiller fault</strong> triggers. It is buried under 34 consequential downstream alarms. He sees it. He clicks acknowledge. He moves on. At 09:15, the data hall reaches <strong>27°C</strong> &mdash; 4°C above threshold. The root fault was there for 112 minutes.
                    </p>
                    <p style="font-size:0.82rem;opacity:0.8;">This operator was not negligent. He was not undertrained. He was operating a <em>system that had been engineered to fail him</em>.</p>
                    <blockquote>"I acknowledged 400 alarms in the first two hours. I couldn't tell you what any of them were."<br><span style="font-size:0.75rem;color:#475569;font-style:normal;">— Anonymous operator survey response, pre-intervention</span></blockquote>
                </div>

                <!-- Section 3: Human Factors & Cognitive Load Theory -->
                <h2 id="sec3"><span class="section-number">3</span> Human Factors & Cognitive Load Theory</h2>

                <p>The reason alarm fatigue is inevitable under poor system design is rooted in fundamental human cognitive architecture. Two models are particularly relevant: Endsley's <span class="tip" data-tip="Situation Awareness (SA): A three-level model by Endsley (1995) comprising perception of elements (Level 1), comprehension of meaning (Level 2), and projection of future state (Level 3).">situation awareness</span> model and Wickens' <span class="tip" data-tip="Multiple Resource Theory: Wickens' model proposing that humans have multiple pools of cognitive resources (visual, auditory, cognitive, motor) that can operate in parallel but each has finite capacity.">multiple resource theory</span>.</p>

                <h3>Endsley's Situation Awareness Model</h3>

                <p>Endsley (1995) defined situation awareness as operating at three levels: <strong>Level 1</strong> &mdash; Perception (detecting that an alarm has occurred), <strong>Level 2</strong> &mdash; Comprehension (understanding what the alarm means in context), and <strong>Level 3</strong> &mdash; Projection (predicting what will happen if action is not taken).<a href="#ref3" class="src-ref" title="Endsley, M. R. (1995). Toward a Theory of Situation Awareness.">[3]</a> Under alarm overload, operators cannot progress beyond Level 1. They perceive the alarm, but lack the cognitive bandwidth to comprehend it or project its consequences. They click "acknowledge" and move on. This is not complacency &mdash; it is the predictable behavior of a cognitive system operating beyond its design capacity.</p>


                <!-- Situation Awareness Diagram -->
                <div class="sa-diagram">
                    <div class="sa-level sa-level-3">
                        <div class="sa-badge">L3</div>
                        <div class="sa-info">
                            <strong>Projection</strong>
                            <span>What will happen if I don&rsquo;t act? Predict consequences.</span>
                        </div>
                        <div class="sa-alarm-state">&#10007; Impossible at &gt;5 alarms/10min</div>
                    </div>
                    <div class="sa-arrow">&#8593;</div>
                    <div class="sa-level sa-level-2">
                        <div class="sa-badge">L2</div>
                        <div class="sa-info">
                            <strong>Comprehension</strong>
                            <span>What does this alarm mean? What caused it?</span>
                        </div>
                        <div class="sa-alarm-state">&#10007; Degraded at &gt;2 alarms/10min</div>
                    </div>
                    <div class="sa-arrow">&#8593;</div>
                    <div class="sa-level sa-level-1">
                        <div class="sa-badge">L1</div>
                        <div class="sa-info">
                            <strong>Perception</strong>
                            <span>Alarm detected, acknowledged, logged.</span>
                        </div>
                        <div class="sa-alarm-state">&#10003; All operators retain L1</div>
                    </div>
                    <p class="sa-caption">Endsley&rsquo;s 3-Level Situation Awareness Model &mdash; Under alarm overload, operators are trapped at Level 1. They see alarms, but cannot understand or predict. <a href="#ref3" class="src-ref">[3]</a></p>
                </div>

                <h3>Wickens' Multiple Resource Theory</h3>

                <p>Wickens (2008) demonstrated that human attention is not a single resource but a set of parallel channels, each with finite capacity.<a href="#ref8" class="src-ref" title="Wickens, C. D. (2008). Multiple Resources and Mental Workload.">[8]</a> When the visual-cognitive channel is saturated by alarm notifications, the operator cannot simultaneously perform other visual-cognitive tasks &mdash; such as monitoring trends, reviewing procedures, or interpreting system states. The alarm system, intended to improve safety, actually degrades it by consuming the attentional resources needed for safe operation.</p>

                <h3>ISA-18.2 Alarm Rate Benchmarks</h3>

                <p><span class="tip" data-tip="ISA-18.2: The primary North American standard for alarm management. Defines the alarm management lifecycle, including philosophy, identification, rationalization, design, implementation, operation, maintenance, monitoring, and change management.">ISA-18.2</span> provides concrete benchmarks for alarm rates based on human factors research. An operator can reliably process a maximum of approximately <strong>1 alarm per 10-minute period</strong>.<a href="#ref4" class="src-ref" title="ISA-18.2-2022. Management of Alarm Systems.">[4]</a> Beyond this threshold, cognitive load exceeds sustainable levels and response quality degrades exponentially.</p>

                <div class="data-table-wrapper">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Performance Level</th>
                                <th>Alarms / Operator / 10 min</th>
                                <th>Alarms / Operator / Day (12 hr)</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong style="color: var(--accent-emerald);">Very Likely Acceptable</strong></td>
                                <td>&le; 1</td>
                                <td>&le; 72</td>
                            </tr>
                            <tr>
                                <td><strong style="color: var(--accent-cyan);">Maximum Manageable</strong></td>
                                <td>&le; 2</td>
                                <td>&le; 144</td>
                            </tr>
                            <tr>
                                <td><strong style="color: var(--accent-amber);">Overloaded</strong></td>
                                <td>2 &ndash; 5</td>
                                <td>144 &ndash; 360</td>
                            </tr>
                            <tr>
                                <td><strong style="color: var(--accent-red);">Very Likely Unacceptable</strong></td>
                                <td>&gt; 5</td>
                                <td>&gt; 360</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <p class="table-source" style="font-size:0.72rem;color:#64748b;font-style:italic;margin:0.4rem 0 1.2rem;">Source: Publicly available industry data and published standards. For educational and research purposes only.</p>
                <p style="font-size: 0.85rem; color: var(--text-secondary); text-align: center;">Table 1: ISA-18.2 alarm rate performance benchmarks per operator<a href="#ref4" class="src-ref" title="ISA-18.2-2022">[4]</a></p>

                <p>These are not arbitrary thresholds. They are derived from decades of human factors research demonstrating that <span class="tip" data-tip="Cognitive load: The total amount of mental effort being used in working memory at any given time. Exceeding cognitive load capacity leads to errors, omissions, and degraded decision-making.">cognitive load</span> beyond sustainable levels produces not gradual degradation but a cliff-edge collapse in performance. An operator receiving 5 alarms per 10 minutes is not "five times busier" than one receiving 1 &mdash; they are effectively unable to process any of them reliably.<a href="#ref3" class="src-ref" title="Endsley (1995)">[3]</a><a href="#ref8" class="src-ref" title="Wickens (2008)">[8]</a></p>

                <!-- Section 4: Industry Standards -->
                <h2 id="sec4"><span class="section-number">4</span> Industry Standards: ISA-18.2, EEMUA 191, IEC 62682</h2>

                <p>Three major standards govern alarm management in industrial and critical infrastructure environments. Together, they provide a comprehensive framework for designing, implementing, and maintaining alarm systems that protect rather than endanger operators.</p>

                <div class="standard-cards">
                    <div class="standard-card">
                        <div class="sc-label">&#127482;&#127480; North America</div>
                        <div class="sc-title">ISA-18.2-2022</div>
                        <div class="sc-desc">Defines the complete alarm management lifecycle &mdash; from philosophy through ongoing audit. Covers rationalization, detailed design, implementation, and management of change.<a href="#ref4" class="src-ref">[4]</a></div>
                        <div class="sc-key-metric"><strong>Core principle:</strong> Every alarm must require a specific operator action within a defined timeframe. No action required = not an alarm.</div>
                    </div>
                    <div class="standard-card">
                        <div class="sc-label">&#127468;&#127463; United Kingdom</div>
                        <div class="sc-title">EEMUA 191 (3rd Ed.)</div>
                        <div class="sc-desc">The foundational alarm management publication since 1999. Established the alarm rate benchmarks later formalized by ISA-18.2. Emphasizes alarm uniqueness.<a href="#ref5" class="src-ref">[5]</a></div>
                        <div class="sc-key-metric"><strong>Key principle:</strong> Each alarm must provide information not available from any other source on the console.</div>
                    </div>
                    <div class="standard-card">
                        <div class="sc-label">&#127760; International</div>
                        <div class="sc-title">IEC 62682:2022</div>
                        <div class="sc-desc">The international equivalent of ISA-18.2 for global consistency. Focuses on alarm timeliness &mdash; alarms must arrive early enough for corrective action.<a href="#ref6" class="src-ref">[6]</a></div>
                        <div class="sc-key-metric"><strong>Key principle:</strong> An alarm that arrives after the safety limit is exceeded is not an alarm &mdash; it is a post-incident log entry.</div>
                    </div>
                </div>

                <div class="formula-box">
                    <div class="formula-label">ISA-18.2 Core Metric: Actionable Alarm Ratio</div>
                    <div class="formula">Actionable Ratio = (Alarms Requiring Operator Action) / (Total Alarms)</div>
                    <div class="formula-label">Target: &ge; 85% &mdash; Every alarm should demand a specific, defined operator response<a href="#ref4" class="src-ref" title="ISA-18.2-2022" style="color:#94a3b8;">[4]</a><a href="#ref5" class="src-ref" title="EEMUA 191" style="color:#94a3b8;">[5]</a><a href="#ref6" class="src-ref" title="IEC 62682" style="color:#94a3b8;">[6]</a></div>
                </div>

                <p>The three standards share a common philosophical foundation: <strong>an alarm is not a notification</strong>. It is a demand for human action. Systems that blur this distinction &mdash; by treating alarms as status indicators, event logs, or informational messages &mdash; are engineering failures regardless of how sophisticated the underlying technology may be.</p>

                <!-- Article Image 2 -->
                <figure style="margin: 2rem 0; text-align: center;">
                    <img src="Article/Article_2 02.02.26/2.2.jpg" alt="Alarm system design analysis and failure taxonomy for emergency power generator operations" loading="lazy" style="max-width: 100%; height: auto; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.1);" decoding="async">
                </figure>

                <!-- Section 5: Alarm System Design Failures -->
                <h2 id="sec5"><span class="section-number">5</span> Alarm System Design Failures &mdash; A Taxonomy</h2>

                <p>The following taxonomy classifies the most common alarm system design failures. Each represents a category of engineering error that contributes directly to alarm fatigue. Recognizing these patterns is the first step toward systematic elimination.<a href="#ref7" class="src-ref" title="Hollifield & Habibi (2010). The Alarm Management Handbook.">[7]</a></p>

                <div class="info-box critical">
                    <div class="info-box-title">1. Chattering Alarms</div>
                    <p><span class="tip" data-tip="Chattering alarm: An alarm that repeatedly transitions between active and clear states in rapid succession, typically due to a process variable oscillating near its setpoint. A single chattering alarm can generate dozens of alarm events per hour.">Chattering alarms</span> cycle rapidly between active and clear states when a process variable oscillates near its setpoint. A single chattering temperature alarm on an AHU return air sensor can generate 30-50 alarm events per hour if the <span class="tip" data-tip="Deadband: A buffer zone or hysteresis band around an alarm setpoint. When a value crosses the alarm threshold, it must return past the deadband before the alarm clears. Prevents oscillation-induced chattering.">deadband</span> is insufficiently configured. This is a pure engineering failure &mdash; the solution is proper deadband configuration, not operator discipline.</p>
                </div>

                <div class="info-box critical">
                    <div class="info-box-title">2. Standing Alarms</div>
                    <p><span class="tip" data-tip="Standing alarm: An alarm that remains continuously active for an extended period (typically >24 hours) without being resolved. Standing alarms consume operator attention, create visual clutter, and mask genuinely new alarm conditions.">Standing alarms</span> remain permanently active, often for days, weeks, or months. They typically represent known conditions that cannot be immediately resolved &mdash; a sensor fault awaiting replacement, a system in maintenance mode, or a design condition that was never accounted for. Standing alarms are the single largest contributor to alarm list clutter and operator desensitization.</p>
                </div>

                <div class="info-box critical">
                    <div class="info-box-title">3. Stale Alarms</div>
                    <p>Stale alarms are those configured for conditions that are no longer operationally relevant. A temperature alarm for a space that has been decommissioned, a flow alarm for a system that has been redesigned, or a status alarm for equipment that has been replaced with a different control architecture. These accumulate over years of system changes without corresponding alarm system updates.</p>
                </div>

                <div class="info-box critical">
                    <div class="info-box-title">4. Consequential Alarms</div>
                    <p>Consequential alarms are downstream effects of a single root cause. When a chiller trips, the consequential effects may include high supply temperature, low flow, high return temperature, high room temperature across multiple zones, and low differential pressure &mdash; each generating its own alarm. A single event can produce 20-50 consequential alarms within minutes, burying the root cause in noise.</p>
                </div>

                <div class="info-box critical">
                    <div class="info-box-title">5. Nuisance Alarms</div>
                    <p>Nuisance alarms are technically correct but operationally useless. A "communication fault" alarm that occurs every time a <span class="tip" data-tip="BMS: Building Management System. The centralized control system for monitoring and managing a building's mechanical, electrical, and environmental systems including HVAC, fire, security, and lighting.">BMS</span> controller performs a routine polling cycle. A "door open" alarm for a door that is legitimately open during occupied hours. These alarms meet their technical trigger conditions but provide no information that requires or enables operator action.</p>
                </div>

                <div class="info-box critical">
                    <div class="info-box-title">6. Misconfigured Deadbands</div>
                    <p>When <span class="tip" data-tip="Deadband: A buffer zone around an alarm setpoint. If alarm triggers at 25.0C and deadband is 1.0C, the alarm only clears when temperature drops below 24.0C. Prevents rapid on/off cycling.">deadbands</span> are set too tight (or not set at all), even stable process variables with normal measurement noise will oscillate across alarm thresholds. A temperature sensor with ±0.3C noise and a 0.1C deadband will chatter continuously. The correct engineering solution is deadband configuration at 1-2% of the measurement range, or 2-3 times the sensor noise floor.</p>
                </div>

                <!-- Section 6: Alarm Flood Analysis -->
                <h2 id="sec6"><span class="section-number">6</span> Quantifying the Problem &mdash; Alarm Flood Analysis</h2>

                <p>An <span class="tip" data-tip="Alarm flood: Defined by ISA-18.2 as more than 10 alarms in any 10-minute period for a single operator. During alarm floods, effective human response capacity drops to near zero.">alarm flood</span> is defined by ISA-18.2 as the condition where more than 10 alarms arrive within a 10-minute period for a single operator. During alarm floods, effective human response capacity approaches zero &mdash; not asymptotically, but precipitously.<a href="#ref4" class="src-ref" title="ISA-18.2-2022">[4]</a></p>

                <h3>Poisson Distribution Model for Alarm Arrivals</h3>

                <p>Alarm arrivals during steady-state operations can be modeled as a Poisson process. If the average daily alarm rate is &lambda;<sub>day</sub>, then the expected number of alarms in any 10-minute window is &lambda;<sub>10</sub> = &lambda;<sub>day</sub> / 144 (there are 144 ten-minute periods in a 24-hour day). The probability of receiving <em>k</em> or more alarms in a given 10-minute window follows the complementary Poisson CDF.</p>

                <div class="formula-box">
                    <div class="formula-label">Poisson Probability of Alarm Flood</div>
                    <div class="formula">P(X &ge; n) = 1 - &Sigma;<sub>k=0</sub><sup>n-1</sup> (&lambda;<sup>k</sup> &middot; e<sup>-&lambda;</sup>) / k!</div>
                    <div class="formula-label">Where &lambda; = average alarms per 10-minute window, n = flood threshold (default 10)</div>
                </div>

                <p>At a daily rate of 800 alarms (&lambda;<sub>10</sub> &asymp; 5.6), the probability of experiencing an alarm flood in any given 10-minute window is approximately 7%. Over a 12-hour shift (72 windows), the probability that at least one alarm flood occurs is approximately 99.5%. The operator <em>will</em> be overwhelmed. The question is not whether, but when.</p>


                <!-- Poisson Distribution Chart -->
                <div class="chart-wrap">
                    <div class="chart-title"><i class="fas fa-chart-bar" style="color:#ef4444;margin-right:6px;"></i>Alarm Flood Probability by Daily Alarm Rate &mdash; Poisson Model</div>
                    <canvas id="poissonChart"></canvas>
                    <p style="font-size:0.72rem;color:#334155;margin-top:0.5rem;text-align:center;">P(at least 1 flood per 12-hr shift) = 1 &minus; [1 &minus; P(X &ge; 10 in 10 min)]<sup>72</sup> &nbsp;|&nbsp; ISA-18.2 flood threshold = 10 alarms / 10 min</p>
                </div>

                <div class="key-insight">
                    <strong>Key Insight: The Cognitive Cliff</strong>
                    During a cascade event, an operator may receive 50-100 alarms in 10 minutes. Research from the ASM Consortium<a href="#ref12" class="src-ref" title="ASM Consortium (2013)">[12]</a> and Hollifield & Habibi<a href="#ref7" class="src-ref" title="Hollifield & Habibi (2010)">[7]</a> demonstrates that effective attention drops to near zero under these conditions. The operator is not failing &mdash; the system has created conditions in which success is impossible. No amount of training can overcome a 50:1 alarm-to-capacity ratio.
                </div>

                <p>The cognitive degradation is not linear. Below the ISA-18.2 threshold of 1 alarm per 10 minutes, operators maintain near-full situation awareness — the kind needed to detect the <a href="article-8.html">weak signals that precede major failures</a>. Between 1 and 5, degradation is measurable but manageable. Above 5, degradation is exponential. Above 10, the operator is effectively absent &mdash; their cognitive resources are fully consumed by the act of acknowledging alarms, leaving no capacity for understanding or responding to them.</p>

                <!-- Section 7: Operational Case Context -->
                <h2 id="sec7"><span class="section-number">7</span> Operational Case Context &mdash; Pre-Intervention State</h2>

                <p>The following case is based on a live data center during the construction-to-operations transition &mdash; a phase that represents one of the highest-risk periods in facility lifecycle management. The <span class="tip" data-tip="BMS: Building Management System. The centralized monitoring and control platform for all mechanical, electrical, and environmental systems in a facility.">BMS</span> and <span class="tip" data-tip="SCADA: Supervisory Control and Data Acquisition. A control system architecture used for high-level process supervisory management, often integrated with or complementary to the BMS in critical infrastructure.">SCADA</span> systems were fully commissioned — monitoring the kind of <a href="article-13.html">critical power and electrical infrastructure</a> where alarm accuracy is non-negotiable — but significant portions of the facility remained under active construction.</p>

                <h3>Pre-Intervention Alarm Environment</h3>
                <ul>
                    <li><strong>Daily alarm count:</strong> 800-1,200 alarms per 24-hour period</li>
                    <li><strong>Per-operator rate:</strong> 33-50 alarms per operator per hour (2 operators per shift)</li>
                    <li><strong>ISA-18.2 rate:</strong> 5.6-8.3 alarms per operator per 10 minutes &mdash; classified as "Very Likely Unacceptable"</li>
                    <li><strong>Standing alarms:</strong> 120-180 at any given time</li>
                    <li><strong>Nuisance percentage:</strong> ~95% of all alarms were known conditions requiring no action</li>
                    <li><strong>Night shift impact:</strong> Operators on 12-hour night shifts experienced the worst cognitive degradation</li>
                </ul>

                <div class="info-box warning">
                    <div class="info-box-title">The Dangerous Paradox</div>
                    <p>Operators were acknowledging alarms without investigation because 95% were known nuisance conditions. This behavior was <strong>entirely rational</strong> given the circumstances &mdash; investigating each alarm at a rate of 50 per hour would consume the operator's entire cognitive capacity for alarm processing alone, leaving zero capacity for actual facility monitoring, trend analysis, or emergency response. Yet this rational adaptation meant that the 5% of genuine critical alarms were being treated identically to the 95% that were noise. <strong>The system had trained the operators to ignore it.</strong></p>
                </div>

                <p>Management's initial response followed the predictable pattern: propose more training, suggest performance improvement plans, discuss adding a third operator per shift. None of these would have solved the underlying problem. Adding a third operator would have reduced the per-capita rate from ~8 to ~5.5 alarms per 10 minutes &mdash; still in the "Overloaded" category per ISA-18.2. The system itself needed to change.<a href="#ref13" class="src-ref" title="Nimmo (2002)">[13]</a></p>

                <!-- Section 8: Structured Intervention -->
                <h2 id="sec8"><span class="section-number">8</span> Structured Intervention &mdash; The Rationalization Process</h2>

                <p><span class="tip" data-tip="Alarm rationalization: The systematic process of reviewing every alarm in a system against defined criteria (does it require action? is it unique? is it timely?) and eliminating, modifying, or reclassifying alarms that do not meet the standard.">Alarm rationalization</span> is the ISA-18.2 term for the systematic process of reviewing every alarm against defined engineering criteria. The following 6-step methodology was implemented over a 10-week period while the facility remained fully operational.</p>

                <h3>Step 1: Alarm Census & Baseline Documentation</h3>
                <p>Every configured alarm point was extracted from the BMS and SCADA systems and compiled into a master spreadsheet. Total configured alarm points: 3,847. Each alarm was documented with its tag, description, setpoint, deadband, priority, and associated equipment. The baseline alarm rate was measured over 30 days to establish statistical reliability.</p>

                <h3>Step 2: Classification by Type</h3>
                <p>Each active alarm was classified into the taxonomy described in Section 5: chattering, standing, stale, consequential, or nuisance. This classification was performed jointly by the operations team and the controls engineering team to ensure both operational context and technical accuracy were considered.</p>

                <h3>Step 3: <span class="tip" data-tip="Master Alarm Database (MAD): A centralized repository documenting every alarm point in the facility with its rationalized priority, setpoint, deadband, required operator response, and responsible system. The single source of truth for alarm configuration.">Master Alarm Database</span> (MAD) Creation</h3>
                <p>The MAD became the single source of truth for all alarm configuration. Every alarm that survived rationalization was documented with: rationalized priority (Critical, High, Medium, Low), setpoint and deadband (with engineering justification), required operator response (specific, actionable, time-bounded), responsible system and equipment, and <span class="tip" data-tip="MOC: Management of Change. A formal process requiring review and approval before any modification to alarm configuration, ensuring that changes are intentional, documented, and do not introduce new hazards.">MOC</span> requirements for any future changes.</p>

                <h3>Step 4: Isolation Matrices for Construction Zones</h3>
                <p>Construction zones were logically isolated from the operational alarm system. Alarms from areas under active construction were routed to construction management systems rather than operations consoles. This single step eliminated approximately 40% of all operational alarms.</p>

                <div class="key-insight">
                    <strong>Key Insight: Isolation Matrices</strong>
                    The construction isolation matrix was perhaps the highest-impact single intervention. By routing construction-zone alarms to the appropriate stakeholders (construction supervisors, commissioning engineers) rather than operations, both populations received more relevant information. Operations saw fewer nuisance alarms; construction saw alarms specific to their work areas. The same data, properly routed, served both audiences better.
                </div>

                <h3>Step 5: Permit-to-Work Integration</h3>
                <p>The permit-to-work system was integrated with alarm management. When a maintenance permit was active, associated alarms were automatically contextualized or suppressed based on pre-defined rules. A "chiller offline" alarm during a scheduled chiller maintenance window was automatically annotated rather than generating a critical alarm.</p>

                <h3>Step 6: Tiered Response Protocol Implementation</h3>
                <p>Alarms were restructured into a tiered response framework: <strong>Critical</strong> (immediate response required, &lt;5 minutes), <strong>High</strong> (response required within 15 minutes), <strong>Medium</strong> (response within 1 hour), and <strong>Low</strong> (next routine round). Only Critical and High alarms generated audible notifications. Medium alarms appeared on the alarm summary screen. Low-priority conditions were logged for trending analysis without generating real-time alarm events.</p>

                <!-- Section 9: Results & Verification -->
                <h2 id="sec9"><span class="section-number">9</span> Results & Verification</h2>

                <p>The following results were measured over a 90-day post-intervention period and compared against the 30-day pre-intervention baseline.</p>

                <div class="info-box success">
                    <div class="info-box-title">Alarm Volume Reduction: &gt;90%</div>
                    <p>Daily alarm count reduced from 800-1,200 to fewer than 80 per day. The ISA-18.2 alarm rate dropped from 5.6-8.3 to 0.56 alarms per operator per 10 minutes &mdash; well within the "Very Likely Acceptable" range.</p>
                </div>

                <div class="info-box success">
                    <div class="info-box-title">Zero False Evacuations</div>
                    <p>In the 90-day post-intervention period, zero false evacuations occurred. In the preceding 90 days, three false evacuations had been triggered by operators misinterpreting alarm cascades during construction activities.</p>
                </div>

                <div class="info-box success">
                    <div class="info-box-title">Response Time Improvement: 180s to 45s Average</div>
                    <p>Mean time from alarm activation to first operator action (<span class="tip" data-tip="MTTR: Mean Time To Respond. The average elapsed time between an alarm being activated and the operator taking the first defined response action.">MTTR</span>) decreased from 180 seconds to 45 seconds &mdash; a 75% improvement. More importantly, the response <em>quality</em> improved: operators were executing defined response procedures rather than simply acknowledging and moving on.</p>
                </div>

                <div class="info-box success">
                    <div class="info-box-title">ISA-18.2 Compliance: 12% to 89%</div>
                    <p>Composite ISA-18.2 compliance score improved from 12% (failing on all four primary metrics) to 89% (meeting or exceeding targets on alarm rate, actionable ratio, and standing alarm percentage; approaching target on critical alarm percentage).</p>
                </div>


                <!-- Before / After Comparison Chart -->
                <div class="chart-wrap" style="margin-top:1.5rem;">
                    <div class="chart-title"><i class="fas fa-chart-line" style="color:#10b981;margin-right:6px;"></i>Before vs After Rationalization &mdash; Key Metrics</div>
                    <canvas id="beforeAfterChart"></canvas>
                    <p style="font-size:0.72rem;color:#334155;margin-top:0.5rem;text-align:center;">90-day measurement window. Data center facility, construction-to-operations transition phase.</p>
                </div>

                <div class="info-box success">
                    <div class="info-box-title">Operator Satisfaction & Confidence</div>
                    <p>An anonymous operator survey showed that 100% of operators reported improved confidence in the alarm system, and 90% reported reduced stress levels. Critically, operators began proactively reporting alarm configuration issues rather than silently adapting around them &mdash; indicating a cultural shift toward alarm system ownership.</p>
                </div>

            </div>
        </div>
    </article>

    <!-- Section 10: Calculator -->
    <section class="calculator-section" id="sec10">
        <div style="max-width: 900px; margin: 0 auto;">
            <h2 style="font-size: 1.4rem; color: #fff; margin-bottom: 0.5rem; padding-bottom: 0.5rem; border-bottom: 3px solid var(--accent-red); display: flex; align-items: center; gap: 0.75rem;">
                <span class="section-number" style="background: var(--accent-red); color: #fff; width: 32px; height: 32px; border-radius: 8px; display: inline-flex; align-items: center; justify-content: center; font-size: 0.85rem; font-weight: 700; flex-shrink: 0;">10</span>
                Interactive Alarm Rationalization Calculator
            </h2>
            <p style="color: #94a3b8; margin-bottom: 1rem;">Enter your facility's alarm data to assess ISA-18.2 compliance, cognitive load, and alarm flood probability. All calculations update in real time.</p>

            <!-- Mode Toggle + Action Buttons -->
            <div class="alarm-toolbar-row">
                <div class="alarm-mode-bar">
                    <button class="alarm-mode-btn active" id="alarmModeFree" onclick="switchAlarmMode('free')"><i class="fas fa-chart-simple"></i> Free Assessment</button>
                    <button class="alarm-mode-btn" id="alarmModePro" onclick="switchAlarmMode('pro')"><i class="fas fa-microscope"></i> Pro Analysis <span class="gated-badge" id="alarmProBadge">PRO</span></button>
                </div>
                <div class="alarm-toolbar-actions">
                    <button class="alarm-action-btn" id="alarmBtnReset2" onclick="alarmResetDefaults()" style="padding:8px 14px;font-size:0.78rem;"><i class="fas fa-rotate-left"></i> Reset</button>
                    <button class="alarm-action-btn primary" id="alarmBtnPdf" onclick="if(window._rzAuth)window._rzAuth.showModal();else alarmShowLogin()" style="padding:8px 14px;font-size:0.78rem;"><i class="fas fa-file-pdf"></i> Export PDF</button>
                </div>
            </div>

            <!-- Free Inputs -->
            <div class="calc-grid">
                <div class="calc-group">
                    <label for="totalDaily">Total Daily Alarms <span class="tooltip-trigger">?<span class="tooltip-content"><div class="tooltip-title">Total Daily Alarms</div><div class="tooltip-desc">Sum of all alarm activations in 24 hours across all priorities and areas.</div><div class="tooltip-formula">EEMUA 191: &le;144/day/op = Acceptable<br>&gt;720/day/op = Overloaded</div></span></span></label>
                    <input type="number" id="totalDaily" value="1200" min="0" max="50000">
                </div>
                <div class="calc-group">
                    <label for="criticalDaily">Critical Alarms / Day <span class="tooltip-trigger">?<span class="tooltip-content"><div class="tooltip-title">Critical Priority</div><div class="tooltip-desc">Alarms requiring immediate operator action. ISA-18.2 target: &le;5% of total alarms.</div><div class="tooltip-formula">Benchmark: Critical &le; 5%<br>Warning &le; 15% &middot; Advisory/Info &ge; 80%</div></span></span></label>
                    <input type="number" id="criticalDaily" value="45" min="0" max="10000">
                </div>
                <div class="calc-group">
                    <label for="warningDaily">Warning Alarms / Day <span class="tooltip-trigger">?<span class="tooltip-content"><div class="tooltip-title">Warning Priority Alarms</div><div class="tooltip-desc">Medium-priority alarms requiring timely response. ISA-18.2 recommends Warning alarms be 15% or less of total.</div><div class="tooltip-formula">Warning target: &le;15% of total alarms</div></span></span></label>
                    <input type="number" id="warningDaily" value="280" min="0" max="10000">
                </div>
                <div class="calc-group">
                    <label for="infoDaily">Information Alarms / Day <span class="tooltip-trigger">?<span class="tooltip-content"><div class="tooltip-title">Information/Advisory Alarms</div><div class="tooltip-desc">Low-priority notifications for operator awareness. Should make up the bulk of alarm traffic.</div><div class="tooltip-formula">Info target: &ge;80% of total alarms</div></span></span></label>
                    <input type="number" id="infoDaily" value="875" disabled style="opacity:0.7; cursor: not-allowed;">
                </div>
                <div class="calc-group">
                    <label for="avgResponse">Avg Response Time (sec) <span class="tooltip-trigger">?<span class="tooltip-content"><div class="tooltip-title">Average Response Time</div><div class="tooltip-desc">Mean time from alarm activation to operator acknowledgment. Drives cognitive utilization calculation.</div><div class="tooltip-formula">utilization = (alarms/hr &times; responseTime) / 3600<br>Degradation onset at 70% utilization</div></span></span></label>
                    <input type="number" id="avgResponse" value="180" min="1" max="3600">
                </div>
                <div class="calc-group">
                    <label for="operatorsPerShift">Operators per Shift <span class="tooltip-trigger">?<span class="tooltip-content"><div class="tooltip-title">Operators per Shift</div><div class="tooltip-desc">Number of operators simultaneously handling alarms during a shift. More operators reduce per-person alarm load.</div><div class="tooltip-formula">Rate per operator = total alarms / operators / time</div></span></span></label>
                    <select id="operatorsPerShift">
                        <option value="1">1</option>
                        <option value="2" selected>2</option>
                        <option value="3">3</option>
                        <option value="4">4</option>
                        <option value="5">5</option>
                    </select>
                </div>
                <div class="calc-group">
                    <label for="shiftDuration">Shift Duration (hours) <span class="tooltip-trigger">?<span class="tooltip-content"><div class="tooltip-title">Shift Duration</div><div class="tooltip-desc">Length of each operator shift in hours. Longer shifts increase fatigue-related alarm miss risk.</div><div class="tooltip-formula">Standard: 8-12 hours</div></span></span></label>
                    <select id="shiftDuration">
                        <option value="8">8</option>
                        <option value="12" selected>12</option>
                    </select>
                </div>
                <div class="calc-group">
                    <label for="shelvingPct">Current Shelving %: <span id="shelvingVal" class="range-value">10%</span> <span class="tooltip-trigger">?<span class="tooltip-content"><div class="tooltip-title">Alarm Shelving Rate</div><div class="tooltip-desc">Percentage of alarms temporarily suppressed (shelved) by operators. Authorized shelving reduces noise but excessive shelving may mask real issues.</div><div class="tooltip-formula">ISA-18.2: Document all shelved alarms &middot; Review weekly</div></span></span></label>
                    <input type="range" id="shelvingPct" min="0" max="50" value="10">
                </div>
            </div>

            <!-- Pro Inputs (hidden by default) -->
            <div id="alarmProInputs">
                <div class="pro-input-section-title"><i class="fas fa-sliders"></i> Advanced Parameters</div>
                <div class="calc-grid">
                    <div class="calc-group">
                        <label for="proFloodWindow">Flood Window (min) <span class="tooltip-trigger">?<span class="tooltip-content"><div class="tooltip-title">Flood Window Size</div><div class="tooltip-desc">Time window for counting alarm floods. ISA-18.2 standard uses 10 minutes.</div></span></span></label>
                        <input type="number" id="proFloodWindow" value="10" min="5" max="30">
                    </div>
                    <div class="calc-group">
                        <label for="proFloodThreshold">Flood Threshold <span class="tooltip-trigger">?<span class="tooltip-content"><div class="tooltip-title">Flood Alarm Threshold</div><div class="tooltip-desc">Number of alarms in a window that constitutes a "flood." Standard definition: &gt;10 alarms per 10-min window.</div></span></span></label>
                        <input type="number" id="proFloodThreshold" value="10" min="5" max="50">
                    </div>
                    <div class="calc-group">
                        <label for="proStandingPct">Standing Alarm % <span class="tooltip-trigger">?<span class="tooltip-content"><div class="tooltip-title">Standing Alarms</div><div class="tooltip-desc">Alarms continuously active for extended periods. Free mode assumes 30% of info alarms. Enter actual measured % here for accuracy.</div><div class="tooltip-formula">ISA target: &le;10% standing</div></span></span></label>
                        <input type="number" id="proStandingPct" value="0" min="0" max="100" placeholder="0 = auto-estimate">
                    </div>
                    <div class="calc-group">
                        <label for="proFacilityType">Facility Type <span class="tooltip-trigger">?<span class="tooltip-content"><div class="tooltip-title">Facility Type</div><div class="tooltip-desc">Type of data center operation. Affects alarm density baselines and ISA-18.2 applicability.</div></span></span></label>
                        <select id="proFacilityType">
                            <option value="dc" selected>Data Center (BMS)</option>
                            <option value="industrial">Industrial (DCS/SCADA)</option>
                            <option value="hospital">Hospital</option>
                            <option value="power">Power Plant</option>
                        </select>
                    </div>
                    <div class="calc-group">
                        <label for="proPriorityModel">Priority Model <span class="tooltip-trigger">?<span class="tooltip-content"><div class="tooltip-title">Priority Model</div><div class="tooltip-desc">Alarm priority classification scheme. ISA-18.2 recommends 3-4 priority levels with strict distribution targets.</div></span></span></label>
                        <select id="proPriorityModel">
                            <option value="3" selected>3-Level (Crit/Warn/Info)</option>
                            <option value="4">4-Level (Emer/High/Med/Low)</option>
                        </select>
                    </div>
                    <div class="calc-group">
                        <label for="proHandlingDist">Handling Time Dist. <span class="tooltip-trigger">?<span class="tooltip-content"><div class="tooltip-title">Handling Time Distribution</div><div class="tooltip-desc">Statistical distribution for queueing model. Lognormal is more realistic for alarm handling (right-skewed).</div></span></span></label>
                        <select id="proHandlingDist">
                            <option value="exponential" selected>Exponential (M/M/c)</option>
                            <option value="lognormal">Lognormal (realistic)</option>
                        </select>
                    </div>
                    <div class="calc-group">
                        <label for="proChatterPct">Est. Chattering % <span class="tooltip-trigger">?<span class="tooltip-content"><div class="tooltip-title">Chattering Alarms</div><div class="tooltip-desc">Alarms that activate/deactivate rapidly (&gt;3 transitions in 1 minute). Major contributor to alarm fatigue.</div></span></span></label>
                        <input type="number" id="proChatterPct" value="5" min="0" max="50">
                    </div>
                    <div class="calc-group">
                        <label for="proSuppressAuth">Authorized Suppress % <span class="tooltip-trigger">?<span class="tooltip-content"><div class="tooltip-title">Authorized Suppression</div><div class="tooltip-desc">Percentage of suppressed/shelved alarms with proper authorization. Unauthorized suppression is a compliance risk.</div></span></span></label>
                        <input type="number" id="proSuppressAuth" value="80" min="0" max="100">
                    </div>
                </div>
            </div>

            <!-- Free Output Cards -->
            <div class="calc-results-grid" id="calcResults">
                <div class="result-card">
                    <div class="result-card-label">Alarm Rate / Operator / 10 min <span class="res-tip">?<span class="res-tip-body"><div class="rtt">Alarm Rate</div><div class="rtd">Number of alarms per operator per 10-minute window. The primary ISA-18.2 metric for alarm system performance.</div><span class="rtf">ISA-18.2 target: &le; 1.0 per 10 min</span></span></span></div>
                    <div class="result-card-value" id="resRate">--</div>
                    <div class="result-card-sub">ISA-18.2 target: &le; 1.0</div>
                </div>
                <div class="result-card">
                    <div class="result-card-label">Cognitive Load Index <span class="res-tip">?<span class="res-tip-body"><div class="rtt">Cognitive Load</div><div class="rtd">Estimated operator cognitive utilization from alarm handling. Accounts for response time, alarm frequency, and multitasking overhead.</div><span class="rtf">Degradation onset at 70% utilization</span></span></span></div>
                    <div class="result-card-value" id="resCognitive">--</div>
                    <div class="result-card-sub" id="resCognitiveSub">Utilization of operator capacity</div>
                </div>
                <div class="result-card">
                    <div class="result-card-label">Alarm Flood Probability / Shift <span class="res-tip">?<span class="res-tip-body"><div class="rtt">Flood Probability</div><div class="rtd">Statistical probability of at least one alarm flood event occurring during a shift.</div><span class="rtf">ISA-18.2 flood: &gt;10 alarms in 10 min</span></span></span></div>
                    <div class="result-card-value" id="resFlood">--</div>
                    <div class="result-card-sub">&gt;10 alarms in any 10-min window</div>
                </div>
                <div class="result-card">
                    <div class="result-card-label">ISA-18.2 Compliance Score <span class="res-tip">?<span class="res-tip-body"><div class="rtt">ISA-18.2 Compliance</div><div class="rtd">Composite compliance score across all ISA-18.2 alarm management KPIs.</div><span class="rtf">&gt;80% Good &middot; &gt;90% Excellent</span></span></span></div>
                    <div class="result-card-value" id="resISA">--</div>
                    <div class="result-card-sub" id="resISASub">Score out of 100</div>
                </div>
                <div class="result-card">
                    <div class="result-card-label">Actionable Ratio <span class="res-tip">?<span class="res-tip-body"><div class="rtt">Actionable Ratio</div><div class="rtd">Percentage of alarms that require and receive operator action. Non-actionable alarms should be eliminated.</div><span class="rtf">Target: &gt;95% actionable</span></span></span></div>
                    <div class="result-card-value" id="resActionable">--</div>
                    <div class="result-card-sub">Target: &ge; 85%</div>
                </div>
                <div class="result-card">
                    <div class="result-card-label">Recommended Daily Alarm Target <span class="res-tip">?<span class="res-tip-body"><div class="rtt">Daily Alarm Target</div><div class="rtd">Maximum recommended daily alarm count based on ISA-18.2 and EEMUA 191 standards.</div><span class="rtf">EEMUA 191: &le;144/day/op = Acceptable</span></span></span></div>
                    <div class="result-card-value green" id="resTarget">--</div>
                    <div class="result-card-sub">Based on ISA-18.2 &le;1 per 10 min</div>
                </div>
                <div class="result-card">
                    <div class="result-card-label">Priority Reduction Targets <span class="res-tip">?<span class="res-tip-body"><div class="rtt">Priority Reduction</div><div class="rtd">Number of alarms to eliminate per priority category to reach compliance targets.</div></span></span></div>
                    <div class="result-card-value" id="resPriority" style="font-size:0.9rem; line-height: 1.6;">--</div>
                    <div class="result-card-sub">Alarms to eliminate per category</div>
                </div>
            </div>

            <!-- Pro Output Panels (hidden by default) -->
            <div id="alarmProPanels" style="display:none;">
                <!-- Panel 1: Burden & Capacity -->
                <div class="pro-panel">
                    <div class="pro-panel-inner">
                        <div class="pro-panel-title"><i class="fas fa-gauge-high"></i> Burden & Capacity Analysis</div>
                        <div class="calc-results-grid" id="proBurdenGrid">
                            <div class="result-card"><div class="result-card-label">Alarms / Op / Hour <span class="res-tip">?<span class="res-tip-body"><div class="rtt">Hourly Alarm Rate</div><div class="rtd">Average number of alarms per operator per hour. Key workload indicator.</div><span class="rtf">ISA-18.2: &le;6/hr is manageable</span></span></span></div><div class="result-card-value" id="proAlmOpHr">--</div><div class="result-card-sub">Hourly operator burden</div></div>
                            <div class="result-card"><div class="result-card-label">Alarms / Op / Shift <span class="res-tip">?<span class="res-tip-body"><div class="rtt">Shift Alarm Count</div><div class="rtd">Total alarms per operator over the shift duration.</div></span></span></div><div class="result-card-value" id="proAlmOpShift">--</div><div class="result-card-sub">Total shift burden</div></div>
                            <div class="result-card"><div class="result-card-label">Operator Busy Time <span class="res-tip">?<span class="res-tip-body"><div class="rtt">Operator Busy Time</div><div class="rtd">Percentage of shift time spent handling alarms (response + action).</div><span class="rtf">&gt;70% indicates overload risk</span></span></span></div><div class="result-card-value" id="proBusyTime">--</div><div class="result-card-sub">% of shift handling alarms</div></div>
                            <div class="result-card"><div class="result-card-label">Remaining Capacity <span class="res-tip">?<span class="res-tip-body"><div class="rtt">Remaining Capacity</div><div class="rtd">Available operator capacity for non-alarm tasks (monitoring, procedures, coordination).</div></span></span></div><div class="result-card-value" id="proCapacity">--</div><div class="result-card-sub">Available bandwidth</div></div>
                            <div class="result-card"><div class="result-card-label">Utilization Band <span class="res-tip">?<span class="res-tip-body"><div class="rtt">Utilization Band</div><div class="rtd">Operator workload classification: Green (manageable), Amber (heavy), Red (overloaded).</div></span></span></div><div class="result-card-value" id="proUtilBand">--</div><div class="result-card-sub">EEMUA workload rating</div></div>
                            <div class="result-card"><div class="result-card-label">Overload Margin <span class="res-tip">?<span class="res-tip-body"><div class="rtt">Overload Margin</div><div class="rtd">How close the operator is to cognitive overload. Negative values indicate current overload.</div></span></span></div><div class="result-card-value" id="proOverload">--</div><div class="result-card-sub">Alarms above safe capacity</div></div>
                            <div class="result-card"><div class="result-card-label">Erlang-C Wait Prob. <span class="res-tip">?<span class="res-tip-body"><div class="rtt">Erlang-C Wait Probability</div><div class="rtd">Probability that an incoming alarm must wait for operator attention, based on queuing theory.</div><span class="rtf">Target: &lt;20% wait probability</span></span></span></div><div class="result-card-value" id="proErlangC">--</div><div class="result-card-sub">P(alarm must queue)</div></div>
                            <div class="result-card"><div class="result-card-label">Avg Queue Wait <span class="res-tip">?<span class="res-tip-body"><div class="rtt">Avg Queue Wait</div><div class="rtd">Mean time an alarm waits in queue before operator acknowledgment.</div></span></span></div><div class="result-card-value" id="proAvgWait">--</div><div class="result-card-sub">Seconds if queued</div></div>
                        </div>
                    </div>
                    <div class="gated-overlay" onclick="if(window._rzAuth)window._rzAuth.showModal();else alarmShowLogin()"><div class="gated-icon"><i class="fas fa-lock"></i></div><div class="gated-text">Pro Analysis Required</div><div class="gated-sub">Login to unlock 28 advanced KPIs</div></div>
                </div>

                <!-- Panel 2: Flood Risk Deep Dive -->
                <div class="pro-panel">
                    <div class="pro-panel-inner">
                        <div class="pro-panel-title"><i class="fas fa-water"></i> Flood Risk Deep Dive</div>
                        <div class="calc-results-grid" id="proFloodGrid">
                            <div class="result-card"><div class="result-card-label">P(Flood per Window) <span class="res-tip">?<span class="res-tip-body"><div class="rtt">Flood Probability per Window</div><div class="rtd">Probability of a flood event in any given 10-minute window.</div></span></span></div><div class="result-card-value" id="proFloodWindow">--</div><div class="result-card-sub">Raw Poisson probability</div></div>
                            <div class="result-card"><div class="result-card-label">Expected Flood Windows <span class="res-tip">?<span class="res-tip-body"><div class="rtt">Expected Flood Events</div><div class="rtd">Expected number of alarm flood windows per shift.</div></span></span></div><div class="result-card-value" id="proFloodExpected">--</div><div class="result-card-sub">Per shift</div></div>
                            <div class="result-card"><div class="result-card-label">95th %ile 10-min Count <span class="res-tip">?<span class="res-tip-body"><div class="rtt">95th Percentile Count</div><div class="rtd">95th percentile of alarm count in any 10-minute window. Captures burst behavior.</div></span></span></div><div class="result-card-value" id="proPct95">--</div><div class="result-card-sub">Peak alarm burst</div></div>
                            <div class="result-card"><div class="result-card-label">Est. Time-in-Flood <span class="res-tip">?<span class="res-tip-body"><div class="rtt">Time in Flood State</div><div class="rtd">Estimated total time per shift spent in alarm flood conditions.</div></span></span></div><div class="result-card-value" id="proTimeFlood">--</div><div class="result-card-sub">% of shift in flood</div></div>
                            <div class="result-card"><div class="result-card-label">Risk-of-Missing-Critical <span class="res-tip">?<span class="res-tip-body"><div class="rtt">Risk of Missing Critical</div><div class="rtd">Probability that a critical alarm is missed or delayed during a flood event.</div><span class="rtf">Key safety metric</span></span></span></div><div class="result-card-value" id="proMissCrit">--</div><div class="result-card-sub">During flood conditions</div></div>
                            <div class="result-card"><div class="result-card-label">Flood Severity Index <span class="res-tip">?<span class="res-tip-body"><div class="rtt">Flood Severity Index</div><div class="rtd">Composite severity score of flood events considering duration, peak rate, and critical alarm exposure.</div></span></span></div><div class="result-card-value" id="proFloodSeverity">--</div><div class="result-card-sub">Composite flood risk</div></div>
                        </div>
                    </div>
                    <div class="gated-overlay" onclick="if(window._rzAuth)window._rzAuth.showModal();else alarmShowLogin()"><div class="gated-icon"><i class="fas fa-lock"></i></div><div class="gated-text">Pro Analysis Required</div><div class="gated-sub">Advanced flood modeling</div></div>
                </div>

                <!-- Panel 3: Priority & Quality -->
                <div class="pro-panel">
                    <div class="pro-panel-inner">
                        <div class="pro-panel-title"><i class="fas fa-ranking-star"></i> Priority & Quality Assessment</div>
                        <div class="calc-results-grid" id="proQualityGrid">
                            <div class="result-card"><div class="result-card-label">Priority Distribution <span class="res-tip">?<span class="res-tip-body"><div class="rtt">Priority Distribution</div><div class="rtd">Breakdown of alarms by priority level. ISA-18.2 recommends Critical &le;5%, High &le;15%.</div></span></span></div><div class="result-card-value" id="proPrioDist" style="font-size:0.85rem;line-height:1.5;">--</div><div class="result-card-sub">vs 80/15/5 benchmark</div></div>
                            <div class="result-card"><div class="result-card-label">Standing Alarm % <span class="res-tip">?<span class="res-tip-body"><div class="rtt">Standing Alarms</div><div class="rtd">Percentage of alarms continuously active. High standing alarms mask new events.</div><span class="rtf">Target: &lt;5% standing</span></span></span></div><div class="result-card-value" id="proStanding">--</div><div class="result-card-sub">ISA target: &le;10%</div></div>
                            <div class="result-card"><div class="result-card-label">Chattering Impact <span class="res-tip">?<span class="res-tip-body"><div class="rtt">Chattering Impact</div><div class="rtd">Alarm activations from chattering (rapid on/off cycling). Should be eliminated.</div></span></span></div><div class="result-card-value" id="proChattering">--</div><div class="result-card-sub">Nuisance alarm load</div></div>
                            <div class="result-card"><div class="result-card-label">Suppression Exposure <span class="res-tip">?<span class="res-tip-body"><div class="rtt">Suppression Exposure</div><div class="rtd">Percentage of alarms currently suppressed/shelved. High suppression may mask real issues.</div></span></span></div><div class="result-card-value" id="proSuppression">--</div><div class="result-card-sub">Unauthorized suppression risk</div></div>
                            <div class="result-card"><div class="result-card-label">Net Actionable Ratio <span class="res-tip">?<span class="res-tip-body"><div class="rtt">Net Actionable Ratio</div><div class="rtd">Actionable alarms after removing standing, chattering, and nuisance alarms.</div></span></span></div><div class="result-card-value" id="proNetActionable">--</div><div class="result-card-sub">After quality adjustment</div></div>
                            <div class="result-card"><div class="result-card-label">Alarm Quality Score <span class="res-tip">?<span class="res-tip-body"><div class="rtt">Alarm Quality Score</div><div class="rtd">Overall alarm system quality combining actionability, priority accuracy, and nuisance rates.</div></span></span></div><div class="result-card-value" id="proQualityScore">--</div><div class="result-card-sub">Composite quality index</div></div>
                        </div>
                    </div>
                    <div class="gated-overlay" onclick="if(window._rzAuth)window._rzAuth.showModal();else alarmShowLogin()"><div class="gated-icon"><i class="fas fa-lock"></i></div><div class="gated-text">Pro Analysis Required</div><div class="gated-sub">Standards-aligned quality metrics</div></div>
                </div>

                <!-- Panel 4: Compliance Drilldown -->
                <div class="pro-panel">
                    <div class="pro-panel-inner">
                        <div class="pro-panel-title"><i class="fas fa-clipboard-check"></i> ISA-18.2 Compliance Drilldown</div>
                        <div class="calc-results-grid" id="proComplianceGrid">
                            <div class="result-card"><div class="result-card-label">Rate Criterion <span class="res-tip">?<span class="res-tip-body"><div class="rtt">Rate Criterion</div><div class="rtd">Pass/Fail assessment of alarm rate against ISA-18.2 maximum threshold.</div></span></span></div><div class="result-card-value" id="proCompRate">--</div><div class="result-card-sub">Score out of 25</div></div>
                            <div class="result-card"><div class="result-card-label">Actionable Criterion <span class="res-tip">?<span class="res-tip-body"><div class="rtt">Actionable Criterion</div><div class="rtd">Pass/Fail assessment of actionable alarm ratio against ISA-18.2 minimum.</div></span></span></div><div class="result-card-value" id="proCompAction">--</div><div class="result-card-sub">Score out of 25</div></div>
                            <div class="result-card"><div class="result-card-label">Critical % Criterion <span class="res-tip">?<span class="res-tip-body"><div class="rtt">Critical % Criterion</div><div class="rtd">Pass/Fail for critical alarm percentage against ISA-18.2 &le;5% target.</div></span></span></div><div class="result-card-value" id="proCompCrit">--</div><div class="result-card-sub">Score out of 25</div></div>
                            <div class="result-card"><div class="result-card-label">Standing % Criterion <span class="res-tip">?<span class="res-tip-body"><div class="rtt">Standing % Criterion</div><div class="rtd">Pass/Fail for standing alarm percentage against ISA-18.2 &lt;5% target.</div></span></span></div><div class="result-card-value" id="proCompStand">--</div><div class="result-card-sub">Score out of 25</div></div>
                        </div>
                    </div>
                    <div class="gated-overlay" onclick="if(window._rzAuth)window._rzAuth.showModal();else alarmShowLogin()"><div class="gated-icon"><i class="fas fa-lock"></i></div><div class="gated-text">Pro Analysis Required</div><div class="gated-sub">Compliance contribution breakdown</div></div>
                </div>

                <!-- Panel 5: Scenario Sensitivity -->
                <div class="pro-panel">
                    <div class="pro-panel-inner">
                        <div class="pro-panel-title"><i class="fas fa-shuffle"></i> Scenario Sensitivity</div>
                        <div class="calc-results-grid" id="proScenarioGrid">
                            <div class="result-card"><div class="result-card-label">+1 Operator Impact <span class="res-tip">?<span class="res-tip-body"><div class="rtt">+1 Operator Impact</div><div class="rtd">Projected improvement in alarm rate if one additional operator is added per shift.</div></span></span></div><div class="result-card-value" id="proScnOp">--</div><div class="result-card-sub">New rate if +1 operator</div></div>
                            <div class="result-card"><div class="result-card-label">50% Faster Response <span class="res-tip">?<span class="res-tip-body"><div class="rtt">50% Faster Response</div><div class="rtd">Impact of reducing average response time by 50% on cognitive load and queue metrics.</div></span></span></div><div class="result-card-value" id="proScnResp">--</div><div class="result-card-sub">New utilization</div></div>
                            <div class="result-card"><div class="result-card-label">+10% Shelving <span class="res-tip">?<span class="res-tip-body"><div class="rtt">+10% Shelving Impact</div><div class="rtd">Effect of increasing authorized alarm shelving by 10 percentage points.</div></span></span></div><div class="result-card-value" id="proScnShelve">--</div><div class="result-card-sub">New flood probability</div></div>
                            <div class="result-card"><div class="result-card-label">Priority Rebalance <span class="res-tip">?<span class="res-tip-body"><div class="rtt">Priority Rebalance</div><div class="rtd">Impact of rebalancing priority distribution to ISA-18.2 recommended ratios.</div></span></span></div><div class="result-card-value" id="proScnPrio">--</div><div class="result-card-sub">If aligned to 80/15/5</div></div>
                        </div>
                    </div>
                    <div class="gated-overlay" onclick="if(window._rzAuth)window._rzAuth.showModal();else alarmShowLogin()"><div class="gated-icon"><i class="fas fa-lock"></i></div><div class="gated-text">Pro Analysis Required</div><div class="gated-sub">What-if scenario modeling</div></div>
                </div>
            </div>

            <div class="privacy-badge">
                <i class="fas fa-shield-halved"></i> PDF generated in your browser — no data is sent to any server
            </div>
            <div class="benchmark-meta">
                <span class="benchmark-meta-tag"><i class="fas fa-code-branch"></i> Model v1.0</span>
                <span class="benchmark-meta-tag"><i class="fas fa-calendar"></i> Updated Feb 2026</span>
                <span class="benchmark-meta-tag"><i class="fas fa-book"></i> Sources: ISA-18.2-2022, EEMUA 191 (3rd ed.), IEC 62682</span>
                <span class="benchmark-meta-tag"><i class="fas fa-info-circle"></i> Poisson flood model, Erlang-C queueing</span>
            </div>

            <!-- Calculator Disclaimer -->
            <div style="background:rgba(30,41,59,0.6);border:1px solid rgba(148,163,184,0.15);border-radius:12px;padding:1.25rem 1.5rem;margin-top:1.5rem;">
                <div style="display:flex;align-items:flex-start;gap:0.75rem;">
                    <div style="color:#f59e0b;font-size:1rem;margin-top:2px;flex-shrink:0;"><i class="fas fa-triangle-exclamation"></i></div>
                    <div>
                        <div style="font-weight:700;font-size:0.8rem;color:#e2e8f0;margin-bottom:0.5rem;">Disclaimer &amp; Data Sources</div>
                        <p style="font-size:0.72rem;color:#94a3b8;line-height:1.65;margin:0 0 0.5rem 0;">This calculator is provided for <strong style="color:#cbd5e1;">educational and estimation purposes only</strong>. Results are approximations based on industry benchmarks and publicly available data. They should not be used as the sole basis for investment, procurement, or engineering decisions. Always consult qualified professionals for site-specific analysis.</p>
                        <p style="font-size:0.72rem;color:#94a3b8;line-height:1.65;margin:0 0 0.5rem 0;"><strong style="color:#cbd5e1;">Algorithm &amp; methodology sources:</strong> ISA-18.2-2022 alarm management standard, EEMUA 191 (3rd edition) alarm system guidelines, IEC 62682, Poisson flood model for alarm distribution, Erlang-C queueing theory for operator workload.</p>
                        <p style="font-size:0.72rem;color:#94a3b8;line-height:1.65;margin:0 0 0.5rem 0;">All calculations are performed entirely in your browser. No data is transmitted to any server. See our <a href="privacy.html" style="color:#60a5fa;text-decoration:underline;">Privacy Policy</a> for details.</p>
                        <p style="font-size:0.68rem;color:#64748b;line-height:1.5;margin:0;">By using this tool you agree to our <a href="terms.html" style="color:#60a5fa;text-decoration:underline;">Terms of Service</a>. All content on ResistanceZero is independent personal research. This site does not represent any current or former employer.</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Section 10b: Monte Carlo Risk Simulation -->
    <section class="mc-section" id="sec10mc" style="max-width:900px;margin:3rem auto;">
        <div class="mc-header">
            <div class="mc-icon">&#127922;</div>
            <div>
                <div class="mc-title">Monte Carlo Risk Simulation</div>
                <div class="mc-subtitle">Section 10b &mdash; 10,000 iterations with randomized inputs &rarr; probability distributions instead of single-point estimates</div>
            </div>
        </div>
        <p style="color:var(--text-secondary);font-size:0.85rem;line-height:1.6;margin-bottom:1rem;">Single-point calculations assume exact inputs. Reality is uncertain. This simulation samples each parameter from a probability distribution (your input &pm; uncertainty range), runs 10,000 scenarios, and shows you the <strong style="color:#7c3aed;">P10 / P50 / P90</strong> risk envelope &mdash; the range within which 80% of real-world outcomes fall.</p>

        <div class="mc-controls">
            <div class="mc-control">
                <label>Mean Daily Alarms <span class="tooltip-trigger">?<span class="tooltip-content"><div class="tooltip-title">Monte Carlo — Daily Alarms</div><div class="tooltip-desc">Baseline daily alarm count for Monte Carlo simulation. Varies around this mean using the selected uncertainty range.</div></span></span></label>
                <input type="number" id="mcAlarms" value="1200" min="50" max="50000">
            </div>
            <div class="mc-control">
                <label>Operators / Shift <span class="tooltip-trigger">?<span class="tooltip-content"><div class="tooltip-title">Monte Carlo — Operators</div><div class="tooltip-desc">Number of operators per shift for simulation. Affects per-operator alarm rate and cognitive load calculations.</div></span></span></label>
                <select id="mcOps">
                    <option value="1">1 operator</option>
                    <option value="2" selected>2 operators</option>
                    <option value="3">3 operators</option>
                    <option value="4">4 operators</option>
                </select>
            </div>
            <div class="mc-control">
                <label>Shift Duration <span class="tooltip-trigger">?<span class="tooltip-content"><div class="tooltip-title">Monte Carlo — Shift Duration</div><div class="tooltip-desc">Shift length in hours for simulation. Longer shifts increase total alarm exposure and fatigue effects.</div></span></span></label>
                <select id="mcShift">
                    <option value="8">8 hours</option>
                    <option value="12" selected>12 hours</option>
                </select>
            </div>
            <div class="mc-control">
                <label>Uncertainty Range <span class="tooltip-trigger">?<span class="tooltip-content"><div class="tooltip-title">Monte Carlo — Uncertainty</div><div class="tooltip-desc">How much the simulation inputs vary around their mean values. Higher uncertainty = wider confidence intervals in results.</div><div class="tooltip-formula">&pm;10% for verified data &middot; &pm;20% typical &middot; &pm;50% rough estimate</div></span></span></label>
                <select id="mcUncertainty">
                    <option value="0.1">&pm;10% (high confidence data)</option>
                    <option value="0.2" selected>&pm;20% (typical field data)</option>
                    <option value="0.3">&pm;30% (early estimate)</option>
                    <option value="0.5">&pm;50% (rough order of magnitude)</option>
                </select>
            </div>
        </div>

        <div style="display:flex;gap:0.75rem;align-items:center;flex-wrap:wrap;margin-bottom:1rem;">
            <button class="mc-run-btn" id="mcRunBtn" onclick="runMonteCarlo()">
                <i class="fas fa-dice"></i> Run 10,000 Simulations
            </button>
            <span style="font-size:0.78rem;color:var(--text-secondary);" id="mcRunNote">Results update on each run</span>
        </div>

        <div class="mc-progress" id="mcProgress" style="display:none">
            <span id="mcProgressText">Running...</span>
            <div class="mc-progress-bar"><div class="mc-progress-fill" id="mcProgressFill" style="width:0%"></div></div>
        </div>

        <div class="mc-results-grid" id="mcResultsGrid" style="display:none;">
            <div class="mc-stat">
                <div class="mc-stat-label">ISA Compliance Score</div>
                <div class="mc-stat-p50" id="mcCompP50">&mdash;</div>
                <div class="mc-stat-range" id="mcCompRange">&nbsp;</div>
            </div>
            <div class="mc-stat">
                <div class="mc-stat-label">Flood Probability / Shift</div>
                <div class="mc-stat-p50" id="mcFloodP50">&mdash;</div>
                <div class="mc-stat-range" id="mcFloodRange">&nbsp;</div>
            </div>
            <div class="mc-stat">
                <div class="mc-stat-label">Alarms / Op / 10 min</div>
                <div class="mc-stat-p50" id="mcRateP50">&mdash;</div>
                <div class="mc-stat-range" id="mcRateRange">&nbsp;</div>
            </div>
            <div class="mc-stat">
                <div class="mc-stat-label">Cognitive Load Index</div>
                <div class="mc-stat-p50" id="mcCLIP50">&mdash;</div>
                <div class="mc-stat-range" id="mcCLIRange">&nbsp;</div>
            </div>
        </div>

        <div class="chart-wrap" id="mcChartWrap" style="display:none;margin-top:1.25rem;">
            <div class="chart-title"><i class="fas fa-chart-area" style="color:#7c3aed;margin-right:6px;"></i>ISA-18.2 Compliance Score Distribution &mdash; 10,000 Scenarios</div>
            <canvas id="mcHistChart" style="max-height:240px;"></canvas>
            <p style="font-size:0.72rem;color:var(--text-secondary);margin-top:0.5rem;text-align:center;">P10 = worst 10% of scenarios &nbsp;&bull;&nbsp; P50 = median &nbsp;&bull;&nbsp; P90 = best 10% &nbsp;&bull;&nbsp; ISA target = &ge; 85%</p>
        </div>
    </section>

    <!-- Section 10c: Interactive Sankey Diagram -->
    <section class="sankey-section" id="sec10sk" style="max-width:900px;margin:3rem auto;">
        <div class="sankey-header">
            <div class="sankey-title">Alarm Flow Rationalization Diagram</div>
            <div class="sankey-subtitle">Section 10c &mdash; Interactive Sankey &mdash; How 3,847 configured alarm points were rationalized. Hover nodes and links for details.</div>
        </div>
        <svg id="sankeyChart"></svg>
        <div class="sankey-legend">
            <div class="sankey-legend-item"><div class="sankey-legend-dot" style="background:#ef4444;"></div>Alarm Failure Types (Input)</div>
            <div class="sankey-legend-item"><div class="sankey-legend-dot" style="background:#f59e0b;"></div>Rationalization Action</div>
            <div class="sankey-legend-item"><div class="sankey-legend-dot" style="background:#10b981;"></div>Active Post-Rationalization</div>
            <div class="sankey-legend-item"><div class="sankey-legend-dot" style="background:#64748b;"></div>Eliminated / Removed</div>
            <div class="sankey-legend-item"><div class="sankey-legend-dot" style="background:#3b82f6;"></div>Suppressed / Shelved</div>
        </div>
        <p style="font-size:0.73rem;color:var(--text-secondary);margin-top:0.75rem;line-height:1.5;">Data source: Alarm rationalization project case study. Values represent configured alarm points (3,847 total). Post-rationalization: 391 active points (&asymp;10% of original &mdash; &gt;90% reduction).</p>
    </section>


    <!-- Continue Article Content -->
    <article class="article-content" style="padding-top: 0;">
        <div class="container" style="max-width: 900px; margin: 0 auto;">
            <div class="article-body">

                <!-- Section 11: Organizational Implications -->
                <h2 id="sec11"><span class="section-number">11</span> Organizational Implications</h2>

                <p>The technical interventions described in Sections 8 and 9 are necessary but not sufficient. Sustainable alarm management requires organizational change that extends beyond the control room to executive leadership.</p>

                <h3>Management Must Stop Blaming Operators</h3>
                <p>The most important organizational change is also the most difficult: management must accept that alarm fatigue is a system design failure, not a personnel performance failure. This requires abandoning the deeply ingrained instinct to treat missed alarms as disciplinary matters. When an alarm is missed, the first question should be: "Why did the system present this alarm in a way that made it easy to miss?" not "Why did the operator fail to respond?"</p>

                <h3>Alarm Management as Continuous Process</h3>
                <p>Alarm rationalization is not a one-time project. It is a continuous process that must be integrated into the facility's <span class="tip" data-tip="MOC: Management of Change. A formal process requiring review and approval before any modification to operational systems, including alarm configuration. Ensures that changes are intentional, documented, and reversible.">management of change</span> (MOC) process. Every new piece of equipment, every control system modification, every operational procedure change has the potential to introduce new alarms. Without MOC integration, the alarm system will inevitably drift back toward its pre-rationalization state within 12-18 months.</p>

                <h3>Alarm Management as a Leading Safety Indicator</h3>
                <p>Rather than treating alarm incidents as lagging indicators (measuring after something goes wrong), alarm system metrics should be treated as <strong>leading safety indicators</strong>. The daily alarm rate, standing alarm count, chattering alarm count, and ISA-18.2 compliance score are all predictive of future incident probability. A rising alarm rate is a warning signal that should trigger proactive intervention, not a metric to be explained away in monthly reports.<a href="#ref9" class="src-ref" title="Uptime Institute (2024)">[9]</a></p>

                <h3>The Three Mile Island Precedent</h3>
                <p>The most consequential example of alarm system failure in industrial history occurred at the Three Mile Island nuclear power plant in 1979. The NRC investigation found that during the initial phase of the accident, operators were confronted with over 100 alarms within the first few minutes, many of them contradictory.<a href="#ref11" class="src-ref" title="NRC (1979). Three Mile Island Report.">[11]</a> The alarm system, rather than guiding operators toward the correct diagnosis, actively impeded their ability to understand what was happening. The operators did not fail because they were incompetent. They failed because the alarm system was incompetently designed.</p>

                <p>Decades later, the same fundamental design failures &mdash; alarm floods, consequential cascades, poor prioritization, and inadequate alarm philosophy &mdash; continue to be replicated in data centers, hospitals, chemical plants, and other critical infrastructure. The standards exist. The knowledge exists. The solutions exist. What too often does not exist is the organizational willingness to implement them.<a href="#ref10" class="src-ref" title="Uptime Institute (2024). Global Data Center Survey.">[10]</a></p>

                <!-- Section 12: Conclusion -->
                <h2 id="sec12"><span class="section-number">12</span> Conclusion</h2>

                <div class="conclusion-box">
                    <h3>Summary of Findings</h3>
                    <p>This analysis demonstrates that alarm fatigue is a predictable, quantifiable, and solvable engineering problem. The key conclusions are:</p>
                    <ul>
                        <li><strong>Alarm fatigue is a system design failure.</strong> It arises from alarm systems that generate more information than human operators can cognitively process. The failure is in the design, not the operator.</li>
                        <li><strong>International standards provide clear guidance.</strong> ISA-18.2, EEMUA 191, and IEC 62682 define the alarm management lifecycle, performance benchmarks, and rationalization methodology. These are not theoretical documents &mdash; they are practical engineering frameworks validated across decades of industrial experience.</li>
                        <li><strong>Organizations that blame operators will never solve alarm fatigue.</strong> The misattribution of alarm fatigue to human negligence prevents the systemic interventions that actually work. It also damages the trust relationship between management and operations teams that is essential for safety culture.</li>
                        <li><strong>The mathematics are unambiguous.</strong> At 800+ alarms per day for two operators, alarm floods are a statistical certainty, cognitive overload is inevitable, and the alarm system provides negative safety value &mdash; it degrades rather than enhances operator performance. The calculator in Section 10 allows readers to verify this for their own operating parameters.</li>
                        <li><strong>Structured rationalization works.</strong> A systematic, standards-based rationalization achieved &gt;90% alarm reduction, 75% response time improvement, and ISA-18.2 compliance improvement from 12% to 89% in a live data center &mdash; without adding staff, purchasing new technology, or compromising safety coverage.</li>
                    </ul>
                    <p style="margin-top: 1.5rem; font-style: italic; color: #94a3b8;">The measure of a good alarm system is not how many alarms it generates, but how few &mdash; while still catching every genuine problem.</p>
                </div>

                
                <!-- Independence Disclaimer -->
                <div style="margin:2rem 0 0;padding:1rem 0;border-top:1px solid rgba(255,255,255,0.06);text-align:center;">
                    <p style="font-size:0.72rem;color:#64748b;font-style:italic;line-height:1.6;margin:0;">All content on ResistanceZero is independent personal research derived from publicly available sources. This site does not represent any current or former employer. <a href="terms.html" style="color:#8b5cf6;">Terms &amp; Disclaimer</a></p>
                </div>

<!-- References -->
                <h2 style="margin-top: 3rem;"><span class="section-number">R</span> References</h2>

                <ol class="ref-list">
                    <li id="ref1">Reason, J. (1997). <em>Managing the Risks of Organizational Accidents</em>. Ashgate Publishing.</li>
                    <li id="ref2">Hollnagel, E. (2014). <em>Safety-I and Safety-II: The Past and Future of Safety Management</em>. CRC Press.</li>
                    <li id="ref3">Endsley, M. R. (1995). "Toward a Theory of Situation Awareness in Dynamic Systems." <em>Human Factors</em>, 37(1), 32-64.</li>
                    <li id="ref4">ISA-18.2-2022. <em>Management of Alarm Systems for the Process Industries</em>. International Society of Automation. <a href="https://www.isa.org/standards-and-publications/isa-standards/isa-standards-committees/isa18" target="_blank">https://www.isa.org/standards-and-publications/isa-standards/isa-standards-committees/isa18</a></li>
                    <li id="ref5">EEMUA Publication 191 (2013). <em>Alarm Systems: A Guide to Design, Management and Procurement</em>. 3rd Edition. Engineering Equipment and Materials Users Association.</li>
                    <li id="ref6">IEC 62682:2022. <em>Management of alarm systems for the process industries</em>. International Electrotechnical Commission.</li>
                    <li id="ref7">Hollifield, B. & Habibi, E. (2010). <em>The Alarm Management Handbook</em>. 2nd Edition. PAS/ISA.</li>
                    <li id="ref8">Wickens, C. D. (2008). "Multiple Resources and Mental Workload." <em>Human Factors</em>, 50(3), 449-455.</li>
                    <li id="ref9">Uptime Institute (2024). "Annual Outage Analysis 2024." <a href="https://uptimeinstitute.com/resources/research-and-reports" target="_blank">https://uptimeinstitute.com/resources/research-and-reports</a></li>
                    <li id="ref10">Uptime Institute (2024). "Global Data Center Survey 2024." Alarm management and monitoring trends.</li>
                    <li id="ref11">NRC (1979). "Three Mile Island: A Report to the Commissioners and to the Public." NUREG/CR-1250. U.S. Nuclear Regulatory Commission.</li>
                    <li id="ref12">ASM Consortium (2013). "Effective Alarm Management Practices." Abnormal Situation Management Consortium.</li>
                    <li id="ref13">Nimmo, I. (2002). "Adequately Address Abnormal Situations." <em>Chemical Engineering Progress</em>, 98(9), 36-44.</li>
                    <li id="ref14">UK Health and Safety Executive (2003). HSG48: "Reducing Error and Influencing Behaviour." 2nd Edition.</li>
                </ol>

                <!-- Newsletter Signup -->
                <div class="newsletter-signup">
                    <h3>Stay Updated</h3>
                    <p>Get notified when new articles on data center operations and engineering excellence are published.</p>
                    <form class="newsletter-form" onsubmit="return subscribeNewsletter(event)">
                        <input type="email" placeholder="Enter your email" required>
                        <button type="submit">Subscribe</button>
                    </form>
                    <p class="newsletter-privacy">No spam. Unsubscribe anytime.</p>
                </div>

                <!-- Author Bio -->
                <div class="author-bio">
                    <div class="author-bio-image">
                        <img loading="lazy" src="assets/profile-photo.jpg" alt="Bagus Dwi Permana">
                    </div>
                    <div class="author-bio-content">
                        <h4>Bagus Dwi Permana</h4>
                        <p class="author-bio-title">Engineering Operations Manager | Ahli K3 Listrik</p>
                        <p>12+ years professional experience in critical infrastructure and operations. CDFOM certified. Transforming operations through systematic excellence and safety-first engineering.</p>
                        <div class="author-bio-links">
                            <a href="https://www.linkedin.com/in/bagus-dwi-permana-ba90b092" target="_blank">
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/></svg>
                                LinkedIn
                            </a>
                            <a href="https://github.com/baguspermana7-cpu" target="_blank">
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/></svg>
                                GitHub
                            </a>
                            <a href="mailto:baguspermana7@gmail.com">
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg>
                                Email
                            </a>
                        </div>
                    </div>
                </div>

                <!-- Related Articles -->
                <div class="related-articles">
                    <h3>Continue Reading</h3>
                    <div class="related-grid">
                        <a href="article-1.html" class="related-card">
                            <div class="related-card-number">01</div>
                            <div class="related-card-content">
                                <h4>When Nothing Happens, Engineering Is Working</h4>
                                <p>The invisible work of reliability engineering</p>
                            </div>
                        </a>
                        <a href="article-3.html" class="related-card">
                            <div class="related-card-number">03</div>
                            <div class="related-card-content">
                                <h4>Maintenance Compliance Is Not a Technician Problem</h4>
                                <p>Systemic approach to maintenance excellence</p>
                            </div>
                        </a>
                    </div>
                </div>

                <!-- Article Navigation -->
                <div class="article-nav">
                    <a href="article-1.html">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M19 12H5M12 19l-7-7 7-7"/></svg>
                        Previous Article
                    </a>
                    <a href="article-3.html">
                        Next Article
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M5 12h14M12 5l7 7-7 7"/></svg>
                    </a>
                </div>
            </div>
        </div>
    </article>

    </main>

    <!-- Footer -->
    <footer class="footer footer-enhanced">
        <div class="container">
            <div class="footer-grid">
                <div class="footer-brand">
                    <p class="footer-tagline-main">BUILT FOR MISSION CRITICAL INFRASTRUCTURE<br>MANAGEMENT // 2026</p>
                    <p class="footer-tagline-sub">ALL OPERATIONAL DATASETS PRESERVED.</p>
                    <p class="footer-copyright">&copy; 2026 Bagus Dwi Permana. All rights reserved.</p>
                </div>
                <div class="footer-nav">
                    <h4 class="footer-heading">NAVIGATION</h4>
                    <ul class="footer-links">
                        <li><a href="index.html">Home Dashboard</a></li>
                        <li><a href="articles.html">Technical Journal</a></li>
                        <li><a href="index.html#case-studies">Case Studies</a></li>
                        <li><a href="datacenter-solutions.html">DC Solutions</a></li>
                    </ul>
                </div>
                <div class="footer-connect">
                    <h4 class="footer-heading">CONNECT</h4>
                    <ul class="footer-links">
                        <li><a href="https://www.linkedin.com/in/bagus-dwi-permana-ba90b092" target="_blank" rel="noopener">LinkedIn Profile</a></li>
                        <li><a href="articles.html">Technical Journal</a></li>
                        <li><a href="mailto:baguspermana7@gmail.com">Direct Contact</a></li>
                        <li><a href="https://github.com/baguspermana7-cpu" target="_blank" rel="noopener">GitHub</a></li>
                    </ul>
                </div>
            </div>
        </div>
    </footer>

    <!-- Login Modal -->
    <div id="alarmLoginModal">
        <div class="alarm-login-box">
            <button onclick="alarmCloseLogin()" style="position:absolute;top:16px;right:16px;background:none;border:none;font-size:1.2rem;color:#94a3b8;cursor:pointer;padding:4px;">&times;</button>
            <div style="text-align:center;margin-bottom:1.5rem;">
                <i class="fas fa-lock-open" style="font-size:2.5rem;color:#ef4444;margin-bottom:0.5rem;"></i>
                <h3 style="font-size:1.3rem;font-weight:700;color:#1e293b;margin:0 0 0.25rem;">Pro Analysis Access</h3>
                <p style="font-size:0.85rem;color:#64748b;margin:0;">Login to unlock 28 advanced alarm KPIs + PDF export</p>
            </div>
            <div id="alarmLoginError" style="display:none;padding:10px 14px;border-radius:8px;background:rgba(239,68,68,0.1);border:1px solid rgba(239,68,68,0.3);color:#dc2626;font-size:0.8rem;margin-bottom:1rem;text-align:center;">Invalid credentials</div>
            <div style="display:flex;flex-direction:column;gap:1rem;">
                <div>
                    <label style="display:block;font-size:0.8rem;font-weight:600;color:#475569;margin-bottom:6px;">Email</label>
                    <input type="email" id="alarmLoginEmail" placeholder="your@email.com">
                </div>
                <div>
                    <label style="display:block;font-size:0.8rem;font-weight:600;color:#475569;margin-bottom:6px;">Password</label>
                    <input type="password" id="alarmLoginPassword" placeholder="Enter password" onkeydown="if(event.key==='Enter')alarmDoLogin()">
                </div>
                <button onclick="alarmDoLogin()" style="padding:12px;border-radius:10px;border:none;background:linear-gradient(135deg,#dc2626,#ef4444);color:white;font-size:0.95rem;font-weight:600;font-family:inherit;cursor:pointer;transition:all 0.3s;box-shadow:0 4px 12px rgba(239,68,68,0.3);">
                    <i class="fas fa-unlock" style="margin-right:8px;"></i>Unlock Pro Analysis
                </button>
                <p style="text-align:center;font-size:0.75rem;color:#94a3b8;margin:0;">Demo: demo@resistancezero.com / demo2026</p>
                <div style="text-align:center;margin-top:6px;"><a href="mailto:bagus@resistancezero.com" style="font-size:0.62rem;color:#64748b;text-decoration:none;">Want full access? Get in touch &rarr;</a></div>
                <p style="text-align:center;font-size:0.68rem;color:#64748b;margin-top:8px;line-height:1.5;">By clicking Login, you agree to our <a href="terms.html" target="_blank" style="color:#8b5cf6;text-decoration:underline;">Terms of Service</a> and <a href="privacy.html" target="_blank" style="color:#8b5cf6;text-decoration:underline;">Privacy Policy</a>.</p>
            </div>
        </div>
    </div>

    <!-- Share Buttons - Floating Sidebar -->
    <aside class="share-buttons" id="shareButtons" aria-label="Share this article">
        <span class="share-label">Share</span>
        <button class="share-btn linkedin" data-tooltip="Share on LinkedIn" onclick="shareLinkedIn()" aria-label="Share on LinkedIn">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                <path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/>
            </svg>
        </button>
        <button class="share-btn twitter" data-tooltip="Share on X" onclick="shareTwitter()" aria-label="Share on X (Twitter)">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                <path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/>
            </svg>
        </button>
        <button class="share-btn whatsapp" data-tooltip="Share on WhatsApp" onclick="shareWhatsApp()" aria-label="Share on WhatsApp">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"/>
            </svg>
        </button>
        <button class="share-btn copy" data-tooltip="Copy link" onclick="copyLink()" aria-label="Copy article link">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="copy-icon">
                <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
            </svg>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="check-icon" style="display:none">
                <polyline points="20 6 9 17 4 12"></polyline>
            </svg>
        </button>
    </aside>

    <script src="script.min.js"></script>

    <!-- Share Buttons Functionality -->
    <script>
        (function() {
            const shareButtons = document.getElementById('shareButtons');
            const articleHero = document.querySelector('.article-hero');
            if (shareButtons && articleHero) {
                document.body.classList.add('has-share-buttons');
                const observer = new IntersectionObserver((entries) => {
                    entries.forEach(entry => {
                        shareButtons.classList.toggle('visible', !entry.isIntersecting);
                    });
                }, { threshold: 0.1 });
                observer.observe(articleHero);
            }
        })();

        function getShareData() {
            return {
                title: document.querySelector('meta[property="og:title"]')?.content || document.title,
                text: document.querySelector('meta[property="og:description"]')?.content || '',
                url: window.location.href
            };
        }

        function shareLinkedIn() {
            const data = getShareData();
            window.open('https://www.linkedin.com/sharing/share-offsite/?url=' + encodeURIComponent(data.url), '_blank', 'width=600,height=600');
        }

        function shareTwitter() {
            const data = getShareData();
            const text = data.title + ' by @BagusDPermana';
            window.open('https://twitter.com/intent/tweet?text=' + encodeURIComponent(text) + '&url=' + encodeURIComponent(data.url), '_blank', 'width=600,height=400');
        }

        function shareWhatsApp() {
            const data = getShareData();
            window.open('https://wa.me/?text=' + encodeURIComponent(data.title + '\n\n' + data.url), '_blank');
        }

        function copyLink() {
            var btn = document.querySelector('.share-btn.copy');
            var copyIcon = btn.querySelector('.copy-icon');
            var checkIcon = btn.querySelector('.check-icon');
            navigator.clipboard.writeText(window.location.href).then(function() {
                btn.classList.add('copied');
                copyIcon.style.display = 'none';
                checkIcon.style.display = 'block';
                btn.setAttribute('data-tooltip', 'Copied!');
                setTimeout(function() {
                    btn.classList.remove('copied');
                    copyIcon.style.display = 'block';
                    checkIcon.style.display = 'none';
                    btn.setAttribute('data-tooltip', 'Copy link');
                }, 2000);
            });
        }
    </script>

    <!-- Calculator Logic + Pro Engine + PDF + Auth -->
    <script>
    (function() {
        var alarmMode = 'free';
        var alarmIsPremium = false;

        // ═══ MATH HELPERS ═══
        function factorial(n) { if (n <= 1) return 1; var r = 1; for (var i = 2; i <= n; i++) r *= i; return r; }
        function poissonCDF(lambda, k) { var s = 0; for (var i = 0; i <= k; i++) s += Math.pow(lambda, i) * Math.exp(-lambda) / factorial(i); return s; }
        function poissonQuantile(lambda, p) { var k = 0; while (poissonCDF(lambda, k) < p && k < 500) k++; return k; }

        function calcRate(totalDaily, operators, shiftHours) {
            var shiftsPerDay = 24 / shiftHours;
            var alarmsPerShift = totalDaily / shiftsPerDay;
            return alarmsPerShift / (operators * shiftHours * 6);
        }

        function cognitiveLoad(alarmsPerHour, responseTimeSec) {
            var utilization = Math.min((alarmsPerHour * responseTimeSec) / 3600, 1.0);
            var degradation = utilization > 0.7 ? 1 - Math.exp(-3 * (utilization - 0.7)) : 0;
            return { utilization: utilization * 100, degradation: degradation * 100, effective: (1 - degradation) * 100 };
        }

        function floodProbability(avgDailyRate, threshold, windowMin, shiftHours) {
            var lambda = avgDailyRate * (windowMin / 1440);
            var pFloodPerWindow = 1 - poissonCDF(lambda, threshold - 1);
            var windowsPerShift = (shiftHours * 60) / windowMin;
            return Math.min((1 - Math.pow(1 - pFloodPerWindow, windowsPerShift)) * 100, 100);
        }

        function floodProbWindow(avgDailyRate, threshold, windowMin) {
            var lambda = avgDailyRate * (windowMin / 1440);
            return 1 - poissonCDF(lambda, threshold - 1);
        }

        function isaComplianceDetail(rate, actionableRatio, criticalPct, standingPct) {
            var rateScore = rate <= 1 ? 25 : rate <= 2 ? 15 : rate <= 5 ? 5 : 0;
            var actScore = actionableRatio >= 0.85 ? 25 : actionableRatio >= 0.6 ? 15 : 5;
            var critScore = criticalPct <= 0.05 ? 25 : criticalPct <= 0.1 ? 15 : criticalPct <= 0.2 ? 5 : 0;
            var standScore = standingPct <= 0.1 ? 25 : standingPct <= 0.3 ? 15 : 5;
            return { rate: rateScore, actionable: actScore, critical: critScore, standing: standScore, total: rateScore + actScore + critScore + standScore };
        }

        // Erlang-C formula
        function erlangC(lambda, mu, c) {
            var rho = lambda / (c * mu);
            if (rho >= 1) return 1;
            var a = lambda / mu;
            var sum = 0;
            for (var k = 0; k < c; k++) sum += Math.pow(a, k) / factorial(k);
            var last = Math.pow(a, c) / factorial(c) * (1 / (1 - rho));
            return last / (sum + last);
        }

        function getGrade(score) { return score >= 90 ? 'A' : score >= 75 ? 'B' : score >= 55 ? 'C' : score >= 35 ? 'D' : 'F'; }
        function getGradeClass(g) { return 'grade-' + g; }
        function getCC(v, g, a) { return v <= g ? 'green' : v <= a ? 'amber' : 'red'; }

        // ═══ MAIN CALCULATOR ═══
        function updateCalculator() {
            var totalDaily = parseInt(document.getElementById('totalDaily').value) || 0;
            var criticalDaily = parseInt(document.getElementById('criticalDaily').value) || 0;
            var warningDaily = parseInt(document.getElementById('warningDaily').value) || 0;
            var infoDaily = Math.max(0, totalDaily - criticalDaily - warningDaily);
            var avgResponse = parseInt(document.getElementById('avgResponse').value) || 60;
            var operators = parseInt(document.getElementById('operatorsPerShift').value) || 2;
            var shiftHours = parseInt(document.getElementById('shiftDuration').value) || 12;
            var shelvingPct = parseInt(document.getElementById('shelvingPct').value) || 0;

            document.getElementById('infoDaily').value = infoDaily;
            document.getElementById('shelvingVal').textContent = shelvingPct + '%';

            var effectiveDaily = totalDaily * (1 - shelvingPct / 100);
            var shiftsPerDay = 24 / shiftHours;
            var alarmsPerShift = effectiveDaily / shiftsPerDay;
            var alarmsPerHourPerOp = alarmsPerShift / (operators * shiftHours);

            // Pro parameters
            var floodWindowMin = parseInt(document.getElementById('proFloodWindow')?.value) || 10;
            var floodThreshold = parseInt(document.getElementById('proFloodThreshold')?.value) || 10;
            var proStandingInput = parseInt(document.getElementById('proStandingPct')?.value) || 0;
            var chatterPct = parseInt(document.getElementById('proChatterPct')?.value) || 5;
            var suppressAuth = parseInt(document.getElementById('proSuppressAuth')?.value) || 80;

            // 1. Rate
            var rate = calcRate(effectiveDaily, operators, shiftHours);
            var rateEl = document.getElementById('resRate');
            rateEl.textContent = rate.toFixed(2);
            rateEl.className = 'result-card-value ' + (rate <= 1 ? 'green' : rate <= 2 ? 'amber' : 'red');

            // 2. Cognitive Load
            var cogLoad = cognitiveLoad(alarmsPerHourPerOp, avgResponse);
            var cogEl = document.getElementById('resCognitive');
            cogEl.textContent = cogLoad.utilization.toFixed(1) + '%';
            cogEl.className = 'result-card-value ' + getCC(cogLoad.utilization, 50, 70);
            document.getElementById('resCognitiveSub').textContent = 'Effective capacity: ' + cogLoad.effective.toFixed(1) + '% | Degradation: ' + cogLoad.degradation.toFixed(1) + '%';

            // 3. Flood Probability
            var floodProb = floodProbability(effectiveDaily, floodThreshold, floodWindowMin, shiftHours);
            var floodEl = document.getElementById('resFlood');
            floodEl.textContent = floodProb.toFixed(1) + '%';
            floodEl.className = 'result-card-value ' + (floodProb < 10 ? 'green' : floodProb < 50 ? 'amber' : 'red');

            // 4. ISA Compliance
            var actionableRatio = totalDaily > 0 ? (criticalDaily + warningDaily) / totalDaily : 0;
            var criticalPct = totalDaily > 0 ? criticalDaily / totalDaily : 0;
            var standingPct = proStandingInput > 0 ? proStandingInput / 100 : (totalDaily > 0 ? (infoDaily * 0.3) / totalDaily : 0);
            var isa = isaComplianceDetail(rate, actionableRatio, criticalPct, standingPct);
            var grade = getGrade(isa.total);
            document.getElementById('resISA').innerHTML = isa.total + '/100 <span class="grade-badge ' + getGradeClass(grade) + '">' + grade + '</span>';

            // 5. Actionable Ratio
            var actEl = document.getElementById('resActionable');
            actEl.textContent = (actionableRatio * 100).toFixed(1) + '%';
            actEl.className = 'result-card-value ' + (actionableRatio >= 0.85 ? 'green' : actionableRatio >= 0.6 ? 'amber' : 'red');

            // 6. Target
            var targetDaily = operators * 144;
            document.getElementById('resTarget').textContent = Math.round(targetDaily) + ' alarms/day';

            // 7. Priority Reduction
            var excess = Math.max(0, totalDaily - targetDaily);
            var infoReduce = Math.min(infoDaily, excess);
            var warnReduce = Math.min(warningDaily, excess - infoReduce);
            var critReduce = Math.min(criticalDaily, excess - infoReduce - warnReduce);
            document.getElementById('resPriority').innerHTML =
                '<span style="color:#94a3b8;">Info:</span> <span style="color:#f87171;">-' + Math.round(infoReduce) + '</span> | ' +
                '<span style="color:#94a3b8;">Warn:</span> <span style="color:#fbbf24;">-' + Math.round(warnReduce) + '</span> | ' +
                '<span style="color:#94a3b8;">Crit:</span> <span style="color:#34d399;">-' + Math.round(critReduce) + '</span>';

            // ═══ PRO OUTPUTS ═══
            if (alarmMode === 'pro' && alarmIsPremium) {
                var almOpHr = alarmsPerHourPerOp;
                var almOpShift = alarmsPerShift / operators;
                var busyTime = cogLoad.utilization;
                var capacity = Math.max(0, 100 - busyTime);
                var overloadAlarms = Math.max(0, effectiveDaily - targetDaily);

                // Utilization band (EEMUA 191)
                var utilBand = rate <= 1 ? 'Acceptable' : rate <= 2 ? 'Manageable' : rate <= 3 ? 'Over-demanding' : 'Unacceptable';
                var utilColor = rate <= 1 ? 'green' : rate <= 2 ? 'amber' : 'red';

                // Erlang-C
                var lambda_hr = effectiveDaily / 24;
                var mu_hr = 3600 / avgResponse;
                var pw = erlangC(lambda_hr, mu_hr, operators);
                var avgWait = pw > 0 && mu_hr * operators - lambda_hr > 0 ? pw / (mu_hr * operators - lambda_hr) * 3600 : 999;

                // Panel 1: Burden
                document.getElementById('proAlmOpHr').textContent = almOpHr.toFixed(1);
                document.getElementById('proAlmOpHr').className = 'result-card-value ' + getCC(almOpHr, 6, 12);
                document.getElementById('proAlmOpShift').textContent = Math.round(almOpShift);
                document.getElementById('proAlmOpShift').className = 'result-card-value ' + getCC(almOpShift, 72, 144);
                document.getElementById('proBusyTime').textContent = busyTime.toFixed(1) + '%';
                document.getElementById('proBusyTime').className = 'result-card-value ' + getCC(busyTime, 50, 70);
                document.getElementById('proCapacity').textContent = capacity.toFixed(1) + '%';
                document.getElementById('proCapacity').className = 'result-card-value ' + (capacity >= 30 ? 'green' : capacity >= 10 ? 'amber' : 'red');
                document.getElementById('proUtilBand').textContent = utilBand;
                document.getElementById('proUtilBand').className = 'result-card-value ' + utilColor;
                document.getElementById('proOverload').textContent = overloadAlarms > 0 ? '+' + Math.round(overloadAlarms) : 'None';
                document.getElementById('proOverload').className = 'result-card-value ' + (overloadAlarms <= 0 ? 'green' : 'red');
                document.getElementById('proErlangC').textContent = (pw * 100).toFixed(1) + '%';
                document.getElementById('proErlangC').className = 'result-card-value ' + getCC(pw * 100, 20, 50);
                document.getElementById('proAvgWait').textContent = avgWait < 999 ? avgWait.toFixed(0) + 's' : 'System overloaded';
                document.getElementById('proAvgWait').className = 'result-card-value ' + (avgWait < 30 ? 'green' : avgWait < 120 ? 'amber' : 'red');

                // Panel 2: Flood
                var pFW = floodProbWindow(effectiveDaily, floodThreshold, floodWindowMin);
                var windowsPerShift = (shiftHours * 60) / floodWindowMin;
                var expectedFloodWindows = pFW * windowsPerShift;
                var lambdaW = effectiveDaily * (floodWindowMin / 1440);
                var pct95 = poissonQuantile(lambdaW, 0.95);
                var timeInFlood = Math.min(pFW * 100, 100);
                var missCritIdx = Math.min(100, (floodProb / 100) * (1 - capacity / 100) * 100 * (criticalPct * 10 + 1));
                var floodSeverity = Math.round(Math.min(100, (timeInFlood * 0.4 + missCritIdx * 0.3 + (floodProb) * 0.3)));

                document.getElementById('proFloodWindow').textContent = (pFW * 100).toFixed(2) + '%';
                document.getElementById('proFloodWindow').className = 'result-card-value ' + getCC(pFW * 100, 1, 10);
                document.getElementById('proFloodExpected').textContent = expectedFloodWindows.toFixed(1);
                document.getElementById('proFloodExpected').className = 'result-card-value ' + getCC(expectedFloodWindows, 1, 5);
                document.getElementById('proPct95').textContent = pct95 + ' alarms';
                document.getElementById('proPct95').className = 'result-card-value ' + getCC(pct95, 10, 20);
                document.getElementById('proTimeFlood').textContent = timeInFlood.toFixed(1) + '%';
                document.getElementById('proTimeFlood').className = 'result-card-value ' + getCC(timeInFlood, 5, 15);
                document.getElementById('proMissCrit').textContent = missCritIdx.toFixed(0) + '/100';
                document.getElementById('proMissCrit').className = 'result-card-value ' + getCC(missCritIdx, 20, 50);
                document.getElementById('proFloodSeverity').textContent = floodSeverity + '/100';
                document.getElementById('proFloodSeverity').className = 'result-card-value ' + getCC(floodSeverity, 25, 50);

                // Panel 3: Priority & Quality
                var critPctDisp = (criticalPct * 100).toFixed(1);
                var warnPctDisp = totalDaily > 0 ? (warningDaily / totalDaily * 100).toFixed(1) : '0.0';
                var infoPctDisp = totalDaily > 0 ? (infoDaily / totalDaily * 100).toFixed(1) : '0.0';
                document.getElementById('proPrioDist').innerHTML = '<span style="color:#f87171;">C:' + critPctDisp + '%</span> <span style="color:#fbbf24;">W:' + warnPctDisp + '%</span> <span style="color:#94a3b8;">I:' + infoPctDisp + '%</span>';
                document.getElementById('proStanding').textContent = (standingPct * 100).toFixed(1) + '%';
                document.getElementById('proStanding').className = 'result-card-value ' + getCC(standingPct * 100, 10, 30);
                var chatterLoad = Math.round(effectiveDaily * chatterPct / 100);
                document.getElementById('proChattering').textContent = chatterLoad + '/day';
                document.getElementById('proChattering').className = 'result-card-value ' + getCC(chatterPct, 3, 10);
                var unauthSuppress = shelvingPct * (1 - suppressAuth / 100);
                document.getElementById('proSuppression').textContent = unauthSuppress.toFixed(1) + '%';
                document.getElementById('proSuppression').className = 'result-card-value ' + getCC(unauthSuppress, 2, 5);
                var netActionable = Math.max(0, actionableRatio - chatterPct / 100 * actionableRatio);
                document.getElementById('proNetActionable').textContent = (netActionable * 100).toFixed(1) + '%';
                document.getElementById('proNetActionable').className = 'result-card-value ' + (netActionable >= 0.85 ? 'green' : netActionable >= 0.6 ? 'amber' : 'red');
                var qualityScore = Math.round(Math.min(100, (netActionable * 30) + ((1 - standingPct) * 25) + ((1 - chatterPct / 100) * 25) + (suppressAuth / 100 * 20)));
                document.getElementById('proQualityScore').textContent = qualityScore + '/100';
                document.getElementById('proQualityScore').className = 'result-card-value ' + getCC(100 - qualityScore, 25, 50);

                // Panel 4: Compliance Drilldown
                var cs = ['proCompRate', 'proCompAction', 'proCompCrit', 'proCompStand'];
                var cv = [isa.rate, isa.actionable, isa.critical, isa.standing];
                for (var ci = 0; ci < 4; ci++) {
                    document.getElementById(cs[ci]).textContent = cv[ci] + '/25';
                    document.getElementById(cs[ci]).className = 'result-card-value ' + (cv[ci] >= 25 ? 'green' : cv[ci] >= 15 ? 'amber' : 'red');
                }

                // Panel 5: Scenario Sensitivity
                var rateP1 = calcRate(effectiveDaily, operators + 1, shiftHours);
                document.getElementById('proScnOp').textContent = rateP1.toFixed(2) + ' /10min';
                document.getElementById('proScnOp').className = 'result-card-value ' + (rateP1 <= 1 ? 'green' : rateP1 <= 2 ? 'amber' : 'red');
                var cogHalf = cognitiveLoad(alarmsPerHourPerOp, avgResponse * 0.5);
                document.getElementById('proScnResp').textContent = cogHalf.utilization.toFixed(1) + '%';
                document.getElementById('proScnResp').className = 'result-card-value ' + getCC(cogHalf.utilization, 50, 70);
                var shelvePlus = Math.min(shelvingPct + 10, 50);
                var effPlus = totalDaily * (1 - shelvePlus / 100);
                var floodPlus = floodProbability(effPlus, floodThreshold, floodWindowMin, shiftHours);
                document.getElementById('proScnShelve').textContent = floodPlus.toFixed(1) + '%';
                document.getElementById('proScnShelve').className = 'result-card-value ' + (floodPlus < 10 ? 'green' : floodPlus < 50 ? 'amber' : 'red');
                var rebalCrit = Math.round(totalDaily * 0.05);
                var rebalWarn = Math.round(totalDaily * 0.15);
                var rebalInfo = totalDaily - rebalCrit - rebalWarn;
                var rebalISA = isaComplianceDetail(rate, 0.20, 0.05, standingPct);
                document.getElementById('proScnPrio').textContent = rebalISA.total + '/100 (' + getGrade(rebalISA.total) + ')';
                document.getElementById('proScnPrio').className = 'result-card-value ' + (rebalISA.total >= 75 ? 'green' : rebalISA.total >= 55 ? 'amber' : 'red');
            }

            // Store for PDF
            window._alarmData = {
                totalDaily: totalDaily, criticalDaily: criticalDaily, warningDaily: warningDaily, infoDaily: infoDaily,
                avgResponse: avgResponse, operators: operators, shiftHours: shiftHours, shelvingPct: shelvingPct,
                effectiveDaily: effectiveDaily, rate: rate, cogLoad: cogLoad, floodProb: floodProb,
                isa: isa, grade: grade, actionableRatio: actionableRatio, criticalPct: criticalPct,
                standingPct: standingPct, targetDaily: targetDaily, excess: excess,
                infoReduce: infoReduce, warnReduce: warnReduce, critReduce: critReduce,
                chatterPct: chatterPct, suppressAuth: suppressAuth
            };
        }

        // ═══ MODE SWITCHING & GATING ═══
        window.switchAlarmMode = function(mode) {
            if (mode === 'pro' && !alarmIsPremium) {
                if(window._rzAuth&&typeof window._rzAuth.showModal==='function') window._rzAuth.showModal();
                else alarmShowLogin();
                return;
            }
            alarmMode = mode;
            document.getElementById('alarmModeFree').classList.toggle('active', mode === 'free');
            document.getElementById('alarmModePro').classList.toggle('active', mode === 'pro');
            var inputs = document.getElementById('alarmProInputs');
            var panels = document.getElementById('alarmProPanels');
            if (inputs) inputs.style.display = mode === 'pro' ? 'block' : 'none';
            if (panels) panels.style.display = mode === 'pro' ? 'block' : 'none';
            updateCalculator();
        };

        function applyAlarmGating() {
            var badge = document.getElementById('alarmProBadge');
            var pdfBtn = document.getElementById('alarmBtnPdf');
            if (alarmIsPremium) {
                if (badge) badge.style.display = 'none';
                document.querySelectorAll('#alarmProPanels .gated-overlay').forEach(function(o) { o.remove(); });
                if (pdfBtn) { pdfBtn.onclick = function() { exportAlarmPDF(); }; pdfBtn.innerHTML = '<i class="fas fa-file-pdf"></i> Export PDF Report'; }
            } else {
                if (badge) badge.style.display = 'inline-block';
                if (pdfBtn) { pdfBtn.onclick = function() { if(window._rzAuth&&typeof window._rzAuth.showModal==='function')window._rzAuth.showModal();else alarmShowLogin(); }; }
            }
        }

        // ═══ AUTH ═══
        window.alarmShowLogin = function() { document.getElementById('alarmLoginModal').classList.add('show'); setTimeout(function() { document.getElementById('alarmLoginEmail').focus(); }, 100); };
        window.alarmCloseLogin = function() { document.getElementById('alarmLoginModal').classList.remove('show'); document.getElementById('alarmLoginError').style.display = 'none'; };
        document.getElementById('alarmLoginModal').addEventListener('click', function(e) { if (e.target === this) alarmCloseLogin(); });

        window.alarmDoLogin = function() {
            var email = document.getElementById('alarmLoginEmail').value.trim().toLowerCase();
            var password = document.getElementById('alarmLoginPassword').value;
            var errEl = document.getElementById('alarmLoginError');
            if (!email || !password) { errEl.textContent = 'Please enter email and password'; errEl.style.display = 'block'; return; }
            var validUsers = [
                { email: 'demo@resistancezero.com', password: 'demo2026', tier: 'pro' }
            ];
            var match = validUsers.find(function(u) { return u.email === email && u.password === password; });
            if (match) {
                localStorage.setItem('rz_premium_session', JSON.stringify({ email: match.email, tier: match.tier, expires: new Date(Date.now() + 30 * 24 * 60 * 60 * 1000).toISOString() }));
                alarmIsPremium = true;
                alarmCloseLogin();
                applyAlarmGating();
                alarmUpdateNavAuth();
                switchAlarmMode('pro');
            } else { errEl.textContent = 'Invalid email or password'; errEl.style.display = 'block'; document.getElementById('alarmLoginPassword').value = ''; }
        };

        window.alarmLogout = function() {
            if (!confirm('Logout from your account?')) return;
            alarmIsPremium = false;
            localStorage.removeItem('rz_premium_session');
            switchAlarmMode('free');
            applyAlarmGating();
            alarmUpdateNavAuth();
            var dd = document.getElementById('alarmNavDropdown'); if (dd) dd.classList.remove('show');
        };

        window.alarmToggleDropdown = function() { document.getElementById('alarmNavDropdown').classList.toggle('show'); };
        document.addEventListener('click', function(e) { if (!e.target.closest('.nav-auth-wrap')) { var dd = document.getElementById('alarmNavDropdown'); if (dd) dd.classList.remove('show'); } });

        function alarmUpdateNavAuth() {
            var loginBtn = document.getElementById('alarmNavLoginBtn');
            var userBtn = document.getElementById('alarmNavUserBtn');
            if (alarmIsPremium) {
                var sess = JSON.parse(localStorage.getItem('rz_premium_session') || '{}');
                var em = sess.email || '';
                loginBtn.style.display = 'none';
                userBtn.style.display = 'flex';
                document.getElementById('alarmNavAvatar').textContent = em.charAt(0).toUpperCase();
                document.getElementById('alarmNavEmail').textContent = em;
                document.getElementById('alarmDdEmail').textContent = em;
            } else { loginBtn.style.display = 'flex'; userBtn.style.display = 'none'; }
        }

        window.alarmResetDefaults = function() {
            document.getElementById('totalDaily').value = 1200;
            document.getElementById('criticalDaily').value = 45;
            document.getElementById('warningDaily').value = 280;
            document.getElementById('avgResponse').value = 180;
            document.getElementById('operatorsPerShift').value = 2;
            document.getElementById('shiftDuration').value = 12;
            document.getElementById('shelvingPct').value = 10;
            if (document.getElementById('proFloodWindow')) document.getElementById('proFloodWindow').value = 10;
            if (document.getElementById('proFloodThreshold')) document.getElementById('proFloodThreshold').value = 10;
            if (document.getElementById('proStandingPct')) document.getElementById('proStandingPct').value = 0;
            if (document.getElementById('proChatterPct')) document.getElementById('proChatterPct').value = 5;
            if (document.getElementById('proSuppressAuth')) document.getElementById('proSuppressAuth').value = 80;
            updateCalculator();
        };

        // ═══ PDF EXPORT WITH NARRATIVE ═══
        window.exportAlarmPDF = function() {
            var d = window._alarmData; if (!d) return;
            var w = window.open('', '_blank');
            if (!w) { alert('Please allow pop-ups for PDF export.'); return; }
            var now = new Date();
            var dateStr = now.toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' });
            var sc = d.isa.total; var gr = d.grade;
            var grColor = sc >= 75 ? '#059669' : sc >= 55 ? '#0284c7' : sc >= 35 ? '#d97706' : '#dc2626';

            // Risk level
            var riskLevel, riskColor, riskNarr;
            if (sc >= 75) { riskLevel = 'LOW'; riskColor = '#059669'; riskNarr = 'The alarm system demonstrates strong ISA-18.2 alignment. Operator workload is within acceptable limits and alarm flood risk is managed. Continue monitoring KPIs and maintain rationalization discipline.'; }
            else if (sc >= 55) { riskLevel = 'MODERATE'; riskColor = '#d97706'; riskNarr = 'The alarm system shows partial compliance. Some criteria are met, but gaps in alarm rate, priority distribution, or standing alarms create operator burden that exceeds recommended thresholds.'; }
            else if (sc >= 35) { riskLevel = 'ELEVATED'; riskColor = '#ea580c'; riskNarr = 'Multiple ISA-18.2 criteria are failing. Operators face alarm rates that impair cognitive function and response quality. Alarm floods are likely during transient conditions. Structured rationalization is recommended within 90 days.'; }
            else { riskLevel = 'HIGH'; riskColor = '#dc2626'; riskNarr = 'The alarm system is in a state of systemic failure. Alarm rates far exceed human cognitive capacity. Operators are in constant overload, alarm floods are a statistical certainty, and critical alarms are at risk of being missed. Immediate intervention is required.'; }

            // Burden narrative
            var burdenNarr;
            if (d.cogLoad.utilization < 50) burdenNarr = 'Operator cognitive utilization at ' + d.cogLoad.utilization.toFixed(1) + '% is within the safe operating envelope. Operators have adequate bandwidth to respond to alarms, perform other duties, and handle unexpected situations.';
            else if (d.cogLoad.utilization < 70) burdenNarr = 'Cognitive utilization of ' + d.cogLoad.utilization.toFixed(1) + '% is approaching the degradation threshold (70%). While operators can currently manage the alarm load, any increase in alarm volume or complexity could push them into cognitive overload.';
            else burdenNarr = 'At ' + d.cogLoad.utilization.toFixed(1) + '% cognitive utilization, operators are in the degradation zone. Effective capacity has dropped to ' + d.cogLoad.effective.toFixed(1) + '% due to exponential cognitive degradation above 70%. Response quality and situation awareness are significantly impaired.';

            // Flood narrative
            var floodNarr;
            if (d.floodProb < 10) floodNarr = 'Alarm flood probability of ' + d.floodProb.toFixed(1) + '% per shift indicates well-managed alarm volume. The Poisson model suggests floods are infrequent and manageable when they occur.';
            else if (d.floodProb < 50) floodNarr = 'Flood probability of ' + d.floodProb.toFixed(1) + '% per shift means operators will experience alarm floods in roughly ' + Math.round(d.floodProb) + '% of shifts. During floods (&gt;' + (parseInt(document.getElementById('proFloodThreshold')?.value) || 10) + ' alarms/' + (parseInt(document.getElementById('proFloodWindow')?.value) || 10) + 'min), operators cannot evaluate each alarm individually — they enter a "suppress and survive" mode.';
            else floodNarr = 'With ' + d.floodProb.toFixed(1) + '% flood probability, alarm floods are a near-certainty during every shift. Operators spend a significant portion of their time in flood conditions where individual alarm response is impossible. This is a <strong>safety-critical deficiency</strong> — critical alarms are routinely buried in noise.';

            // Compliance narrative
            var compNarr = 'The ISA-18.2 compliance score of <strong>' + sc + '/100 (Grade ' + gr + ')</strong> breaks down as follows: Rate criterion ' + d.isa.rate + '/25' + (d.isa.rate < 25 ? ' (FAILING — alarm rate exceeds 1/op/10min)' : ' (PASSING)') + ', Actionable ratio ' + d.isa.actionable + '/25' + (d.isa.actionable < 25 ? ' (needs improvement)' : ' (PASSING)') + ', Critical % ' + d.isa.critical + '/25' + (d.isa.critical < 25 ? ' (critical alarms exceed target)' : ' (PASSING)') + ', Standing % ' + d.isa.standing + '/25' + (d.isa.standing < 25 ? ' (standing alarms above threshold)' : ' (PASSING)') + '.';

            // Actions
            var actions = [];
            if (d.rate > 2) actions.push({ p: 'CRITICAL', t: '<strong>Reduce Alarm Rate:</strong> Current rate of ' + d.rate.toFixed(2) + '/op/10min is ' + (d.rate > 3 ? 'unacceptable' : 'over-demanding') + '. Target &le;1.0 through rationalization of the ' + Math.round(d.infoReduce) + ' lowest-priority alarms.' });
            if (d.cogLoad.utilization > 70) actions.push({ p: 'CRITICAL', t: '<strong>Address Cognitive Overload:</strong> ' + d.cogLoad.utilization.toFixed(1) + '% utilization causes exponential degradation. Consider adding operators, reducing response time, or implementing alarm prioritization.' });
            if (d.floodProb > 50) actions.push({ p: 'HIGH', t: '<strong>Flood Mitigation:</strong> ' + d.floodProb.toFixed(1) + '% flood probability requires immediate rationalization. Focus on chattering alarms, consequential suppression, and state-based alarm management.' });
            if (d.criticalPct > 0.1) actions.push({ p: 'HIGH', t: '<strong>Priority Rebalance:</strong> Critical alarms at ' + (d.criticalPct * 100).toFixed(1) + '% exceed the 5% benchmark. Review critical classifications — over-prioritization dilutes urgency.' });
            if (d.standingPct > 0.1) actions.push({ p: 'MEDIUM', t: '<strong>Standing Alarm Cleanup:</strong> ' + (d.standingPct * 100).toFixed(1) + '% standing alarms. Investigate root causes, adjust setpoints/deadbands, or reclassify as status indicators.' });
            if (d.actionableRatio < 0.85) actions.push({ p: 'MEDIUM', t: '<strong>Improve Actionable Ratio:</strong> At ' + (d.actionableRatio * 100).toFixed(1) + '%, too many alarms lack clear operator action. Review alarm philosophy and document cause/consequence/action for each alarm.' });
            actions.push({ p: 'LOW', t: '<strong>Establish MOC Process:</strong> Implement Management of Change controls for alarm configuration to prevent rationalization gains from eroding over 12-18 months.' });
            actions.push({ p: 'LOW', t: '<strong>Annual Review:</strong> Re-run this analysis quarterly with updated alarm data. Track KPI trends to validate improvement initiatives.' });

            var actHTML = actions.map(function(a) {
                var c = a.p === 'CRITICAL' ? '#dc2626' : a.p === 'HIGH' ? '#ea580c' : a.p === 'MEDIUM' ? '#d97706' : '#059669';
                return '<tr><td style="padding:5px 8px;border-bottom:1px solid #e5e7eb;"><span style="display:inline-block;padding:2px 8px;border-radius:4px;background:' + c + ';color:white;font-size:9px;font-weight:700;">' + a.p + '</span></td><td style="padding:5px 8px;border-bottom:1px solid #e5e7eb;font-size:11px;">' + a.t + '</td></tr>';
            }).join('');

            // Result rows
            var metrics = [
                ['Alarm Rate / Op / 10min', d.rate.toFixed(2), '&le; 1.0'],
                ['Cognitive Utilization', d.cogLoad.utilization.toFixed(1) + '%', '&le; 70%'],
                ['Effective Capacity', d.cogLoad.effective.toFixed(1) + '%', '&ge; 30%'],
                ['Flood Probability / Shift', d.floodProb.toFixed(1) + '%', '&le; 10%'],
                ['ISA-18.2 Score', sc + '/100 (' + gr + ')', '&ge; 75'],
                ['Actionable Ratio', (d.actionableRatio * 100).toFixed(1) + '%', '&ge; 85%'],
                ['Standing Alarms', (d.standingPct * 100).toFixed(1) + '%', '&le; 10%'],
                ['Recommended Target', Math.round(d.targetDaily) + '/day', d.operators + ' ops &times; 144']
            ];
            var metricRows = metrics.map(function(m) {
                return '<tr><td style="padding:5px 8px;border-bottom:1px solid #e5e7eb;font-weight:600;">' + m[0] + '</td><td style="padding:5px 8px;border-bottom:1px solid #e5e7eb;text-align:right;font-family:monospace;">' + m[1] + '</td><td style="padding:5px 8px;border-bottom:1px solid #e5e7eb;text-align:right;color:#6b7280;">' + m[2] + '</td></tr>';
            }).join('');

            var printHTML = '<!DOCTYPE html><html><head><meta charset="UTF-8"><title>Alarm Assessment Report — ' + dateStr + '</title>' +
                '<style>@media print{body{-webkit-print-color-adjust:exact;print-color-adjust:exact;}@page{margin:12mm 15mm;}}</style></head>' +
                '<body style="font-family:Arial,Helvetica,sans-serif;max-width:820px;margin:0 auto;padding:30px 40px;color:#1f2937;">' +
                '<div style="display:flex;justify-content:space-between;align-items:center;border-bottom:3px solid #1e3a5f;padding-bottom:10px;margin-bottom:12px;">' +
                '<div><h1 style="font-size:20px;color:#1e3a5f;margin:0;">Alarm System Assessment Report</h1><p style="font-size:11px;color:#6b7280;margin:4px 0 0;">Generated ' + dateStr + ' &middot; ISA-18.2 / EEMUA 191 Aligned &middot; resistancezero.com</p></div>' +
                '<div style="text-align:right;"><div style="font-size:32px;font-weight:800;color:' + grColor + ';font-family:monospace;">' + sc + '</div><div style="font-size:12px;color:#6b7280;">Grade ' + gr + ' &middot; ' + d.totalDaily + ' alarms/day</div></div></div>' +

                // Key Metrics Summary Row
                '<div style="display:grid;grid-template-columns:repeat(6,1fr);gap:8px;margin-bottom:14px;">' +
                [{ l: 'Compliance', v: sc + '/100', c: grColor }, { l: 'Rate/Op/10m', v: d.rate.toFixed(2), c: d.rate <= 1 ? '#10b981' : '#ef4444' }, { l: 'Utilization', v: d.cogLoad.utilization.toFixed(0) + '%', c: d.cogLoad.utilization < 70 ? '#10b981' : '#ef4444' }, { l: 'Flood Risk', v: d.floodProb.toFixed(0) + '%', c: d.floodProb < 10 ? '#10b981' : '#f59e0b' }, { l: 'Actionable', v: (d.actionableRatio * 100).toFixed(0) + '%', c: d.actionableRatio >= 0.85 ? '#10b981' : '#f59e0b' }, { l: 'Daily Target', v: Math.round(d.targetDaily).toString(), c: '#3b82f6' }].map(function(k) {
                    return '<div style="background:' + k.c + '12;border:1px solid ' + k.c + '33;border-radius:8px;padding:8px;text-align:center;"><div style="font-size:15px;font-weight:800;color:' + k.c + ';font-family:monospace;">' + k.v + '</div><div style="font-size:8px;color:#6b7280;text-transform:uppercase;letter-spacing:0.5px;margin-top:2px;">' + k.l + '</div></div>';
                }).join('') + '</div>' +

                // Executive Summary + Risk side by side
                '<div style="display:flex;gap:12px;margin-bottom:14px;">' +
                '<div style="flex:0 0 120px;background:' + riskColor + ';color:white;border-radius:8px;padding:12px;text-align:center;"><div style="font-size:9px;opacity:0.8;text-transform:uppercase;letter-spacing:1px;">Risk Level</div><div style="font-size:20px;font-weight:800;margin:4px 0;">' + riskLevel + '</div><div style="font-size:10px;opacity:0.8;">' + sc + '/100</div></div>' +
                '<div style="flex:1;font-size:11px;line-height:1.55;color:#374151;"><p style="margin:0 0 4px;"><strong>Assessment:</strong> A facility processing <strong>' + d.totalDaily.toLocaleString() + ' alarms/day</strong> with <strong>' + d.operators + ' operators</strong> on <strong>' + d.shiftHours + '-hour shifts</strong> and <strong>' + d.shelvingPct + '% shelving</strong>.</p><p style="margin:0;">' + riskNarr + '</p></div></div>' +

                // ─── Visual Analytics Charts (SVG) ───
                '<h2 style="font-size:14px;color:#1e3a5f;border-bottom:3px solid #1e3a5f;padding-bottom:4px;margin:12px 0 10px;">Visual Analytics</h2>' +
                '<div style="display:flex;gap:16px;margin-bottom:14px;">' +
                // Chart A: ISA-18.2 Compliance Breakdown — Horizontal Bar
                (function() {
                    var criteria = [
                        { label: 'Alarm Rate', score: d.isa.rate, color: d.isa.rate >= 25 ? '#059669' : d.isa.rate >= 15 ? '#f59e0b' : '#ef4444' },
                        { label: 'Actionable %', score: d.isa.actionable, color: d.isa.actionable >= 25 ? '#059669' : d.isa.actionable >= 15 ? '#f59e0b' : '#ef4444' },
                        { label: 'Critical %', score: d.isa.critical, color: d.isa.critical >= 25 ? '#059669' : d.isa.critical >= 15 ? '#f59e0b' : '#ef4444' },
                        { label: 'Standing %', score: d.isa.standing, color: d.isa.standing >= 25 ? '#059669' : d.isa.standing >= 15 ? '#f59e0b' : '#ef4444' }
                    ];
                    var bW = 340, bH = 150, ml = 78, mr = 42, mt = 8, mb = 18;
                    var cW = bW - ml - mr;
                    var barH = 22, gap = 6;
                    var svg = '<div style="flex:1.3;"><div style="font-size:11px;font-weight:700;color:#1e3a5f;margin-bottom:6px;">ISA-18.2 Compliance Breakdown</div>' +
                        '<svg viewBox="0 0 ' + bW + ' ' + bH + '" style="width:100%;height:auto;font-family:Arial,sans-serif;">';
                    for (var i = 0; i < criteria.length; i++) {
                        var y = mt + i * (barH + gap);
                        var w = (criteria[i].score / 25) * cW;
                        svg += '<text x="' + (ml - 6) + '" y="' + (y + barH / 2 + 3) + '" text-anchor="end" font-size="9" fill="#374151">' + criteria[i].label + '</text>';
                        svg += '<rect x="' + ml + '" y="' + y + '" width="' + cW + '" height="' + barH + '" rx="4" fill="#f3f4f6"/>';
                        svg += '<rect x="' + ml + '" y="' + y + '" width="' + w + '" height="' + barH + '" rx="4" fill="' + criteria[i].color + '"/>';
                        svg += '<text x="' + (ml + cW + 5) + '" y="' + (y + barH / 2 + 3) + '" font-size="9" font-weight="700" fill="' + criteria[i].color + '">' + criteria[i].score + '/25</text>';
                    }
                    svg += '<text x="' + (ml + cW / 2) + '" y="' + (bH - 2) + '" text-anchor="middle" font-size="10" font-weight="700" fill="' + grColor + '">ISA Score: ' + sc + '/100 (Grade ' + gr + ')</text>';
                    svg += '</svg></div>';
                    return svg;
                })() +
                // Chart B: Cognitive Load Gauge — Semicircular SVG
                (function() {
                    var util = d.cogLoad.utilization;
                    var eff = d.cogLoad.effective;
                    var gW = 240, gH = 150;
                    var cx = gW / 2, cy = 110, r = 70;
                    function arcPath(startPct, endPct, radius) {
                        var startAng = Math.PI * (1 - startPct);
                        var endAng = Math.PI * (1 - endPct);
                        var x1 = cx + radius * Math.cos(startAng);
                        var y1 = cy - radius * Math.sin(startAng);
                        var x2 = cx + radius * Math.cos(endAng);
                        var y2 = cy - radius * Math.sin(endAng);
                        var large = (endPct - startPct) > 0.5 ? 1 : 0;
                        return 'M ' + x1.toFixed(1) + ' ' + y1.toFixed(1) + ' A ' + radius + ' ' + radius + ' 0 ' + large + ' 0 ' + x2.toFixed(1) + ' ' + y2.toFixed(1);
                    }
                    var needlePct = Math.min(util / 100, 1);
                    var needleAng = Math.PI * (1 - needlePct);
                    var nx = cx + (r - 8) * Math.cos(needleAng);
                    var ny = cy - (r - 8) * Math.sin(needleAng);
                    var gaugeColor = util < 50 ? '#059669' : util < 70 ? '#f59e0b' : '#ef4444';
                    var svg = '<div style="flex:1;"><div style="font-size:11px;font-weight:700;color:#1e3a5f;margin-bottom:6px;">Operator Cognitive Load</div>' +
                        '<svg viewBox="0 0 ' + gW + ' ' + gH + '" style="width:100%;height:auto;font-family:Arial,sans-serif;">' +
                        '<path d="' + arcPath(0, 1, r) + '" fill="none" stroke="#e5e7eb" stroke-width="14" stroke-linecap="round"/>' +
                        '<path d="' + arcPath(0, 0.5, r) + '" fill="none" stroke="#059669" stroke-width="14" stroke-linecap="butt" opacity="0.25"/>' +
                        '<path d="' + arcPath(0.5, 0.7, r) + '" fill="none" stroke="#f59e0b" stroke-width="14" stroke-linecap="butt" opacity="0.25"/>' +
                        '<path d="' + arcPath(0.7, 1, r) + '" fill="none" stroke="#ef4444" stroke-width="14" stroke-linecap="butt" opacity="0.25"/>' +
                        '<path d="' + arcPath(0, needlePct, r) + '" fill="none" stroke="' + gaugeColor + '" stroke-width="14" stroke-linecap="round"/>' +
                        '<line x1="' + cx + '" y1="' + cy + '" x2="' + nx.toFixed(1) + '" y2="' + ny.toFixed(1) + '" stroke="#1e3a5f" stroke-width="2" stroke-linecap="round"/>' +
                        '<circle cx="' + cx + '" cy="' + cy + '" r="4" fill="#1e3a5f"/>' +
                        '<text x="' + cx + '" y="' + (cy - 16) + '" text-anchor="middle" font-size="18" font-weight="800" fill="' + gaugeColor + '">' + util.toFixed(1) + '%</text>' +
                        '<text x="' + cx + '" y="' + (cy - 4) + '" text-anchor="middle" font-size="8" fill="#6b7280">utilization</text>' +
                        '<text x="' + (cx - r - 2) + '" y="' + (cy + 12) + '" text-anchor="middle" font-size="7" fill="#059669">0%</text>' +
                        '<text x="' + (cx + r + 2) + '" y="' + (cy + 12) + '" text-anchor="middle" font-size="7" fill="#ef4444">100%</text>' +
                        '<text x="' + cx + '" y="' + (cy + 24) + '" text-anchor="middle" font-size="8" fill="#6b7280">Effective capacity: ' + eff.toFixed(1) + '%</text>' +
                        '</svg></div>';
                    return svg;
                })() +
                '</div>' +

                // Chart C: Alarm Priority Distribution — Stacked Horizontal Bar
                '<div style="margin-bottom:14px;">' +
                (function() {
                    var critPct = d.criticalPct * 100;
                    var warnPct = d.totalDaily > 0 ? (d.warningDaily / d.totalDaily * 100) : 0;
                    var infoPct = d.totalDaily > 0 ? (d.infoDaily / d.totalDaily * 100) : 0;
                    var bW = 700, bH = 100, ml = 100, mr = 10, mt = 10, mb = 25;
                    var cW = bW - ml - mr;
                    var barH = 22;
                    var rows = [
                        { label: 'Your System', crit: critPct, warn: warnPct, info: infoPct },
                        { label: 'ISA Benchmark', crit: 5, warn: 15, info: 80 }
                    ];
                    var svg = '<div style="font-size:11px;font-weight:700;color:#1e3a5f;margin-bottom:6px;">Alarm Priority Distribution vs ISA-18.2 Benchmark</div>' +
                        '<svg viewBox="0 0 ' + bW + ' ' + bH + '" style="width:100%;height:auto;font-family:Arial,sans-serif;">';
                    for (var i = 0; i < rows.length; i++) {
                        var y = mt + i * (barH + 10);
                        var r = rows[i];
                        var total = r.crit + r.warn + r.info;
                        if (total === 0) total = 1;
                        var wCrit = (r.crit / total) * cW;
                        var wWarn = (r.warn / total) * cW;
                        var wInfo = (r.info / total) * cW;
                        svg += '<text x="' + (ml - 6) + '" y="' + (y + barH / 2 + 4) + '" text-anchor="end" font-size="9" fill="#374151" font-weight="600">' + r.label + '</text>';
                        // Background
                        svg += '<rect x="' + ml + '" y="' + y + '" width="' + cW + '" height="' + barH + '" rx="3" fill="#f3f4f6"/>';
                        // Critical segment
                        svg += '<rect x="' + ml + '" y="' + y + '" width="' + wCrit + '" height="' + barH + '" rx="' + (wCrit > 3 ? 3 : 0) + '" fill="#ef4444"/>';
                        if (wCrit > 25) svg += '<text x="' + (ml + wCrit / 2) + '" y="' + (y + barH / 2 + 3) + '" text-anchor="middle" font-size="8" fill="white" font-weight="600">' + r.crit.toFixed(1) + '%</text>';
                        // Warning segment
                        svg += '<rect x="' + (ml + wCrit) + '" y="' + y + '" width="' + wWarn + '" height="' + barH + '" fill="#f59e0b"/>';
                        if (wWarn > 25) svg += '<text x="' + (ml + wCrit + wWarn / 2) + '" y="' + (y + barH / 2 + 3) + '" text-anchor="middle" font-size="8" fill="white" font-weight="600">' + r.warn.toFixed(1) + '%</text>';
                        // Info segment
                        svg += '<rect x="' + (ml + wCrit + wWarn) + '" y="' + y + '" width="' + wInfo + '" height="' + barH + '" rx="3" fill="#3b82f6"/>';
                        if (wInfo > 25) svg += '<text x="' + (ml + wCrit + wWarn + wInfo / 2) + '" y="' + (y + barH / 2 + 3) + '" text-anchor="middle" font-size="8" fill="white" font-weight="600">' + r.info.toFixed(1) + '%</text>';
                    }
                    // Legend
                    var ly = bH - 6;
                    svg += '<rect x="' + ml + '" y="' + ly + '" width="10" height="8" rx="2" fill="#ef4444"/><text x="' + (ml + 13) + '" y="' + (ly + 7) + '" font-size="8" fill="#6b7280">Critical</text>';
                    svg += '<rect x="' + (ml + 60) + '" y="' + ly + '" width="10" height="8" rx="2" fill="#f59e0b"/><text x="' + (ml + 73) + '" y="' + (ly + 7) + '" font-size="8" fill="#6b7280">Warning</text>';
                    svg += '<rect x="' + (ml + 130) + '" y="' + ly + '" width="10" height="8" rx="2" fill="#3b82f6"/><text x="' + (ml + 143) + '" y="' + (ly + 7) + '" font-size="8" fill="#6b7280">Info/Advisory</text>';
                    svg += '</svg></div>' ;
                    return svg;
                })() +
                '</div>' +

                // Configuration + KPI Results side by side
                '<div style="display:flex;gap:16px;margin-bottom:14px;">' +
                '<div style="flex:1;"><h2 style="font-size:13px;color:#1e3a5f;border-bottom:2px solid #3b82f6;padding-bottom:4px;margin:0 0 8px;">System Configuration</h2>' +
                '<table style="width:100%;font-size:10px;border-collapse:collapse;"><tr style="background:#f8fafc;"><td style="padding:4px 6px;color:#6b7280;">Total Daily</td><td style="padding:4px 6px;font-weight:600;">' + d.totalDaily.toLocaleString() + '</td></tr>' +
                '<tr><td style="padding:4px 6px;color:#6b7280;">Effective</td><td style="padding:4px 6px;font-weight:600;">' + Math.round(d.effectiveDaily).toLocaleString() + '</td></tr>' +
                '<tr style="background:#f8fafc;"><td style="padding:4px 6px;color:#6b7280;">C / W / I Split</td><td style="padding:4px 6px;font-weight:600;">' + (d.criticalPct * 100).toFixed(1) + '% / ' + (d.totalDaily > 0 ? (d.warningDaily / d.totalDaily * 100).toFixed(1) : 0) + '% / ' + (d.totalDaily > 0 ? (d.infoDaily / d.totalDaily * 100).toFixed(1) : 0) + '%</td></tr>' +
                '<tr><td style="padding:4px 6px;color:#6b7280;">Operators</td><td style="padding:4px 6px;font-weight:600;">' + d.operators + ' per shift</td></tr>' +
                '<tr style="background:#f8fafc;"><td style="padding:4px 6px;color:#6b7280;">Shift Duration</td><td style="padding:4px 6px;font-weight:600;">' + d.shiftHours + ' hours</td></tr>' +
                '<tr><td style="padding:4px 6px;color:#6b7280;">Avg Response</td><td style="padding:4px 6px;font-weight:600;">' + d.avgResponse + ' sec</td></tr>' +
                '<tr style="background:#f8fafc;"><td style="padding:4px 6px;color:#6b7280;">Shelving</td><td style="padding:4px 6px;font-weight:600;">' + d.shelvingPct + '%</td></tr></table></div>' +
                '<div style="flex:1;"><h2 style="font-size:13px;color:#1e3a5f;border-bottom:2px solid #f59e0b;padding-bottom:4px;margin:0 0 8px;">Key Performance Indicators</h2>' +
                '<table style="width:100%;border-collapse:collapse;font-size:10px;"><tr style="background:#1e3a5f;color:white;"><th style="padding:4px 6px;text-align:left;">Metric</th><th style="padding:4px 6px;text-align:right;">Value</th><th style="padding:4px 6px;text-align:right;">Bench</th></tr>' + metricRows + '</table></div></div>' +

                // Narrative sections: two side-by-side, then one below
                '<h2 style="font-size:14px;color:#1e3a5f;border-bottom:3px solid #1e3a5f;padding-bottom:4px;margin:12px 0 10px;">Executive Assessment & Recommendations</h2>' +

                '<div style="display:flex;gap:10px;margin-bottom:10px;">' +
                '<div style="flex:1;background:#fffbeb;border:1px solid #fde68a;border-radius:8px;padding:10px;">' +
                '<div style="font-size:11px;font-weight:700;color:#92400e;margin-bottom:4px;">Operator Burden Analysis</div>' +
                '<p style="font-size:10px;line-height:1.5;color:#374151;margin:0;">' + burdenNarr + '</p></div>' +

                '<div style="flex:1;background:#fef2f2;border:1px solid #fecaca;border-radius:8px;padding:10px;">' +
                '<div style="font-size:11px;font-weight:700;color:#991b1b;margin-bottom:4px;">Flood Risk Assessment</div>' +
                '<p style="font-size:10px;line-height:1.5;color:#374151;margin:0;">' + floodNarr + '</p></div></div>' +

                '<div style="background:#f0fdf4;border:1px solid #bbf7d0;border-radius:8px;padding:10px;margin-bottom:10px;">' +
                '<div style="font-size:11px;font-weight:700;color:#14532d;margin-bottom:4px;">ISA-18.2 Compliance Analysis</div>' +
                '<p style="font-size:10px;line-height:1.5;color:#374151;margin:0;">' + compNarr + '</p></div>' +

                '<div style="margin-bottom:12px;"><div style="font-size:11px;font-weight:700;color:#1e3a5f;margin-bottom:6px;">Prioritized Action Items</div>' +
                '<table style="width:100%;border-collapse:collapse;"><tr style="background:#1e3a5f;color:white;"><th style="padding:4px 6px;text-align:left;font-size:9px;width:70px;">Priority</th><th style="padding:4px 6px;text-align:left;font-size:9px;">Recommendation</th></tr>' + actHTML + '</table></div>' +

                '<div style="margin-top:20px;padding-top:10px;border-top:1px solid #e5e7eb;font-size:9px;color:#9ca3af;text-align:center;">' +
                '<p>Assessment based on user-provided summary metrics and Poisson steady-state assumptions. Actual alarm performance may differ.</p>' +
                '<p style="margin-top:4px;">Generated by Alarm Rationalization Calculator &middot; ISA-18.2 / EEMUA 191 / IEC 62682 Aligned &middot; resistancezero.com &middot; &copy; ' + now.getFullYear() + ' Bagus Dwi Permana</p></div>' +
                '</body></html>';

            w.document.write(printHTML);
            w.document.close();
            w.focus();
            setTimeout(function() { w.print(); }, 500);
        };

        // ═══ TOOLTIPS ═══
        function initAlarmTooltips() {
            var tooltipEl = document.createElement('div');
            tooltipEl.id = 'alarm-tooltip-container';
            document.body.appendChild(tooltipEl);
            document.querySelectorAll('.tooltip-trigger').forEach(function(trigger) {
                var content = trigger.querySelector('.tooltip-content');
                if (!content) return;
                trigger.addEventListener('mouseenter', function() {
                    tooltipEl.innerHTML = content.innerHTML;
                    var rect = trigger.getBoundingClientRect();
                    var left = rect.right + 12;
                    var top = rect.top + rect.height / 2;
                    if (left + 320 > window.innerWidth - 20) left = rect.left - 332;
                    if (left < 20) left = 20;
                    var th = tooltipEl.offsetHeight || 150;
                    top = top - th / 2;
                    if (top < 20) top = 20;
                    if (top + th > window.innerHeight - 20) top = window.innerHeight - th - 20;
                    tooltipEl.style.left = left + 'px';
                    tooltipEl.style.top = top + 'px';
                    tooltipEl.classList.add('visible');
                });
                trigger.addEventListener('mouseleave', function() { tooltipEl.classList.remove('visible'); });
            });
        }

        // ═══ INIT ═══
        var inputs = document.querySelectorAll('.calculator-section input, .calculator-section select');
        for (var i = 0; i < inputs.length; i++) inputs[i].addEventListener('input', updateCalculator);
        updateCalculator();

        // Check existing session
        var session = localStorage.getItem('rz_premium_session');
        if (session) {
            try {
                var data = JSON.parse(session);
                var exp = typeof data.expires === 'string' ? new Date(data.expires).getTime() : data.expires;
                if (exp > Date.now()) { alarmIsPremium = true; setTimeout(function() { applyAlarmGating(); alarmUpdateNavAuth(); }, 100); }
                else localStorage.removeItem('rz_premium_session');
            } catch(e) { localStorage.removeItem('rz_premium_session'); }
        }

        // Listen for global auth changes (login/logout via navbar auth.js)
        window.addEventListener('rz-auth-change', function(e) {
            if (e.detail && e.detail.action === 'login') {
                alarmIsPremium = true;
                applyAlarmGating();
                alarmUpdateNavAuth();
                switchAlarmMode('pro');
            } else if (e.detail && e.detail.action === 'logout') {
                alarmIsPremium = false;
                switchAlarmMode('free');
                applyAlarmGating();
                alarmUpdateNavAuth();
            }
        });

        setTimeout(function() { applyAlarmGating(); alarmUpdateNavAuth(); initAlarmTooltips(); }, 150);
    })();
    </script>

<!-- ═══ Feature 22: Reading Progress Bar ═══ -->
<script>
(function() {
    var bar = document.getElementById('scrollProgress');
    if (!bar) return;
    var ticking = false;
    function updateProgress() {
        var scrollTop = window.scrollY || document.documentElement.scrollTop;
        var docHeight = document.documentElement.scrollHeight - window.innerHeight;
        var pct = docHeight > 0 ? (scrollTop / docHeight) * 100 : 0;
        bar.style.width = Math.min(pct, 100) + '%';
        ticking = false;
    }
    window.addEventListener('scroll', function() {
        if (!ticking) { requestAnimationFrame(updateProgress); ticking = true; }
    }, { passive: true });
    updateProgress();
})();
</script>

<!-- ═══ Feature 23: TOC Sidebar ═══ -->
<script>
(function() {
    // Find H2s with IDs first, then fallback to auto-generating IDs
    var sections = document.querySelectorAll('.article-body h2[id], .article-content h2[id]');
    if (!sections.length) {
        var allH2s = document.querySelectorAll('.article-body h2, .article-content h2');
        allH2s.forEach(function(h2, i) {
            if (!h2.id) h2.id = 'toc-section-' + (i + 1);
        });
        sections = document.querySelectorAll('.article-body h2[id], .article-content h2[id]');
    }
    if (!sections.length) return;

    var sidebarList = document.getElementById('tocSidebarList');
    var mobileList = document.getElementById('tocMobileList');
    var sidebar = document.getElementById('tocSidebar');
    var tocToggle = document.getElementById('tocMobileToggle');
    var tocDrawer = document.getElementById('tocMobileDrawer');
    var tocBackdrop = document.getElementById('tocMobileBackdrop');
    var tocClose = document.getElementById('tocDrawerClose');

    var tocData = [];
    sections.forEach(function(h2, i) {
        var id = h2.getAttribute('id');
        var numMatch = id.match(/\d+/);
        var num = numMatch ? numMatch[0] : String(i + 1);
        var text = h2.textContent.replace(/^\s*\d+[\.\s]*/, '').trim();
        tocData.push({ id: id, num: num, text: text });
    });

    function buildList(container, isMobile) {
        tocData.forEach(function(item) {
            var li = document.createElement('li');
            if (!isMobile) li.className = 'toc-sidebar-item';
            var a = document.createElement('a');
            a.href = '#' + item.id;
            a.setAttribute('data-section', item.id);
            if (isMobile) {
                a.textContent = item.num + '. ' + item.text;
            } else {
                a.className = 'toc-sidebar-link';
                a.innerHTML = '<span class="toc-sidebar-num">' + item.num + '</span>' + item.text;
            }
            a.addEventListener('click', function(e) {
                e.preventDefault();
                var target = document.getElementById(item.id);
                if (target) window.scrollTo({ top: target.offsetTop - 80, behavior: 'smooth' });
                if (isMobile) closeMobileDrawer();
            });
            li.appendChild(a);
            container.appendChild(li);
        });
    }

    buildList(sidebarList, false);
    buildList(mobileList, true);

    var currentSection = null;
    var observer = new IntersectionObserver(function(entries) {
        entries.forEach(function(entry) {
            if (entry.isIntersecting) {
                currentSection = entry.target.getAttribute('id');
                highlightActive(currentSection);
            }
        });
    }, { rootMargin: '-80px 0px -70% 0px', threshold: 0 });

    sections.forEach(function(s) { observer.observe(s); });

    function highlightActive(sectionId) {
        sidebarList.querySelectorAll('.toc-sidebar-link').forEach(function(a) {
            a.classList.toggle('active', a.getAttribute('data-section') === sectionId);
        });
        mobileList.querySelectorAll('a').forEach(function(a) {
            a.classList.toggle('active', a.getAttribute('data-section') === sectionId);
        });
    }

    var articleContent = document.querySelector('.article-content');
    if (articleContent && sidebar) {
        var sidebarObserver = new IntersectionObserver(function(entries) {
            entries.forEach(function(entry) {
                sidebar.classList.toggle('visible', entry.isIntersecting);
            });
        }, { rootMargin: '0px', threshold: 0.01 });
        sidebarObserver.observe(articleContent);
    }

    function openMobileDrawer() {
        tocDrawer.classList.add('active');
        tocBackdrop.classList.add('active');
        document.body.style.overflow = 'hidden';
    }
    function closeMobileDrawer() {
        tocDrawer.classList.remove('active');
        tocBackdrop.classList.remove('active');
        document.body.style.overflow = '';
    }

    if (tocToggle) tocToggle.addEventListener('click', openMobileDrawer);
    if (tocClose) tocClose.addEventListener('click', closeMobileDrawer);
    if (tocBackdrop) tocBackdrop.addEventListener('click', closeMobileDrawer);
})();
</script>

<!-- ═══ Feature 21: Global Search ═══ -->
<script>
(function() {
    var searchBtn = document.getElementById('navSearchBtn');
    var overlay = document.getElementById('searchOverlay');
    var modal = document.getElementById('searchModal');
    var input = document.getElementById('searchInput');
    var resultsEl = document.getElementById('searchResults');
    var previewEl = document.getElementById('searchPreview');
    var chipsEl = document.getElementById('searchChips');
    var fuse = null;
    var searchData = null;
    var focusedIdx = -1;
    var activeFilter = 'all';
    var lastResults = [];
    var RECENT_KEY = 'rz-search-recent';

    function getRecent() {
        try { return JSON.parse(localStorage.getItem(RECENT_KEY)) || []; }
        catch(e) { return []; }
    }
    function saveRecent(query) {
        if (!query || query.length < 2) return;
        var arr = getRecent().filter(function(q) { return q !== query; });
        arr.unshift(query);
        if (arr.length > 3) arr = arr.slice(0, 3);
        try { localStorage.setItem(RECENT_KEY, JSON.stringify(arr)); } catch(e) {}
    }
    function clearRecent() {
        try { localStorage.removeItem(RECENT_KEY); } catch(e) {}
    }

    function renderRecent() {
        var recent = getRecent();
        if (!recent.length) {
            resultsEl.innerHTML = '<div class="search-empty">Type to search across all content</div>';
            return;
        }
        var html = '<div class="search-recent"><div class="search-recent-header">'
            + '<span class="search-recent-label">Recent</span>'
            + '<button class="search-recent-clear" id="clearRecent">Clear</button></div>';
        recent.forEach(function(q) {
            html += '<div class="search-recent-item" data-query="' + q.replace(/"/g, '&quot;') + '">'
                + '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>'
                + '<span>' + q + '</span></div>';
        });
        html += '</div>';
        resultsEl.innerHTML = html;
        var clearBtn = document.getElementById('clearRecent');
        if (clearBtn) clearBtn.addEventListener('click', function() { clearRecent(); renderRecent(); });
        resultsEl.querySelectorAll('.search-recent-item').forEach(function(el) {
            el.addEventListener('click', function() {
                input.value = el.getAttribute('data-query');
                input.dispatchEvent(new Event('input'));
            });
        });
    }

    function openSearch() {
        overlay.classList.add('active');
        modal.classList.add('active');
        input.value = '';
        input.focus();
        focusedIdx = -1;
        activeFilter = 'all';
        lastResults = [];
        updateChips();
        hidePreview();
        renderRecent();
        if (!searchData) {
            fetch('search-index.json')
                .then(function(r) { return r.json(); })
                .then(function(data) {
                    searchData = data;
                    fuse = new Fuse(data, {
                        keys: [
                            { name: 'title', weight: 0.4 },
                            { name: 'description', weight: 0.25 },
                            { name: 'keywords', weight: 0.25 },
                            { name: 'category', weight: 0.1 }
                        ],
                        threshold: 0.35,
                        includeScore: true,
                        includeMatches: true,
                        minMatchCharLength: 2
                    });
                })
                .catch(function() {});
        }
    }

    function closeSearch() {
        overlay.classList.remove('active');
        modal.classList.remove('active');
        input.blur();
        hidePreview();
    }

    function getIconClass(cat) {
        cat = (cat || '').toLowerCase();
        if (cat === 'calculator') return 'calc';
        if (cat === 'tool') return 'tool';
        if (cat === 'policy') return 'policy';
        if (cat === 'sustainability') return 'sustainability';
        if (cat === 'geopolitics') return 'geopolitics';
        if (cat === 'analysis') return 'analysis';
        if (cat === 'leadership') return 'leadership';
        if (cat === 'business') return 'business';
        return '';
    }

    function getIconLabel(item) {
        if (item.url && item.url.indexOf('article-') === 0) {
            return item.url.replace('article-', '').replace('.html', '').padStart(2, '0');
        }
        var cat = (item.category || '').toLowerCase();
        if (cat === 'calculator') return '&#9889;';
        if (cat === 'tool') return '&#9881;';
        if (cat === 'geopolitics') return '&#9733;';
        return '&#9733;';
    }

    function getCatFilter(cat) {
        cat = (cat || '').toLowerCase();
        if (cat === 'calculator') return 'calculators';
        if (cat === 'tool') return 'tools';
        return 'articles';
    }

    function highlightText(text, matches, key) {
        if (!matches || !matches.length) return text;
        var found = null;
        for (var i = 0; i < matches.length; i++) {
            if (matches[i].key === key) { found = matches[i]; break; }
        }
        if (!found || !found.indices || !found.indices.length) return text;
        var indices = found.indices.sort(function(a, b) { return a[0] - b[0]; });
        var result = '';
        var last = 0;
        indices.forEach(function(pair) {
            var start = pair[0], end = pair[1];
            if (start > last) result += text.substring(last, start);
            result += '<mark class="search-highlight">' + text.substring(start, end + 1) + '</mark>';
            last = end + 1;
        });
        if (last < text.length) result += text.substring(last);
        return result;
    }

    function filterResults(results) {
        if (activeFilter === 'all') return results;
        return results.filter(function(r) {
            return getCatFilter(r.item.category) === activeFilter;
        });
    }

    function renderResults(results) {
        var filtered = filterResults(results);
        if (!filtered.length) {
            resultsEl.innerHTML = '<div class="search-empty">No results found</div>';
            focusedIdx = -1;
            hidePreview();
            return;
        }
        var html = '';
        filtered.slice(0, 8).forEach(function(r, i) {
            var item = r.item;
            var iconCls = getIconClass(item.category);
            var titleHtml = highlightText(item.title, r.matches, 'title');
            var descHtml = highlightText(item.description, r.matches, 'description');
            html += '<a href="' + item.url + '" class="search-result-item" data-idx="' + i + '">'
                + '<div class="search-result-icon ' + iconCls + '">' + getIconLabel(item) + '</div>'
                + '<div class="search-result-info">'
                + '<div class="search-result-category">' + (item.category || '') + '</div>'
                + '<div class="search-result-title">' + titleHtml + '</div>'
                + '<div class="search-result-desc">' + descHtml + '</div>'
                + '</div></a>';
        });
        resultsEl.innerHTML = html;
        focusedIdx = -1;
        attachHoverListeners(filtered);
    }

    function attachHoverListeners(filtered) {
        resultsEl.querySelectorAll('.search-result-item').forEach(function(el) {
            var idx = parseInt(el.getAttribute('data-idx'), 10);
            el.addEventListener('mouseenter', function() { showPreview(filtered[idx], el); });
            el.addEventListener('mouseleave', function() { hidePreview(); });
            el.addEventListener('click', function() { saveRecent(input.value.trim()); });
        });
    }

    function showPreview(r, anchorEl) {
        if (!previewEl || !r) return;
        var item = r.item;
        var imgHtml = item.image ? '<img class="search-preview-img" src="' + item.image + '" alt="">' : '';
        var timeHtml = item.readingTime ? '<div class="search-preview-badge"><svg viewBox="0 0 24 24" width="10" height="10" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>' + item.readingTime + ' min</div>' : '';
        previewEl.innerHTML = imgHtml
            + '<div class="search-preview-text">'
            + '<div class="search-preview-cat">' + (item.category || '') + '</div>'
            + '<div class="search-preview-title">' + item.title + '</div>'
            + '<div class="search-preview-desc">' + item.description + '</div>'
            + timeHtml
            + '</div>';
        // Position tooltip to the right of the modal
        var modalRect = modal.getBoundingClientRect();
        var itemRect = anchorEl.getBoundingClientRect();
        var tipLeft = modalRect.right + 10;
        var tipTop = itemRect.top;
        // If no space on right, show on left
        if (tipLeft + 270 > window.innerWidth) {
            tipLeft = modalRect.left - 270;
        }
        // Keep within viewport vertically
        if (tipTop + 100 > window.innerHeight) {
            tipTop = window.innerHeight - 110;
        }
        previewEl.style.left = tipLeft + 'px';
        previewEl.style.top = tipTop + 'px';
        previewEl.classList.add('visible');
    }

    function hidePreview() {
        if (!previewEl) return;
        previewEl.innerHTML = '';
        previewEl.classList.remove('visible');
    }

    function updateChips() {
        if (!chipsEl) return;
        chipsEl.querySelectorAll('.search-chip').forEach(function(chip) {
            chip.classList.toggle('active', chip.getAttribute('data-filter') === activeFilter);
        });
    }

    if (chipsEl) {
        chipsEl.addEventListener('click', function(e) {
            var chip = e.target.closest('.search-chip');
            if (!chip) return;
            activeFilter = chip.getAttribute('data-filter');
            updateChips();
            if (lastResults.length) renderResults(lastResults);
        });
    }

    function updateFocus() {
        var items = resultsEl.querySelectorAll('.search-result-item');
        items.forEach(function(el, i) {
            el.classList.toggle('focused', i === focusedIdx);
            if (i === focusedIdx) {
                el.scrollIntoView({ block: 'nearest' });
                var idx = parseInt(el.getAttribute('data-idx'), 10);
                var filtered = filterResults(lastResults);
                if (filtered[idx]) showPreview(filtered[idx], el);
            }
        });
    }

    if (searchBtn) searchBtn.addEventListener('click', openSearch);
    if (overlay) overlay.addEventListener('click', closeSearch);

    document.addEventListener('keydown', function(e) {
        if ((e.ctrlKey || e.metaKey) && e.key === 'k') {
            e.preventDefault();
            if (modal.classList.contains('active')) closeSearch();
            else openSearch();
            return;
        }
        if (!modal.classList.contains('active')) return;
        if (e.key === 'Escape') { closeSearch(); return; }
        var items = resultsEl.querySelectorAll('.search-result-item');
        if (e.key === 'ArrowDown') {
            e.preventDefault();
            focusedIdx = Math.min(focusedIdx + 1, items.length - 1);
            updateFocus();
        } else if (e.key === 'ArrowUp') {
            e.preventDefault();
            focusedIdx = Math.max(focusedIdx - 1, 0);
            updateFocus();
        } else if (e.key === 'Enter' && focusedIdx >= 0 && items[focusedIdx]) {
            e.preventDefault();
            saveRecent(input.value.trim());
            items[focusedIdx].click();
        }
    });

    if (input) {
        input.addEventListener('input', function() {
            var query = input.value.trim();
            if (query.length < 2 || !fuse) {
                lastResults = [];
                focusedIdx = -1;
                hidePreview();
                if (query.length === 0) { renderRecent(); }
                else { resultsEl.innerHTML = '<div class="search-empty">Type to search across all content</div>'; }
                return;
            }
            var results = fuse.search(query);
            lastResults = results;
            renderResults(results);
        });
    }
})();
</script>

<script>
// ═══════════════════════════════════════════════════════════════════════════
//  CHART.JS — Poisson Distribution Chart
// ═══════════════════════════════════════════════════════════════════════════
(function initPoissonChart() {
    var canvas = document.getElementById('poissonChart');
    if (!canvas || typeof Chart === 'undefined') return;

    function poissonProb(lambda, n) {
        // P(X >= n) using complement of Poisson CDF
        var sum = 0, term = Math.exp(-lambda), factorial = 1;
        for (var k = 0; k < n; k++) {
            sum += term;
            factorial = k === 0 ? 1 : factorial * k;
            term = Math.exp(-lambda) * Math.pow(lambda, k + 1) / (factorial * (k + 1));
        }
        return Math.max(0, Math.min(1, 1 - sum));
    }

    function shiftFloodProb(lambda10, windows) {
        // P(at least 1 flood in shift) = 1 - (1 - P_window)^windows
        var p_window = poissonProb(lambda10, 10);
        return 1 - Math.pow(1 - p_window, windows);
    }

    var scenarios = [
        { label: '72/day\n(ISA Target)', dailyRate: 72, color: 'rgba(16,185,129,0.8)' },
        { label: '144/day\n(Max Manageable)', dailyRate: 144, color: 'rgba(6,182,212,0.8)' },
        { label: '360/day\n(Overloaded)', dailyRate: 360, color: 'rgba(245,158,11,0.8)' },
        { label: '576/day', dailyRate: 576, color: 'rgba(249,115,22,0.8)' },
        { label: '800/day\n(Case Baseline)', dailyRate: 800, color: 'rgba(239,68,68,0.8)' },
        { label: '1,200/day\n(Case Peak)', dailyRate: 1200, color: 'rgba(185,28,28,0.9)' },
    ];

    var labels = scenarios.map(function(s) { return s.label; });
    var perWindowData = scenarios.map(function(s) {
        return (poissonProb(s.dailyRate / 144, 10) * 100).toFixed(1);
    });
    var perShiftData = scenarios.map(function(s) {
        return (shiftFloodProb(s.dailyRate / 144, 72) * 100).toFixed(1);
    });
    var colors = scenarios.map(function(s) { return s.color; });

    new Chart(canvas, {
        type: 'bar',
        data: {
            labels: labels,
            datasets: [
                {
                    label: 'P(flood) per 10-min window',
                    data: perWindowData,
                    backgroundColor: colors.map(function(c) { return c.replace('0.8','0.45').replace('0.9','0.45'); }),
                    borderColor: colors,
                    borderWidth: 2,
                    borderRadius: 5,
                    yAxisID: 'y'
                },
                {
                    label: 'P(≥1 flood) per 12-hr shift',
                    data: perShiftData,
                    backgroundColor: colors,
                    borderColor: colors.map(function(c) { return c; }),
                    borderWidth: 2,
                    borderRadius: 5,
                    yAxisID: 'y'
                }
            ]
        },
        options: {
            responsive: true,
            interaction: { mode: 'index', intersect: false },
            plugins: {
                legend: { labels: { color: '#94a3b8', font: { size: 11 } } },
                tooltip: {
                    callbacks: {
                        label: function(ctx) { return ctx.dataset.label + ': ' + ctx.raw + '%'; }
                    }
                }
            },
            scales: {
                x: { ticks: { color: '#64748b', font: { size: 10 } }, grid: { color: 'rgba(30,58,95,0.3)' } },
                y: {
                    type: 'linear',
                    ticks: { color: '#64748b', callback: function(v) { return v + '%'; } },
                    grid: { color: 'rgba(30,58,95,0.3)' },
                    max: 100,
                    title: { display: true, text: 'Probability (%)', color: '#475569', font: { size: 10 } }
                }
            }
        }
    });
})();

// ═══════════════════════════════════════════════════════════════════════════
//  CHART.JS — Before / After Comparison Chart
// ═══════════════════════════════════════════════════════════════════════════
(function initBeforeAfterChart() {
    var canvas = document.getElementById('beforeAfterChart');
    if (!canvas || typeof Chart === 'undefined') return;

    new Chart(canvas, {
        type: 'bar',
        data: {
            labels: ['Daily Alarms\n(÷10 for scale)', 'Response Time\n(seconds)', 'ISA Compliance\n(%)', 'False Evacuations\n(per 90 days)'],
            datasets: [
                {
                    label: 'Before Rationalization',
                    data: [100, 180, 12, 3],
                    backgroundColor: 'rgba(239,68,68,0.6)',
                    borderColor: 'rgba(239,68,68,0.9)',
                    borderWidth: 2,
                    borderRadius: 6,
                },
                {
                    label: 'After Rationalization',
                    data: [8, 45, 89, 0],
                    backgroundColor: 'rgba(16,185,129,0.6)',
                    borderColor: 'rgba(16,185,129,0.9)',
                    borderWidth: 2,
                    borderRadius: 6,
                }
            ]
        },
        options: {
            responsive: true,
            interaction: { mode: 'index', intersect: false },
            plugins: {
                legend: { labels: { color: '#94a3b8', font: { size: 11 } } },
                tooltip: {
                    callbacks: {
                        label: function(ctx) {
                            var labels = ['', ' alarms/day', ' seconds', '%', ' evacuations'];
                            var realBefore = [1000, 180, 12, 3];
                            var realAfter  = [80, 45, 89, 0];
                            var idx = ctx.dataIndex;
                            var real = ctx.datasetIndex === 0 ? realBefore[idx] : realAfter[idx];
                            return ctx.dataset.label + ': ' + real + (labels[idx + 1] || '');
                        }
                    }
                }
            },
            scales: {
                x: { ticks: { color: '#64748b', font: { size: 10 } }, grid: { color: 'rgba(30,58,95,0.3)' } },
                y: { ticks: { color: '#64748b' }, grid: { color: 'rgba(30,58,95,0.3)' }, title: { display: true, text: 'Normalized Value', color: '#475569', font: { size: 10 } } }
            }
        }
    });
})();

// ═══════════════════════════════════════════════════════════════════════════
//  MONTE CARLO RISK SIMULATION — 10,000 iterations
// ═══════════════════════════════════════════════════════════════════════════
var mcHistChart = null;

function normalSample(mean, stdDev) {
    // Box-Muller transform
    var u1 = Math.random(), u2 = Math.random();
    var z = Math.sqrt(-2 * Math.log(u1)) * Math.cos(2 * Math.PI * u2);
    return mean + stdDev * z;
}

function clamp(val, min, max) {
    return Math.max(min, Math.min(max, val));
}

function computeISAScore(dailyAlarms, operators, shiftHours) {
    var windows = shiftHours * 6; // 10-min windows per shift
    var lambda10 = dailyAlarms / (operators * 144);
    var alarmRate10 = dailyAlarms / (operators * 144);

    // Rate score (0-100): ISA target ≤ 1.0/10min
    var rateScore = alarmRate10 <= 1.0 ? 100 : Math.max(0, 100 - (alarmRate10 - 1.0) * 20);

    // Flood probability (assuming 90% nuisance rate, so effective lambda)
    function poissonCDF(lam, n) {
        var sum = 0, term = Math.exp(-lam), fact = 1;
        for (var k = 0; k < n; k++) {
            sum += term;
            fact = k === 0 ? 1 : fact * k;
            term = Math.exp(-lam) * Math.pow(lam, k + 1) / (fact * (k + 1));
        }
        return sum;
    }
    var pFlood = Math.max(0, 1 - Math.pow(poissonCDF(lambda10, 10), windows));

    // Flood score
    var floodScore = pFlood <= 0.1 ? 100 : Math.max(0, 100 - (pFlood - 0.1) * 120);

    // Composite ISA score (simplified: rate 50% + flood 30% + assumed actionable ratio 20%)
    var actionableEstimate = alarmRate10 <= 1 ? 90 : Math.max(20, 90 - (alarmRate10 - 1) * 15);
    var actionableScore = actionableEstimate >= 85 ? 100 : (actionableEstimate / 85) * 100;

    var composite = rateScore * 0.5 + floodScore * 0.3 + actionableScore * 0.2;
    return {
        isa: clamp(composite, 0, 100),
        flood: pFlood,
        rate: alarmRate10,
        cli: clamp(alarmRate10 / 5, 0, 1)
    };
}

function runMonteCarlo() {
    var btn = document.getElementById('mcRunBtn');
    var progress = document.getElementById('mcProgress');
    var fill = document.getElementById('mcProgressFill');
    var progressText = document.getElementById('mcProgressText');
    var resultsGrid = document.getElementById('mcResultsGrid');
    var chartWrap = document.getElementById('mcChartWrap');

    var meanAlarms = parseFloat(document.getElementById('mcAlarms').value) || 1200;
    var operators = parseInt(document.getElementById('mcOps').value) || 2;
    var shiftHours = parseInt(document.getElementById('mcShift').value) || 12;
    var uncertainty = parseFloat(document.getElementById('mcUncertainty').value) || 0.2;

    btn.disabled = true;
    progress.style.display = 'flex';
    resultsGrid.style.display = 'none';
    chartWrap.style.display = 'none';

    var N = 10000;
    var results = { isa: [], flood: [], rate: [], cli: [] };
    var batchSize = 500;
    var done = 0;

    function runBatch() {
        var end = Math.min(done + batchSize, N);
        for (var i = done; i < end; i++) {
            var sampledAlarms = clamp(normalSample(meanAlarms, meanAlarms * uncertainty), 10, meanAlarms * 3);
            var sampledOps = clamp(Math.round(normalSample(operators, operators * uncertainty * 0.5)), 1, 10);
            var r = computeISAScore(sampledAlarms, sampledOps, shiftHours);
            results.isa.push(r.isa);
            results.flood.push(r.flood * 100);
            results.rate.push(r.rate);
            results.cli.push(r.cli * 100);
        }
        done = end;
        var pct = (done / N * 100).toFixed(0);
        fill.style.width = pct + '%';
        progressText.textContent = 'Running ' + done.toLocaleString() + ' / ' + N.toLocaleString() + ' scenarios...';

        if (done < N) {
            setTimeout(runBatch, 0);
        } else {
            finalizeMC(results, N);
            btn.disabled = false;
            progress.style.display = 'none';
        }
    }

    setTimeout(runBatch, 10);
}

function percentile(arr, p) {
    var sorted = arr.slice().sort(function(a, b) { return a - b; });
    var idx = Math.floor(p / 100 * sorted.length);
    return sorted[Math.min(idx, sorted.length - 1)];
}

function finalizeMC(results, N) {
    var resultsGrid = document.getElementById('mcResultsGrid');
    var chartWrap = document.getElementById('mcChartWrap');

    function setMCStat(prefix, values, fmt) {
        var p10 = percentile(values, 10), p50 = percentile(values, 50), p90 = percentile(values, 90);
        document.getElementById(prefix + 'P50').textContent = fmt(p50);
        document.getElementById(prefix + 'Range').textContent = 'P10: ' + fmt(p10) + ' — P90: ' + fmt(p90);
    }

    setMCStat('mcComp', results.isa, function(v) { return v.toFixed(1) + '%'; });
    setMCStat('mcFlood', results.flood, function(v) { return v.toFixed(1) + '%'; });
    setMCStat('mcRate', results.rate, function(v) { return v.toFixed(2); });
    setMCStat('mcCLI', results.cli, function(v) { return v.toFixed(1) + '%'; });

    resultsGrid.style.display = 'grid';

    // Build histogram of ISA compliance scores
    var bins = 20, binData = new Array(bins).fill(0), binLabels = [];
    var minV = 0, maxV = 100, binSize = (maxV - minV) / bins;
    for (var i = 0; i < bins; i++) {
        binLabels.push((minV + i * binSize).toFixed(0) + '%');
    }
    results.isa.forEach(function(v) {
        var b = Math.min(bins - 1, Math.floor((v - minV) / binSize));
        binData[b]++;
    });

    var p10Val = percentile(results.isa, 10);
    var p50Val = percentile(results.isa, 50);
    var p90Val = percentile(results.isa, 90);

    var bgColors = binLabels.map(function(label) {
        var midV = parseFloat(label) + binSize / 2;
        if (midV < p10Val) return 'rgba(239,68,68,0.7)';
        if (midV < p90Val) return 'rgba(139,92,246,0.6)';
        return 'rgba(16,185,129,0.7)';
    });

    if (mcHistChart) mcHistChart.destroy();

    var canvas = document.getElementById('mcHistChart');
    chartWrap.style.display = 'block';
    mcHistChart = new Chart(canvas, {
        type: 'bar',
        data: {
            labels: binLabels,
            datasets: [{
                label: 'Frequency (scenarios)',
                data: binData,
                backgroundColor: bgColors,
                borderColor: 'transparent',
                borderRadius: 3,
                barPercentage: 1.0,
                categoryPercentage: 1.0
            }]
        },
        options: {
            responsive: true,
            plugins: {
                legend: { display: false },
                tooltip: {
                    callbacks: {
                        label: function(ctx) {
                            return ctx.raw + ' scenarios (' + (ctx.raw / N * 100).toFixed(1) + '%)';
                        }
                    }
                },
                annotation: {
                    annotations: {
                        target: {
                            type: 'line',
                            xMin: (85 / binSize) - 0.5,
                            xMax: (85 / binSize) - 0.5,
                            borderColor: '#10b981',
                            borderWidth: 2,
                            borderDash: [4, 4],
                            label: { content: 'ISA Target 85%', enabled: true, color: '#10b981', font: { size: 10 } }
                        }
                    }
                }
            },
            scales: {
                x: { ticks: { color: '#475569', font: { size: 9 }, maxRotation: 0 }, grid: { display: false } },
                y: { ticks: { color: '#64748b', font: { size: 10 } }, grid: { color: 'rgba(30,58,95,0.3)' }, title: { display: true, text: 'Scenarios (out of 10,000)', color: '#475569', font: { size: 10 } } }
            }
        }
    });
}

// ═══════════════════════════════════════════════════════════════════════════
//  D3-SANKEY — Alarm Flow Rationalization Diagram
// ═══════════════════════════════════════════════════════════════════════════
(function initSankey() {
    if (typeof d3 === 'undefined' || typeof d3.sankey === 'undefined') return;

    var container = document.getElementById('sankeyChart');
    if (!container) return;

    var isMobile = window.innerWidth < 600;
    var W = Math.min(container.parentElement.clientWidth - 20, 840);
    var H = isMobile ? 420 : 380;
    var margin = { top: 12, right: 120, bottom: 12, left: 120 };

    var svg = d3.select('#sankeyChart')
        .attr('viewBox', '0 0 ' + W + ' ' + H)
        .attr('width', '100%')
        .attr('height', null)
        .style('max-height', H + 'px');

    var sankey = d3.sankey()
        .nodeWidth(18)
        .nodePadding(12)
        .extent([[margin.left, margin.top], [W - margin.right, H - margin.bottom]]);

    var nodeColors = {
        'Chattering': '#ef4444',
        'Standing / Stale': '#f97316',
        'Consequential': '#eab308',
        'Nuisance / Invalid': '#ef4444',
        'Valid Actionable': '#10b981',
        'Eliminated': '#475569',
        'Suppressed / Shelved': '#3b82f6',
        'Reconfigured': '#f59e0b',
        'Critical Active': '#10b981',
        'Warning Active': '#22d3ee',
        'Info Active': '#a78bfa',
    };

    var data = {
        nodes: [
            { name: 'Chattering' },           // 0 - 423
            { name: 'Standing / Stale' },      // 1 - 770
            { name: 'Consequential' },         // 2 - 962
            { name: 'Nuisance / Invalid' },    // 3 - 1347
            { name: 'Valid Actionable' },      // 4 - 345
            { name: 'Eliminated' },            // 5
            { name: 'Suppressed / Shelved' },  // 6
            { name: 'Reconfigured' },          // 7
            { name: 'Critical Active' },       // 8
            { name: 'Warning Active' },        // 9
            { name: 'Info Active' },           // 10
        ],
        links: [
            // Chattering (423 total)
            { source: 0, target: 5, value: 366 },   // Eliminated
            { source: 0, target: 7, value: 57  },   // Reconfigured
            // Standing/Stale (770 total)
            { source: 1, target: 5, value: 308 },   // Eliminated
            { source: 1, target: 6, value: 462 },   // Suppressed
            // Consequential (962 total)
            { source: 2, target: 5, value: 112 },   // Eliminated
            { source: 2, target: 6, value: 350 },   // Suppressed
            { source: 2, target: 7, value: 500 },   // Reconfigured
            // Nuisance/Invalid (1347 total)
            { source: 3, target: 5, value: 1000 },  // Eliminated
            { source: 3, target: 7, value: 347 },   // Reconfigured
            // Valid Actionable (345 total = 345 kept)
            { source: 4, target: 8, value: 170 },   // Critical Active
            { source: 4, target: 9, value: 130 },   // Warning Active
            { source: 4, target: 10, value: 45 },   // Info Active
            // Reconfigured → Active (904 reconfigured, most re-eliminated after review)
            { source: 7, target: 5, value: 858 },   // Most reconfigured removed
            { source: 7, target: 8, value: 15  },   // Some → Critical
            { source: 7, target: 9, value: 23  },   // Some → Warning
            { source: 7, target: 10, value: 8  },   // Some → Info
        ]
    };

    try {
        var graph = sankey({
            nodes: data.nodes.map(function(d) { return Object.assign({}, d); }),
            links: data.links.map(function(d) { return Object.assign({}, d); })
        });
    } catch(e) { console.warn('Sankey error:', e); return; }

    var defs = svg.append('defs');
    graph.links.forEach(function(link, i) {
        var id = 'lg' + i;
        var grad = defs.append('linearGradient').attr('id', id)
            .attr('gradientUnits', 'userSpaceOnUse')
            .attr('x1', link.source.x1).attr('x2', link.target.x0);
        grad.append('stop').attr('offset', '0%').attr('stop-color', nodeColors[link.source.name] || '#64748b').attr('stop-opacity', 0.6);
        grad.append('stop').attr('offset', '100%').attr('stop-color', nodeColors[link.target.name] || '#64748b').attr('stop-opacity', 0.6);
    });

    // Links
    svg.append('g').attr('class', 'sankey-links')
        .selectAll('path')
        .data(graph.links)
        .enter().append('path')
        .attr('d', d3.sankeyLinkHorizontal())
        .attr('stroke', function(d, i) { return 'url(#lg' + i + ')'; })
        .attr('stroke-width', function(d) { return Math.max(1, d.width); })
        .attr('fill', 'none')
        .attr('opacity', 0.55)
        .on('mouseover', function() { d3.select(this).attr('opacity', 0.85); })
        .on('mouseout', function() { d3.select(this).attr('opacity', 0.55); })
        .append('title')
        .text(function(d) { return d.source.name + ' → ' + d.target.name + ': ' + d.value.toLocaleString() + ' alarm points'; });

    // Nodes
    var node = svg.append('g').attr('class', 'sankey-nodes')
        .selectAll('g')
        .data(graph.nodes)
        .enter().append('g');

    node.append('rect')
        .attr('x', function(d) { return d.x0; })
        .attr('y', function(d) { return d.y0; })
        .attr('height', function(d) { return d.y1 - d.y0; })
        .attr('width', function(d) { return d.x1 - d.x0; })
        .attr('fill', function(d) { return nodeColors[d.name] || '#64748b'; })
        .attr('rx', 3)
        .on('mouseover', function(event, d) {
            d3.select(this).attr('opacity', 0.8);
        })
        .on('mouseout', function() { d3.select(this).attr('opacity', 1); })
        .append('title')
        .text(function(d) { return d.name + '\n' + d.value.toLocaleString() + ' alarm points'; });

    // Node labels — name
    node.append('text')
        .attr('x', function(d) { return d.x0 < W / 2 ? d.x1 + 6 : d.x0 - 6; })
        .attr('y', function(d) { return (d.y0 + d.y1) / 2 - 1; })
        .attr('dy', '0.35em')
        .attr('text-anchor', function(d) { return d.x0 < W / 2 ? 'start' : 'end'; })
        .attr('font-size', isMobile ? 9 : 10.5)
        .attr('font-weight', '600')
        .attr('fill', function(d) { return nodeColors[d.name] || '#475569'; })
        .text(function(d) { return d.name; });

    // Node labels — value
    node.append('text')
        .attr('x', function(d) { return d.x0 < W / 2 ? d.x1 + 6 : d.x0 - 6; })
        .attr('y', function(d) { return (d.y0 + d.y1) / 2 + 11; })
        .attr('dy', '0.35em')
        .attr('text-anchor', function(d) { return d.x0 < W / 2 ? 'start' : 'end'; })
        .attr('font-size', isMobile ? 8 : 9.5)
        .attr('font-weight', '700')
        .attr('fill', '#64748b')
        .text(function(d) { return d.value.toLocaleString() + ' pts'; });
})();
</script>

<script>
function subscribeNewsletter(e){e.preventDefault();var email=e.target.querySelector('input[type="email"]').value.trim();if(!email)return false;var subs=JSON.parse(localStorage.getItem('rz_newsletter_subscribers')||'[]');if(subs.find(function(s){return s.email===email})){alert('Already subscribed!');return false}subs.push({email:email,date:new Date().toISOString(),source:location.pathname.split('/').pop(),status:'active'});localStorage.setItem('rz_newsletter_subscribers',JSON.stringify(subs));e.target.innerHTML='<p style="color:#fff;font-weight:600;">&#10003; Subscribed successfully!</p>';return false}
</script>
<script src="auth.js"></script>
<script src="rz-tracker.js"></script>

<!-- Cookie Consent Banner -->
<div class="cookie-banner hidden" id="cookieBanner">
    <p>We use cookies for analytics to improve your experience. <a href="privacy.html">Learn more</a></p>
    <div class="cookie-actions">
        <button class="cookie-accept" id="cookieAccept">Accept</button>
        <button class="cookie-decline" id="cookieDecline">Decline</button>
    </div>
</div>

<!-- Scroll to Top -->
<button class="scroll-top-btn" id="scrollTopBtn" aria-label="Scroll to top">
    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><polyline points="18 15 12 9 6 15"/></svg>
</button>

<script>
(function(){
    // Cookie Banner
    var cb = document.getElementById('cookieBanner');
    var consent = localStorage.getItem('rz_cookie_consent');
    if (!consent && cb) {
        cb.classList.remove('hidden');
    }
    var acceptBtn = document.getElementById('cookieAccept');
    var declineBtn = document.getElementById('cookieDecline');
    if (acceptBtn) acceptBtn.addEventListener('click', function(){
        localStorage.setItem('rz_cookie_consent', 'accepted');
        cb.classList.add('hidden');
    });
    if (declineBtn) declineBtn.addEventListener('click', function(){
        localStorage.setItem('rz_cookie_consent', 'declined');
        cb.classList.add('hidden');
        // Disable GA
        window['ga-disable-G-GED7FX8RTV'] = true;
    });

    // Scroll to Top
    var sBtn = document.getElementById('scrollTopBtn');
    if (sBtn) {
        var ticking = false;
        window.addEventListener('scroll', function(){
            if (!ticking) {
                window.requestAnimationFrame(function(){
                    if (window.scrollY > 500) {
                        sBtn.classList.add('visible');
                    } else {
                        sBtn.classList.remove('visible');
                    }
                    ticking = false;
                });
                ticking = true;
            }
        });
        sBtn.addEventListener('click', function(){
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });
    }
})();
</script>

</body>
</html>
