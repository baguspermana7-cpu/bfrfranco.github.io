<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-GED7FX8RTV"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-GED7FX8RTV');
    </script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <!-- SEO Meta Tags -->
    <title>AI Data Centers Funding Grid's Future | ResistanceZero</title>
    <meta name="description" content="Contrarian analysis: AI data centers drive $57B+ renewable investments, modernize aging grids, and generate $33,500/MW surplus value. The 180-degree counter-argument to 'data centers vs citizens' narrative.">
    <meta name="keywords" content="AI Data Center, Grid Modernization, Renewable Energy, PPA, Corporate Sustainability, Southeast Asia, Grid Investment, Load Factor, Energy Transition, Digital Infrastructure">
    <meta name="author" content="Bagus Dwi Permana">
    <meta name="robots" content="index, follow">
    <meta name="theme-color" content="#059669">
    <link rel="canonical" href="https://resistancezero.com/article-12.html">

    <!-- Open Graph Meta Tags -->
    <meta property="og:type" content="article">
    <meta property="og:url" content="https://resistancezero.com/article-12.html">
    <meta property="og:title" content="The Uncomfortable Truth: How AI Data Centers Are Secretly Funding Your Grid's Future">
    <meta property="og:description" content="Contrarian analysis: Data centers drive renewable investment, modernize grids, and generate economic surplus. The devil's advocate perspective.">
    <meta property="og:image" content="https://resistancezero.com/assets/article-12-cover.jpg">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:image:alt" content="How AI Data Centers Are Secretly Funding Your Grid's Future - Contrarian Analysis">
    <meta property="og:locale" content="en_US">
    <meta property="og:site_name" content="Bagus Dwi Permana Portfolio">
    <meta property="article:author" content="Bagus Dwi Permana">
    <meta property="article:published_time" content="2026-02-10T00:00:00Z">
    <meta property="article:modified_time" content="2026-02-17T00:00:00Z">
    <meta property="article:section" content="Energy & Policy">
    <meta property="article:tag" content="AI Data Centers">
    <meta property="article:tag" content="Renewable Energy">
    <meta property="article:tag" content="Grid Modernization">
    <meta property="article:tag" content="Southeast Asia">

    <!-- Twitter Card Meta Tags -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@BagusDPermana">
    <meta name="twitter:creator" content="@BagusDPermana">
    <meta name="twitter:title" content="The Uncomfortable Truth: How AI Data Centers Are Secretly Funding Your Grid's Future">
    <meta name="twitter:description" content="Data centers: Grid burdens or grid builders? The contrarian analysis with $57B+ renewable data.">
    <meta name="twitter:image" content="https://resistancezero.com/assets/article-12-cover.jpg">
    <meta name="twitter:image:alt" content="Renewable Energy Strategy for Data Center Operations">

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
    <link rel="icon" type="image/png" href="assets/Favicon.png">
    <link rel="apple-touch-icon" href="assets/Favicon.png">
    <link rel="stylesheet" href="styles.css">
    <link rel="preload" as="image" href="assets/article-12-cover.jpg">

    <!-- Structured Data -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "TechnicalArticle",
        "headline": "The Uncomfortable Truth: How AI Data Centers Are Secretly Funding Your Grid's Future",
        "description": "Contrarian analysis of AI data center impact on electricity grids - renewable investment, grid modernization, and economic value creation",
        "author": {
            "@type": "Person",
            "name": "Bagus Dwi Permana"
        },
        "datePublished": "2026-02-08",
        "publisher": {
            "@type": "Person",
            "name": "Bagus Dwi Permana"
        }
    }
    </script>

    <style>
        :root {
            --energy-green: #059669;
            --energy-emerald: #10b981;
            --energy-teal: #14b8a6;
            --energy-cyan: #06b6d4;
            --energy-blue: #3b82f6;
            --spacing-xs: 0.25rem;
            --spacing-sm: 0.5rem;
            --spacing-md: 1rem;
            --spacing-lg: 1.5rem;
            --spacing-xl: 2rem;
            --spacing-2xl: 3rem;
        }

        .article-hero {
            background: linear-gradient(135deg, #022c22 0%, #064e3b 50%, #065f46 100%);
            padding: 7rem 2rem 3.5rem;
            color: #fff;
            text-align: center;
            position: relative;
            overflow: hidden;
        }
        .article-hero::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            background:
                radial-gradient(circle at 20% 80%, rgba(16, 185, 129, 0.3) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(6, 182, 212, 0.2) 0%, transparent 50%);
            z-index: 0;
        }
        .article-hero::after {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            background: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M30 5 L35 25 L55 30 L35 35 L30 55 L25 35 L5 30 L25 25 Z' fill='%2310b981' fill-opacity='0.05'/%3E%3C/svg%3E");
            opacity: 0.5;
            z-index: 0;
        }
        .article-hero > * { position: relative; z-index: 1; }
        .article-hero .container { max-width: 1000px; }
        .article-category {
            display: inline-block;
            background: rgba(16, 185, 129, 0.2);
            color: #6ee7b7;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-size: 0.875rem;
            font-weight: 600;
            margin-bottom: 1.5rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            border: 1px solid rgba(16, 185, 129, 0.3);
        }
        .article-title {
            font-size: clamp(1.6rem, 3.2vw, 2.35rem);
            font-weight: 800;
            margin-bottom: 1.25rem;
            line-height: 1.25;
            color: #fff;
            letter-spacing: -0.01em;
        }
        .article-title .highlight {
            background: linear-gradient(90deg, #10b981, #06b6d4);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        .article-subtitle {
            font-size: clamp(0.95rem, 1.6vw, 1.15rem);
            color: #94a3b8;
            max-width: 800px;
            margin: 0 auto 2rem;
            line-height: 1.7;
        }
        .article-meta {
            display: flex;
            justify-content: center;
            gap: 2rem;
            flex-wrap: wrap;
            color: #94a3b8;
            font-size: 0.9375rem;
        }
        .article-meta-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        .back-link {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            color: #94a3b8;
            margin-bottom: 2rem;
            font-weight: 500;
            transition: color 0.3s ease;
        }
        .back-link:hover { color: #fff; }

        /* Contrarian Badge */
        .contrarian-badge {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
            color: #fff;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 700;
            margin-bottom: 1rem;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        /* Article Content */
        .article-content {
            padding: 4rem 2rem;
            background: #fff;
        }
        .article-content .container { max-width: 900px; }
        .article-body {
            font-size: 0.95rem;
            line-height: 1.7;
            color: #374151;
        }
        .article-body p { margin-bottom: 1rem; }
        .article-body h2 {
            font-size: 1.4rem;
            color: #059669;
            margin: var(--spacing-xl) 0 var(--spacing-md);
            padding-bottom: var(--spacing-sm);
            border-bottom: 3px solid #a7f3d0;
        }
        .article-body h3 {
            font-size: 1.1rem;
            color: #047857;
            margin: var(--spacing-lg) 0 var(--spacing-sm);
        }
        .article-body h4 {
            font-size: 0.9rem;
            color: #059669;
            margin: var(--spacing-md) 0 var(--spacing-sm);
        }
        .article-body blockquote {
            background: linear-gradient(135deg, #ecfdf5 0%, #a7f3d0 100%);
            border-left: 4px solid #059669;
            padding: var(--spacing-lg) var(--spacing-xl);
            margin: var(--spacing-lg) 0;
            border-radius: 0 12px 12px 0;
            font-style: italic;
            color: #047857;
            font-size: 1rem;
        }
        .article-body ul, .article-body ol {
            margin: 1.5rem 0;
            padding-left: 1.5rem;
        }
        .article-body li { margin-bottom: 0.75rem; }

        /* Truth Box (opposite of Controversy Box) */
        .truth-box {
            background: linear-gradient(135deg, #022c22 0%, #064e3b 100%);
            border-radius: 16px;
            padding: 2rem;
            margin: 2.5rem 0;
            border: 2px solid #10b981;
            position: relative;
            overflow: hidden;
        }
        .truth-box::before {
            content: '';
            position: absolute;
            top: 0; right: 0;
            width: 150px; height: 150px;
            background: radial-gradient(circle, rgba(16, 185, 129, 0.3) 0%, transparent 70%);
        }
        .truth-box h4 {
            color: #6ee7b7;
            font-size: 0.95rem;
            margin-bottom: 0.75rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        .truth-box p {
            color: #e5e7eb;
            margin-bottom: 0.5rem;
            font-size: 0.9rem;
        }
        .truth-box .stat-highlight {
            color: #34d399;
            font-weight: 700;
            font-size: 1.25rem;
        }

        /* Data Comparison */
        .comparison-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1.5rem;
            margin: 2rem 0;
        }
        .comparison-card {
            background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
            border-radius: 12px;
            padding: 1.5rem;
            border: 1px solid #e2e8f0;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        .comparison-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 12px 40px rgba(0,0,0,0.1);
        }
        .comparison-card.positive {
            background: linear-gradient(135deg, #ecfdf5 0%, #d1fae5 100%);
            border-color: #a7f3d0;
        }
        .comparison-card.neutral {
            background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
            border-color: #bae6fd;
        }
        .comparison-card h5 {
            font-size: 0.875rem;
            color: #64748b;
            margin-bottom: 0.5rem;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        .comparison-card .value {
            font-size: 2rem;
            font-weight: 700;
            color: #1e293b;
        }
        .comparison-card.positive .value { color: #059669; }
        .comparison-card.neutral .value { color: #0284c7; }
        .comparison-card .unit {
            font-size: 0.875rem;
            color: #64748b;
        }

        /* Investment Table */
        .investment-table {
            width: 100%;
            border-collapse: collapse;
            margin: 2rem 0;
            font-size: 0.95rem;
        }
        .investment-table th, .investment-table td {
            padding: 1rem;
            text-align: left;
            border-bottom: 1px solid #e2e8f0;
        }
        .investment-table th {
            background: #064e3b;
            color: #fff;
            font-weight: 600;
        }
        .investment-table tr:hover {
            background: #f0fdf4;
        }
        .investment-badge {
            display: inline-flex;
            align-items: center;
            gap: 4px;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.8rem;
            font-weight: 600;
        }
        .investment-badge.renewable {
            background: #ecfdf5;
            color: #059669;
        }
        .investment-badge.nuclear {
            background: #fef3c7;
            color: #d97706;
        }
        .investment-badge.grid {
            background: #e0f2fe;
            color: #0284c7;
        }

        /* Impact Calculator */
        .value-calculator {
            background: linear-gradient(135deg, #022c22 0%, #064e3b 100%);
            border-radius: 20px;
            padding: 2.5rem;
            margin: 3rem 0;
            color: #fff;
        }
        .calc-title {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }
        .calc-subtitle {
            color: #94a3b8;
            margin-bottom: 2rem;
        }
        .calc-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }
        .calc-input-group {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }
        .calc-input-group label {
            font-size: 0.875rem;
            color: #94a3b8;
            font-weight: 500;
        }
        .calc-input-group select,
        .calc-input-group input {
            background: rgba(255,255,255,0.1);
            border: 1px solid rgba(255,255,255,0.2);
            border-radius: 8px;
            padding: 0.75rem 1rem;
            color: #fff;
            font-size: 1rem;
            transition: all 0.3s ease;
        }
        .calc-input-group select:focus,
        .calc-input-group input:focus {
            outline: none;
            border-color: #10b981;
            background: rgba(16, 185, 129, 0.1);
        }
        .calc-input-group select option {
            background: #064e3b;
            color: #fff;
        }
        .calc-button {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            background: linear-gradient(135deg, #10b981 0%, #06b6d4 100%);
            color: #fff;
            border: none;
            border-radius: 10px;
            padding: 0.875rem 1.75rem;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(16, 185, 129, 0.3);
        }
        .calc-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(16, 185, 129, 0.4);
        }
        .calc-results {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 1rem;
            background: rgba(0,0,0,0.3);
            border-radius: 12px;
            padding: 1.5rem;
            margin-top: 2rem;
        }
        .calc-result-item {
            text-align: center;
            padding: 1rem;
            background: rgba(255,255,255,0.05);
            border-radius: 8px;
        }
        .calc-result-item .label {
            font-size: 0.75rem;
            color: #94a3b8;
            margin-bottom: 0.5rem;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        .calc-result-item .value {
            font-size: 1.5rem;
            font-weight: 700;
            color: #34d399;
        }
        .calc-result-item .value.blue { color: #38bdf8; }
        .calc-result-item .value.yellow { color: #fbbf24; }
        .calc-result-item .subtext {
            font-size: 0.7rem;
            color: #64748b;
            margin-top: 0.25rem;
        }

        /* Visualization: Investment Flow */
        .investment-viz {
            background: linear-gradient(135deg, #ecfdf5 0%, #fff 100%);
            border-radius: 16px;
            padding: 2rem;
            margin: 2rem 0;
            border: 1px solid #a7f3d0;
        }
        .investment-bar {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin: 1rem 0;
        }
        .investment-bar .company {
            width: 100px;
            font-weight: 600;
            color: #064e3b;
            font-size: 0.9rem;
        }
        .investment-bar .bar-container {
            flex: 1;
            height: 32px;
            background: #f1f5f9;
            border-radius: 6px;
            overflow: hidden;
            position: relative;
        }
        .investment-bar .bar {
            height: 100%;
            background: linear-gradient(90deg, #10b981, #06b6d4);
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: flex-end;
            padding-right: 10px;
            transition: width 0.5s ease;
        }
        .investment-bar .bar span {
            color: #fff;
            font-size: 0.75rem;
            font-weight: 600;
        }
        .investment-bar .value {
            width: 80px;
            text-align: right;
            font-weight: 700;
            color: #059669;
        }
        .dual-bar-row {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 0.5rem 0;
            border-bottom: 1px solid rgba(0,0,0,0.05);
        }
        .dual-bar-row:last-of-type {
            border-bottom: none;
        }
        .dual-bar-row .company {
            color: #064e3b;
        }

        /* Highlight Box - Positive */
        .positive-box {
            background: linear-gradient(135deg, #ecfdf5 0%, #d1fae5 100%);
            border-radius: 12px;
            padding: 1.5rem 2rem;
            margin: 2rem 0;
            border-left: 4px solid #10b981;
        }
        .positive-box p {
            margin: 0;
            color: #065f46;
        }

        /* Warning Box - Nuance */
        .nuance-box {
            background: linear-gradient(135deg, #fefce8 0%, #fef9c3 100%);
            border-radius: 12px;
            padding: 1.5rem 2rem;
            margin: 2rem 0;
            border-left: 4px solid #ca8a04;
        }
        .nuance-box p {
            margin: 0;
            color: #854d0e;
        }

        /* Data Table */
        .data-table-container {
            overflow-x: auto;
            margin: 2rem 0;
        }
        .data-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.9rem;
        }
        .data-table th, .data-table td {
            padding: 0.875rem 1rem;
            text-align: left;
            border-bottom: 1px solid #e2e8f0;
        }
        .data-table th {
            background: #064e3b;
            color: #fff;
            font-weight: 600;
            white-space: nowrap;
        }
        .data-table tr:hover {
            background: #f0fdf4;
        }
        .table-source {
            font-size: 0.8rem;
            color: #64748b;
            margin-top: 0.5rem;
        }

        /* References */
        .references {
            background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
            padding: 2rem;
            border-radius: 12px;
            margin-top: 3rem;
            border-left: 4px solid #059669;
        }
        .references h3 {
            font-size: 1.1rem;
            margin-bottom: 1.25rem;
            color: #047857;
        }
        .references ol {
            font-size: 0.875rem;
            color: #475569;
            padding-left: 1.5rem;
            line-height: 1.5;
        }
        .references ol li {
            margin-bottom: 0.5rem;
        }
        .references a {
            color: #059669;
            text-decoration: none;
        }
        .references a:hover {
            text-decoration: underline;
        }
        .ref-source {
            color: #64748b;
            font-size: 0.8rem;
            display: block;
            margin-top: 0.15rem;
        }

        /* Article Nav */
        .article-nav {
            display: flex;
            justify-content: space-between;
            padding: 2rem 0;
            border-top: 1px solid #e2e8f0;
            margin-top: 3rem;
        }
        .article-nav a {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: #1e3a5f;
            font-weight: 600;
            transition: color 0.3s ease;
            text-decoration: none;
        }
        [data-theme="dark"] .article-nav a { color: #93c5fd; }
        .article-nav a:hover { color: #60a5fa; }

        /* Dark Mode */
        [data-theme="dark"] .article-content { background: #0f172a; }
        [data-theme="dark"] .article-body { background: #0f172a; color: #e2e8f0; }
        [data-theme="dark"] .article-body h2 { color: #93c5fd; }
        [data-theme="dark"] .article-body h3 { color: #cbd5e1; }
        [data-theme="dark"] .article-body p { color: #cbd5e1; }
        [data-theme="dark"] .article-body blockquote { background: rgba(30,58,95,0.3); border-color: rgba(96,165,250,0.4); color: #cbd5e1; }
        [data-theme="dark"] .article-body .info-box,
        [data-theme="dark"] .article-body .key-insight { background: rgba(15,23,42,0.8); border-color: rgba(255,255,255,0.1); color: #cbd5e1; }
        [data-theme="dark"] .article-body table th { background: #0f172a; color: #e2e8f0; }
        [data-theme="dark"] .article-body table td { color: #cbd5e1; border-color: rgba(255,255,255,0.1); }
        [data-theme="dark"] .article-body ul li,
        [data-theme="dark"] .article-body ol li { color: #cbd5e1; }
        [data-theme="dark"] .article-body a { color: #60a5fa; }
        [data-theme="dark"] .article-body strong { color: #f1f5f9; }
        [data-theme="dark"] .comparison-card { background: #1e293b; border-color: rgba(255,255,255,0.1); }
        [data-theme="dark"] .comparison-card h5 { color: #94a3b8; }
        [data-theme="dark"] .comparison-card .value { color: #e2e8f0; }
        [data-theme="dark"] .comparison-card .unit { color: #94a3b8; }
        [data-theme="dark"] .comparison-card.positive { background: rgba(5,150,105,0.15); border-color: rgba(16,185,129,0.3); }
        [data-theme="dark"] .comparison-card.positive .value { color: #34d399; }
        [data-theme="dark"] .comparison-card.neutral { background: rgba(2,132,199,0.15); border-color: rgba(56,189,248,0.3); }
        [data-theme="dark"] .comparison-card.neutral .value { color: #38bdf8; }
        [data-theme="dark"] .investment-table th { background: #1e293b; color: #e2e8f0; }
        [data-theme="dark"] .investment-table td { color: #cbd5e1; border-color: rgba(255,255,255,0.1); }
        [data-theme="dark"] .investment-table tr:hover { background: rgba(16,185,129,0.1); }
        [data-theme="dark"] .nuance-box { background: rgba(30,58,95,0.3); border-color: rgba(96,165,250,0.3); color: #cbd5e1; }

        /* Table of Contents */
        .toc-section {
            background: linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%);
            padding: 3rem 2rem;
            border-bottom: 1px solid #d1fae5;
        }
        .toc-container {
            max-width: 900px;
            margin: 0 auto;
        }
        .toc-title {
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--energy-green);
            margin-bottom: 1.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        .toc-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 0.625rem;
        }
        .toc-item {
            background: #fff;
            padding: 0.75rem 1rem;
            border-radius: 10px;
            border-left: 4px solid var(--energy-emerald);
            transition: all 0.2s ease;
            text-decoration: none;
            color: #1e293b;
        }
        .toc-item:hover {
            transform: translateX(4px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        .toc-item-number {
            font-size: 0.75rem;
            color: var(--energy-emerald);
            font-weight: 700;
            margin-bottom: 0.25rem;
        }
        .toc-item-title {
            font-weight: 600;
            font-size: 0.88rem;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .article-hero { padding: 6rem 1rem 3rem; }
            .article-content { padding: 3rem 1rem; }
            .article-body { font-size: 1rem; }
            .value-calculator { padding: 1.5rem; }
            .calc-grid { grid-template-columns: 1fr; }
            .comparison-grid { grid-template-columns: 1fr; }
            .toc-grid { grid-template-columns: 1fr; }
        }

        @media print {
            .navbar, .value-calculator, .article-nav { display: none !important; }
        }

        /* Tooltip Icon Styles */
        .tooltip-icon {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 14px;
            height: 14px;
            background: rgba(255,255,255,0.15);
            border-radius: 50%;
            font-size: 0.65rem;
            color: #94a3b8;
            margin-left: 4px;
            cursor: help;
            vertical-align: middle;
        }
        .tooltip-icon:hover {
            background: rgba(16, 185, 129, 0.3);
            color: #34d399;
        }
        .calc-input-group label[title] {
            cursor: help;
        }
        .calc-input-group select[title],
        .calc-input-group input[title] {
            cursor: help;
        }

        /* ===== Pro Enhancement Mode — Operational Maturity (.opm-) ===== */
        .opm-cta-block {
            margin: 2rem 0; padding: 1.5rem 2rem; border-radius: 14px;
            background: linear-gradient(135deg, rgba(16,185,129,0.1) 0%, rgba(16,185,129,0.04) 100%);
            border: 1px solid rgba(16,185,129,0.2); text-align: center;
        }
        .opm-cta-headline { font-size: 1.1rem; font-weight: 700; color: #065f46; margin-bottom: 0.4rem; }
        .opm-cta-sub { font-size: 0.85rem; color: #64748b; margin-bottom: 1rem; }
        .opm-cta-btn {
            display: inline-block; padding: 0.7rem 1.8rem; background: linear-gradient(135deg, #10b981, #059669);
            color: #fff; border-radius: 10px; font-weight: 700; font-size: 0.88rem; text-decoration: none; transition: all 0.2s;
        }
        .opm-cta-btn:hover { opacity: 0.9; transform: translateY(-1px); }

        .opm-toolbar-row {
            display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 1rem;
            margin-bottom: 1.5rem; padding: 1rem;
            background: linear-gradient(135deg, rgba(16,185,129,0.08) 0%, rgba(16,185,129,0.03) 100%);
            border-radius: 12px; border: 1px solid rgba(16,185,129,0.15);
        }
        .opm-mode-bar .opm-mode-toggle { display: flex; background: rgba(16,185,129,0.1); border-radius: 8px; overflow: hidden; }
        .opm-mode-btn { padding: 8px 20px; border: none; background: transparent; color: #64748b; font-weight: 600; font-size: 0.82rem; cursor: pointer; transition: all 0.2s; }
        .opm-mode-btn.active { background: #10b981; color: #fff; }
        .opm-toolbar-actions { display: flex; gap: 0.5rem; align-items: center; }
        .opm-toolbar-actions button {
            padding: 6px 14px; border: 1px solid rgba(16,185,129,0.3); border-radius: 6px;
            background: transparent; color: #10b981; font-size: 0.78rem; cursor: pointer; transition: all 0.2s;
        }
        .opm-toolbar-actions button:hover { background: rgba(16,185,129,0.1); }
        .opm-btn-pdf { background: linear-gradient(135deg, rgba(16,185,129,0.2), rgba(16,185,129,0.1)) !important; color: #34d399 !important; border: 1px solid rgba(16,185,129,0.3) !important; }
        .opm-btn-pdf:hover { background: linear-gradient(135deg, rgba(16,185,129,0.3), rgba(16,185,129,0.15)) !important; }
        .opm-privacy-badge { font-size: 0.7rem; color: #64748b; display: flex; align-items: center; gap: 4px; }
        .opm-privacy-badge i { color: #10b981; font-size: 0.75rem; }

        .opm-pro-inputs {
            display: none; margin: 1.5rem 0; padding: 1.5rem;
            background: linear-gradient(135deg, rgba(16,185,129,0.06) 0%, rgba(16,185,129,0.02) 100%);
            border-radius: 12px; border: 1px solid rgba(16,185,129,0.12);
        }
        .opm-pro-inputs.visible { display: block; }
        .opm-pro-inputs h4 { font-size: 0.95rem; font-weight: 700; color: #065f46; margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem; }
        .opm-pro-inputs h4 i { color: #10b981; }
        .opm-input-grid {
            display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;
        }
        .opm-input-group { display: flex; flex-direction: column; gap: 0.35rem; }
        .opm-input-group label { font-size: 0.78rem; color: #475569; font-weight: 600; display: flex; align-items: center; gap: 4px; cursor: help; }
        .opm-input-group select, .opm-input-group input {
            padding: 0.6rem 0.75rem; border: 1px solid rgba(16,185,129,0.2); border-radius: 8px;
            background: rgba(255,255,255,0.8); color: #1e293b; font-size: 0.85rem; transition: all 0.2s;
        }
        .opm-input-group select:focus, .opm-input-group input:focus { outline: none; border-color: #10b981; box-shadow: 0 0 0 3px rgba(16,185,129,0.1); }
        .opm-tooltip-icon {
            display: inline-flex; align-items: center; justify-content: center; width: 15px; height: 15px;
            background: rgba(16,185,129,0.15); border-radius: 50%; font-size: 0.6rem; color: #10b981;
            cursor: help; font-weight: 700; font-style: normal;
        }
        .opm-tooltip-icon:hover { background: rgba(16,185,129,0.3); }

        .opm-pro-panel {
            margin: 1.5rem 0; padding: 1.5rem; position: relative;
            background: linear-gradient(135deg, #f0fdf4 0%, #ecfdf5 100%);
            border-radius: 14px; border: 1px solid rgba(16,185,129,0.15);
        }
        .opm-pro-panel.gated { filter: blur(3px); pointer-events: none; user-select: none; }
        .opm-pro-panel .opm-panel-title {
            font-size: 0.95rem; font-weight: 700; color: #065f46; margin-bottom: 0.75rem;
            display: flex; align-items: center; gap: 0.5rem;
        }
        .opm-pro-panel .opm-panel-title i { color: #10b981; font-size: 1.1rem; }
        .opm-kpi-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 0.75rem; }
        .opm-kpi-card {
            background: rgba(255,255,255,0.9); border-radius: 10px; padding: 1rem; text-align: center;
            border: 1px solid rgba(16,185,129,0.1);
        }
        .opm-kpi-value { font-size: 1.4rem; font-weight: 800; color: #065f46; }
        .opm-kpi-label { font-size: 0.72rem; color: #64748b; margin-top: 4px; }
        .opm-kpi-sublabel { font-size: 0.62rem; color: #94a3b8; margin-top: 2px; }
        .opm-gate-overlay {
            position: absolute; inset: 0; display: flex; flex-direction: column; align-items: center;
            justify-content: center; gap: 0.5rem; background: rgba(240,253,244,0.5); border-radius: 14px;
            cursor: pointer; z-index: 2; filter: none; pointer-events: auto; user-select: auto;
        }
        .opm-gate-overlay i { font-size: 1.5rem; color: #10b981; }
        .opm-gate-overlay span { font-size: 0.82rem; font-weight: 600; color: #065f46; }
        .opm-chart-container { margin-top: 1rem; border-radius: 10px; overflow: hidden; background: rgba(255,255,255,0.5); padding: 0.5rem; }
        .opm-narrative {
            font-size: 0.82rem; line-height: 1.65; color: #1e293b; padding: 1rem;
            background: rgba(255,255,255,0.7); border-radius: 10px; border-left: 3px solid #10b981;
        }
        .opm-narrative p { margin-bottom: 0.75rem; }
        .opm-narrative p:last-child { margin-bottom: 0; }
        .opm-narrative p strong { color: #065f46; }
        .opm-narrative .opm-narr-section { margin-bottom: 0.5rem; }

        /* Login Modal */
        .opm-login-overlay {
            display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.75); backdrop-filter: blur(8px);
            z-index: 9999; align-items: center; justify-content: center;
        }
        .opm-login-overlay.active { display: flex; }
        .opm-login-box {
            background: #0f172a; border-radius: 16px; padding: 2.5rem; max-width: 380px; width: 90%;
            border: 1px solid rgba(16,185,129,0.3); box-shadow: 0 20px 60px rgba(0,0,0,0.5);
            position: relative;
        }
        .opm-login-box h3 { color: #e2e8f0; margin: 0 0 0.5rem; font-size: 1.1rem; }
        .opm-login-box p { color: #64748b; font-size: 0.8rem; margin: 0 0 1.5rem; }
        .opm-login-box input {
            width: 100%; padding: 0.75rem 1rem; background: #1e293b;
            border: 1px solid #334155; border-radius: 8px; color: #e2e8f0;
            font-size: 0.9rem; margin-bottom: 0.75rem; box-sizing: border-box;
        }
        .opm-login-box input:focus { outline: none; border-color: #10b981; }
        .opm-login-box button.opm-login-submit {
            width: 100%; padding: 0.75rem; background: linear-gradient(135deg, #10b981, #059669); color: #fff;
            border: none; border-radius: 8px; font-weight: 700; cursor: pointer; font-size: 0.9rem; margin-top: 0.5rem;
        }
        .opm-login-box .demo-hint { font-size: 0.7rem; color: #64748b; margin-top: 0.75rem; text-align: center; }
        .opm-login-box .demo-hint code { background: rgba(16,185,129,0.15); padding: 1px 5px; border-radius: 3px; color: #6ee7b7; }
        .opm-login-close {
            position: absolute; top: 12px; right: 16px; background: none; border: none;
            color: #64748b; font-size: 1.2rem; cursor: pointer;
        }
        .opm-login-error { color: #f87171; font-size: 0.75rem; margin-top: 0.5rem; text-align: center; display: none; }
        [data-theme="light"] .opm-login-box { background: #ffffff; border-color: #e2e8f0; }
        [data-theme="light"] .opm-login-box h3 { color: #1e293b; }
        [data-theme="light"] .opm-login-box p { color: #64748b; }
        [data-theme="light"] .opm-login-box input { background: #f1f5f9; border-color: #e2e8f0; color: #1e293b; }

        /* Dark mode overrides for Pro Mode */
        [data-theme="dark"] .opm-cta-block { background: linear-gradient(135deg, rgba(16,185,129,0.15), rgba(16,185,129,0.06)); border-color: rgba(16,185,129,0.25); }
        [data-theme="dark"] .opm-cta-headline { color: #a7f3d0; }
        [data-theme="dark"] .opm-pro-inputs { background: linear-gradient(135deg, rgba(16,185,129,0.08), rgba(16,185,129,0.02)); border-color: rgba(16,185,129,0.15); }
        [data-theme="dark"] .opm-pro-inputs h4 { color: #a7f3d0; }
        [data-theme="dark"] .opm-input-group label { color: #94a3b8; }
        [data-theme="dark"] .opm-input-group select, [data-theme="dark"] .opm-input-group input { background: rgba(30,41,59,0.8); color: #e2e8f0; border-color: rgba(16,185,129,0.2); }
        [data-theme="dark"] .opm-pro-panel { background: linear-gradient(135deg, #0c1220 0%, #162032 100%); border-color: rgba(16,185,129,0.2); }
        [data-theme="dark"] .opm-kpi-card { background: rgba(30,41,59,0.8); border-color: rgba(16,185,129,0.15); }
        [data-theme="dark"] .opm-kpi-value { color: #34d399; }
        [data-theme="dark"] .opm-panel-title { color: #a7f3d0; }
        [data-theme="dark"] .opm-gate-overlay { background: rgba(12,18,32,0.5); }
        [data-theme="dark"] .opm-gate-overlay span { color: #a7f3d0; }
        [data-theme="dark"] .opm-narrative { background: rgba(30,41,59,0.5); color: #e2e8f0; border-left-color: #10b981; }
        [data-theme="dark"] .opm-narrative p strong { color: #6ee7b7; }
        [data-theme="dark"] .opm-chart-container { background: rgba(30,41,59,0.5); }
        [data-theme="dark"] .opm-login-box { background: #0f172a; }
        [data-theme="dark"] .opm-toolbar-row { background: linear-gradient(135deg, rgba(16,185,129,0.1), rgba(16,185,129,0.03)); }

        @media (max-width: 768px) {
            .opm-toolbar-row { flex-direction: column; gap: 0.75rem; }
            .opm-input-grid { grid-template-columns: 1fr; }
            .opm-kpi-grid { grid-template-columns: repeat(2, 1fr); }
            .opm-cta-block { padding: 1.25rem 1rem; }
        }
    </style>
</head>
<body>
    <a href="#main-content" class="skip-link">Skip to main content</a>
    <nav class="navbar">
        <div class="nav-container">
            <a href="index.html" class="nav-logo">
                <img loading="lazy" src="assets/profile-photo.jpg" alt="Bagus Dwi Permana" class="nav-avatar">
            </a>
            <ul class="nav-menu">
                <li><a href="index.html" class="nav-link">Home</a></li>
                <li class="nav-dropdown">
                    <a href="datacenter-solutions.html" class="nav-link">
                        DC Solutions
                        <svg class="dropdown-arrow" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polyline points="6 9 12 15 18 9"></polyline>
                        </svg>
                    </a>
                    <ul class="dropdown-menu">
                        <li><a href="datacenter-solutions.html" style="color: #06b6d4; font-weight: 600;">DC Solutions Hub</a></li>
                        <li style="border-bottom: 1px solid rgba(255,255,255,0.1); margin: 4px 0;"></li>
                        <li><a href="datahallAI.html" style="color: #8b5cf6;">DC AI/HPC</a></li>
                        <li><a href="dc-conventional.html">DC Conventional</a></li>
                        <li style="border-bottom: 1px solid rgba(255,255,255,0.1); margin: 4px 0;"></li>
                        <li><a href="capex-calculator.html" style="color: #f59e0b;">CAPEX Calculator</a></li>
                        <li><a href="opex-calculator.html" style="color: #10b981;">OPEX Calculator</a></li>
                    </ul>
                </li>
                <li><a href="index.html#metrics" class="nav-link">Results</a></li>
                <li><a href="index.html#case-studies" class="nav-link">Case Studies</a></li>
                <li><a href="articles.html" class="nav-link">Articles</a></li>
                <li><a href="index.html#faq" class="nav-link">FAQ</a></li>
                <li><a href="index.html#contact" class="nav-link">Contact</a></li>
            </ul>
            <button class="theme-toggle" id="themeToggle" aria-label="Toggle dark mode" title="Toggle dark/light mode">
                <svg class="moon-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                </svg>
                <svg class="sun-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <circle cx="12" cy="12" r="5"></circle>
                    <line x1="12" y1="1" x2="12" y2="3"></line>
                    <line x1="12" y1="21" x2="12" y2="23"></line>
                    <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                    <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                    <line x1="1" y1="12" x2="3" y2="12"></line>
                    <line x1="21" y1="12" x2="23" y2="12"></line>
                    <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                    <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                </svg>
            </button>
            <div class="hamburger">
                <span class="bar"></span>
                <span class="bar"></span>
                <span class="bar"></span>
            </div>
        </div>
    </nav>

    <main id="main-content">
    <section class="article-hero">
        <div class="container">
            <a href="articles.html" class="back-link">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M19 12H5M12 19l-7-7 7-7"/>
                </svg>
                Back to Articles
            </a>
            <span class="contrarian-badge">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="10"/>
                    <path d="M12 16v-4M12 8h.01"/>
                </svg>
                Counter-Perspective Analysis
            </span>
            <span class="article-category">Energy & Grid Economics</span>
            <h1 class="article-title">The Uncomfortable Truth: How AI Data Centers Are <span class="highlight">Secretly Funding Your Grid's Future</span></h1>
            <p class="article-subtitle">A contrarian analysis: What if data centers aren't grid burdens, but the largest private investors in renewable energy and grid modernization in history? $57B+ in evidence suggests we're looking at this wrong.</p>
            <div class="article-meta">
                <span class="article-meta-item">
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="10"/>
                        <path d="M12 6v6l4 2"/>
                    </svg>
                    28 min read
                </span>
                <span class="article-meta-item">
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/>
                        <line x1="16" y1="2" x2="16" y2="6"/>
                        <line x1="8" y1="2" x2="8" y2="6"/>
                        <line x1="3" y1="10" x2="21" y2="10"/>
                    </svg>
                    February 8, 2026
                </span>
                <span class="article-meta-item">
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/>
                        <circle cx="12" cy="7" r="4"/>
                    </svg>
                    Bagus Dwi Permana
                </span>
            </div>
        </div>
    </section>

    <article class="article-content">
        <div class="container">
            <div class="article-body">

                <section class="toc-section">
                    <div class="toc-container">
                        <h2 class="toc-title">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <line x1="8" y1="6" x2="21" y2="6"></line>
                                <line x1="8" y1="12" x2="21" y2="12"></line>
                                <line x1="8" y1="18" x2="21" y2="18"></line>
                                <line x1="3" y1="6" x2="3.01" y2="6"></line>
                                <line x1="3" y1="12" x2="3.01" y2="12"></line>
                                <line x1="3" y1="18" x2="3.01" y2="18"></line>
                            </svg>
                            Table of Contents
                        </h2>
                        <div class="toc-grid">
                            <a href="#section-1" class="toc-item">
                                <div class="toc-item-number">SECTION 1</div>
                                <div class="toc-item-title">The Narrative You've Been Told</div>
                            </a>
                            <a href="#section-2" class="toc-item">
                                <div class="toc-item-number">SECTION 2</div>
                                <div class="toc-item-title">The $100+ Billion Question: Who's Actually Building Renewable Energy?</div>
                            </a>
                            <a href="#section-3" class="toc-item">
                                <div class="toc-item-number">SECTION 3</div>
                                <div class="toc-item-title">Grid Modernization: The Infrastructure Nobody Else Would Fund</div>
                            </a>
                            <a href="#section-4" class="toc-item">
                                <div class="toc-item-number">SECTION 4</div>
                                <div class="toc-item-title">The Efficiency Revolution: Doing More with Less</div>
                            </a>
                            <a href="#section-5" class="toc-item">
                                <div class="toc-item-number">SECTION 5</div>
                                <div class="toc-item-title">Economic Value Creation: Beyond Electricity Bills</div>
                            </a>
                            <a href="#section-6" class="toc-item">
                                <div class="toc-item-number">SECTION 6</div>
                                <div class="toc-item-title">The Cost Allocation Reality: Who Actually Subsidizes Whom?</div>
                            </a>
                            <a href="#section-7" class="toc-item">
                                <div class="toc-item-number">SECTION 7</div>
                                <div class="toc-item-title">The 15-Why Counter-Analysis</div>
                            </a>
                            <a href="#section-8" class="toc-item toc-calculator">
                                <div class="toc-item-number">SECTION 8 <span class="toc-calc-badge"><i class="fas fa-calculator" style="font-size:0.5rem;"></i> Interactive</span></div>
                                <div class="toc-item-title">Interactive Calculator: Comprehensive Value Generation Analysis</div>
                            </a>
                            <a href="#section-9" class="toc-item">
                                <div class="toc-item-number">SECTION 9</div>
                                <div class="toc-item-title">The Nuanced Truth: Both Narratives Are Incomplete</div>
                            </a>
                            <a href="#section-10" class="toc-item">
                                <div class="toc-item-number">SECTION 10</div>
                                <div class="toc-item-title">Conclusion: The Grid's Future is Being Built Now</div>
                            </a>
                        </div>
                    </div>
                </section>

                <h2 id="section-1">The Narrative You've Been Told</h2>

                <p>In my previous article, <a href="article-11.html">"AI Data Centers vs Citizen Electricity Bills"</a>, I presented the case that data centers burden electricity grids and pass costs to consumers. The social media outrage, the Senator Warren investigation, the rising tariffs — it all paints a damning picture.</p>

                <p>But what if that narrative is <strong>incomplete?</strong></p>

                <p>What if the same data centers being vilified are simultaneously the largest private investors in renewable energy in human history? What if they're funding grid modernization that would otherwise take decades? What if, economically, they're actually <strong>subsidizing residential consumers</strong> rather than the reverse?</p>

                <p>This is the counter-perspective analysis. Not to defend Big Tech blindly, but to examine the data that the "data centers vs citizens" narrative conveniently ignores.</p>

                <div class="nuance-box">
                    <p><strong>Important Caveat:</strong> This article presents the counter-argument, not the complete truth. Reality lives somewhere between "data centers are parasites" and "data centers are saviors." Both narratives contain valid points — and blind spots.</p>
                </div>

                <!-- Key Infographic -->
                <figure style="margin: 2.5rem 0; text-align: center;">
                    <img loading="lazy" src="assets/article-12-infographic.jpg" alt="Data Center Renewable Investment and Grid Value Infographic" style="max-width: 100%; height: auto; border-radius: 12px; box-shadow: 0 4px 20px rgba(0,0,0,0.15);">
                    <figcaption style="margin-top: 0.75rem; font-size: 0.875rem; color: #64748b; font-style: italic;">Figure 1: The scale of Big Tech renewable energy investment and grid value contribution</figcaption>
                </figure>

                <h2 id="section-2">1. The $100+ Billion Question: Who's Actually Building Renewable Energy?</h2>

                <p>Here's a fact that rarely makes it into the "data centers are bad" discourse: <strong>Big Tech companies are collectively the largest corporate purchasers of renewable energy on Earth.</strong></p>

                <div class="truth-box">
                    <h4>The Renewable Reality</h4>
                    <p>Amazon alone has contracted <span class="stat-highlight">34 GW</span> of renewable capacity — more than most countries' entire renewable portfolios.</p>
                    <p>Microsoft has committed <span class="stat-highlight">23.2 GW</span> cumulative, including a <span class="stat-highlight">$10+ billion</span> deal with Brookfield Renewable.</p>
                    <p>Google, Meta, and Microsoft are funding <span class="stat-highlight">nuclear restart projects</span> — including Three Mile Island.</p>
                </div>

                <h3>1.1 Corporate Renewable Investment Scale</h3>

                <div class="investment-viz">
                    <h4 style="margin-bottom: 0.5rem; color: #047857;">Renewable Energy Capacity vs Market Valuation</h4>
                    <p style="font-size: 0.8rem; color: #64748b; margin-bottom: 1.5rem;">Comparing clean energy commitments (GW) with company valuations ($T/B)</p>

                    <div class="dual-bar-legend" style="display: flex; gap: 1.5rem; margin-bottom: 1rem; font-size: 0.75rem;">
                        <span><span style="display: inline-block; width: 12px; height: 12px; background: linear-gradient(90deg, #10b981, #34d399); border-radius: 2px; margin-right: 4px;"></span> Renewable Capacity (GW)</span>
                        <span><span style="display: inline-block; width: 12px; height: 12px; background: linear-gradient(90deg, #3b82f6, #60a5fa); border-radius: 2px; margin-right: 4px;"></span> Market Cap/Valuation</span>
                    </div>

                    <!-- Amazon -->
                    <div class="dual-bar-row" style="margin-bottom: 0.75rem;">
                        <span class="company" style="width: 80px; font-weight: 600; font-size: 0.85rem;">Amazon</span>
                        <div class="dual-bars" style="flex: 1; display: flex; flex-direction: column; gap: 2px;">
                            <div style="display: flex; align-items: center; height: 18px;">
                                <div style="width: 100%; background: linear-gradient(90deg, #10b981, #34d399); border-radius: 3px; height: 100%; display: flex; align-items: center; justify-content: flex-end; padding-right: 8px;">
                                    <span style="color: white; font-size: 0.7rem; font-weight: 600;">34 GW</span>
                                </div>
                            </div>
                            <div style="display: flex; align-items: center; height: 18px;">
                                <div style="width: 63%; background: linear-gradient(90deg, #3b82f6, #60a5fa); border-radius: 3px; height: 100%; display: flex; align-items: center; justify-content: flex-end; padding-right: 8px;">
                                    <span style="color: white; font-size: 0.7rem; font-weight: 600;">$2.49T</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Microsoft -->
                    <div class="dual-bar-row" style="margin-bottom: 0.75rem;">
                        <span class="company" style="width: 80px; font-weight: 600; font-size: 0.85rem;">Microsoft</span>
                        <div class="dual-bars" style="flex: 1; display: flex; flex-direction: column; gap: 2px;">
                            <div style="display: flex; align-items: center; height: 18px;">
                                <div style="width: 68%; background: linear-gradient(90deg, #10b981, #34d399); border-radius: 3px; height: 100%; display: flex; align-items: center; justify-content: flex-end; padding-right: 8px;">
                                    <span style="color: white; font-size: 0.7rem; font-weight: 600;">23.2 GW</span>
                                </div>
                            </div>
                            <div style="display: flex; align-items: center; height: 18px;">
                                <div style="width: 89%; background: linear-gradient(90deg, #3b82f6, #60a5fa); border-radius: 3px; height: 100%; display: flex; align-items: center; justify-content: flex-end; padding-right: 8px;">
                                    <span style="color: white; font-size: 0.7rem; font-weight: 600;">$3.53T</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Google -->
                    <div class="dual-bar-row" style="margin-bottom: 0.75rem;">
                        <span class="company" style="width: 80px; font-weight: 600; font-size: 0.85rem;">Google</span>
                        <div class="dual-bars" style="flex: 1; display: flex; flex-direction: column; gap: 2px;">
                            <div style="display: flex; align-items: center; height: 18px;">
                                <div style="width: 44%; background: linear-gradient(90deg, #10b981, #34d399); border-radius: 3px; height: 100%; display: flex; align-items: center; justify-content: flex-end; padding-right: 8px;">
                                    <span style="color: white; font-size: 0.7rem; font-weight: 600;">15 GW</span>
                                </div>
                            </div>
                            <div style="display: flex; align-items: center; height: 18px;">
                                <div style="width: 97%; background: linear-gradient(90deg, #3b82f6, #60a5fa); border-radius: 3px; height: 100%; display: flex; align-items: center; justify-content: flex-end; padding-right: 8px;">
                                    <span style="color: white; font-size: 0.7rem; font-weight: 600;">$3.83T</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Meta -->
                    <div class="dual-bar-row" style="margin-bottom: 0.75rem;">
                        <span class="company" style="width: 80px; font-weight: 600; font-size: 0.85rem;">Meta</span>
                        <div class="dual-bars" style="flex: 1; display: flex; flex-direction: column; gap: 2px;">
                            <div style="display: flex; align-items: center; height: 18px;">
                                <div style="width: 49%; background: linear-gradient(90deg, #10b981, #34d399); border-radius: 3px; height: 100%; display: flex; align-items: center; justify-content: flex-end; padding-right: 8px;">
                                    <span style="color: white; font-size: 0.7rem; font-weight: 600;">16.6 GW</span>
                                </div>
                            </div>
                            <div style="display: flex; align-items: center; height: 18px;">
                                <div style="width: 38%; background: linear-gradient(90deg, #3b82f6, #60a5fa); border-radius: 3px; height: 100%; display: flex; align-items: center; justify-content: flex-end; padding-right: 8px;">
                                    <span style="color: white; font-size: 0.7rem; font-weight: 600;">$1.5T</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Oracle -->
                    <div class="dual-bar-row" style="margin-bottom: 0.75rem;">
                        <span class="company" style="width: 80px; font-weight: 600; font-size: 0.85rem;">Oracle</span>
                        <div class="dual-bars" style="flex: 1; display: flex; flex-direction: column; gap: 2px;">
                            <div style="display: flex; align-items: center; height: 18px;">
                                <div style="width: 29%; background: linear-gradient(90deg, #10b981, #34d399); border-radius: 3px; height: 100%; display: flex; align-items: center; justify-content: flex-end; padding-right: 8px;">
                                    <span style="color: white; font-size: 0.7rem; font-weight: 600;">10 GW</span>
                                </div>
                            </div>
                            <div style="display: flex; align-items: center; height: 18px;">
                                <div style="width: 10%; background: linear-gradient(90deg, #3b82f6, #60a5fa); border-radius: 3px; height: 100%;"></div>
                                <span style="margin-left: 6px; font-size: 0.7rem; color: #3b82f6; font-weight: 600;">$400B</span>
                            </div>
                        </div>
                    </div>

                    <!-- Tencent -->
                    <div class="dual-bar-row" style="margin-bottom: 0.75rem;">
                        <span class="company" style="width: 80px; font-weight: 600; font-size: 0.85rem;">Tencent</span>
                        <div class="dual-bars" style="flex: 1; display: flex; flex-direction: column; gap: 2px;">
                            <div style="display: flex; align-items: center; height: 18px;">
                                <div style="width: 3%; min-width: 4px; background: linear-gradient(90deg, #10b981, #34d399); border-radius: 3px; height: 100%;"></div>
                                <span style="margin-left: 6px; font-size: 0.7rem; color: #10b981; font-weight: 600;">1.3 GW</span>
                                <span style="font-size: 0.6rem; color: #64748b; margin-left: 4px;">(procurement)</span>
                            </div>
                            <div style="display: flex; align-items: center; height: 18px;">
                                <div style="width: 16%; background: linear-gradient(90deg, #3b82f6, #60a5fa); border-radius: 3px; height: 100%;"></div>
                                <span style="margin-left: 6px; font-size: 0.7rem; color: #3b82f6; font-weight: 600;">$635B</span>
                            </div>
                        </div>
                    </div>

                    <!-- Alibaba -->
                    <div class="dual-bar-row" style="margin-bottom: 0.75rem;">
                        <span class="company" style="width: 80px; font-weight: 600; font-size: 0.85rem;">Alibaba</span>
                        <div class="dual-bars" style="flex: 1; display: flex; flex-direction: column; gap: 2px;">
                            <div style="display: flex; align-items: center; height: 18px;">
                                <div style="width: 4%; min-width: 4px; background: linear-gradient(90deg, #10b981, #34d399); border-radius: 3px; height: 100%;"></div>
                                <span style="margin-left: 6px; font-size: 0.7rem; color: #10b981; font-weight: 600;">1.6 GW</span>
                                <span style="font-size: 0.6rem; color: #64748b; margin-left: 4px;">(procurement)</span>
                            </div>
                            <div style="display: flex; align-items: center; height: 18px;">
                                <div style="width: 10%; background: linear-gradient(90deg, #3b82f6, #60a5fa); border-radius: 3px; height: 100%;"></div>
                                <span style="margin-left: 6px; font-size: 0.7rem; color: #3b82f6; font-weight: 600;">$388B</span>
                            </div>
                        </div>
                    </div>

                    <!-- ByteDance -->
                    <div class="dual-bar-row" style="margin-bottom: 0.75rem;">
                        <span class="company" style="width: 80px; font-weight: 600; font-size: 0.85rem;">ByteDance</span>
                        <div class="dual-bars" style="flex: 1; display: flex; flex-direction: column; gap: 2px;">
                            <div style="display: flex; align-items: center; height: 18px;">
                                <div style="width: 3%; min-width: 4px; background: linear-gradient(90deg, #10b981, #34d399); border-radius: 3px; height: 100%;"></div>
                                <span style="margin-left: 6px; font-size: 0.7rem; color: #10b981; font-weight: 600;">1 GW</span>
                                <span style="font-size: 0.6rem; color: #64748b; margin-left: 4px;">(Brazil target)</span>
                            </div>
                            <div style="display: flex; align-items: center; height: 18px;">
                                <div style="width: 8%; background: linear-gradient(90deg, #8b5cf6, #a78bfa); border-radius: 3px; height: 100%;"></div>
                                <span style="margin-left: 6px; font-size: 0.7rem; color: #8b5cf6; font-weight: 600;">$315B</span>
                                <span style="font-size: 0.6rem; color: #64748b; margin-left: 4px;">(private)</span>
                            </div>
                        </div>
                    </div>

                    <!-- OpenAI -->
                    <div class="dual-bar-row" style="margin-bottom: 0.75rem;">
                        <span class="company" style="width: 80px; font-weight: 600; font-size: 0.85rem;">OpenAI</span>
                        <div class="dual-bars" style="flex: 1; display: flex; flex-direction: column; gap: 2px;">
                            <div style="display: flex; align-items: center; height: 18px;">
                                <div style="width: 15%; min-width: 4px; background: linear-gradient(90deg, #10b981, #34d399); border-radius: 3px; height: 100%;"></div>
                                <span style="margin-left: 6px; font-size: 0.7rem; color: #10b981; font-weight: 600;">5 GW</span>
                                <span style="font-size: 0.6rem; color: #64748b; margin-left: 4px;">(Stargate)</span>
                            </div>
                            <div style="display: flex; align-items: center; height: 18px;">
                                <div style="width: 19%; background: linear-gradient(90deg, #8b5cf6, #a78bfa); border-radius: 3px; height: 100%;"></div>
                                <span style="margin-left: 6px; font-size: 0.7rem; color: #8b5cf6; font-weight: 600;">$750B</span>
                                <span style="font-size: 0.6rem; color: #64748b; margin-left: 4px;">(private)</span>
                            </div>
                        </div>
                    </div>

                    <!-- Anthropic -->
                    <div class="dual-bar-row" style="margin-bottom: 0.75rem;">
                        <span class="company" style="width: 80px; font-weight: 600; font-size: 0.85rem;">Anthropic</span>
                        <div class="dual-bars" style="flex: 1; display: flex; flex-direction: column; gap: 2px;">
                            <div style="display: flex; align-items: center; height: 18px;">
                                <div style="width: 9%; min-width: 4px; background: linear-gradient(90deg, #10b981, #34d399); border-radius: 3px; height: 100%;"></div>
                                <span style="margin-left: 6px; font-size: 0.7rem; color: #10b981; font-weight: 600;">3 GW</span>
                                <span style="font-size: 0.6rem; color: #64748b; margin-left: 4px;">(via partners)</span>
                            </div>
                            <div style="display: flex; align-items: center; height: 18px;">
                                <div style="width: 9%; background: linear-gradient(90deg, #8b5cf6, #a78bfa); border-radius: 3px; height: 100%;"></div>
                                <span style="margin-left: 6px; font-size: 0.7rem; color: #8b5cf6; font-weight: 600;">$350B</span>
                                <span style="font-size: 0.6rem; color: #64748b; margin-left: 4px;">(private)</span>
                            </div>
                        </div>
                    </div>

                    <!-- xAI -->
                    <div class="dual-bar-row" style="margin-bottom: 0.75rem;">
                        <span class="company" style="width: 80px; font-weight: 600; font-size: 0.85rem;">xAI</span>
                        <div class="dual-bars" style="flex: 1; display: flex; flex-direction: column; gap: 2px;">
                            <div style="display: flex; align-items: center; height: 18px;">
                                <div style="width: 6%; min-width: 4px; background: linear-gradient(90deg, #10b981, #34d399); border-radius: 3px; height: 100%;"></div>
                                <span style="margin-left: 6px; font-size: 0.7rem; color: #10b981; font-weight: 600;">2 GW</span>
                                <span style="font-size: 0.6rem; color: #64748b; margin-left: 4px;">(Colossus)</span>
                            </div>
                            <div style="display: flex; align-items: center; height: 18px;">
                                <div style="width: 6%; background: linear-gradient(90deg, #8b5cf6, #a78bfa); border-radius: 3px; height: 100%;"></div>
                                <span style="margin-left: 6px; font-size: 0.7rem; color: #8b5cf6; font-weight: 600;">$230B</span>
                                <span style="font-size: 0.6rem; color: #64748b; margin-left: 4px;">(private)</span>
                            </div>
                        </div>
                    </div>

                    <p style="font-size: 0.75rem; color: #64748b; margin-top: 1rem;">
                        <strong>Sources:</strong> Amazon Sustainability 2025, Microsoft Datacenter Community, Google Environmental Reports, Meta Nuclear Deals Jan 2026, Oracle Stargate Partnership, BloombergNEF Corporate PPA Database, Alibaba/Tencent ESG Reports 2024, ByteDance Brazil Announcement Dec 2025, OpenAI Stargate Project, Anthropic Infrastructure Nov 2025, xAI Colossus Expansion.
                    </p>
                    <p style="font-size: 0.7rem; color: #94a3b8; margin-top: 0.5rem;">
                        <em>Note: GW figures represent contracted/owned renewable capacity or committed clean energy projects. Chinese companies (Alibaba, Tencent) figures converted from annual kWh procurement. Private company valuations from latest funding rounds. Market caps as of Feb 2026.</em>
                    </p>
                </div>

                <p>To put this in perspective: Amazon's 34 GW of renewable capacity is larger than the entire electricity generation capacity of <strong>Malaysia (35 GW)</strong>. These aren't paper commitments — they're contracted Power Purchase Agreements (PPAs) that provide the financial certainty needed for renewable projects to get built.</p>

                <h3>1.1.1 Beyond US/EU: Asian Tech Giants Leading Too</h3>

                <p>It's not just American Big Tech. Asian hyperscalers are making significant renewable commitments:</p>

                <div class="data-table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Company</th>
                                <th>Current RE %</th>
                                <th>2030 Target</th>
                                <th>Notable Projects</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Alibaba Cloud</strong></td>
                                <td>56%</td>
                                <td>100% clean energy</td>
                                <td>500 MW Hebei project, 20-year Jiangsu PPA</td>
                            </tr>
                            <tr>
                                <td><strong>Tencent</strong></td>
                                <td>54%</td>
                                <td>100% + carbon neutral</td>
                                <td>10.54 MW Tianjin solar microgrid, 1.3B kWh/year procurement</td>
                            </tr>
                            <tr>
                                <td><strong>ByteDance</strong></td>
                                <td>100% (Norway)</td>
                                <td>Expanding globally</td>
                                <td>$37.7B Brazil DC - 100% wind-powered</td>
                            </tr>
                        </tbody>
                    </table>
                    <p class="table-source">Sources: Alibaba ESG Report 2024, Tencent Carbon Neutrality Report, ByteDance Brazil Announcement 2025</p>
                </div>

                <h3>1.2 The PPA Revolution</h3>

                <p>Corporate Power Purchase Agreements have become the dominant mechanism for new renewable energy financing globally. According to <a href="https://about.bnef.com/corporate-energy-market-outlook/" target="_blank">BloombergNEF</a>:</p>

                <ul>
                    <li><strong>2024 Corporate PPA volume:</strong> 50+ GW globally — a record year</li>
                    <li><strong>Tech sector share:</strong> ~40% of all corporate PPAs</li>
                    <li><strong>Without tech PPAs:</strong> Renewable deployment would be significantly slower</li>
                </ul>

                <p>The mechanism matters: when Microsoft signs a 20-year PPA for a wind farm, that agreement provides the revenue certainty needed for developers to secure financing. The wind farm gets built. The grid gets cleaner. <strong>Everyone benefits from lower wholesale prices as more renewables come online.</strong></p>

                <h3>1.3 Beyond Renewables: The Nuclear Bet</h3>

                <p>What's particularly telling is Big Tech's willingness to fund <strong>nuclear energy</strong> — the only 24/7 carbon-free baseload source:</p>

                <div class="data-table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Company</th>
                                <th>Nuclear Initiative</th>
                                <th>Capacity</th>
                                <th>Investment/Status</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Meta</strong></td>
                                <td>TerraPower + Oklo + existing plants (Ohio)</td>
                                <td>6+ GW total</td>
                                <td>Largest nuclear deal package 2026</td>
                            </tr>
                            <tr>
                                <td><strong>Microsoft</strong></td>
                                <td>Three Mile Island Unit 1 restart (Constellation)</td>
                                <td>835 MW</td>
                                <td>20-year PPA, online by 2028</td>
                            </tr>
                            <tr>
                                <td><strong>Google</strong></td>
                                <td>Kairos Power SMRs + Elementl Power</td>
                                <td>500 MW + 1.8 GW</td>
                                <td>First unit 2030, full by 2035</td>
                            </tr>
                            <tr>
                                <td><strong>Amazon</strong></td>
                                <td>X-energy SMRs + Talen Energy nuclear PPA</td>
                                <td>960+ MW</td>
                                <td>~$500M+ committed</td>
                            </tr>
                            <tr>
                                <td><strong>Oracle</strong></td>
                                <td>3 SMRs powering 1 GW AI data center</td>
                                <td>1,000 MW</td>
                                <td>Permits secured, mid-2030s target</td>
                            </tr>
                        </tbody>
                    </table>
                    <p class="table-source">Sources: Meta nuclear deals Jan 2026, Microsoft/Constellation Sept 2024, Google/Kairos Oct 2024, Amazon nuclear 2024, Oracle SMR Sept 2024</p>
                </div>

                <p>Meta's January 2026 announcement is particularly striking: <strong>6+ GW of nuclear capacity</strong> across multiple partnerships — more than the entire nuclear fleet of some countries.</p>

                <h3>1.4 The New Players: AI-Native Companies</h3>

                <p>It's not just established hyperscalers. AI-native companies are making significant infrastructure investments:</p>

                <div class="comparison-grid" style="grid-template-columns: repeat(3, 1fr);">
                    <div class="comparison-card positive">
                        <h5>Anthropic</h5>
                        <div class="value" style="font-size: 1.5rem;">$50B</div>
                        <div class="unit">US infrastructure investment</div>
                        <p style="margin-top: 0.5rem; font-size: 0.8rem; color: #64748b;">3+ GW capacity via Google Cloud + AWS + Fluidstack. Texas & NY sites live 2026. 800 permanent + 2,400 construction jobs.</p>
                    </div>
                    <div class="comparison-card neutral">
                        <h5>xAI (Musk)</h5>
                        <div class="value" style="font-size: 1.5rem;">2 GW</div>
                        <div class="unit">Colossus expansion target</div>
                        <p style="margin-top: 0.5rem; font-size: 0.8rem; color: #64748b;">130 MW solar (30 MW adjacent + 100 MW farm). $439M USDA grant for battery storage. Gas turbines for baseload.</p>
                    </div>
                    <div class="comparison-card positive">
                        <h5>ByteDance/TikTok</h5>
                        <div class="value" style="font-size: 1.5rem;">$37.7B</div>
                        <div class="unit">Brazil data center (100% wind)</div>
                        <p style="margin-top: 0.5rem; font-size: 0.8rem; color: #64748b;">Ceará state, partnering with Casa dos Ventos. First Latin America facility. 100% renewable from wind farms.</p>
                    </div>
                </div>

                <blockquote>
                    "The tech industry is doing more to accelerate nuclear energy than any government policy in the past 30 years."
                    <br><span style="font-size: 0.9rem; color: #64748b;">— Nuclear Energy Institute analysis, 2025</span>
                </blockquote>

                <h2 id="section-3">2. Grid Modernization: The Infrastructure Nobody Else Would Fund</h2>

                <p>The "data centers raise your electricity bill" narrative focuses on transmission upgrades as a <em>cost</em>. But there's another way to look at it: <strong>data centers are funding grid modernization that utilities couldn't otherwise afford.</strong></p>

                <h3>2.1 The Load Factor Economics</h3>

                <p>Here's a fundamental truth about electricity grids that rarely gets discussed:</p>

                <div class="comparison-grid">
                    <div class="comparison-card positive">
                        <h5>Data Center Load Factor</h5>
                        <div class="value">85-95%</div>
                        <div class="unit">consistent, predictable demand</div>
                    </div>
                    <div class="comparison-card neutral">
                        <h5>Residential Load Factor</h5>
                        <div class="value">30-40%</div>
                        <div class="unit">peaks mornings/evenings, low overnight</div>
                    </div>
                </div>

                <p><strong>What this means:</strong> Data centers use electricity consistently 24/7, while residential demand spikes at breakfast and dinner, then crashes overnight. From a grid operator's perspective, data center load is <em>ideal</em> — it fills in the valleys that would otherwise go unused.</p>

                <p>According to the <a href="https://www.e3.com" target="_blank">Energy+Environmental Economics (E3)</a> study commissioned by Northern Virginia:</p>

                <div class="truth-box">
                    <h4>The Economic Surplus Finding</h4>
                    <p>Data centers generate approximately <span class="stat-highlight">$33,500 per MW</span> in annual grid surplus value.</p>
                    <p>This surplus comes from: paying full industrial rates + high capacity factors + minimal transmission line diversity needs.</p>
                    <p style="margin-top: 1rem; font-size: 0.85rem; color: #94a3b8;">This means data centers pay MORE into the grid than the cost of serving them.</p>
                </div>

                <h3>2.2 Transmission Investment Reality</h3>

                <p>Yes, PJM (the US's largest grid operator) is investing $5.9-6.7 billion in transmission upgrades. But consider:</p>

                <ul>
                    <li>These upgrades serve <strong>all customers</strong> in the region, not just data centers</li>
                    <li>The infrastructure enables more renewable energy integration</li>
                    <li>Without the investment trigger from data center demand, these upgrades might never happen</li>
                    <li>The upgraded grid is more resilient for <strong>everyone</strong></li>
                </ul>

                <p>The E3 study specifically found that Dominion Energy's data center customers are <strong>net contributors</strong> to the system, not net burdens. The industrial rates they pay exceed their proportional share of infrastructure costs.</p>

                <h3>2.3 Demand Response: A Grid Asset, Not a Liability</h3>

                <p>Modern data centers aren't just passive loads — they can act as <strong>grid assets</strong>:</p>

                <ul>
                    <li><strong>Demand response capability:</strong> Data centers can shed 10-20% of load within minutes during grid emergencies</li>
                    <li><strong>UPS battery systems:</strong> Potential grid stabilization resource (emerging technology)</li>
                    <li><strong>Predictable scheduling:</strong> Operators can shift non-critical workloads to off-peak hours</li>
                </ul>

                <p>According to the <a href="https://www.iea.org/reports/energy-and-ai" target="_blank">IEA</a>, global data center demand response potential is estimated at <strong>76-126 GW</strong> — equivalent to the peak demand of several major countries combined.</p>

                <h2 id="section-4">3. The Efficiency Revolution: Doing More with Less</h2>

                <p>While the narrative focuses on <em>total</em> data center energy consumption, it ignores a crucial trend: <strong>efficiency is improving dramatically.</strong></p>

                <h3>3.1 The PUE Journey</h3>

                <div class="comparison-grid">
                    <div class="comparison-card">
                        <h5>Avg. Data Center PUE (2010)</h5>
                        <div class="value" style="color: #dc2626;">>2.5</div>
                        <div class="unit">150%+ overhead for cooling/power</div>
                    </div>
                    <div class="comparison-card positive">
                        <h5>Avg. Data Center PUE (2024)</h5>
                        <div class="value">1.56</div>
                        <div class="unit">56% overhead — a massive improvement</div>
                    </div>
                    <div class="comparison-card positive">
                        <h5>Hyperscale Best-in-Class</h5>
                        <div class="value">1.1-1.2</div>
                        <div class="unit">Google, Microsoft, Meta facilities</div>
                    </div>
                </div>

                <p>This efficiency gain is enormous. If today's data centers operated at 2010 efficiency levels, they would consume <strong>60% more electricity</strong> than they actually do.</p>

                <h3>3.2 AI-Driven Efficiency Gains</h3>

                <p>Ironically, AI is being used to make data centers themselves more efficient:</p>

                <ul>
                    <li><strong>Google DeepMind:</strong> AI reduced cooling energy by <strong>40%</strong> at Google data centers</li>
                    <li><strong>Microsoft Project Natick:</strong> Underwater data centers achieved <strong>PUE of 1.07</strong></li>
                    <li><strong>Predictive cooling:</strong> ML models optimize HVAC based on weather, workload, and equipment state</li>
                </ul>

                <h3>3.3 Cloud vs. On-Premise: The Hidden Efficiency</h3>

                <p>Here's what the "data center electricity" debate often misses: <strong>cloud data centers are dramatically more efficient than the on-premise alternatives they replace.</strong></p>

                <div class="positive-box">
                    <p><strong>Key Finding:</strong> According to Lawrence Berkeley National Laboratory, migrating workloads from enterprise on-premise data centers to hyperscale cloud facilities reduces energy consumption by <strong>72-93%</strong> for the same computing tasks.</p>
                </div>

                <p>If every company ran its own inefficient server room instead of using AWS, Azure, or GCP, total global IT energy consumption would be <strong>significantly higher</strong>. Cloud concentration creates efficiency through:</p>

                <ul>
                    <li>Better server utilization (40-60% vs. 10-20% for enterprise servers)</li>
                    <li>Purpose-built cooling infrastructure</li>
                    <li>Economies of scale in equipment and operations</li>
                    <li>Latest-generation hardware deployment</li>
                </ul>

                <h2 id="section-5">4. Economic Value Creation: Beyond Electricity Bills</h2>

                <p>Focusing solely on electricity costs ignores the broader economic picture.</p>

                <h3>4.1 GDP and Productivity Impacts</h3>

                <p>According to Goldman Sachs' 2025 economic research:</p>

                <div class="truth-box">
                    <h4>AI Infrastructure Economic Impact</h4>
                    <p>AI-related capital expenditure is expected to contribute <span class="stat-highlight">1.1% to US GDP growth</span> in 2025-2026.</p>
                    <p>Generative AI applications are projected to add <span class="stat-highlight">$2.6-4.4 trillion annually</span> to the global economy.</p>
                </div>

                <p>The electricity used by AI data centers enables:</p>
                <ul>
                    <li>Medical diagnostics and drug discovery</li>
                    <li>Climate modeling and weather prediction</li>
                    <li>Productivity tools used by millions of workers</li>
                    <li>Scientific research acceleration</li>
                    <li>Manufacturing and logistics optimization</li>
                </ul>

                <p>Asking "why do data centers use so much electricity?" without asking "what value does that electricity generate?" is like asking "why do hospitals use so much electricity?" without considering the lives they save.</p>

                <h3>4.2 Southeast Asia FDI and Digital Economy</h3>

                <p>For Southeast Asia specifically, data center investment represents a massive economic opportunity:</p>

                <div class="data-table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Country</th>
                                <th>Big Tech Investment</th>
                                <th>Jobs Created</th>
                                <th>Digital Economy Contribution</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Malaysia</td>
                                <td>$16.9B (Microsoft, Google, AWS)</td>
                                <td>120,000+ (projected)</td>
                                <td>Target: 25.5% GDP by 2025</td>
                            </tr>
                            <tr>
                                <td>Indonesia</td>
                                <td>$10B+ (various)</td>
                                <td>100,000+ (projected)</td>
                                <td>$130B digital economy by 2025</td>
                            </tr>
                            <tr>
                                <td>Vietnam</td>
                                <td>$7B+ (announced)</td>
                                <td>50,000+ (projected)</td>
                                <td>Fastest growing in SEA</td>
                            </tr>
                            <tr>
                                <td>Thailand</td>
                                <td>$5B+ (various)</td>
                                <td>40,000+ (projected)</td>
                                <td>Digital hub strategy</td>
                            </tr>
                        </tbody>
                    </table>
                    <p class="table-source">Sources: Official government announcements, Google e-Conomy SEA Report 2025, individual company press releases</p>
                </div>

                <p>The SEA digital economy is projected to reach <strong>$300+ billion by 2025</strong>. This growth is enabled by data center infrastructure.</p>

                <h2 id="section-6">5. The Cost Allocation Reality: Who Actually Subsidizes Whom?</h2>

                <p>This is perhaps the most contentious point. The popular narrative says "citizens subsidize data centers." But the data suggests the opposite may be true.</p>

                <h3>5.1 Industrial vs. Residential Rates</h3>

                <p>Globally, industrial electricity consumers (including data centers) typically pay <strong>higher effective rates per kWh</strong> than residential consumers when all charges are included:</p>

                <ul>
                    <li>Industrial users pay full demand charges ($/kW)</li>
                    <li>Industrial users don't receive subsidized rates</li>
                    <li>Industrial users often face time-of-use penalties</li>
                    <li>Residential users receive tiered/subsidized rates in most countries</li>
                </ul>

                <p>In Indonesia specifically, the electricity generation cost is <strong>IDR 1,732/kWh</strong>, but residential tariffs average <strong>IDR 1,153/kWh</strong>. The difference is covered by:</p>
                <ol>
                    <li>Government subsidies (IDR 83 trillion budget)</li>
                    <li><strong>Cross-subsidies from industrial users paying higher rates</strong></li>
                </ol>

                <h3>5.2 The E3 Virginia Study Deep Dive</h3>

                <p>The Energy+Environmental Economics study for Virginia is particularly illuminating because it attempted to quantify <em>actual</em> cost allocation:</p>

                <div class="comparison-grid">
                    <div class="comparison-card positive">
                        <h5>Data Center Contribution</h5>
                        <div class="value">$33,500</div>
                        <div class="unit">net surplus per MW/year</div>
                    </div>
                    <div class="comparison-card neutral">
                        <h5>Revenue Contribution</h5>
                        <div class="value">20%+</div>
                        <div class="unit">of Dominion Energy revenue</div>
                    </div>
                </div>

                <p>The study found that data center customers generate a <strong>net positive value</strong> for the grid because:</p>
                <ul>
                    <li>They pay full industrial rates without subsidies</li>
                    <li>Their high load factor maximizes infrastructure utilization</li>
                    <li>They fund their own interconnection costs</li>
                    <li>They don't require the same distribution network density as residential</li>
                </ul>

                <h3>5.3 The Uncomfortable Implication</h3>

                <p>If the E3 analysis is correct, then the narrative is exactly backwards: <strong>data centers are subsidizing residential customers</strong>, not the other way around.</p>

                <p>This doesn't mean infrastructure investments are free — but it does mean the cost allocation debate deserves more nuance than "tech giants are stealing from families."</p>

                <h2 id="section-7">6. The 15-Why Counter-Analysis</h2>

                <p>In my previous article, I used a "15-Why" analysis to trace how data center costs flow to consumers. Here's the devil's advocate version:</p>

                <h3>Starting Point: Grid infrastructure is being modernized</h3>

                <ol>
                    <li><strong>Why is infrastructure being upgraded?</strong> — Growing demand from all sectors, plus aging infrastructure</li>
                    <li><strong>Why is demand growing?</strong> — Electrification of transport, buildings, and industry; digital transformation</li>
                    <li><strong>Why is digital transformation accelerating?</strong> — AI, cloud computing, remote work, digital services</li>
                    <li><strong>Why do these need data centers?</strong> — Computing requires physical infrastructure</li>
                    <li><strong>Who pays for new infrastructure?</strong> — Those who trigger the investment pay connection costs; all users share transmission</li>
                    <li><strong>Who benefits from grid modernization?</strong> — All grid users get improved reliability and renewable integration</li>
                    <li><strong>What would happen without data center investment?</strong> — Slower renewable deployment, delayed grid upgrades</li>
                    <li><strong>Why do utilities want data centers?</strong> — High-margin, predictable customers that improve load factor</li>
                    <li><strong>Why do states compete for data centers?</strong> — Jobs, tax revenue, tech ecosystem development</li>
                    <li><strong>Who really bears infrastructure costs?</strong> — Primarily those who trigger the investment (data centers)</li>
                    <li><strong>Why do residential rates rise?</strong> — Fuel costs, general inflation, deferred maintenance — not primarily data centers</li>
                    <li><strong>What do data centers pay?</strong> — Full industrial rates, demand charges, interconnection costs</li>
                    <li><strong>Do data centers receive subsidies?</strong> — Tax incentives exist, but not electricity subsidies like residential</li>
                    <li><strong>What's the net economic impact?</strong> — Positive when jobs, GDP, and grid investment are counted</li>
                    <li><strong>Why is the narrative so one-sided?</strong> — Electricity bills are visible; renewable investment, efficiency gains, and economic benefits are less visible</li>
                </ol>

                <!-- CTA Teaser Block -->
                <div class="opm-cta-block">
                    <p class="opm-cta-headline"><i class="fas fa-brain" style="color:#10b981;margin-right:6px;"></i> Strategic Intelligence Engine</p>
                    <p class="opm-cta-sub">Unlock 8-dimension maturity analysis, EED/AI Act compliance scoring, Monte Carlo simulation with 10,000 iterations, and board-ready PDF export.</p>
                    <a href="#section-8" class="opm-cta-btn"><i class="fas fa-calculator" style="margin-right:6px;"></i> Open Maturity Calculator</a>
                </div>

                <h2 id="section-8">7. Interactive Calculator: Comprehensive Value Generation Analysis</h2>

                <p>This advanced calculator quantifies the full economic ecosystem impact of data center investment. Configure your scenario with detailed parameters to see renewable investment, grid economics, job creation, and environmental benefits.</p>

                <!-- Calculator Section 1: Configuration -->
                <div class="value-calculator" id="valueCalc">
                    <div class="calc-title">
                        <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="#34d399" stroke-width="2">
                            <path d="M12 2v20M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/>
                        </svg>
                        Data Center Economic Value Simulator
                    </div>
                    <p class="calc-subtitle">Configure detailed parameters to simulate economic, environmental, and grid impact</p>

                    <!-- Pro Mode Toolbar -->
                    <div class="opm-toolbar-row">
                        <div class="opm-mode-bar">
                            <div class="opm-mode-toggle">
                                <button class="opm-mode-btn active" id="opmFreeBtn" onclick="opmSetMode('free')">Free Mode</button>
                                <button class="opm-mode-btn" id="opmProBtn" onclick="opmSetMode('pro')">Pro Analysis</button>
                            </div>
                        </div>
                        <div class="opm-toolbar-actions">
                            <button class="opm-btn-pdf" id="opmPdfBtn" onclick="opmExportPDF()" style="display:none"><i class="fas fa-file-pdf"></i> Export PDF</button>
                            <span class="opm-privacy-badge"><i class="fas fa-shield-alt"></i> Client-Side Only</span>
                        </div>
                    </div>

                    <!-- Tab Navigation -->
                    <div class="calc-tabs" style="display: flex; gap: 0.5rem; margin-bottom: 1.5rem; flex-wrap: wrap;">
                        <button type="button" class="calc-tab active" data-tab="basic" onclick="switchCalcTab('basic')" style="padding: 0.5rem 1rem; border-radius: 8px; border: 1px solid rgba(16,185,129,0.3); background: rgba(16,185,129,0.2); color: #34d399; cursor: pointer; font-weight: 600;">Basic Config</button>
                        <button type="button" class="calc-tab" data-tab="advanced" onclick="switchCalcTab('advanced')" style="padding: 0.5rem 1rem; border-radius: 8px; border: 1px solid rgba(255,255,255,0.2); background: transparent; color: #94a3b8; cursor: pointer;">Advanced</button>
                        <button type="button" class="calc-tab" data-tab="comparison" onclick="switchCalcTab('comparison')" style="padding: 0.5rem 1rem; border-radius: 8px; border: 1px solid rgba(255,255,255,0.2); background: transparent; color: #94a3b8; cursor: pointer;">Scenario Compare</button>
                    </div>

                    <!-- Basic Configuration Tab -->
                    <div class="calc-tab-content" id="tab-basic">
                        <div class="calc-grid" style="grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));">
                            <div class="calc-input-group">
                                <label for="calcCountry" title="Select deployment location. Each region has different electricity rates, carbon intensity, and cost structures.">Country / Region <span class="tooltip-icon">?</span></label>
                                <select id="calcCountry" onchange="calculateValueAdvanced()" title="Affects electricity cost ($0.055-0.22/kWh), carbon intensity (320-620 gCO2/kWh), and economic multipliers">
                                    <option value="indonesia">Indonesia (IDR 1,153/kWh)</option>
                                    <option value="malaysia">Malaysia (MYR 0.40/kWh)</option>
                                    <option value="singapore">Singapore (SGD 0.33/kWh)</option>
                                    <option value="thailand">Thailand (THB 3.99/kWh)</option>
                                    <option value="vietnam">Vietnam (VND 2,204/kWh)</option>
                                    <option value="philippines">Philippines (PHP 13/kWh)</option>
                                    <option value="us_virginia">US - Virginia (Data Center Alley)</option>
                                    <option value="us_texas">US - Texas (ERCOT Grid)</option>
                                    <option value="eu_ireland">EU - Ireland (Low Carbon)</option>
                                    <option value="eu_netherlands">EU - Netherlands (High RE)</option>
                                </select>
                            </div>
                            <div class="calc-input-group">
                                <label for="dcCapacityMW" title="Total IT equipment power capacity. This is the power consumed by servers, storage, and networking - not including cooling overhead.">IT Load Capacity (MW) <span class="tooltip-icon">?</span></label>
                                <input type="number" id="dcCapacityMW" value="100" min="1" max="2000" onchange="calculateValueAdvanced()" title="Example: Google's largest DC ~100MW, xAI Colossus 250MW, typical enterprise 5-20MW">
                                <span style="font-size: 0.7rem; color: #64748b;">Enterprise: 5-20MW | Hyperscale: 50-500MW</span>
                            </div>
                            <div class="calc-input-group">
                                <label for="dcType" title="Data center business model affects CAPEX ($10-18M/MW), job density, and typical PUE range.">Data Center Type <span class="tooltip-icon">?</span></label>
                                <select id="dcType" onchange="calculateValueAdvanced()" title="Hyperscale: lowest PUE, highest efficiency. AI/HPC: highest power density, needs liquid cooling">
                                    <option value="hyperscale">Hyperscale (Google/AWS/Azure/Alibaba)</option>
                                    <option value="colocation">Colocation (Equinix/Digital Realty)</option>
                                    <option value="enterprise">Enterprise (Private/On-premise DC)</option>
                                    <option value="ai_hpc">AI/HPC Focused (NVIDIA GPU clusters)</option>
                                </select>
                            </div>
                            <div class="calc-input-group">
                                <label for="renewableTarget" title="Corporate renewable energy commitment level. 24/7 CFE requires 1.5x overbuild, Annual Match requires 1.2x.">Renewable Energy Target <span class="tooltip-icon">?</span></label>
                                <select id="renewableTarget" onchange="calculateValueAdvanced()" title="Higher targets = more PPA investment, lower carbon emissions, better ESG ratings">
                                    <option value="100">100% 24/7 CFE (Google/Meta standard)</option>
                                    <option value="100_annual">100% Annual Match (Microsoft)</option>
                                    <option value="80">80% Renewable (Amazon target)</option>
                                    <option value="50">50% Renewable (Alibaba current)</option>
                                    <option value="grid">Grid Default (No commitment)</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Advanced Configuration Tab -->
                    <div class="calc-tab-content" id="tab-advanced" style="display: none;">
                        <div class="calc-grid" style="grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));">
                            <div class="calc-input-group">
                                <label for="pueTarget" title="Power Usage Effectiveness = Total Facility Power / IT Equipment Power. Lower is better. PUE 1.2 means 20% overhead for cooling & power distribution.">PUE (Power Usage Effectiveness) <span class="tooltip-icon">?</span></label>
                                <select id="pueTarget" onchange="calculateValueAdvanced()" title="Google averages 1.10, Industry average 1.56, Legacy can exceed 2.0">
                                    <option value="1.1">1.10 (Best-in-class: Google, Meta)</option>
                                    <option value="1.2" selected>1.20 (Modern hyperscale standard)</option>
                                    <option value="1.4">1.40 (Good colocation facility)</option>
                                    <option value="1.56">1.56 (Global industry average 2024)</option>
                                    <option value="1.8">1.80 (Legacy enterprise DC)</option>
                                    <option value="2.0">2.00+ (Inefficient legacy facility)</option>
                                </select>
                            </div>
                            <div class="calc-input-group">
                                <label for="capacityFactor" title="Average IT load as % of max capacity. DC typically runs 80-95% (high load factor), residential only 30-40%. Higher = better grid economics.">Capacity Utilization (%) <span class="tooltip-icon">?</span></label>
                                <input type="range" id="capacityFactor" min="50" max="95" value="85" onchange="updateCapacityLabel(); calculateValueAdvanced();" style="width: 100%;" title="Data centers: 80-95% | Residential: 30-40%">
                                <span id="capacityLabel" style="font-size: 0.8rem; color: #34d399;">85%</span>
                            </div>
                            <div class="calc-input-group">
                                <label for="projectYears" title="Time horizon for economic analysis. PPAs typically 10-20 years. Infrastructure asset life 20-25 years.">Analysis Period (Years) <span class="tooltip-icon">?</span></label>
                                <select id="projectYears" onchange="calculateValueAdvanced()" title="Longer periods show compounding benefits of renewable investment">
                                    <option value="1">1 Year (Annual snapshot)</option>
                                    <option value="5">5 Years (Medium-term)</option>
                                    <option value="10" selected>10 Years (Standard PPA term)</option>
                                    <option value="20">20 Years (Long-term PPA)</option>
                                    <option value="25">25 Years (Full asset lifecycle)</option>
                                </select>
                            </div>
                            <div class="calc-input-group">
                                <label for="coolingType" title="Cooling method impacts PUE and water usage. Liquid cooling essential for AI/GPU racks (40-100kW/rack). Air cooling for standard servers.">Cooling Technology <span class="tooltip-icon">?</span></label>
                                <select id="coolingType" onchange="calculateValueAdvanced()" title="AI workloads require liquid cooling due to high power density">
                                    <option value="liquid">Direct Liquid Cooling (AI/HPC: 40-100kW/rack)</option>
                                    <option value="air_hot_aisle" selected>Air Cooling - Hot Aisle (Standard: 10-20kW/rack)</option>
                                    <option value="evaporative">Evaporative Cooling (High WUE)</option>
                                    <option value="free_cooling">Free Cooling (Cold climates only)</option>
                                </select>
                            </div>
                            <div class="calc-input-group">
                                <label for="gridConnection" title="How DC connects to power grid. Dedicated substation = DC funds infrastructure. Behind-meter = on-site generation.">Grid Connection Type <span class="tooltip-icon">?</span></label>
                                <select id="gridConnection" onchange="calculateValueAdvanced()" title="Affects who pays for transmission infrastructure">
                                    <option value="dedicated">Dedicated Substation (DC self-funded)</option>
                                    <option value="shared" selected>Shared Transmission (Rate-based)</option>
                                    <option value="behind_meter">Behind-the-Meter (On-site solar/storage)</option>
                                </select>
                            </div>
                            <div class="calc-input-group">
                                <label for="demandResponse" title="DC's ability to reduce load during grid emergencies. Provides grid services revenue and improves reliability. Valued at ~$50K/MW/year.">Demand Response Participation <span class="tooltip-icon">?</span></label>
                                <select id="demandResponse" onchange="calculateValueAdvanced()" title="Full DR: 10-20% load shed capability earns ~$50K/MW/year">
                                    <option value="full">Full (10-20% load flexibility, ~$50K/MW/yr)</option>
                                    <option value="partial" selected>Partial (5-10% flexibility)</option>
                                    <option value="none">None (No grid services)</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Scenario Comparison Tab -->
                    <div class="calc-tab-content" id="tab-comparison" style="display: none;">
                        <p style="color: #94a3b8; margin-bottom: 1rem;">Compare your configured scenario against industry benchmarks:</p>
                        <div id="scenarioComparison" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1rem;">
                            <!-- Will be populated by JS -->
                        </div>
                    </div>

                    <button type="button" class="calc-button" onclick="calculateValueAdvanced(); scrollToResults();" style="margin-top: 1.5rem;">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M12 2v20M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/>
                        </svg>
                        Calculate Full Impact Analysis
                    </button>
                    <p style="font-size: 0.75rem; color: #6ee7b7; margin-top: 0.75rem; text-align: center;">
                        <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="vertical-align: middle; margin-right: 4px;">
                            <path d="M12 5v14M5 12l7 7 7-7"/>
                        </svg>
                        Results will appear below after calculation
                    </p>
                </div>

                <!-- Results Section: Economic Impact -->
                <div id="resultsSection" class="value-calculator" style="margin-top: 1.5rem; background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);">
                    <h4 style="color: #34d399; margin-bottom: 1.5rem; display: flex; align-items: center; gap: 0.5rem;">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <rect x="1" y="4" width="22" height="16" rx="2" ry="2"></rect>
                            <line x1="1" y1="10" x2="23" y2="10"></line>
                        </svg>
                        Economic Value Generation
                    </h4>
                    <div class="calc-results" style="grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));">
                        <div class="calc-result-item">
                            <div class="label">CAPEX Investment</div>
                            <div class="value blue" id="capexInvestment">$1.2B</div>
                            <div class="subtext">DC construction cost</div>
                        </div>
                        <div class="calc-result-item">
                            <div class="label">Annual OPEX</div>
                            <div class="value" id="annualOpex">$85M</div>
                            <div class="subtext">operating expenses/year</div>
                        </div>
                        <div class="calc-result-item">
                            <div class="label">Annual Energy Spend</div>
                            <div class="value yellow" id="annualEnergy">$72M</div>
                            <div class="subtext">electricity cost/year</div>
                        </div>
                        <div class="calc-result-item">
                            <div class="label">Tax Revenue (Est.)</div>
                            <div class="value" id="taxRevenue">$15M</div>
                            <div class="subtext">to local/national gov</div>
                        </div>
                        <div class="calc-result-item">
                            <div class="label">Direct Jobs</div>
                            <div class="value" id="directJobs">150</div>
                            <div class="subtext">permanent positions</div>
                        </div>
                        <div class="calc-result-item">
                            <div class="label">Indirect Jobs</div>
                            <div class="value" id="indirectJobs">650</div>
                            <div class="subtext">supply chain + services</div>
                        </div>
                    </div>

                    <!-- Economic Impact Visualization -->
                    <div style="margin-top: 2rem; padding: 1.5rem; background: rgba(0,0,0,0.3); border-radius: 12px;">
                        <h5 style="color: #e5e7eb; margin-bottom: 1rem; font-size: 0.9rem;">Economic Multiplier Effect (10-Year Projection)</h5>
                        <div id="economicBars">
                            <div style="display: flex; align-items: center; gap: 1rem; margin: 0.75rem 0;">
                                <span style="width: 120px; color: #94a3b8; font-size: 0.8rem;">Direct Impact</span>
                                <div style="flex: 1; height: 24px; background: #1e293b; border-radius: 4px; overflow: hidden;">
                                    <div id="directBar" style="height: 100%; background: linear-gradient(90deg, #10b981, #34d399); width: 40%; display: flex; align-items: center; justify-content: flex-end; padding-right: 8px; transition: width 0.5s ease;">
                                        <span style="color: #fff; font-size: 0.7rem; font-weight: 600;">$1.2B</span>
                                    </div>
                                </div>
                            </div>
                            <div style="display: flex; align-items: center; gap: 1rem; margin: 0.75rem 0;">
                                <span style="width: 120px; color: #94a3b8; font-size: 0.8rem;">Indirect Impact</span>
                                <div style="flex: 1; height: 24px; background: #1e293b; border-radius: 4px; overflow: hidden;">
                                    <div id="indirectBar" style="height: 100%; background: linear-gradient(90deg, #06b6d4, #38bdf8); width: 60%; display: flex; align-items: center; justify-content: flex-end; padding-right: 8px; transition: width 0.5s ease;">
                                        <span style="color: #fff; font-size: 0.7rem; font-weight: 600;">$1.8B</span>
                                    </div>
                                </div>
                            </div>
                            <div style="display: flex; align-items: center; gap: 1rem; margin: 0.75rem 0;">
                                <span style="width: 120px; color: #94a3b8; font-size: 0.8rem;">Induced Impact</span>
                                <div style="flex: 1; height: 24px; background: #1e293b; border-radius: 4px; overflow: hidden;">
                                    <div id="inducedBar" style="height: 100%; background: linear-gradient(90deg, #f59e0b, #fbbf24); width: 30%; display: flex; align-items: center; justify-content: flex-end; padding-right: 8px; transition: width 0.5s ease;">
                                        <span style="color: #fff; font-size: 0.7rem; font-weight: 600;">$0.9B</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <p style="color: #64748b; font-size: 0.75rem; margin-top: 1rem;">Economic multiplier: 1.5-2.5x based on regional input-output analysis (IMPLAN methodology)</p>
                    </div>
                </div>

                <!-- Results Section: Renewable & Grid Impact -->
                <div class="value-calculator" style="margin-top: 1.5rem; background: linear-gradient(135deg, #022c22 0%, #064e3b 100%);">
                    <h4 style="color: #34d399; margin-bottom: 1.5rem; display: flex; align-items: center; gap: 0.5rem;">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="12" cy="12" r="5"></circle>
                            <line x1="12" y1="1" x2="12" y2="3"></line>
                            <line x1="12" y1="21" x2="12" y2="23"></line>
                            <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                            <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                            <line x1="1" y1="12" x2="3" y2="12"></line>
                            <line x1="21" y1="12" x2="23" y2="12"></line>
                        </svg>
                        Renewable Energy & Grid Value
                    </h4>
                    <div class="calc-results" style="grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));">
                        <div class="calc-result-item">
                            <div class="label">Renewable PPA Capacity</div>
                            <div class="value" id="ppaCapacity">150 MW</div>
                            <div class="subtext">solar/wind contracted</div>
                        </div>
                        <div class="calc-result-item">
                            <div class="label">PPA Investment Value</div>
                            <div class="value blue" id="ppaValue">$67.5M</div>
                            <div class="subtext">20-year contract value</div>
                        </div>
                        <div class="calc-result-item">
                            <div class="label">Grid Surplus Value</div>
                            <div class="value" id="gridSurplus">$3.35M</div>
                            <div class="subtext">annual (E3 methodology)</div>
                        </div>
                        <div class="calc-result-item">
                            <div class="label">Demand Response Value</div>
                            <div class="value yellow" id="drValue">$850K</div>
                            <div class="subtext">annual grid services</div>
                        </div>
                        <div class="calc-result-item">
                            <div class="label">Load Factor Benefit</div>
                            <div class="value" id="loadFactorBenefit">+$2.1M</div>
                            <div class="subtext">vs. residential equivalent</div>
                        </div>
                        <div class="calc-result-item">
                            <div class="label">Grid Reliability Index</div>
                            <div class="value" id="reliabilityIndex">+0.12%</div>
                            <div class="subtext">system improvement</div>
                        </div>
                    </div>

                    <!-- Load Factor Comparison Visualization -->
                    <div style="margin-top: 2rem; padding: 1.5rem; background: rgba(0,0,0,0.3); border-radius: 12px;">
                        <h5 style="color: #e5e7eb; margin-bottom: 1rem; font-size: 0.9rem;">Load Factor Comparison: Data Center vs Residential</h5>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem;">
                            <div style="text-align: center;">
                                <div style="width: 120px; height: 120px; margin: 0 auto; position: relative;">
                                    <svg viewBox="0 0 36 36" style="transform: rotate(-90deg);">
                                        <path d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831" fill="none" stroke="#1e293b" stroke-width="3"/>
                                        <path id="dcLoadCircle" d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831" fill="none" stroke="#10b981" stroke-width="3" stroke-dasharray="85, 100"/>
                                    </svg>
                                    <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); text-align: center;">
                                        <div id="dcLoadPct" style="font-size: 1.5rem; font-weight: 700; color: #10b981;">85%</div>
                                        <div style="font-size: 0.6rem; color: #94a3b8;">Load Factor</div>
                                    </div>
                                </div>
                                <p style="color: #e5e7eb; font-size: 0.85rem; margin-top: 0.5rem;">Data Center</p>
                                <p style="color: #64748b; font-size: 0.7rem;">24/7 consistent demand</p>
                            </div>
                            <div style="text-align: center;">
                                <div style="width: 120px; height: 120px; margin: 0 auto; position: relative;">
                                    <svg viewBox="0 0 36 36" style="transform: rotate(-90deg);">
                                        <path d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831" fill="none" stroke="#1e293b" stroke-width="3"/>
                                        <path d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831" fill="none" stroke="#f59e0b" stroke-width="3" stroke-dasharray="35, 100"/>
                                    </svg>
                                    <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); text-align: center;">
                                        <div style="font-size: 1.5rem; font-weight: 700; color: #f59e0b;">35%</div>
                                        <div style="font-size: 0.6rem; color: #94a3b8;">Load Factor</div>
                                    </div>
                                </div>
                                <p style="color: #e5e7eb; font-size: 0.85rem; margin-top: 0.5rem;">Residential</p>
                                <p style="color: #64748b; font-size: 0.7rem;">Peak morning/evening</p>
                            </div>
                        </div>
                        <p style="color: #64748b; font-size: 0.75rem; margin-top: 1rem; text-align: center;">Higher load factor = better grid infrastructure utilization = lower cost per kWh delivered</p>
                    </div>
                </div>

                <!-- Results Section: Environmental Impact -->
                <div class="value-calculator" style="margin-top: 1.5rem; background: linear-gradient(135deg, #1e3a5f 0%, #0b1220 100%);">
                    <h4 style="color: #38bdf8; margin-bottom: 1.5rem; display: flex; align-items: center; gap: 0.5rem;">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M12 22c5.523 0 10-4.477 10-10S17.523 2 12 2 2 6.477 2 12s4.477 10 10 10z"></path>
                            <path d="M12 8v8M8 12h8"></path>
                        </svg>
                        Environmental Impact Analysis
                    </h4>
                    <div class="calc-results" style="grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));">
                        <div class="calc-result-item">
                            <div class="label">Annual Energy Use</div>
                            <div class="value" id="annualEnergy2">744</div>
                            <div class="subtext">GWh/year</div>
                        </div>
                        <div class="calc-result-item">
                            <div class="label">Grid Carbon Intensity</div>
                            <div class="value yellow" id="carbonIntensity">610</div>
                            <div class="subtext">gCO2/kWh</div>
                        </div>
                        <div class="calc-result-item">
                            <div class="label">Baseline Emissions</div>
                            <div class="value" style="color: #f87171;" id="baselineEmissions">454K</div>
                            <div class="subtext">tons CO2/year</div>
                        </div>
                        <div class="calc-result-item">
                            <div class="label">With Renewables</div>
                            <div class="value" id="renewableEmissions">0</div>
                            <div class="subtext">tons CO2/year</div>
                        </div>
                        <div class="calc-result-item">
                            <div class="label">CO2 Avoided</div>
                            <div class="value" style="color: #34d399;" id="co2Avoided">454K</div>
                            <div class="subtext">tons/year</div>
                        </div>
                        <div class="calc-result-item">
                            <div class="label">Equivalent Trees</div>
                            <div class="value" id="treesEquiv">20.6M</div>
                            <div class="subtext">trees for 1 year</div>
                        </div>
                    </div>

                    <!-- PUE Efficiency Comparison -->
                    <div style="margin-top: 2rem; padding: 1.5rem; background: rgba(0,0,0,0.3); border-radius: 12px;">
                        <h5 style="color: #e5e7eb; margin-bottom: 1rem; font-size: 0.9rem;">Energy Efficiency: Your PUE vs Industry</h5>
                        <div id="pueComparison">
                            <div style="display: flex; align-items: center; gap: 0.5rem; margin: 0.5rem 0;">
                                <span style="width: 140px; color: #94a3b8; font-size: 0.75rem;">Your Config</span>
                                <div style="flex: 1; height: 20px; background: #1e293b; border-radius: 4px; position: relative;">
                                    <div id="yourPueBar" style="position: absolute; left: 0; top: 0; height: 100%; background: #10b981; border-radius: 4px; width: 40%;"></div>
                                    <div id="yourPueMarker" style="position: absolute; top: -4px; height: 28px; width: 3px; background: #10b981; border-radius: 2px; left: 40%;"></div>
                                </div>
                                <span id="yourPueValue" style="width: 50px; color: #10b981; font-size: 0.8rem; font-weight: 600;">1.20</span>
                            </div>
                            <div style="display: flex; align-items: center; gap: 0.5rem; margin: 0.5rem 0;">
                                <span style="width: 140px; color: #94a3b8; font-size: 0.75rem;">Industry Avg (2024)</span>
                                <div style="flex: 1; height: 20px; background: #1e293b; border-radius: 4px; position: relative;">
                                    <div style="position: absolute; left: 0; top: 0; height: 100%; background: #f59e0b; border-radius: 4px; width: 56%;"></div>
                                </div>
                                <span style="width: 50px; color: #f59e0b; font-size: 0.8rem; font-weight: 600;">1.56</span>
                            </div>
                            <div style="display: flex; align-items: center; gap: 0.5rem; margin: 0.5rem 0;">
                                <span style="width: 140px; color: #94a3b8; font-size: 0.75rem;">Legacy DC (2010)</span>
                                <div style="flex: 1; height: 20px; background: #1e293b; border-radius: 4px; position: relative;">
                                    <div style="position: absolute; left: 0; top: 0; height: 100%; background: #ef4444; border-radius: 4px; width: 100%;"></div>
                                </div>
                                <span style="width: 50px; color: #ef4444; font-size: 0.8rem; font-weight: 600;">2.50</span>
                            </div>
                        </div>
                        <p id="pueEfficiencySummary" style="color: #34d399; font-size: 0.8rem; margin-top: 1rem; text-align: center;">Your PUE of 1.20 saves 23% energy vs industry average</p>
                    </div>
                </div>

                <!-- Summary Card -->
                <div class="positive-box" style="margin-top: 2rem; background: linear-gradient(135deg, #022c22 0%, #064e3b 100%); border-color: #10b981;">
                    <h4 style="color: #34d399; margin-bottom: 1rem;">Summary: Net Value Assessment</h4>
                    <div id="summaryText" style="color: #d1fae5;">
                        <p style="margin-bottom: 0.5rem;"><strong>Total Economic Impact (10-year):</strong> <span id="totalEconomic">$3.9B</span></p>
                        <p style="margin-bottom: 0.5rem;"><strong>Total Jobs Enabled:</strong> <span id="totalJobs">800</span> (direct + indirect)</p>
                        <p style="margin-bottom: 0.5rem;"><strong>Renewable Capacity Funded:</strong> <span id="totalRenewable">150 MW</span></p>
                        <p style="margin-bottom: 0.5rem;"><strong>Carbon Avoided (10-year):</strong> <span id="totalCarbon">4.5M tons</span> CO2</p>
                        <p style="margin-bottom: 0;"><strong>Grid Surplus Generated:</strong> <span id="totalGridSurplus">$33.5M</span> over analysis period</p>
                    </div>
                </div>

                <p style="font-size: 0.75rem; color: #64748b; margin-top: 1.5rem; text-align: center; padding: 1rem; background: rgba(0,0,0,0.05); border-radius: 8px;">
                    <strong>Methodology & Sources:</strong> CAPEX uses Uptime Institute benchmark ($10-15M/MW for hyperscale). Jobs calculated using IMPLAN economic multipliers.
                    PPA investment assumes $450K/MW installed solar. Grid surplus from E3 Virginia study ($33,500/MW/year). Carbon intensity from IEA national grid data 2024.
                    Economic multipliers: 1.5x direct, 2.5x total based on regional input-output analysis. Renewable overbuild factor: 1.5x for 100% match due to intermittency.
                </p>

                <!-- ===== PRO MODE: Strategic Inputs ===== -->
                <div class="opm-pro-inputs" id="opmProInputs">
                    <h4><i class="fas fa-sliders-h"></i> Strategic Maturity Inputs</h4>
                    <div class="opm-input-grid">
                        <div class="opm-input-group">
                            <label for="opmRegion" title="Deployment region affects regulatory requirements (EU EED/AI Act), energy costs, carbon intensity, and labor rates.">Region / Location <span class="opm-tooltip-icon" title="Region determines regulatory regime (EU EED Article 12 mandatory for EU), grid carbon intensity, energy rates, water stress index, and local labor costs.">?</span></label>
                            <select id="opmRegion" onchange="opmRecalc()">
                                <option value="EU-Germany">EU - Germany</option>
                                <option value="EU-Ireland">EU - Ireland</option>
                                <option value="EU-Nordics">EU - Nordics</option>
                                <option value="SEA-Singapore">SEA - Singapore</option>
                                <option value="SEA-Indonesia">SEA - Indonesia</option>
                                <option value="US-Virginia" selected>US - Virginia</option>
                                <option value="US-Oregon">US - Oregon</option>
                                <option value="Middle-East">Middle East</option>
                            </select>
                        </div>
                        <div class="opm-input-group">
                            <label for="opmTier" title="Uptime Institute Tier classification determines redundancy, expected availability, and baseline MTBF/MTTR assumptions.">Infrastructure Tier <span class="opm-tooltip-icon" title="Tier I: 99.671% (no redundancy). Tier II: 99.741% (partial). Tier III: 99.982% (concurrent maintenance). Tier IV: 99.995% (fault tolerant). Higher tier = higher CAPEX but lower risk.">?</span></label>
                            <select id="opmTier" onchange="opmRecalc()">
                                <option value="1">Tier I - Basic</option>
                                <option value="2">Tier II - Redundant</option>
                                <option value="3" selected>Tier III - Concurrently Maintainable</option>
                                <option value="4">Tier IV - Fault Tolerant</option>
                            </select>
                        </div>
                        <div class="opm-input-group">
                            <label for="opmITLoad" title="Total IT power capacity in megawatts. Determines scale of operations and regulatory reporting requirements.">Total IT Load (MW) <span class="opm-tooltip-icon" title="Total IT equipment power. EED Article 12 reporting mandatory for EU DCs >500kW. Larger facilities have economies of scale but higher regulatory burden.">?</span></label>
                            <input type="number" id="opmITLoad" value="10" min="0.5" max="100" step="0.5" onchange="opmRecalc()">
                        </div>
                        <div class="opm-input-group">
                            <label for="opmPUE" title="Current Power Usage Effectiveness. Industry average 1.56, best-in-class 1.10. Directly impacts energy cost and carbon footprint.">Current PUE <span class="opm-tooltip-icon" title="PUE = Total Facility Power / IT Power. 1.0 is theoretical perfect. Google averages 1.10, industry avg 1.56. Each 0.1 PUE improvement saves ~6-8% energy costs.">?</span></label>
                            <input type="number" id="opmPUE" value="1.45" min="1.1" max="3.0" step="0.01" onchange="opmRecalc()">
                        </div>
                        <div class="opm-input-group">
                            <label for="opmStaffCount" title="Full-time equivalent staff and annual voluntary turnover rate. Affects labor costs and operational maturity.">Staff Count <span class="opm-tooltip-icon" title="FTE headcount for facility operations. Industry benchmark: 0.5-2.5 FTE per MW depending on tier and automation level. High turnover (>25%) indicates culture or compensation issues.">?</span></label>
                            <input type="number" id="opmStaffCount" value="50" min="5" max="500" step="1" onchange="opmRecalc()">
                        </div>
                        <div class="opm-input-group">
                            <label for="opmTurnover" title="Annual staff turnover rate (%). High turnover erodes institutional knowledge and operational maturity.">Staff Turnover (%) <span class="opm-tooltip-icon" title="Voluntary turnover rate. Industry avg ~18%. Below 10% is excellent. Above 30% is critical — knowledge loss compounds reliability risk.">?</span></label>
                            <input type="number" id="opmTurnover" value="18" min="5" max="60" step="1" onchange="opmRecalc()">
                        </div>
                        <div class="opm-input-group">
                            <label for="opmIncidents" title="Number of critical (Severity 1-2) incidents per year. Directly correlates with operational maturity level.">Incident Frequency <span class="opm-tooltip-icon" title="Critical incidents per year (Sev-1/Sev-2 causing customer impact or capacity loss). Mature orgs: 0-3/yr. Average: 5-12/yr. Immature: 15+/yr. Each incident costs $100K-$1M+ in direct + reputational damage.">?</span></label>
                            <input type="number" id="opmIncidents" value="8" min="0" max="50" step="1" onchange="opmRecalc()">
                        </div>
                    </div>
                </div>

                <!-- ===== PRO PANEL 1: Financial Impact & ROI ===== -->
                <div class="opm-pro-panel gated" id="opmPanel1" style="display:none;">
                    <div class="opm-gate-overlay" onclick="opmShowLogin()">
                        <i class="fas fa-lock"></i>
                        <span>Pro Feature — Log in to unlock</span>
                    </div>
                    <div class="opm-panel-title"><i class="fas fa-chart-line opm-panel-icon"></i> Financial Impact &amp; ROI Analysis</div>
                    <div class="opm-kpi-grid">
                        <div class="opm-kpi-card">
                            <div class="opm-kpi-value" id="opmALE">$2.4M</div>
                            <div class="opm-kpi-label">Annual Loss Expectancy</div>
                            <div class="opm-kpi-sublabel">SLE x ARO</div>
                        </div>
                        <div class="opm-kpi-card">
                            <div class="opm-kpi-value" id="opmInsuranceIdx">1.32</div>
                            <div class="opm-kpi-label">Insurance Risk Index</div>
                            <div class="opm-kpi-sublabel">Premium multiplier</div>
                        </div>
                        <div class="opm-kpi-card">
                            <div class="opm-kpi-value" id="opmROI">187%</div>
                            <div class="opm-kpi-label">Fulfillment ROI</div>
                            <div class="opm-kpi-sublabel">Maturity improvement</div>
                        </div>
                        <div class="opm-kpi-card">
                            <div class="opm-kpi-value" id="opmOPEXEff">72%</div>
                            <div class="opm-kpi-label">OPEX Efficiency Score</div>
                            <div class="opm-kpi-sublabel">vs peer benchmark</div>
                        </div>
                        <div class="opm-kpi-card">
                            <div class="opm-kpi-value" id="opmBudgetVar">+8.5%</div>
                            <div class="opm-kpi-label">Budget Variance Forecast</div>
                            <div class="opm-kpi-sublabel">Next 12 months</div>
                        </div>
                        <div class="opm-kpi-card">
                            <div class="opm-kpi-value" id="opmNPV">$4.8M</div>
                            <div class="opm-kpi-label">5-Year NPV</div>
                            <div class="opm-kpi-sublabel">Maturity investment</div>
                        </div>
                    </div>
                </div>

                <!-- ===== PRO PANEL 2: Regulatory Compliance ===== -->
                <div class="opm-pro-panel gated" id="opmPanel2" style="display:none;">
                    <div class="opm-gate-overlay" onclick="opmShowLogin()">
                        <i class="fas fa-lock"></i>
                        <span>Pro Feature — Log in to unlock</span>
                    </div>
                    <div class="opm-panel-title"><i class="fas fa-gavel opm-panel-icon"></i> Regulatory Compliance Scorecard</div>
                    <div class="opm-kpi-grid">
                        <div class="opm-kpi-card">
                            <div class="opm-kpi-value" id="opmEEDScore">68%</div>
                            <div class="opm-kpi-label">EED Article 12 Score</div>
                            <div class="opm-kpi-sublabel">vs 25 mandatory points</div>
                        </div>
                        <div class="opm-kpi-card">
                            <div class="opm-kpi-value" id="opmAIActScore">42%</div>
                            <div class="opm-kpi-label">AI Act Art. 12 Readiness</div>
                            <div class="opm-kpi-sublabel">Record-keeping / traceability</div>
                        </div>
                        <div class="opm-kpi-card">
                            <div class="opm-kpi-value" id="opmDQI">0.82</div>
                            <div class="opm-kpi-label">Detection Quality Index</div>
                            <div class="opm-kpi-sublabel">TP / (TP + FP)</div>
                        </div>
                        <div class="opm-kpi-card">
                            <div class="opm-kpi-value" id="opmEvidenceSLA">94%</div>
                            <div class="opm-kpi-label">Evidence Delivery SLA</div>
                            <div class="opm-kpi-sublabel">Within 48hr target</div>
                        </div>
                        <div class="opm-kpi-card">
                            <div class="opm-kpi-value" id="opmAutoRatio">35%</div>
                            <div class="opm-kpi-label">Automation Ratio</div>
                            <div class="opm-kpi-sublabel">Automated vs manual checks</div>
                        </div>
                        <div class="opm-kpi-card">
                            <div class="opm-kpi-value" id="opmCompGrade">B-</div>
                            <div class="opm-kpi-label">Composite Grade</div>
                            <div class="opm-kpi-sublabel">Weighted compliance</div>
                        </div>
                    </div>
                    <div class="opm-chart-container">
                        <canvas id="opmRadarChart" height="280"></canvas>
                    </div>
                </div>

                <!-- ===== PRO PANEL 3: Infrastructure & Reliability ===== -->
                <div class="opm-pro-panel gated" id="opmPanel3" style="display:none;">
                    <div class="opm-gate-overlay" onclick="opmShowLogin()">
                        <i class="fas fa-lock"></i>
                        <span>Pro Feature — Log in to unlock</span>
                    </div>
                    <div class="opm-panel-title"><i class="fas fa-server opm-panel-icon"></i> Infrastructure &amp; Reliability</div>
                    <div class="opm-kpi-grid">
                        <div class="opm-kpi-card">
                            <div class="opm-kpi-value" id="opmSurvival">96.3%</div>
                            <div class="opm-kpi-label">P(Survival) 12-Month</div>
                            <div class="opm-kpi-sublabel">e^(-t/MTBF)</div>
                        </div>
                        <div class="opm-kpi-card">
                            <div class="opm-kpi-value" id="opmMTBF">8,760 hrs</div>
                            <div class="opm-kpi-label">MTBF Estimated</div>
                            <div class="opm-kpi-sublabel">Tier + maturity derived</div>
                        </div>
                        <div class="opm-kpi-card">
                            <div class="opm-kpi-value" id="opmMTTR">4.2 hrs</div>
                            <div class="opm-kpi-label">MTTR Estimated</div>
                            <div class="opm-kpi-sublabel">Incident response speed</div>
                        </div>
                        <div class="opm-kpi-card">
                            <div class="opm-kpi-value" id="opmERF">0.12</div>
                            <div class="opm-kpi-label">Energy Reuse Factor</div>
                            <div class="opm-kpi-sublabel">Reused / Total Energy</div>
                        </div>
                        <div class="opm-kpi-card">
                            <div class="opm-kpi-value" id="opmWUE">1.35</div>
                            <div class="opm-kpi-label">WUE Estimate (L/kWh)</div>
                            <div class="opm-kpi-sublabel">Region + cooling type</div>
                        </div>
                        <div class="opm-kpi-card">
                            <div class="opm-kpi-value" id="opmPUEBench">Top 32%</div>
                            <div class="opm-kpi-label">PUE Peer Benchmark</div>
                            <div class="opm-kpi-sublabel">vs Top 15% target</div>
                        </div>
                    </div>
                </div>

                <!-- ===== PRO PANEL 4: Monte Carlo Simulation ===== -->
                <div class="opm-pro-panel gated" id="opmPanel4" style="display:none;">
                    <div class="opm-gate-overlay" onclick="opmShowLogin()">
                        <i class="fas fa-lock"></i>
                        <span>Pro Feature — Log in to unlock</span>
                    </div>
                    <div class="opm-panel-title"><i class="fas fa-dice opm-panel-icon"></i> Monte Carlo Simulation (10K Iterations)</div>
                    <div class="opm-kpi-grid">
                        <div class="opm-kpi-card">
                            <div class="opm-kpi-value" id="opmMCP5">$1.2M</div>
                            <div class="opm-kpi-label">P5 (Best Case)</div>
                        </div>
                        <div class="opm-kpi-card">
                            <div class="opm-kpi-value" id="opmMCP25">$1.8M</div>
                            <div class="opm-kpi-label">P25</div>
                        </div>
                        <div class="opm-kpi-card">
                            <div class="opm-kpi-value" id="opmMCP50">$2.4M</div>
                            <div class="opm-kpi-label">P50 (Median)</div>
                        </div>
                        <div class="opm-kpi-card">
                            <div class="opm-kpi-value" id="opmMCP75">$3.2M</div>
                            <div class="opm-kpi-label">P75</div>
                        </div>
                        <div class="opm-kpi-card">
                            <div class="opm-kpi-value" id="opmMCP95">$5.1M</div>
                            <div class="opm-kpi-label">P95 (Worst Case)</div>
                        </div>
                        <div class="opm-kpi-card">
                            <div class="opm-kpi-value" id="opmCVaR">$4.6M</div>
                            <div class="opm-kpi-label">CVaR-95</div>
                            <div class="opm-kpi-sublabel">Conditional Value at Risk</div>
                        </div>
                        <div class="opm-kpi-card">
                            <div class="opm-kpi-value" id="opmBEProb">73%</div>
                            <div class="opm-kpi-label">Break-Even Probability</div>
                            <div class="opm-kpi-sublabel">ROI > 0 likelihood</div>
                        </div>
                        <div class="opm-kpi-card">
                            <div class="opm-kpi-value" id="opmConfBand">$1.8M</div>
                            <div class="opm-kpi-label">90% CI Band Width</div>
                            <div class="opm-kpi-sublabel">P5 to P95 range</div>
                        </div>
                    </div>
                    <div class="opm-chart-container">
                        <canvas id="opmHistogramChart" height="240"></canvas>
                    </div>
                    <div class="opm-chart-container" style="margin-top:0.75rem;">
                        <canvas id="opmTornadoChart" height="200"></canvas>
                    </div>
                </div>

                <!-- ===== PRO PANEL 5: AI-Generated Narrative ===== -->
                <div class="opm-pro-panel gated" id="opmPanel5" style="display:none;">
                    <div class="opm-gate-overlay" onclick="opmShowLogin()">
                        <i class="fas fa-lock"></i>
                        <span>Pro Feature — Log in to unlock</span>
                    </div>
                    <div class="opm-panel-title"><i class="fas fa-robot opm-panel-icon"></i> AI-Generated Executive Assessment</div>
                    <div class="opm-narrative" id="opmNarrative">
                        <p><strong>Executive Summary:</strong> Assessment pending — configure inputs and calculate to generate narrative.</p>
                    </div>
                </div>

                <!-- Login Modal -->
                <div class="opm-login-overlay" id="opmLoginOverlay">
                    <div class="opm-login-box">
                        <button class="opm-login-close" onclick="opmHideLogin()">&times;</button>
                        <h3><i class="fas fa-lock" style="color:#10b981;margin-right:6px;"></i> Unlock Pro Analysis</h3>
                        <p>Access Financial Impact, Compliance Scoring, Infrastructure Reliability, Monte Carlo Simulation, and Executive Assessment.</p>
                        <input type="email" id="opmLoginEmail" placeholder="Email address" autocomplete="email">
                        <input type="password" id="opmLoginPass" placeholder="Password" autocomplete="current-password">
                        <div class="opm-login-error" id="opmLoginError">Invalid credentials. Please try again.</div>
                        <button class="opm-login-submit" onclick="opmDoLogin()">Sign In</button>
                        <div class="demo-hint">Demo: <code>demo@resistancezero.com</code> / <code>demo2026</code></div>
                        <div style="text-align:center;margin-top:6px;"><a href="https://bagus-dwi-permana.myr.id/membership/resistancezero-pro" target="_blank" rel="noopener" style="font-size:0.62rem;color:#64748b;text-decoration:none;">Unlock Pro Mode &rarr;</a></div>
                    </div>
                </div>

                <h2 id="section-9">8. The Nuanced Truth: Both Narratives Are Incomplete</h2>

                <p>After presenting both sides, here's my honest assessment:</p>

                <h3>8.1 What the "Data Centers Are Bad" Narrative Gets Right</h3>
                <ul>
                    <li>Infrastructure costs <em>are</em> rising, and data centers contribute to demand growth</li>
                    <li>Cost allocation mechanisms <em>do</em> need modernization for the AI era</li>
                    <li>Not all data center operators are equally responsible — hyperscalers lead, but many lag</li>
                    <li>Transparency in grid cost allocation is genuinely lacking</li>
                    <li>Regional disparities mean some communities bear more burden than others</li>
                </ul>

                <h3>8.2 What the "Data Centers Are Good" Narrative Gets Right</h3>
                <ul>
                    <li>Big Tech renewable investment is genuinely transformative — $57B+ and growing</li>
                    <li>Load factor economics favor data centers as grid customers</li>
                    <li>Efficiency improvements are real and ongoing</li>
                    <li>Economic value creation (jobs, GDP, digital economy) is substantial</li>
                    <li>Grid modernization benefits all users, not just data centers</li>
                </ul>

                <h3>8.3 The Policy Implications</h3>

                <p>Rather than "data centers vs. citizens," the policy conversation should focus on:</p>

                <ol>
                    <li><strong>Transparent cost allocation:</strong> Show exactly how infrastructure costs are distributed</li>
                    <li><strong>Renewable requirements:</strong> Mandate 100% renewable matching for new facilities</li>
                    <li><strong>Efficiency standards:</strong> Require PUE reporting and minimum standards</li>
                    <li><strong>Grid services participation:</strong> Incentivize data centers to provide demand response</li>
                    <li><strong>Local benefit sharing:</strong> Ensure host communities receive tangible economic benefits</li>
                </ol>

                <h2 id="section-10">9. Conclusion: The Grid's Future is Being Built Now</h2>

                <p>The uncomfortable truth is this: <strong>AI data centers are simultaneously the largest consumers of electricity AND the largest private investors in clean energy infrastructure.</strong></p>

                <p>They're not angels — they're profit-driven companies making calculated investments. But those investments are:</p>
                <ul>
                    <li>Funding renewable energy projects that might not exist otherwise</li>
                    <li>Triggering grid modernization that benefits everyone</li>
                    <li>Driving efficiency improvements that reduce the carbon intensity of computing</li>
                    <li>Creating economic value that extends far beyond their electricity consumption</li>
                </ul>

                <p>The "data centers vs. citizens" framing is politically convenient but economically incomplete. The real question isn't whether data centers should exist — they're essential infrastructure for the modern economy. The question is how to ensure:</p>

                <ol>
                    <li>Cost allocation is fair and transparent</li>
                    <li>All operators meet high sustainability standards</li>
                    <li>Host communities share in the benefits</li>
                    <li>Grid investments serve long-term public interest</li>
                </ol>

                <blockquote>
                    "The same data centers being blamed for grid stress are funding more renewable energy than most governments. The cognitive dissonance is remarkable."
                    <br><span style="font-size: 0.9rem; color: #64748b;">— Energy Analyst, IEA Report Discussion, 2025</span>
                </blockquote>

                <div class="positive-box">
                    <p><strong>Final Thought:</strong> Read both this article and <a href="article-11.html">Article 11</a>. The truth lives in the tension between these perspectives. Demand transparency, support renewable requirements, and resist the temptation of simple narratives about complex systems.</p>
                </div>

                <div class="references" id="references">
                    <h3>References & Data Sources</h3>
                    <ol>
                        <li>
                            <a href="https://sustainability.aboutamazon.com/climate-solutions/renewable-energy" target="_blank" rel="noopener">Amazon Renewable Energy Portfolio</a>
                            <span class="ref-source">Amazon Sustainability — 34 GW renewable capacity as of 2024</span>
                        </li>
                        <li>
                            <a href="https://www.microsoft.com/en-us/corporate-responsibility/sustainability" target="_blank" rel="noopener">Microsoft Sustainability Report</a>
                            <span class="ref-source">Microsoft — 23.2 GW cumulative renewable commitments, Brookfield deal</span>
                        </li>
                        <li>
                            <a href="https://sustainability.google/reports/" target="_blank" rel="noopener">Google Environmental Reports</a>
                            <span class="ref-source">Google — 24/7 Carbon-Free Energy initiative, Kairos nuclear deal</span>
                        </li>
                        <li>
                            <a href="https://about.bnef.com/corporate-energy-market-outlook/" target="_blank" rel="noopener">BloombergNEF Corporate PPA Database</a>
                            <span class="ref-source">BNEF — 50+ GW corporate PPA volume 2024</span>
                        </li>
                        <li>
                            <a href="https://www.constellation.com/newsroom/2024/Constellation-to-Launch-Crane-Clean-Energy-Center.html" target="_blank" rel="noopener">Constellation/Microsoft Three Mile Island Restart</a>
                            <span class="ref-source">Constellation Energy — 835 MW nuclear restart, 20-year Microsoft PPA</span>
                        </li>
                        <li>
                            <a href="https://www.e3.com" target="_blank" rel="noopener">Energy+Environmental Economics (E3) Virginia Study</a>
                            <span class="ref-source">E3 — $33,500/MW annual surplus value from data centers</span>
                        </li>
                        <li>
                            <a href="https://www.iea.org/reports/energy-and-ai" target="_blank" rel="noopener">IEA Energy and AI Report 2025</a>
                            <span class="ref-source">IEA — Global data center efficiency trends, demand response potential</span>
                        </li>
                        <li>
                            <a href="https://www.goldmansachs.com/insights/pages/ai-investment-forecast-to-approach-200-billion-globally-by-2025.html" target="_blank" rel="noopener">Goldman Sachs AI Economic Impact</a>
                            <span class="ref-source">Goldman Sachs — AI capex contributing 1.1% to GDP growth</span>
                        </li>
                        <li>
                            <a href="https://economysea.withgoogle.com/" target="_blank" rel="noopener">Google e-Conomy SEA Report</a>
                            <span class="ref-source">Google/Temasek/Bain — $300B+ SEA digital economy projection</span>
                        </li>
                        <li>
                            <a href="https://uptimeinstitute.com/resources/research-and-reports" target="_blank" rel="noopener">Uptime Institute Global Data Center Survey</a>
                            <span class="ref-source">Uptime Institute — PUE trends, efficiency benchmarks</span>
                        </li>
                        <li>
                            <a href="https://deepmind.google/discover/blog/deepmind-ai-reduces-google-data-centre-cooling-bill-by-40/" target="_blank" rel="noopener">DeepMind AI Cooling Optimization</a>
                            <span class="ref-source">DeepMind — 40% cooling energy reduction through AI</span>
                        </li>
                        <li>
                            <a href="https://www.nrel.gov/docs/fy21osti/78505.pdf" target="_blank" rel="noopener">NREL Cloud Computing Energy Study</a>
                            <span class="ref-source">Lawrence Berkeley National Lab / NREL — 72-93% efficiency improvement cloud vs on-premise</span>
                        </li>
                    </ol>
                </div>

                <!-- Download PDF Section -->
                <div style="margin-top: 3rem; display: flex; justify-content: center; gap: 1rem; flex-wrap: wrap;">
                    <a href="article-12-paper.pdf" class="download-pdf-btn" download style="display: inline-flex; align-items: center; gap: 0.5rem; background: linear-gradient(135deg, #059669 0%, #047857 100%); color: white; padding: 1rem 2rem; border-radius: 12px; font-weight: 600; text-decoration: none; transition: all 0.3s ease; box-shadow: 0 4px 15px rgba(5, 150, 105, 0.3);">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                            <polyline points="7 10 12 15 17 10"/>
                            <line x1="12" y1="15" x2="12" y2="3"/>
                        </svg>
                        Download PDF Journal
                    </a>
                    <button onclick="window.print()" style="display: inline-flex; align-items: center; gap: 0.5rem; background: transparent; border: 2px solid #059669; color: #059669; padding: 1rem 2rem; border-radius: 12px; font-weight: 600; cursor: pointer; transition: all 0.3s ease;">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polyline points="6 9 6 2 18 2 18 9"/>
                            <path d="M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"/>
                            <rect x="6" y="14" width="12" height="8"/>
                        </svg>
                        Print Article
                    </button>
                </div>

                <!-- Newsletter Signup -->
                <div class="newsletter-signup">
                    <h3>Stay Updated</h3>
                    <p>Get notified when new articles on data center operations and engineering excellence are published.</p>
                    <form class="newsletter-form" onsubmit="return subscribeNewsletter(event)">
                        <input type="email" placeholder="Enter your email" required>
                        <button type="submit">Subscribe</button>
                    </form>
                    <p class="newsletter-privacy">No spam. Unsubscribe anytime.</p>
                </div>

                <!-- Author Bio -->
                <div class="author-bio">
                    <div class="author-bio-image">
                        <img loading="lazy" src="assets/profile-photo.jpg" alt="Bagus Dwi Permana">
                    </div>
                    <div class="author-bio-content">
                        <h4>Bagus Dwi Permana</h4>
                        <p class="author-bio-title">Engineering Operations Manager | Ahli K3 Listrik</p>
                        <p>12+ years professional experience in critical infrastructure and operations. CDFOM certified. Transforming operations through systematic excellence and safety-first engineering.</p>
                        <div class="author-bio-links">
                            <a href="https://www.linkedin.com/in/bagus-dwi-permana-ba90b092" target="_blank">
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/></svg>
                                LinkedIn
                            </a>
                            <a href="https://github.com/baguspermana7-cpu" target="_blank">
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/></svg>
                                GitHub
                            </a>
                            <a href="mailto:baguspermana7@gmail.com">
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg>
                                Email
                            </a>
                        </div>
                    </div>
                </div>

                <!-- Related Articles -->
                <div class="related-articles">
                    <h3>Continue Reading</h3>
                    <div class="related-grid">
                        <a href="article-11.html" class="related-card">
                            <div class="related-card-number">11</div>
                            <div class="related-card-content">
                                <h4>AI Data Centers vs Citizen Electricity Bills: Who Really Pays?</h4>
                                <p>The energy cost impact on communities</p>
                            </div>
                        </a>
                        <a href="article-13.html" class="related-card">
                            <div class="related-card-number">13</div>
                            <div class="related-card-content">
                                <h4>Data Center Power Distribution Design: Hyperscaler Architecture Deep Dive</h4>
                                <p>Power architecture patterns and best practices</p>
                            </div>
                        </a>
                    </div>
                </div>

                <!-- Article Navigation -->
                <div class="article-nav">
                    <a href="article-11.html">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M19 12H5M12 19l-7-7 7-7"/></svg>
                        Previous Article
                    </a>
                    <a href="article-13.html">
                        Next Article
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M5 12h14M12 5l7 7-7 7"/></svg>
                    </a>
                </div>

            </div>
        </div>
    </article>

    </main>

    <!-- Footer -->
    <footer class="footer footer-enhanced">
        <div class="container">
            <div class="footer-grid">
                <div class="footer-brand">
                    <p class="footer-tagline-main">BUILT FOR MISSION CRITICAL INFRASTRUCTURE<br>MANAGEMENT // 2026</p>
                    <p class="footer-tagline-sub">ALL OPERATIONAL DATASETS PRESERVED.</p>
                    <p class="footer-copyright">&copy; 2026 Bagus Dwi Permana. All rights reserved.</p>
                </div>
                <div class="footer-nav">
                    <h4 class="footer-heading">NAVIGATION</h4>
                    <ul class="footer-links">
                        <li><a href="index.html">Home Dashboard</a></li>
                        <li><a href="articles.html">Technical Journal</a></li>
                        <li><a href="index.html#case-studies">Case Studies</a></li>
                        <li><a href="datacenter-solutions.html">DC Solutions</a></li>
                    </ul>
                </div>
                <div class="footer-connect">
                    <h4 class="footer-heading">CONNECT</h4>
                    <ul class="footer-links">
                        <li><a href="https://www.linkedin.com/in/bagus-dwi-permana-ba90b092" target="_blank" rel="noopener">LinkedIn Profile</a></li>
                        <li><a href="articles.html">Technical Journal</a></li>
                        <li><a href="mailto:baguspermana7@gmail.com">Direct Contact</a></li>
                        <li><a href="https://github.com/baguspermana7-cpu" target="_blank" rel="noopener">GitHub</a></li>
                    </ul>
                </div>
            </div>
        </div>
    </footer>

    <script src="script.js"></script>
    <script>
        // Value Generation Calculator
        // ============================================
        // COMPREHENSIVE DATA CENTER VALUE CALCULATOR
        // ============================================

        // Country/Region Data Configuration
        const countryData = {
            indonesia: {
                name: 'Indonesia', currency: 'IDR', symbol: 'Rp',
                electricityRate: 0.072, // USD/kWh industrial
                carbonIntensity: 610, // gCO2/kWh (coal-heavy grid)
                capexMultiplier: 0.85, // Lower construction costs
                jobMultiplier: 1.3, // Higher labor intensity
                taxRate: 0.12, // Estimated effective tax rate
                ppaPrice: 380000, // USD/MW solar installed
                gridCapacityGW: 70
            },
            malaysia: {
                name: 'Malaysia', currency: 'MYR', symbol: 'RM',
                electricityRate: 0.097, carbonIntensity: 580,
                capexMultiplier: 0.9, jobMultiplier: 1.2, taxRate: 0.15,
                ppaPrice: 400000, gridCapacityGW: 35
            },
            singapore: {
                name: 'Singapore', currency: 'SGD', symbol: 'S$',
                electricityRate: 0.18, carbonIntensity: 400,
                capexMultiplier: 1.3, jobMultiplier: 0.8, taxRate: 0.17,
                ppaPrice: 550000, gridCapacityGW: 14
            },
            thailand: {
                name: 'Thailand', currency: 'THB', symbol: '฿',
                electricityRate: 0.11, carbonIntensity: 500,
                capexMultiplier: 0.88, jobMultiplier: 1.15, taxRate: 0.13,
                ppaPrice: 390000, gridCapacityGW: 50
            },
            vietnam: {
                name: 'Vietnam', currency: 'VND', symbol: '₫',
                electricityRate: 0.084, carbonIntensity: 550,
                capexMultiplier: 0.82, jobMultiplier: 1.4, taxRate: 0.10,
                ppaPrice: 360000, gridCapacityGW: 80
            },
            philippines: {
                name: 'Philippines', currency: 'PHP', symbol: '₱',
                electricityRate: 0.18, carbonIntensity: 620,
                capexMultiplier: 0.95, jobMultiplier: 1.25, taxRate: 0.14,
                ppaPrice: 420000, gridCapacityGW: 25
            },
            us_virginia: {
                name: 'US - Virginia', currency: 'USD', symbol: '$',
                electricityRate: 0.065, carbonIntensity: 350,
                capexMultiplier: 1.0, jobMultiplier: 1.0, taxRate: 0.21,
                ppaPrice: 450000, gridCapacityGW: 180
            },
            us_texas: {
                name: 'US - Texas', currency: 'USD', symbol: '$',
                electricityRate: 0.055, carbonIntensity: 420,
                capexMultiplier: 0.95, jobMultiplier: 1.05, taxRate: 0.18,
                ppaPrice: 400000, gridCapacityGW: 85
            },
            eu_ireland: {
                name: 'EU - Ireland', currency: 'EUR', symbol: '€',
                electricityRate: 0.22, carbonIntensity: 320,
                capexMultiplier: 1.15, jobMultiplier: 0.9, taxRate: 0.125,
                ppaPrice: 500000, gridCapacityGW: 11
            },
            eu_netherlands: {
                name: 'EU - Netherlands', currency: 'EUR', symbol: '€',
                electricityRate: 0.20, carbonIntensity: 380,
                capexMultiplier: 1.2, jobMultiplier: 0.85, taxRate: 0.25,
                ppaPrice: 520000, gridCapacityGW: 31
            }
        };

        // DC Type Configuration
        const dcTypes = {
            hyperscale: { capexPerMW: 12000000, jobsPerMW: 1.5, pueRange: [1.1, 1.25] },
            colocation: { capexPerMW: 10000000, jobsPerMW: 2.0, pueRange: [1.3, 1.5] },
            enterprise: { capexPerMW: 15000000, jobsPerMW: 2.5, pueRange: [1.5, 1.8] },
            ai_hpc: { capexPerMW: 18000000, jobsPerMW: 1.8, pueRange: [1.15, 1.3] }
        };

        // Scroll to results after calculation
        function scrollToResults() {
            setTimeout(() => {
                const resultsSection = document.getElementById('resultsSection');
                if (resultsSection) {
                    resultsSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
                }
            }, 100);
        }

        // Tab Switching
        function switchCalcTab(tabName) {
            document.querySelectorAll('.calc-tab-content').forEach(el => el.style.display = 'none');
            document.querySelectorAll('.calc-tab').forEach(el => {
                el.style.background = 'transparent';
                el.style.color = '#94a3b8';
                el.style.borderColor = 'rgba(255,255,255,0.2)';
            });
            document.getElementById('tab-' + tabName).style.display = 'block';
            const activeTab = document.querySelector(`.calc-tab[data-tab="${tabName}"]`);
            if (activeTab) {
                activeTab.style.background = 'rgba(16,185,129,0.2)';
                activeTab.style.color = '#34d399';
                activeTab.style.borderColor = 'rgba(16,185,129,0.3)';
            }
            if (tabName === 'comparison') generateScenarioComparison();
        }

        // Update capacity label from slider
        function updateCapacityLabel() {
            const val = document.getElementById('capacityFactor').value;
            document.getElementById('capacityLabel').textContent = val + '%';
        }

        // Main Calculation Function
        function calculateValueAdvanced() {
            // Get inputs
            const country = document.getElementById('calcCountry').value;
            const dcCapacityMW = parseFloat(document.getElementById('dcCapacityMW').value) || 100;
            const dcType = document.getElementById('dcType').value;
            const renewableTarget = document.getElementById('renewableTarget').value;
            const pue = parseFloat(document.getElementById('pueTarget').value) || 1.2;
            const capacityFactor = (parseFloat(document.getElementById('capacityFactor').value) || 85) / 100;
            const projectYears = parseInt(document.getElementById('projectYears').value) || 10;
            const coolingType = document.getElementById('coolingType').value;
            const gridConnection = document.getElementById('gridConnection').value;
            const demandResponse = document.getElementById('demandResponse').value;

            const cd = countryData[country];
            const dt = dcTypes[dcType];

            // Calculate renewable percentage
            let renewablePct = 0;
            if (renewableTarget === '100' || renewableTarget === '100_annual') renewablePct = 1.0;
            else if (renewableTarget === '80') renewablePct = 0.8;
            else if (renewableTarget === '50') renewablePct = 0.5;
            else renewablePct = 0;

            // Calculate total power (IT + overhead from PUE)
            const totalPowerMW = dcCapacityMW * pue;

            // Annual energy consumption
            const annualMWh = totalPowerMW * 8760 * capacityFactor;
            const annualGWh = annualMWh / 1000;

            // === ECONOMIC CALCULATIONS ===
            const capex = dcCapacityMW * dt.capexPerMW * cd.capexMultiplier;
            const annualOpex = capex * 0.07; // ~7% of CAPEX for operations
            const annualEnergyCost = annualMWh * cd.electricityRate;
            const taxRevenue = (annualOpex + annualEnergyCost) * cd.taxRate;

            // Jobs calculation
            const directJobs = Math.round(dcCapacityMW * dt.jobsPerMW * cd.jobMultiplier);
            const indirectJobs = Math.round(directJobs * 4.3); // IMPLAN multiplier

            // Economic multiplier effect
            const directImpact = capex;
            const indirectImpact = capex * 1.5;
            const inducedImpact = capex * 0.75;
            const totalEconomicImpact = (directImpact + indirectImpact + inducedImpact) +
                                       (annualOpex + annualEnergyCost) * projectYears;

            // === RENEWABLE & GRID CALCULATIONS ===
            // PPA capacity (1.5x overbuild for 24/7 CFE, 1.2x for annual match)
            const overbuildFactor = renewableTarget === '100' ? 1.5 : 1.2;
            const ppaCapacityMW = Math.round(dcCapacityMW * overbuildFactor * renewablePct);
            const ppaInvestmentValue = ppaCapacityMW * cd.ppaPrice * 20 / 1000000; // 20-year PPA value

            // Grid surplus value (E3 methodology: $33,500/MW/year)
            const gridSurplusAnnual = dcCapacityMW * 33500;

            // Demand response value
            let drCapacityPct = 0;
            if (demandResponse === 'full') drCapacityPct = 0.15;
            else if (demandResponse === 'partial') drCapacityPct = 0.075;
            const drCapacityMW = dcCapacityMW * drCapacityPct;
            const drValueAnnual = drCapacityMW * 50000; // ~$50K/MW/year for DR participation

            // Load factor benefit calculation
            const dcLoadFactor = capacityFactor;
            const residentialLoadFactor = 0.35;
            const loadFactorBenefit = dcCapacityMW * 8760 * (dcLoadFactor - residentialLoadFactor) * 0.003; // $3/MWh value

            // Grid reliability improvement
            const gridReliabilityImprovement = (dcCapacityMW / cd.gridCapacityGW / 1000) * 0.5; // 0.5% per % of grid

            // === ENVIRONMENTAL CALCULATIONS ===
            const baselineEmissions = annualMWh * cd.carbonIntensity / 1000000; // Million tons
            const actualEmissions = baselineEmissions * (1 - renewablePct);
            const co2Avoided = baselineEmissions * renewablePct;
            const treesEquivalent = co2Avoided * 1000000 / 22; // ~22 kg CO2 per tree per year

            // PUE efficiency comparison
            const industryAvgPUE = 1.56;
            const pueEfficiencyGain = ((industryAvgPUE - pue) / industryAvgPUE) * 100;

            // === UPDATE UI ===
            // Economic section
            document.getElementById('capexInvestment').textContent = formatCurrency(capex);
            document.getElementById('annualOpex').textContent = formatCurrency(annualOpex);
            document.getElementById('annualEnergy').textContent = formatCurrency(annualEnergyCost);
            document.getElementById('taxRevenue').textContent = formatCurrency(taxRevenue);
            document.getElementById('directJobs').textContent = directJobs.toLocaleString();
            document.getElementById('indirectJobs').textContent = indirectJobs.toLocaleString();

            // Update economic bars
            const maxImpact = directImpact + indirectImpact + inducedImpact;
            document.getElementById('directBar').style.width = (directImpact / maxImpact * 100) + '%';
            document.getElementById('directBar').querySelector('span').textContent = formatCurrency(directImpact);
            document.getElementById('indirectBar').style.width = (indirectImpact / maxImpact * 100) + '%';
            document.getElementById('indirectBar').querySelector('span').textContent = formatCurrency(indirectImpact);
            document.getElementById('inducedBar').style.width = (inducedImpact / maxImpact * 100) + '%';
            document.getElementById('inducedBar').querySelector('span').textContent = formatCurrency(inducedImpact);

            // Renewable & Grid section
            document.getElementById('ppaCapacity').textContent = ppaCapacityMW.toLocaleString() + ' MW';
            document.getElementById('ppaValue').textContent = formatCurrency(ppaInvestmentValue * 1000000);
            document.getElementById('gridSurplus').textContent = formatCurrency(gridSurplusAnnual);
            document.getElementById('drValue').textContent = formatCurrency(drValueAnnual);
            document.getElementById('loadFactorBenefit').textContent = '+' + formatCurrency(loadFactorBenefit);
            document.getElementById('reliabilityIndex').textContent = '+' + gridReliabilityImprovement.toFixed(2) + '%';

            // Update load factor circle
            document.getElementById('dcLoadCircle').setAttribute('stroke-dasharray', (capacityFactor * 100) + ', 100');
            document.getElementById('dcLoadPct').textContent = Math.round(capacityFactor * 100) + '%';

            // Environmental section
            document.getElementById('annualEnergy2').textContent = annualGWh.toFixed(0);
            document.getElementById('carbonIntensity').textContent = cd.carbonIntensity;
            document.getElementById('baselineEmissions').textContent = formatNumber(baselineEmissions * 1000) + 'K';
            document.getElementById('renewableEmissions').textContent = formatNumber(actualEmissions * 1000) + 'K';
            document.getElementById('co2Avoided').textContent = formatNumber(co2Avoided * 1000) + 'K';
            document.getElementById('treesEquiv').textContent = formatNumber(treesEquivalent / 1000000) + 'M';

            // PUE comparison
            const pueBarWidth = ((pue - 1) / 1.5) * 100; // Scale: 1.0 = 0%, 2.5 = 100%
            document.getElementById('yourPueBar').style.width = pueBarWidth + '%';
            document.getElementById('yourPueMarker').style.left = pueBarWidth + '%';
            document.getElementById('yourPueValue').textContent = pue.toFixed(2);
            document.getElementById('pueEfficiencySummary').textContent =
                `Your PUE of ${pue.toFixed(2)} saves ${Math.abs(pueEfficiencyGain).toFixed(0)}% energy vs industry average`;

            // Summary section
            document.getElementById('totalEconomic').textContent = formatCurrency(totalEconomicImpact);
            document.getElementById('totalJobs').textContent = (directJobs + indirectJobs).toLocaleString();
            document.getElementById('totalRenewable').textContent = ppaCapacityMW.toLocaleString() + ' MW';
            document.getElementById('totalCarbon').textContent = formatNumber(co2Avoided * projectYears) + ' tons';
            document.getElementById('totalGridSurplus').textContent = formatCurrency(gridSurplusAnnual * projectYears);
        }

        // Generate scenario comparison
        function generateScenarioComparison() {
            const dcCapacityMW = parseFloat(document.getElementById('dcCapacityMW').value) || 100;
            const country = document.getElementById('calcCountry').value;
            const cd = countryData[country];

            const scenarios = [
                { name: 'Your Configuration', type: document.getElementById('dcType').value,
                  pue: parseFloat(document.getElementById('pueTarget').value),
                  renewable: document.getElementById('renewableTarget').value },
                { name: 'Best-in-Class Hyperscale', type: 'hyperscale', pue: 1.1, renewable: '100' },
                { name: 'Industry Average', type: 'colocation', pue: 1.56, renewable: '50' },
                { name: 'Legacy Enterprise', type: 'enterprise', pue: 1.8, renewable: 'grid' }
            ];

            let html = '';
            scenarios.forEach((s, i) => {
                const dt = dcTypes[s.type];
                const renewPct = s.renewable === '100' || s.renewable === '100_annual' ? 1 :
                                s.renewable === '80' ? 0.8 : s.renewable === '50' ? 0.5 : 0;
                const annualMWh = dcCapacityMW * s.pue * 8760 * 0.85;
                const emissions = annualMWh * cd.carbonIntensity * (1 - renewPct) / 1000000;
                const capex = dcCapacityMW * dt.capexPerMW * cd.capexMultiplier;

                const isYours = i === 0;
                html += `
                    <div style="background: ${isYours ? 'rgba(16,185,129,0.15)' : 'rgba(255,255,255,0.05)'};
                               border: 1px solid ${isYours ? '#10b981' : 'rgba(255,255,255,0.1)'};
                               border-radius: 12px; padding: 1rem;">
                        <h5 style="color: ${isYours ? '#34d399' : '#e5e7eb'}; font-size: 0.9rem; margin-bottom: 0.75rem;">
                            ${isYours ? '★ ' : ''}${s.name}
                        </h5>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 0.5rem; font-size: 0.8rem;">
                            <div style="color: #94a3b8;">PUE:</div>
                            <div style="color: #e5e7eb; font-weight: 600;">${s.pue.toFixed(2)}</div>
                            <div style="color: #94a3b8;">Renewable:</div>
                            <div style="color: #e5e7eb; font-weight: 600;">${Math.round(renewPct * 100)}%</div>
                            <div style="color: #94a3b8;">CAPEX:</div>
                            <div style="color: #e5e7eb; font-weight: 600;">${formatCurrency(capex)}</div>
                            <div style="color: #94a3b8;">CO2/year:</div>
                            <div style="color: ${emissions < 100 ? '#34d399' : '#f87171'}; font-weight: 600;">
                                ${formatNumber(emissions * 1000)}K tons
                            </div>
                        </div>
                    </div>
                `;
            });
            document.getElementById('scenarioComparison').innerHTML = html;
        }

        // Utility functions
        function formatCurrency(value) {
            if (value >= 1000000000) return '$' + (value / 1000000000).toFixed(1) + 'B';
            if (value >= 1000000) return '$' + (value / 1000000).toFixed(1) + 'M';
            if (value >= 1000) return '$' + (value / 1000).toFixed(0) + 'K';
            return '$' + value.toFixed(0);
        }

        function formatNumber(value) {
            if (value >= 1000000) return (value / 1000000).toFixed(1);
            if (value >= 1000) return (value / 1000).toFixed(0);
            return value.toFixed(0);
        }

        // Initialize calculator on load
        document.addEventListener('DOMContentLoaded', function() {
            calculateValueAdvanced();

            // Add event listeners to all inputs
            const inputs = ['calcCountry', 'dcCapacityMW', 'dcType', 'renewableTarget',
                           'pueTarget', 'capacityFactor', 'projectYears', 'coolingType',
                           'gridConnection', 'demandResponse'];
            inputs.forEach(id => {
                const el = document.getElementById(id);
                if (el) {
                    el.addEventListener('change', calculateValueAdvanced);
                    if (el.type === 'number') {
                        el.addEventListener('keyup', function(e) {
                            if (e.key === 'Enter') calculateValueAdvanced();
                        });
                    }
                }
            });
        });
    </script>

    <!-- Share Buttons - Floating Sidebar -->
    <aside class="share-buttons" id="shareButtons" aria-label="Share this article">
        <span class="share-label">Share</span>
        <button class="share-btn linkedin" data-tooltip="Share on LinkedIn" onclick="shareLinkedIn()" aria-label="Share on LinkedIn">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/></svg>
        </button>
        <button class="share-btn twitter" data-tooltip="Share on X" onclick="shareTwitter()" aria-label="Share on X">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/></svg>
        </button>
        <button class="share-btn whatsapp" data-tooltip="Share on WhatsApp" onclick="shareWhatsApp()" aria-label="Share on WhatsApp">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"/></svg>
        </button>
        <button class="share-btn copy" data-tooltip="Copy link" onclick="copyLink()" aria-label="Copy article link">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="copy-icon"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="check-icon" style="display:none"><polyline points="20 6 9 17 4 12"></polyline></svg>
        </button>
    </aside>

    <script>
    // Share Buttons Functions
    (function(){const s=document.getElementById('shareButtons'),h=document.querySelector('.article-hero');if(s&&h){document.body.classList.add('has-share-buttons');new IntersectionObserver(e=>e.forEach(x=>s.classList.toggle('visible',!x.isIntersecting)),{threshold:.1}).observe(h)}})();
    function getShareData(){return{title:document.querySelector('meta[property="og:title"]')?.content||document.title,url:window.location.href}}
    function shareLinkedIn(){window.open(`https://www.linkedin.com/sharing/share-offsite/?url=${encodeURIComponent(getShareData().url)}`,'_blank','width=600,height=600')}
    function shareTwitter(){const d=getShareData();window.open(`https://twitter.com/intent/tweet?text=${encodeURIComponent(d.title+' by @BagusDPermana')}&url=${encodeURIComponent(d.url)}`,'_blank','width=600,height=400')}
    function shareWhatsApp(){const d=getShareData();window.open(`https://wa.me/?text=${encodeURIComponent(d.title+'\n\n'+d.url)}`,'_blank')}
    function copyLink(){const b=document.querySelector('.share-btn.copy'),c=b.querySelector('.copy-icon'),k=b.querySelector('.check-icon');navigator.clipboard.writeText(window.location.href).then(()=>{b.classList.add('copied');c.style.display='none';k.style.display='block';b.setAttribute('data-tooltip','Copied!');setTimeout(()=>{b.classList.remove('copied');c.style.display='block';k.style.display='none';b.setAttribute('data-tooltip','Copy link')},2000)})}
    </script>
    <script>
    function subscribeNewsletter(e){e.preventDefault();var email=e.target.querySelector('input[type="email"]').value.trim();if(!email)return false;var subs=JSON.parse(localStorage.getItem('rz_newsletter_subscribers')||'[]');if(subs.find(function(s){return s.email===email})){alert('Already subscribed!');return false}subs.push({email:email,date:new Date().toISOString(),source:location.pathname.split('/').pop(),status:'active'});localStorage.setItem('rz_newsletter_subscribers',JSON.stringify(subs));e.target.innerHTML='<p style="color:#fff;font-weight:600;">&#10003; Subscribed successfully!</p>';return false}
    </script>
<script>
/* ============================================================
   Article-12  Operational Maturity Assessment — Pro Enhancement Mode
   Prefix: opm-   Theme: emerald (#10b981)
   IIFE — all onclick handlers attached to window
   ============================================================ */
(function(){
    'use strict';

    // ── state ──
    var opmProMode = false;

    // ── Region data (must match <select id="opmRegion"> option values) ──
    var REGIONS = {
        'EU-Germany':     { label:'EU - Germany',     energyRate:0.18, gridCarbon:0.33, waterStress:2.1, regSeverity:85, laborCost:72000, insuranceIdx:1.06 },
        'EU-Ireland':     { label:'EU - Ireland',     energyRate:0.16, gridCarbon:0.30, waterStress:1.8, regSeverity:80, laborCost:68000, insuranceIdx:1.08 },
        'EU-Nordics':     { label:'EU - Nordics',     energyRate:0.08, gridCarbon:0.08, waterStress:1.2, regSeverity:75, laborCost:70000, insuranceIdx:1.04 },
        'SEA-Singapore':  { label:'SEA - Singapore',  energyRate:0.14, gridCarbon:0.41, waterStress:3.2, regSeverity:50, laborCost:45000, insuranceIdx:1.12 },
        'SEA-Indonesia':  { label:'SEA - Indonesia',  energyRate:0.09, gridCarbon:0.72, waterStress:2.8, regSeverity:35, laborCost:18000, insuranceIdx:1.25 },
        'US-Virginia':    { label:'US - Virginia',    energyRate:0.07, gridCarbon:0.38, waterStress:2.3, regSeverity:60, laborCost:85000, insuranceIdx:1.05 },
        'US-Oregon':      { label:'US - Oregon',      energyRate:0.05, gridCarbon:0.12, waterStress:2.0, regSeverity:55, laborCost:82000, insuranceIdx:1.04 },
        'Middle-East':    { label:'Middle East',      energyRate:0.06, gridCarbon:0.65, waterStress:4.5, regSeverity:40, laborCost:35000, insuranceIdx:1.40 }
    };

    // ── Tier data (must match <select id="opmTier"> option values: "1","2","3","4") ──
    var TIERS = {
        '1': { mtbfBase:6000,  availTarget:99.671, capexMult:1.0, redundancy:'N'    },
        '2': { mtbfBase:12000, availTarget:99.741, capexMult:1.3, redundancy:'N+1'  },
        '3': { mtbfBase:24000, availTarget:99.982, capexMult:1.7, redundancy:'N+1 concurrent' },
        '4': { mtbfBase:48000, availTarget:99.995, capexMult:2.2, redundancy:'2N fully redundant' }
    };

    // ── helpers ──
    function $(id){ return document.getElementById(id); }
    function fmt(v){
        if(Math.abs(v)>=1e9) return '$'+( v/1e9).toFixed(2)+'B';
        if(Math.abs(v)>=1e6) return '$'+(v/1e6).toFixed(2)+'M';
        if(Math.abs(v)>=1e3) return '$'+(v/1e3).toFixed(1)+'K';
        return '$'+v.toFixed(0);
    }
    function pct(v){ return v.toFixed(1)+'%'; }
    function clamp(v,lo,hi){ return Math.max(lo,Math.min(hi,v)); }

    // Box-Muller
    function boxMuller(){ var u1=Math.random(),u2=Math.random(); return Math.sqrt(-2*Math.log(u1))*Math.cos(2*Math.PI*u2); }

    function percentile(arr,p){ var i=(p/100)*(arr.length-1); var lo=Math.floor(i),hi=Math.ceil(i),f=i-lo; return arr[lo]+(arr[hi]-arr[lo])*f; }

    // ── Tier labels for display ──
    var TIER_LABELS = {'1':'Tier I','2':'Tier II','3':'Tier III','4':'Tier IV'};

    // ── read inputs ──
    function getInputs(){
        var regionKey = $('opmRegion').value;
        var region    = REGIONS[regionKey];
        var tierKey   = $('opmTier').value;
        var tier      = TIERS[tierKey];
        var tierLabel = TIER_LABELS[tierKey] || ('Tier '+tierKey);
        var itLoad    = clamp(parseFloat($('opmITLoad').value)||10, 0.5, 100);
        var pue       = clamp(parseFloat($('opmPUE').value)||1.45, 1.1, 3.0);
        var staffCount= clamp(parseInt($('opmStaffCount').value)||50, 5, 500);
        var turnover  = clamp(parseFloat($('opmTurnover').value)||18, 5, 60);
        var incidents = clamp(parseInt($('opmIncidents').value)||8, 0, 50);

        var totalPowerMW = itLoad * pue;
        var annualEnergyMWh = totalPowerMW * 8760;
        var annualEnergyCost = annualEnergyMWh * region.energyRate * 1000; // rate is $/kWh
        var annualLaborCost = staffCount * region.laborCost;
        var maturityScore = calcMaturityScore(incidents, turnover, staffCount, tier, pue);

        return {
            regionKey:regionKey, region:region, tierKey:tierLabel, tier:tier,
            itLoad:itLoad, pue:pue, staffCount:staffCount, turnover:turnover,
            incidents:incidents, totalPowerMW:totalPowerMW,
            annualEnergyMWh:annualEnergyMWh, annualEnergyCost:annualEnergyCost,
            annualLaborCost:annualLaborCost, maturityScore:maturityScore
        };
    }

    // maturity score 0-100
    function calcMaturityScore(incidents, turnover, staff, tier, pue){
        var incidentScore = clamp(100 - incidents*6, 0, 100);
        var turnoverScore = clamp(100 - turnover*1.5, 0, 100);
        var staffRatio    = clamp(staff / 50, 0.5, 3) * 20;
        var tierBonus     = ({1:10,2:20,3:35,4:50})[parseInt(tier.redundancy==='2N fully redundant'?'4': tier.redundancy==='N+1 concurrent'?'3':tier.redundancy==='N+1'?'2':'1')] || 20;
        var pueScore      = clamp((2.0-pue)*80, 0, 80);
        return clamp((incidentScore*0.30 + turnoverScore*0.15 + staffRatio*0.10 + tierBonus*0.25 + pueScore*0.20), 0, 100);
    }

    // ── Panel 1: Financial Impact & ROI ──
    function calcFinancial(inp){
        // Single Loss Expectancy (cost of one major outage)
        var sle = inp.itLoad * 1e6 * 0.35; // ~$350K per MW of IT load per outage
        // Annualized Rate of Occurrence
        var aro = inp.incidents * 0.15; // 15% of incidents lead to financial loss events
        var ale = sle * aro;

        // Insurance risk index: region base * incident modifier * tier discount
        var tierDiscount = ({1:1.35, 2:1.15, 3:0.95, 4:0.85})[parseInt(inp.tier.redundancy==='2N fully redundant'?'4':inp.tier.redundancy==='N+1 concurrent'?'3':inp.tier.redundancy==='N+1'?'2':'1')] || 1.0;
        var insuranceIdx = inp.region.insuranceIdx * (1 + inp.incidents*0.02) * tierDiscount;

        // ROI of maturity improvement
        var investmentCost = inp.itLoad * 150000 * inp.tier.capexMult;
        var avoidedLoss = ale * 0.65; // 65% of ALE avoided through maturity improvement
        var efficiencyGain = inp.annualEnergyCost * (inp.pue - 1.2) / inp.pue * 0.3;
        var roi = investmentCost > 0 ? ((avoidedLoss + efficiencyGain) / investmentCost * 100) : 0;

        // OPEX efficiency score
        var totalOpex = inp.annualEnergyCost + inp.annualLaborCost + ale;
        var benchmarkOpex = inp.itLoad * 1.3 * 8760 * inp.region.energyRate * 1000 + inp.staffCount * inp.region.laborCost * 0.8;
        var opexEff = benchmarkOpex > 0 ? clamp((benchmarkOpex / totalOpex) * 100, 0, 150) : 70;

        // Budget variance forecast (next 12 months)
        var volatility = (inp.incidents * 0.5 + inp.turnover * 0.2 + (inp.pue - 1.2) * 10);
        var budgetVar = clamp(volatility - 5, -15, 30);

        // 5-year NPV of maturity investment
        var discountRate = 0.08;
        var npv = -investmentCost;
        for(var y=1;y<=5;y++){
            var benefit = (avoidedLoss + efficiencyGain) * Math.pow(1.03, y); // 3% annual growth
            npv += benefit / Math.pow(1 + discountRate, y);
        }

        return {
            ale:ale, insuranceIdx:insuranceIdx, roi:roi, opexEff:opexEff,
            budgetVar:budgetVar, npv:npv, investmentCost:investmentCost,
            avoidedLoss:avoidedLoss, efficiencyGain:efficiencyGain,
            sle:sle, aro:aro, totalOpex:totalOpex
        };
    }

    // ── Panel 2: Regulatory Compliance ──
    function calcCompliance(inp){
        var maturity = inp.maturityScore;
        // EED Article 12 score (Energy Efficiency Directive) — 25 mandatory reporting points
        var eedBase = clamp(maturity * 0.85 + (100-inp.pue*30), 0, 100);
        var eedRegBonus = inp.region.regSeverity > 60 ? 10 : 0; // higher reg = better prep
        var eedScore = clamp(eedBase + eedRegBonus, 0, 100);

        // AI Act Article 12 Readiness (record-keeping, traceability)
        var aiActBase = clamp(maturity * 0.55 - inp.incidents * 2 + inp.staffCount * 0.05, 0, 100);
        var aiActScore = clamp(aiActBase, 0, 100);

        // Detection Quality Index: TP / (TP + FP)
        var dqi = clamp(0.95 - inp.incidents * 0.015 - inp.turnover * 0.003, 0.40, 0.99);

        // Evidence delivery SLA (within 48hr target)
        var evidenceSLA = clamp(98 - inp.incidents * 0.8 - inp.turnover * 0.15, 50, 99.5);

        // Automation ratio
        var autoRatio = clamp(maturity * 0.65 - 10 + inp.staffCount * 0.02, 10, 90);

        // Composite grade
        var composite = (eedScore * 0.25 + aiActScore * 0.20 + dqi * 100 * 0.20 + evidenceSLA * 0.20 + autoRatio * 0.15);
        var grades = ['F','D-','D','D+','C-','C','C+','B-','B','B+','A-','A','A+'];
        var gradeIdx = clamp(Math.floor(composite / 8), 0, 12);
        var compGrade = grades[gradeIdx];

        return {
            eedScore:eedScore, aiActScore:aiActScore, dqi:dqi,
            evidenceSLA:evidenceSLA, autoRatio:autoRatio,
            compGrade:compGrade, composite:composite
        };
    }

    // ── Panel 3: Infrastructure & Reliability ──
    function calcReliability(inp){
        // MTBF adjusted by maturity & incidents
        var mtbf = inp.tier.mtbfBase * (1 + (inp.maturityScore - 50) / 100) * (1 - inp.incidents * 0.01);
        mtbf = Math.max(mtbf, 1000);

        // P(Survival) = e^(-t/MTBF) for t=8760 hrs (12 months)
        var survival = Math.exp(-8760 / mtbf) * 100;

        // MTTR based on staff, maturity
        var mttrBase = 8 - inp.maturityScore * 0.05; // baseline 3-8 hours
        var mttr = clamp(mttrBase * (1 + inp.turnover / 100) * (50 / Math.max(inp.staffCount, 10)), 0.5, 24);

        // Energy Reuse Factor
        var erf = clamp(0.05 + inp.maturityScore * 0.002 - (inp.pue - 1.2) * 0.1, 0, 0.40);

        // WUE estimate
        var wueBase = 1.8;
        var wue = wueBase * (inp.pue / 1.4) * (1 + inp.region.waterStress * 0.05);
        wue = clamp(wue, 0.4, 4.0);

        // PUE peer benchmark percentile
        var pueBenchmarks = [1.10,1.15,1.20,1.25,1.30,1.35,1.40,1.45,1.50,1.55,1.60,1.70,1.80,2.00,2.50];
        var betterCount = pueBenchmarks.filter(function(b){ return b >= inp.pue; }).length;
        var puePercentile = Math.round((betterCount / pueBenchmarks.length) * 100);
        var pueLabel = 'Top ' + (100 - puePercentile) + '%';
        if(puePercentile >= 80) pueLabel = 'Top ' + (100-puePercentile) + '%';

        return {
            survival:survival, mtbf:mtbf, mttr:mttr,
            erf:erf, wue:wue, pueBench:pueLabel, puePercentile:puePercentile
        };
    }

    // ── Panel 4: Monte Carlo 10K Simulation ──
    function runMonteCarlo(inp, fin){
        var N = 10000;
        var results = [];
        var baseALE = fin.ale;
        var baseEnergy = inp.annualEnergyCost;
        var baseLabor = inp.annualLaborCost;
        var baseCost = baseALE + baseEnergy + baseLabor;

        for(var i=0;i<N;i++){
            var energyShock = 1 + boxMuller() * 0.15;        // +/-15% energy cost
            var pueShock    = 1 + boxMuller() * 0.08;         // +/-8% PUE variation
            var incidentShock = 1 + Math.abs(boxMuller()) * 0.25; // right-skewed incident cost
            var laborShock  = 1 + boxMuller() * 0.10;         // +/-10% labor cost
            var turnoverShock = 1 + boxMuller() * 0.12;       // +/-12% turnover effect

            var simCost = baseEnergy * energyShock * pueShock
                        + baseALE * incidentShock * turnoverShock
                        + baseLabor * laborShock * turnoverShock;
            results.push(simCost);
        }
        results.sort(function(a,b){ return a-b; });

        var p5  = percentile(results, 5);
        var p25 = percentile(results, 25);
        var p50 = percentile(results, 50);
        var p75 = percentile(results, 75);
        var p95 = percentile(results, 95);

        // CVaR-95: average of worst 5%
        var tail5 = results.slice(Math.floor(N*0.95));
        var cvar = tail5.reduce(function(s,v){return s+v;},0) / tail5.length;

        // Break-even probability: P(investment ROI > 0)
        var investCost = fin.investmentCost;
        var beCount = 0;
        for(var j=0;j<N;j++){
            var savedCost = baseCost - results[j]; // negative = worse
            if((fin.avoidedLoss + fin.efficiencyGain + savedCost * 0.1) > investCost * 0.2) beCount++;
        }
        var beProb = (beCount / N) * 100;

        // 90% CI band width
        var confBand = p95 - p5;

        return {
            results:results, p5:p5, p25:p25, p50:p50, p75:p75, p95:p95,
            cvar:cvar, beProb:beProb, confBand:confBand, baseCost:baseCost
        };
    }

    // ── Sensitivity Analysis (5 factors) ──
    function runSensitivity(inp, fin){
        var baseCost = fin.ale + inp.annualEnergyCost + inp.annualLaborCost;
        var factors = [
            { name:'Energy Cost',    up: inp.annualEnergyCost * 1.10 + fin.ale + inp.annualLaborCost, down: inp.annualEnergyCost * 0.90 + fin.ale + inp.annualLaborCost },
            { name:'PUE',            up: inp.annualEnergyCost*(inp.pue*1.10/inp.pue) + fin.ale + inp.annualLaborCost, down: inp.annualEnergyCost*(inp.pue*0.90/inp.pue) + fin.ale + inp.annualLaborCost },
            { name:'Labor Cost',     up: inp.annualEnergyCost + fin.ale + inp.annualLaborCost*1.10, down: inp.annualEnergyCost + fin.ale + inp.annualLaborCost*0.90 },
            { name:'Incidents',      up: inp.annualEnergyCost + fin.sle*(inp.incidents*1.10)*0.15 + inp.annualLaborCost, down: inp.annualEnergyCost + fin.sle*(inp.incidents*0.90)*0.15 + inp.annualLaborCost },
            { name:'Staff Turnover', up: inp.annualEnergyCost + fin.ale*1.08 + inp.annualLaborCost*1.05, down: inp.annualEnergyCost + fin.ale*0.92 + inp.annualLaborCost*0.95 }
        ];

        var sensitivity = factors.map(function(f){
            var absSwing = Math.abs(f.up - f.down);
            return { name:f.name, upVal:f.up, downVal:f.down, absSwing:absSwing, impact:((f.up-baseCost)/baseCost)*100 };
        });
        sensitivity.sort(function(a,b){ return b.absSwing - a.absSwing; });
        return sensitivity;
    }

    // ── Canvas: Compliance Radar Chart ──
    function drawRadarChart(comp){
        var canvas = $('opmRadarChart');
        if(!canvas||!canvas.getContext) return;
        var ctx = canvas.getContext('2d');
        var W = canvas.parentElement.clientWidth - 32;
        canvas.width = W; canvas.height = 280;
        ctx.clearRect(0,0,W,280);

        var cx = W/2, cy = 155, R = 110;
        var labels = ['EED Art.12','AI Act','DQI','Evidence SLA','Automation','Composite'];
        var values = [comp.eedScore/100, comp.aiActScore/100, comp.dqi, comp.evidenceSLA/100, comp.autoRatio/100, comp.composite/100];
        var n = labels.length;
        var angleStep = (2*Math.PI)/n;

        // title
        ctx.fillStyle='#94a3b8'; ctx.font='11px Inter,sans-serif'; ctx.textAlign='center';
        ctx.fillText('Regulatory Compliance Radar', W/2, 16);

        // concentric rings
        [0.25,0.50,0.75,1.0].forEach(function(frac){
            ctx.beginPath();
            for(var i=0;i<=n;i++){
                var a = -Math.PI/2 + i*angleStep;
                var x = cx + Math.cos(a)*R*frac;
                var y = cy + Math.sin(a)*R*frac;
                if(i===0) ctx.moveTo(x,y); else ctx.lineTo(x,y);
            }
            ctx.closePath();
            ctx.strokeStyle='rgba(148,163,184,0.2)'; ctx.lineWidth=1; ctx.stroke();
        });

        // axis lines + labels
        for(var i=0;i<n;i++){
            var a=-Math.PI/2+i*angleStep;
            ctx.beginPath(); ctx.moveTo(cx,cy);
            ctx.lineTo(cx+Math.cos(a)*R, cy+Math.sin(a)*R);
            ctx.strokeStyle='rgba(148,163,184,0.15)'; ctx.stroke();

            var lx=cx+Math.cos(a)*(R+20), ly=cy+Math.sin(a)*(R+20);
            ctx.fillStyle='#94a3b8'; ctx.font='9px Inter,sans-serif'; ctx.textAlign='center';
            ctx.fillText(labels[i], lx, ly+3);
        }

        // data polygon
        ctx.beginPath();
        for(var i=0;i<n;i++){
            var a=-Math.PI/2+i*angleStep;
            var v = clamp(values[i],0,1);
            var x=cx+Math.cos(a)*R*v, y=cy+Math.sin(a)*R*v;
            if(i===0) ctx.moveTo(x,y); else ctx.lineTo(x,y);
        }
        ctx.closePath();
        ctx.fillStyle='rgba(16,185,129,0.15)'; ctx.fill();
        ctx.strokeStyle='#10b981'; ctx.lineWidth=2; ctx.stroke();

        // data points
        for(var i=0;i<n;i++){
            var a=-Math.PI/2+i*angleStep;
            var v=clamp(values[i],0,1);
            ctx.beginPath();
            ctx.arc(cx+Math.cos(a)*R*v, cy+Math.sin(a)*R*v, 4, 0, 2*Math.PI);
            ctx.fillStyle='#10b981'; ctx.fill();
            ctx.strokeStyle='#fff'; ctx.lineWidth=1.5; ctx.stroke();
        }
    }

    // ── Canvas: Monte Carlo Histogram ──
    function drawHistogramChart(mc){
        var canvas = $('opmHistogramChart');
        if(!canvas||!canvas.getContext) return;
        var ctx = canvas.getContext('2d');
        var W = canvas.parentElement.clientWidth - 32;
        canvas.width = W; canvas.height = 240;
        ctx.clearRect(0,0,W,240);

        var results = mc.results;
        var minV=results[0], maxV=results[results.length-1], range=maxV-minV||1;
        var numBins=40, bins=new Array(numBins).fill(0);
        results.forEach(function(v){ var b=Math.min(Math.floor((v-minV)/range*numBins),numBins-1); bins[b]++; });
        var maxBin=Math.max.apply(null,bins);
        var barW=(W-60)/numBins, baseY=200;

        ctx.fillStyle='#94a3b8'; ctx.font='11px Inter,sans-serif'; ctx.textAlign='center';
        ctx.fillText('Annual Cost Distribution — 10,000 Simulations', W/2, 16);

        bins.forEach(function(c,i){
            var x=30+i*barW;
            var barH=maxBin>0?(c/maxBin)*160:0;
            var y=baseY-barH;
            var binCenter=minV+(i+0.5)*range/numBins;
            var color = binCenter<=mc.p5?'#10b981': binCenter<=mc.p50?'#0891b2': binCenter<=mc.p95?'#f59e0b':'#ef4444';
            ctx.fillStyle=color;
            ctx.fillRect(x,y,Math.max(barW-0.5,0.5),barH);
        });

        // percentile lines
        [{v:mc.p5,l:'P5 '+fmt(mc.p5),c:'#10b981'},{v:mc.p50,l:'P50 '+fmt(mc.p50),c:'#0891b2'},{v:mc.p95,l:'P95 '+fmt(mc.p95),c:'#ef4444'}].forEach(function(m){
            var xp=30+((m.v-minV)/range)*(W-60);
            ctx.strokeStyle=m.c; ctx.lineWidth=1.5; ctx.setLineDash([4,3]);
            ctx.beginPath(); ctx.moveTo(xp,25); ctx.lineTo(xp,baseY); ctx.stroke();
            ctx.setLineDash([]);
            ctx.fillStyle=m.c; ctx.font='bold 9px Inter,sans-serif'; ctx.textAlign='center';
            ctx.fillText(m.l,xp,baseY+14);
        });

        // legend
        ctx.font='8px Inter,sans-serif'; ctx.textAlign='left';
        [{c:'#10b981',l:'Best 5%'},{c:'#0891b2',l:'P5-P50'},{c:'#f59e0b',l:'P50-P95'},{c:'#ef4444',l:'Worst 5%'}].forEach(function(leg,i){
            var lx=W-200+i*52;
            ctx.fillStyle=leg.c; ctx.fillRect(lx,226,10,8);
            ctx.fillStyle='#94a3b8'; ctx.fillText(leg.l,lx+13,234);
        });
    }

    // ── Canvas: Tornado Chart ──
    function drawTornadoChart(sensitivity, baseCost){
        var canvas=$('opmTornadoChart');
        if(!canvas||!canvas.getContext) return;
        var ctx=canvas.getContext('2d');
        var W=canvas.parentElement.clientWidth-32;
        canvas.width=W; canvas.height=200;
        ctx.clearRect(0,0,W,200);

        ctx.fillStyle='#94a3b8'; ctx.font='11px Inter,sans-serif'; ctx.textAlign='center';
        ctx.fillText('Sensitivity Tornado Chart (+/- 10% Input Variation)',W/2,15);

        var maxSwing=Math.max.apply(null,sensitivity.map(function(d){return d.absSwing;}))||1;
        var barH=28, gap=8, startY=35;
        var centerX=W*0.55, maxBarW=W*0.32;

        // baseline reference
        ctx.strokeStyle='rgba(148,163,184,0.3)'; ctx.lineWidth=1; ctx.setLineDash([3,3]);
        ctx.beginPath(); ctx.moveTo(centerX,startY-5);
        ctx.lineTo(centerX,startY+sensitivity.length*(barH+gap));
        ctx.stroke(); ctx.setLineDash([]);
        ctx.fillStyle='#64748b'; ctx.font='8px Inter,sans-serif'; ctx.textAlign='center';
        ctx.fillText('Baseline: '+fmt(baseCost),centerX,startY-8);

        sensitivity.forEach(function(d,i){
            var y=startY+i*(barH+gap);
            var upW=d.absSwing>0?(((d.upVal-baseCost)/maxSwing)*maxBarW):0;
            var dnW=d.absSwing>0?(((baseCost-d.downVal)/maxSwing)*maxBarW):0;

            if(upW>0){
                ctx.fillStyle='#ef4444';
                ctx.beginPath(); var rr=3;
                ctx.moveTo(centerX,y); ctx.lineTo(centerX+upW-rr,y);
                ctx.quadraticCurveTo(centerX+upW,y,centerX+upW,y+rr);
                ctx.lineTo(centerX+upW,y+barH-rr);
                ctx.quadraticCurveTo(centerX+upW,y+barH,centerX+upW-rr,y+barH);
                ctx.lineTo(centerX,y+barH); ctx.closePath(); ctx.fill();
                ctx.fillStyle='#fca5a5'; ctx.font='bold 9px Inter,sans-serif'; ctx.textAlign='left';
                ctx.fillText('+'+fmt(d.upVal-baseCost),centerX+upW+4,y+barH/2+3);
            }
            if(dnW>0){
                ctx.fillStyle='#06b6d4';
                ctx.beginPath(); var rl=3;
                ctx.moveTo(centerX,y); ctx.lineTo(centerX-dnW+rl,y);
                ctx.quadraticCurveTo(centerX-dnW,y,centerX-dnW,y+rl);
                ctx.lineTo(centerX-dnW,y+barH-rl);
                ctx.quadraticCurveTo(centerX-dnW,y+barH,centerX-dnW+rl,y+barH);
                ctx.lineTo(centerX,y+barH); ctx.closePath(); ctx.fill();
                ctx.fillStyle='#67e8f9'; ctx.font='bold 9px Inter,sans-serif'; ctx.textAlign='right';
                ctx.fillText('-'+fmt(baseCost-d.downVal),centerX-dnW-4,y+barH/2+3);
            }

            ctx.fillStyle='#e2e8f0'; ctx.font='10px Inter,sans-serif'; ctx.textAlign='right';
            ctx.fillText(d.name,centerX-maxBarW-12,y+barH/2+3);
        });
    }

    // ── Panel 5: Narrative Generator (4 paragraphs) ──
    function generateNarrative(inp, fin, comp, rel, mc, sens){
        var region = inp.region;
        var html = '';

        // 1. Executive Summary
        var matLevel = inp.maturityScore >= 75 ? 'advanced' : inp.maturityScore >= 50 ? 'moderate' : 'developing';
        html += '<p class="opm-narr-section"><strong>Executive Summary:</strong> ';
        html += 'This ' + inp.itLoad.toFixed(1) + ' MW ' + inp.tierKey + ' facility in ' + region.label;
        html += ' operates at a <strong>' + matLevel + '</strong> maturity level (score: ' + inp.maturityScore.toFixed(0) + '/100).';
        html += ' With a PUE of ' + inp.pue.toFixed(2) + ' and ' + inp.staffCount + ' operations staff,';
        html += ' the facility demonstrates ' + (inp.maturityScore >= 60 ? 'competent' : 'improvement-needed') + ' operational governance.';
        html += ' Annual energy consumption of ' + (inp.annualEnergyMWh/1000).toFixed(0) + ' GWh at ' + region.label + ' grid rates';
        html += ' places total OPEX at approximately ' + fmt(fin.totalOpex) + '.</p>';

        // 2. Financial Exposure
        html += '<p class="opm-narr-section"><strong>Financial Exposure:</strong> ';
        html += 'The Annualized Loss Expectancy stands at <strong>' + fmt(fin.ale) + '</strong>,';
        html += ' derived from a Single Loss Expectancy of ' + fmt(fin.sle) + ' across ' + inp.incidents + ' annual incidents.';
        html += ' Insurance risk indexing at <strong>' + fin.insuranceIdx.toFixed(2) + 'x</strong>';
        html += (fin.insuranceIdx > 1.3 ? ' signals elevated premium exposure.' : ' remains within acceptable bounds.');
        html += ' A targeted maturity investment of ' + fmt(fin.investmentCost) + ' projects';
        html += ' an ROI of <strong>' + fin.roi.toFixed(0) + '%</strong> through avoided losses (' + fmt(fin.avoidedLoss) + '/yr)';
        html += ' and efficiency gains (' + fmt(fin.efficiencyGain) + '/yr).';
        html += ' Monte Carlo analysis (10K iterations) reveals a P50 annual cost of <strong>' + fmt(mc.p50) + '</strong>';
        html += ' with CVaR-95 at ' + fmt(mc.cvar) + ', indicating ';
        html += (mc.cvar > mc.p50 * 1.5 ? 'significant tail risk requiring contingency reserves.' : 'manageable cost distribution.');
        html += '</p>';

        // 3. Regulatory Risk
        html += '<p class="opm-narr-section"><strong>Regulatory & Compliance Risk:</strong> ';
        html += 'Composite compliance grade of <strong>' + comp.compGrade + '</strong>';
        html += (comp.composite >= 70 ? ' indicates strong regulatory posture.' : comp.composite >= 50 ? ' suggests moderate compliance gaps.' : ' highlights critical compliance deficiencies.');
        html += ' EED Article 12 readiness at ' + comp.eedScore.toFixed(0) + '%';
        html += ' and AI Act traceability at ' + comp.aiActScore.toFixed(0) + '%';
        html += ' reflect ' + (region.regSeverity >= 60 ? 'the demanding regulatory environment in ' + region.label + '.' : 'room for improvement ahead of tightening regulations.');
        html += ' Detection Quality Index of ' + comp.dqi.toFixed(2);
        html += (comp.dqi >= 0.85 ? ' meets industry best-practice thresholds.' : comp.dqi >= 0.70 ? ' approaches acceptable performance.' : ' requires significant improvement in monitoring fidelity.');
        html += ' Current automation ratio of ' + comp.autoRatio.toFixed(0) + '% ';
        html += (comp.autoRatio >= 50 ? 'supports sustainable compliance operations.' : 'will likely drive rising labor costs as regulatory burden increases.');
        html += '</p>';

        // 4. Strategic Recommendations
        var topDriver = sens[0].name;
        html += '<p class="opm-narr-section"><strong>Strategic Recommendations:</strong> ';
        html += 'Sensitivity analysis identifies <strong>' + topDriver + '</strong> as the dominant cost driver.';
        if(inp.incidents > 5) html += ' Priority: reduce incident frequency from ' + inp.incidents + ' to below 5 per year through enhanced preventive maintenance and DCIM integration.';
        if(inp.turnover > 20) html += ' Staff retention programs (current turnover: ' + inp.turnover + '%) should target industry-standard 12-15% to preserve institutional knowledge.';
        if(inp.pue > 1.5) html += ' PUE optimization from ' + inp.pue.toFixed(2) + ' toward 1.30 through hot/cold aisle containment and AI-driven cooling would yield ' + fmt(inp.annualEnergyCost * (inp.pue-1.3)/inp.pue) + ' annual savings.';
        if(comp.autoRatio < 50) html += ' Invest in compliance automation to raise the ratio from ' + comp.autoRatio.toFixed(0) + '% to 60%+, reducing evidence-gathering labor by an estimated 35%.';
        html += ' The 5-year NPV of <strong>' + fmt(fin.npv) + '</strong> validates the business case for structured maturity advancement.';
        html += '</p>';

        return html;
    }

    // ── SVG builders for PDF ──
    function buildRadarSVG(comp){
        var svgW=400, svgH=320, cx=200, cy=175, R=110;
        var labels=['EED Art.12','AI Act','DQI','Evidence SLA','Automation','Composite'];
        var values=[comp.eedScore/100,comp.aiActScore/100,comp.dqi,comp.evidenceSLA/100,comp.autoRatio/100,comp.composite/100];
        var n=labels.length, step=(2*Math.PI)/n;
        var svg='<svg xmlns="http://www.w3.org/2000/svg" width="'+svgW+'" height="'+svgH+'" viewBox="0 0 '+svgW+' '+svgH+'">';
        svg+='<rect width="'+svgW+'" height="'+svgH+'" fill="#f8fafc"/>';
        svg+='<text x="'+cx+'" y="20" text-anchor="middle" fill="#1f2937" font-family="Inter,sans-serif" font-size="12" font-weight="bold">Compliance Radar</text>';
        [0.25,0.5,0.75,1.0].forEach(function(frac){
            svg+='<polygon points="';
            for(var i=0;i<n;i++){ var a=-Math.PI/2+i*step; svg+=(cx+Math.cos(a)*R*frac)+','+(cy+Math.sin(a)*R*frac)+' '; }
            svg+='" fill="none" stroke="#cbd5e1" stroke-width="0.5"/>';
        });
        // data polygon
        svg+='<polygon points="';
        for(var i=0;i<n;i++){ var a=-Math.PI/2+i*step; var v=clamp(values[i],0,1); svg+=(cx+Math.cos(a)*R*v)+','+(cy+Math.sin(a)*R*v)+' '; }
        svg+='" fill="rgba(16,185,129,0.2)" stroke="#10b981" stroke-width="2"/>';
        for(var i=0;i<n;i++){
            var a=-Math.PI/2+i*step;
            var lx=cx+Math.cos(a)*(R+22), ly=cy+Math.sin(a)*(R+22);
            svg+='<text x="'+lx+'" y="'+(ly+4)+'" text-anchor="middle" fill="#64748b" font-family="Inter,sans-serif" font-size="9">'+labels[i]+'</text>';
            var v=clamp(values[i],0,1);
            svg+='<circle cx="'+(cx+Math.cos(a)*R*v)+'" cy="'+(cy+Math.sin(a)*R*v)+'" r="4" fill="#10b981" stroke="#fff" stroke-width="1.5"/>';
        }
        svg+='</svg>';
        return svg;
    }

    function buildHistogramSVG(mc){
        var results=mc.results;
        var minV=results[0], maxV=results[results.length-1], range=maxV-minV||1;
        var numBins=40, bins=new Array(numBins).fill(0);
        results.forEach(function(v){ var b=Math.min(Math.floor((v-minV)/range*numBins),numBins-1); bins[b]++; });
        var maxBin=Math.max.apply(null,bins);
        var svgW=520, svgH=200, barW=(svgW-60)/numBins;
        var svg='<svg xmlns="http://www.w3.org/2000/svg" width="'+svgW+'" height="'+svgH+'" viewBox="0 0 '+svgW+' '+svgH+'">';
        svg+='<rect width="'+svgW+'" height="'+svgH+'" fill="#f8fafc"/>';
        svg+='<text x="'+(svgW/2)+'" y="18" text-anchor="middle" fill="#1f2937" font-family="Inter,sans-serif" font-size="12" font-weight="bold">Monte Carlo Distribution (10K Simulations)</text>';
        bins.forEach(function(c,i){
            var x=30+i*barW, barH=maxBin>0?(c/maxBin)*140:0, y=170-barH;
            var binCenter=minV+(i+0.5)*range/numBins;
            var color=binCenter<=mc.p5?'#10b981':binCenter<=mc.p50?'#0891b2':binCenter<=mc.p95?'#f59e0b':'#ef4444';
            svg+='<rect x="'+x+'" y="'+y+'" width="'+Math.max(barW-0.5,0.5)+'" height="'+barH+'" fill="'+color+'"/>';
        });
        [{v:mc.p5,l:'P5 '+fmt(mc.p5),c:'#10b981'},{v:mc.p50,l:'P50 '+fmt(mc.p50),c:'#0891b2'},{v:mc.p95,l:'P95 '+fmt(mc.p95),c:'#ef4444'}].forEach(function(m){
            var xp=30+((m.v-minV)/range)*(svgW-60);
            svg+='<line x1="'+xp+'" y1="28" x2="'+xp+'" y2="170" stroke="'+m.c+'" stroke-width="1.5" stroke-dasharray="4,3"/>';
            svg+='<text x="'+xp+'" y="185" text-anchor="middle" fill="'+m.c+'" font-family="Inter,sans-serif" font-size="9" font-weight="bold">'+m.l+'</text>';
        });
        svg+='</svg>';
        return svg;
    }

    function buildTornadoSVG(sensitivity, baseCost){
        var svgW=520, svgH=200;
        var maxSwing=Math.max.apply(null,sensitivity.map(function(d){return d.absSwing;}))||1;
        var barH=28, gap=8, startY=35;
        var centerX=svgW*0.55, maxBarW=svgW*0.30;
        var svg='<svg xmlns="http://www.w3.org/2000/svg" width="'+svgW+'" height="'+svgH+'" viewBox="0 0 '+svgW+' '+svgH+'">';
        svg+='<rect width="'+svgW+'" height="'+svgH+'" fill="#f8fafc"/>';
        svg+='<text x="'+(svgW/2)+'" y="18" text-anchor="middle" fill="#1f2937" font-family="Inter,sans-serif" font-size="12" font-weight="bold">Sensitivity Tornado Chart</text>';
        svg+='<line x1="'+centerX+'" y1="'+(startY-5)+'" x2="'+centerX+'" y2="'+(startY+sensitivity.length*(barH+gap))+'" stroke="#94a3b8" stroke-width="1" stroke-dasharray="3,3"/>';
        svg+='<text x="'+centerX+'" y="'+(startY-8)+'" text-anchor="middle" fill="#64748b" font-family="Inter,sans-serif" font-size="8">Baseline: '+fmt(baseCost)+'</text>';
        sensitivity.forEach(function(d,i){
            var y=startY+i*(barH+gap);
            var upW=d.absSwing>0?(((d.upVal-baseCost)/maxSwing)*maxBarW):0;
            var dnW=d.absSwing>0?(((baseCost-d.downVal)/maxSwing)*maxBarW):0;
            if(upW>0){
                svg+='<rect x="'+centerX+'" y="'+y+'" width="'+upW+'" height="'+barH+'" fill="#ef4444" rx="3"/>';
                svg+='<text x="'+(centerX+upW+4)+'" y="'+(y+barH/2+4)+'" fill="#dc2626" font-family="Inter,sans-serif" font-size="9" font-weight="bold">+'+fmt(d.upVal-baseCost)+'</text>';
            }
            if(dnW>0){
                svg+='<rect x="'+(centerX-dnW)+'" y="'+y+'" width="'+dnW+'" height="'+barH+'" fill="#0891b2" rx="3"/>';
                svg+='<text x="'+(centerX-dnW-4)+'" y="'+(y+barH/2+4)+'" text-anchor="end" fill="#0891b2" font-family="Inter,sans-serif" font-size="9" font-weight="bold">-'+fmt(baseCost-d.downVal)+'</text>';
            }
            svg+='<text x="'+(centerX-maxBarW-12)+'" y="'+(y+barH/2+4)+'" text-anchor="end" fill="#1f2937" font-family="Inter,sans-serif" font-size="10">'+d.name+'</text>';
        });
        svg+='</svg>';
        return svg;
    }

    // ── Master update ──
    function updateAllPanels(){
        var inp = getInputs();
        var fin = calcFinancial(inp);
        var comp = calcCompliance(inp);
        var rel = calcReliability(inp);
        var mc = runMonteCarlo(inp, fin);
        var sens = runSensitivity(inp, fin);

        // Panel 1 — Financial
        $('opmALE').textContent = fmt(fin.ale);
        $('opmInsuranceIdx').textContent = fin.insuranceIdx.toFixed(2);
        $('opmROI').textContent = fin.roi.toFixed(0) + '%';
        $('opmOPEXEff').textContent = fin.opexEff.toFixed(0) + '%';
        $('opmBudgetVar').textContent = (fin.budgetVar >= 0 ? '+' : '') + fin.budgetVar.toFixed(1) + '%';
        $('opmNPV').textContent = fmt(fin.npv);

        // Panel 2 — Compliance
        $('opmEEDScore').textContent = comp.eedScore.toFixed(0) + '%';
        $('opmAIActScore').textContent = comp.aiActScore.toFixed(0) + '%';
        $('opmDQI').textContent = comp.dqi.toFixed(2);
        $('opmEvidenceSLA').textContent = comp.evidenceSLA.toFixed(0) + '%';
        $('opmAutoRatio').textContent = comp.autoRatio.toFixed(0) + '%';
        $('opmCompGrade').textContent = comp.compGrade;

        // Panel 3 — Reliability
        $('opmSurvival').textContent = rel.survival.toFixed(1) + '%';
        $('opmMTBF').textContent = rel.mtbf.toFixed(0).replace(/\B(?=(\d{3})+(?!\d))/g,',') + ' hrs';
        $('opmMTTR').textContent = rel.mttr.toFixed(1) + ' hrs';
        $('opmERF').textContent = rel.erf.toFixed(2);
        $('opmWUE').textContent = rel.wue.toFixed(2);
        $('opmPUEBench').textContent = rel.pueBench;

        // Panel 4 — Monte Carlo
        $('opmMCP5').textContent = fmt(mc.p5);
        $('opmMCP25').textContent = fmt(mc.p25);
        $('opmMCP50').textContent = fmt(mc.p50);
        $('opmMCP75').textContent = fmt(mc.p75);
        $('opmMCP95').textContent = fmt(mc.p95);
        $('opmCVaR').textContent = fmt(mc.cvar);
        $('opmBEProb').textContent = mc.beProb.toFixed(0) + '%';
        $('opmConfBand').textContent = fmt(mc.confBand);

        // Panel 5 — Narrative
        $('opmNarrative').innerHTML = generateNarrative(inp, fin, comp, rel, mc, sens);

        // Charts (only draw when panels visible)
        if(opmProMode){
            drawRadarChart(comp);
            drawHistogramChart(mc);
            drawTornadoChart(sens, mc.baseCost);
        }
    }

    // ── Auth ──
    function opmCheckAuth(){
        try{
            var s=JSON.parse(localStorage.getItem('rz_premium_session')||'null');
            if(s && s.tier==='pro' && new Date(s.expires)>new Date()) return true;
        }catch(e){}
        return false;
    }

    function opmUnlockPanels(){
        opmProMode = true;
        $('opmProInputs').classList.add('visible');
        document.querySelectorAll('.opm-pro-panel').forEach(function(p){
            p.style.display='';
            p.classList.remove('gated');
            var overlay=p.querySelector('.opm-gate-overlay');
            if(overlay) overlay.style.display='none';
        });
        $('opmProBtn').classList.add('active');
        $('opmFreeBtn').classList.remove('active');
        var pdfBtn=$('opmPdfBtn');
        if(pdfBtn) pdfBtn.style.display='';
        updateAllPanels();
    }

    function opmLockPanels(){
        opmProMode = false;
        $('opmProInputs').classList.remove('visible');
        document.querySelectorAll('.opm-pro-panel').forEach(function(p){
            p.style.display='none';
            p.classList.add('gated');
            var overlay=p.querySelector('.opm-gate-overlay');
            if(overlay) overlay.style.display='';
        });
        $('opmFreeBtn').classList.add('active');
        $('opmProBtn').classList.remove('active');
        var pdfBtn=$('opmPdfBtn');
        if(pdfBtn) pdfBtn.style.display='none';
    }

    function opmShowPanelsGated(){
        // Show panels but gated (blurred, click to login)
        document.querySelectorAll('.opm-pro-panel').forEach(function(p){
            p.style.display='';
            p.classList.add('gated');
            var overlay=p.querySelector('.opm-gate-overlay');
            if(overlay) overlay.style.display='';
        });
        $('opmProInputs').classList.add('visible');
        $('opmProBtn').classList.add('active');
        $('opmFreeBtn').classList.remove('active');
        updateAllPanels();
    }

    // ── window-exposed functions ──
    window.opmSetMode = function(mode){
        if(mode==='pro'){
            if(opmCheckAuth()){ opmUnlockPanels(); }
            else { opmShowPanelsGated(); }
        } else {
            opmLockPanels();
        }
    };

    window.opmShowLogin = function(){
        $('opmLoginOverlay').classList.add('active');
        $('opmLoginError').style.display='none';
        $('opmLoginEmail').value='';
        $('opmLoginPass').value='';
        setTimeout(function(){ $('opmLoginEmail').focus(); },100);
    };

    window.opmHideLogin = function(){
        $('opmLoginOverlay').classList.remove('active');
    };

    window.opmDoLogin = function(){
        var email=$('opmLoginEmail').value.trim().toLowerCase();
        var pass=$('opmLoginPass').value;
        if(email==='demo@resistancezero.com' && pass==='demo2026'){
            var session={email:email, tier:'pro', expires:new Date(Date.now()+24*60*60*1000).toISOString()};
            localStorage.setItem('rz_premium_session',JSON.stringify(session));
            window.dispatchEvent(new Event('rz-auth-change'));
            opmHideLogin();
            opmUnlockPanels();
        } else {
            $('opmLoginError').style.display='block';
        }
    };

    window.opmRecalc = function(){
        updateAllPanels();
    };

    window.opmExportPDF = function(){
        if(!opmCheckAuth()){ opmShowLogin(); return; }
        var w=window.open('','_blank');
        if(!w){ alert('Please allow popups for this site to export PDF.'); return; }

        var inp=getInputs();
        var fin=calcFinancial(inp);
        var comp=calcCompliance(inp);
        var rel=calcReliability(inp);
        var mc=runMonteCarlo(inp,fin);
        var sens=runSensitivity(inp,fin);
        var narrative=generateNarrative(inp,fin,comp,rel,mc,sens);

        var region=inp.region;

        var html='<!DOCTYPE html><html><head><meta charset="UTF-8">';
        html+='<title>Operational Maturity Report - '+region.label+'</title>';
        html+='<style>';
        html+='body{font-family:Inter,Helvetica,Arial,sans-serif;color:#1f2937;max-width:800px;margin:0 auto;padding:40px 30px;font-size:11pt;line-height:1.6;}';
        html+='h1{color:#065f46;font-size:22pt;margin-bottom:4px;border-bottom:3px solid #10b981;padding-bottom:8px;}';
        html+='h2{color:#065f46;font-size:14pt;margin-top:28px;margin-bottom:10px;border-bottom:1px solid #e5e7eb;padding-bottom:4px;}';
        html+='h3{color:#065f46;font-size:12pt;margin-top:20px;}';
        html+='.subtitle{color:#64748b;font-size:10pt;margin-bottom:20px;}';
        html+='.meta{display:flex;gap:20px;font-size:9pt;color:#64748b;margin-bottom:24px;flex-wrap:wrap;}';
        html+='.meta span{background:#ecfdf5;padding:3px 10px;border-radius:4px;border:1px solid #d1fae5;}';
        html+='table{width:100%;border-collapse:collapse;margin:12px 0;font-size:10pt;}';
        html+='th{background:#ecfdf5;color:#065f46;padding:8px 10px;text-align:left;font-weight:600;border-bottom:2px solid #d1fae5;}';
        html+='td{padding:7px 10px;border-bottom:1px solid #e5e7eb;color:#1f2937;}';
        html+='.kpi-row{display:flex;flex-wrap:wrap;gap:8px;margin:10px 0;}';
        html+='.kpi-item{flex:1;min-width:100px;background:#f0fdf4;border:1px solid #d1fae5;border-radius:8px;padding:10px;text-align:center;}';
        html+='.kpi-val{font-size:14pt;font-weight:800;color:#065f46;}';
        html+='.kpi-lbl{font-size:7.5pt;color:#64748b;margin-top:2px;}';
        html+='.kpi-sub{font-size:7pt;color:#94a3b8;}';
        html+='.narrative{background:#ecfdf5;border-left:3px solid #10b981;padding:12px 16px;margin:14px 0;border-radius:0 8px 8px 0;}';
        html+='.narrative p{color:#1f2937;font-size:9.5pt;margin:0 0 8px;line-height:1.6;}';
        html+='.narrative p:last-child{margin-bottom:0;}';
        html+='.narrative strong{color:#065f46;}';
        html+='.chart-wrap{text-align:center;margin:16px 0;}';
        html+='.methodology{background:#f8fafc;padding:12px 16px;border-radius:8px;margin-top:24px;font-size:9pt;color:#64748b;}';
        html+='.methodology h3{color:#065f46;margin-top:0;}';
        html+='.footer{margin-top:30px;padding-top:12px;border-top:1px solid #e5e7eb;font-size:8pt;color:#94a3b8;text-align:center;}';
        html+='@media print{body{padding:20px;}}';
        html+='</style></head><body>';

        html+='<h1>Operational Maturity Assessment Report</h1>';
        html+='<p class="subtitle">Data Center Operational Maturity & Risk Analysis \u2014 '+region.label+'</p>';
        html+='<div class="meta">';
        html+='<span>Region: '+region.label+'</span>';
        html+='<span>Tier: '+inp.tierKey+'</span>';
        html+='<span>IT Load: '+inp.itLoad.toFixed(1)+' MW</span>';
        html+='<span>PUE: '+inp.pue.toFixed(2)+'</span>';
        html+='<span>Staff: '+inp.staffCount+'</span>';
        html+='<span>Maturity: '+inp.maturityScore.toFixed(0)+'/100</span>';
        html+='<span>Generated: '+new Date().toLocaleDateString()+'</span>';
        html+='</div>';

        // Section 1: Financial
        html+='<h2>1. Financial Impact &amp; ROI Analysis</h2>';
        html+='<div class="kpi-row">';
        html+='<div class="kpi-item"><div class="kpi-val">'+fmt(fin.ale)+'</div><div class="kpi-lbl">Annual Loss Expectancy</div><div class="kpi-sub">SLE \u00d7 ARO</div></div>';
        html+='<div class="kpi-item"><div class="kpi-val">'+fin.insuranceIdx.toFixed(2)+'</div><div class="kpi-lbl">Insurance Risk Index</div></div>';
        html+='<div class="kpi-item"><div class="kpi-val">'+fin.roi.toFixed(0)+'%</div><div class="kpi-lbl">Fulfillment ROI</div></div>';
        html+='<div class="kpi-item"><div class="kpi-val">'+fin.opexEff.toFixed(0)+'%</div><div class="kpi-lbl">OPEX Efficiency</div></div>';
        html+='<div class="kpi-item"><div class="kpi-val">'+(fin.budgetVar>=0?'+':'')+fin.budgetVar.toFixed(1)+'%</div><div class="kpi-lbl">Budget Variance</div></div>';
        html+='<div class="kpi-item"><div class="kpi-val">'+fmt(fin.npv)+'</div><div class="kpi-lbl">5-Year NPV</div></div>';
        html+='</div>';
        html+='<table><tr><th>Metric</th><th>Value</th><th>Assessment</th></tr>';
        html+='<tr><td>Single Loss Expectancy</td><td>'+fmt(fin.sle)+'</td><td>Per-incident cost estimate</td></tr>';
        html+='<tr><td>Annualized Rate (ARO)</td><td>'+fin.aro.toFixed(2)+'</td><td>'+inp.incidents+' incidents \u00d7 15% loss rate</td></tr>';
        html+='<tr><td>Investment Required</td><td>'+fmt(fin.investmentCost)+'</td><td>'+inp.tierKey+' maturity program</td></tr>';
        html+='<tr><td>Annual Avoided Loss</td><td>'+fmt(fin.avoidedLoss)+'</td><td>65% ALE reduction target</td></tr>';
        html+='<tr><td>Efficiency Gains</td><td>'+fmt(fin.efficiencyGain)+'</td><td>PUE optimization savings</td></tr>';
        html+='</table>';

        // Section 2: Compliance
        html+='<h2>2. Regulatory Compliance Scorecard</h2>';
        html+='<div class="kpi-row">';
        html+='<div class="kpi-item"><div class="kpi-val">'+comp.eedScore.toFixed(0)+'%</div><div class="kpi-lbl">EED Art. 12</div></div>';
        html+='<div class="kpi-item"><div class="kpi-val">'+comp.aiActScore.toFixed(0)+'%</div><div class="kpi-lbl">AI Act Art. 12</div></div>';
        html+='<div class="kpi-item"><div class="kpi-val">'+comp.dqi.toFixed(2)+'</div><div class="kpi-lbl">DQI</div></div>';
        html+='<div class="kpi-item"><div class="kpi-val">'+comp.evidenceSLA.toFixed(0)+'%</div><div class="kpi-lbl">Evidence SLA</div></div>';
        html+='<div class="kpi-item"><div class="kpi-val">'+comp.autoRatio.toFixed(0)+'%</div><div class="kpi-lbl">Automation Ratio</div></div>';
        html+='<div class="kpi-item"><div class="kpi-val">'+comp.compGrade+'</div><div class="kpi-lbl">Composite Grade</div></div>';
        html+='</div>';
        html+='<div class="chart-wrap">'+buildRadarSVG(comp)+'</div>';

        // Section 3: Reliability
        html+='<h2>3. Infrastructure &amp; Reliability</h2>';
        html+='<div class="kpi-row">';
        html+='<div class="kpi-item"><div class="kpi-val">'+rel.survival.toFixed(1)+'%</div><div class="kpi-lbl">P(Survival) 12-Month</div><div class="kpi-sub">e^(-t/MTBF)</div></div>';
        html+='<div class="kpi-item"><div class="kpi-val">'+rel.mtbf.toFixed(0).replace(/\\B(?=(\\d{3})+(?!\\d))/g,',')+' hrs</div><div class="kpi-lbl">MTBF</div></div>';
        html+='<div class="kpi-item"><div class="kpi-val">'+rel.mttr.toFixed(1)+' hrs</div><div class="kpi-lbl">MTTR</div></div>';
        html+='<div class="kpi-item"><div class="kpi-val">'+rel.erf.toFixed(2)+'</div><div class="kpi-lbl">Energy Reuse Factor</div></div>';
        html+='<div class="kpi-item"><div class="kpi-val">'+rel.wue.toFixed(2)+'</div><div class="kpi-lbl">WUE (L/kWh)</div></div>';
        html+='<div class="kpi-item"><div class="kpi-val">'+rel.pueBench+'</div><div class="kpi-lbl">PUE Peer Rank</div></div>';
        html+='</div>';
        html+='<table><tr><th>Parameter</th><th>Value</th><th>Target ('+inp.tierKey+')</th></tr>';
        html+='<tr><td>Availability Target</td><td>'+inp.tier.availTarget+'%</td><td>'+inp.tier.availTarget+'%</td></tr>';
        html+='<tr><td>Redundancy</td><td>'+inp.tier.redundancy+'</td><td>'+inp.tier.redundancy+'</td></tr>';
        html+='<tr><td>Annual Downtime Budget</td><td>'+(8760*(1-inp.tier.availTarget/100)).toFixed(1)+' hrs</td><td>'+(8760*(1-inp.tier.availTarget/100)).toFixed(1)+' hrs</td></tr>';
        html+='<tr><td>Grid Carbon Intensity</td><td>'+region.gridCarbon+' tCO2/MWh</td><td>< 0.40 tCO2/MWh</td></tr>';
        html+='</table>';

        // Section 4: Monte Carlo
        html+='<h2>4. Monte Carlo Risk Analysis (10,000 Iterations)</h2>';
        html+='<div class="kpi-row">';
        html+='<div class="kpi-item"><div class="kpi-val">'+fmt(mc.p5)+'</div><div class="kpi-lbl">P5 (Best)</div></div>';
        html+='<div class="kpi-item"><div class="kpi-val">'+fmt(mc.p25)+'</div><div class="kpi-lbl">P25</div></div>';
        html+='<div class="kpi-item"><div class="kpi-val">'+fmt(mc.p50)+'</div><div class="kpi-lbl">P50 (Median)</div></div>';
        html+='<div class="kpi-item"><div class="kpi-val">'+fmt(mc.p75)+'</div><div class="kpi-lbl">P75</div></div>';
        html+='<div class="kpi-item"><div class="kpi-val">'+fmt(mc.p95)+'</div><div class="kpi-lbl">P95 (Worst)</div></div>';
        html+='<div class="kpi-item"><div class="kpi-val">'+fmt(mc.cvar)+'</div><div class="kpi-lbl">CVaR-95</div></div>';
        html+='<div class="kpi-item"><div class="kpi-val">'+mc.beProb.toFixed(0)+'%</div><div class="kpi-lbl">Break-Even Prob</div></div>';
        html+='<div class="kpi-item"><div class="kpi-val">'+fmt(mc.confBand)+'</div><div class="kpi-lbl">90% CI Band</div></div>';
        html+='</div>';
        html+='<div class="chart-wrap">'+buildHistogramSVG(mc)+'</div>';
        html+='<h3>Sensitivity Analysis</h3>';
        html+='<div class="chart-wrap">'+buildTornadoSVG(sens, mc.baseCost)+'</div>';
        html+='<table><tr><th>Variable</th><th>Impact (+10%)</th><th>Absolute Swing</th></tr>';
        sens.forEach(function(d){ html+='<tr><td>'+d.name+'</td><td>+'+d.impact.toFixed(1)+'%</td><td>'+fmt(d.absSwing)+'</td></tr>'; });
        html+='</table>';

        // Narrative
        html+='<h2>5. Executive Assessment</h2>';
        html+='<div class="narrative">'+narrative+'</div>';

        // Methodology
        html+='<div class="methodology">';
        html+='<h3>Methodology Note</h3>';
        html+='<p>Maturity scoring integrates incident frequency (30%), turnover impact (15%), staffing adequacy (10%), tier redundancy (25%), and PUE efficiency (20%). Financial calculations use Single Loss Expectancy \u00d7 Annualized Rate of Occurrence for ALE. NPV computed at 8% discount rate with 3% annual benefit growth over 5 years. Monte Carlo: 10,000 iterations with Box-Muller normal distribution \u2014 energy cost \u00b115%, PUE \u00b18%, incidents \u00b125% (right-skewed), labor \u00b110%, turnover \u00b112%. CVaR-95 = mean of worst 5%. Compliance scoring references EU Energy Efficiency Directive (EED) Art. 12 and EU AI Act Art. 12 frameworks. MTBF derived from Uptime Institute tier baselines adjusted for operational maturity. All calculations performed client-side; no data transmitted.</p>';
        html+='</div>';

        html+='<div class="footer">Generated by ResistanceZero Operational Maturity Calculator | resistancezero.com | '+new Date().toISOString().split('T')[0]+'</div>';
</body></html>';

        w.document.write(html);
        w.document.close();
        setTimeout(function(){ w.print(); },500);
    };

    // ── Enter key in login ──
    $('opmLoginPass').addEventListener('keydown',function(e){ if(e.key==='Enter') opmDoLogin(); });
    $('opmLoginEmail').addEventListener('keydown',function(e){ if(e.key==='Enter') $('opmLoginPass').focus(); });

    // ── Close on overlay click ──
    $('opmLoginOverlay').addEventListener('click',function(e){ if(e.target===this) opmHideLogin(); });

    // ── Listen for auth changes ──
    window.addEventListener('rz-auth-change',function(){
        if(opmCheckAuth()) opmUnlockPanels();
        else opmLockPanels();
    });

    // ── Tooltip positioning ──
    document.querySelectorAll('.tooltip-trigger').forEach(function(trigger){
        trigger.addEventListener('mouseenter',function(){
            var tip=this.querySelector('.tooltip-content');
            if(!tip) return;
            var rect=this.getBoundingClientRect();
            var tipRect=tip.getBoundingClientRect();
            if(rect.left+tipRect.width/2>window.innerWidth-10){
                tip.style.left='auto'; tip.style.right='-10px'; tip.style.transform='none';
            }
            if(rect.left-tipRect.width/2<10){
                tip.style.left='-10px'; tip.style.right='auto'; tip.style.transform='none';
            }
            if(rect.top<tipRect.height+20){
                tip.style.bottom='auto'; tip.style.top='calc(100% + 10px)';
            }
        });
    });

    // ── Init ──
    if(opmCheckAuth()){
        opmUnlockPanels();
    } else {
        updateAllPanels(); // pre-populate values (blurred behind gate)
    }

})();
</script>
<script src="auth.js"></script>
<script src="rz-tracker.js"></script>
  <script src="/rz-chat.js" defer></script>
</body>
</html>
