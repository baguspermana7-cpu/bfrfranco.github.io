<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-GED7FX8RTV"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-GED7FX8RTV');
    </script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <!-- SEO Meta Tags -->
    <title>Data Center Service Catalog | 135+ Services | ResistanceZero</title>
    <meta name="description" content="The definitive guide to data center services — 135+ items across 12 categories, ranked by Annual Revenue Potential, with regional pricing for Americas, Europe, SEA, and Australia.">
    <meta name="keywords" content="Data Center Services, Service Catalog, Revenue Ranking, Colocation, Consulting, Commissioning, DCIM, Managed Services, Pricing Guide, Operations Engineering">
    <meta name="author" content="Bagus Dwi Permana">
    <meta name="robots" content="index, follow">
    <meta name="theme-color" content="#1e3a5f">
    <link rel="canonical" href="https://resistancezero.com/article-15.html">

    <!-- Open Graph Meta Tags -->
    <meta property="og:type" content="article">
    <meta property="og:url" content="https://resistancezero.com/article-15.html">
    <meta property="og:title" content="Data Center Service Catalog: 135+ Services Ranked by Revenue">
    <meta property="og:description" content="135+ data center services across 12 categories, ranked by Annual Revenue Potential with regional pricing for Americas, Europe, SEA, and Australia.">
    <meta property="og:image" content="https://resistancezero.com/assets/article-15-cover.jpg">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:image:alt" content="Data Center Service Catalog: 135+ Services Ranked by Revenue">
    <meta property="og:locale" content="en_US">
    <meta property="og:site_name" content="Bagus Dwi Permana Portfolio">
    <meta property="article:author" content="Bagus Dwi Permana">
    <meta property="article:published_time" content="2026-02-14T00:00:00Z">
    <meta property="article:modified_time" content="2026-02-17T00:00:00Z">
    <meta property="article:section" content="Operations Engineering Journal">

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@BagusDPermana">
    <meta name="twitter:creator" content="@BagusDPermana">
    <meta name="twitter:title" content="Data Center Service Catalog: 135+ Services Ranked by Revenue">
    <meta name="twitter:description" content="135+ data center services across 12 categories ranked by Annual Revenue Potential with regional pricing.">
    <meta name="twitter:image" content="https://resistancezero.com/assets/article-15-cover.jpg">
    <meta name="twitter:image:alt" content="Data Center Service Catalog with 135+ Services Ranked">

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
    <link rel="icon" type="image/png" href="assets/Favicon.png">
    <link rel="apple-touch-icon" href="assets/Favicon.png">
    <link rel="stylesheet" href="styles.css">
    <link rel="preload" as="image" href="assets/article-15-cover.jpg">

    <!-- Structured Data -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "TechnicalArticle",
        "headline": "Data Center Service Catalog: 135+ Services Ranked by Revenue",
        "description": "The definitive guide to data center services — 135+ items across 12 categories, ranked by Annual Revenue Potential, with regional pricing.",
        "image": "https://resistancezero.com/assets/article-15-cover.jpg",
        "author": {
            "@type": "Person",
            "name": "Bagus Dwi Permana",
            "jobTitle": "Engineering Operations Manager"
        },
        "datePublished": "2026-02-14",
        "wordCount": "18000",
        "articleSection": "Operations Engineering Journal",
        "keywords": ["Data Center Services", "Service Catalog", "Revenue Ranking", "Colocation", "Consulting", "Commissioning", "DCIM", "Managed Services"]
    }
    </script>

    <style>
        /* ============================================
           Article 15 - Inline Styles
           ============================================ */
        :root {
            --primary-blue: #1e3a5f;
            --accent-gold: #f59e0b;
            --accent-cyan: #06b6d4;
            --accent-emerald: #10b981;
            --accent-red: #ef4444;
            --accent-purple: #8b5cf6;
            --bg-dark: #0f172a;
            --bg-light: #f8fafc;
            --text-primary: #1e293b;
            --text-secondary: #64748b;
            --card-bg: #ffffff;
            --card-border: #e2e8f0;
            --section-bg: #f8fafc;
            --table-stripe: #f1f5f9;
        }

        [data-theme="dark"] {
            --text-primary: #e2e8f0;
            --text-secondary: #94a3b8;
            --card-bg: #1e293b;
            --card-border: #334155;
            --section-bg: #0f172a;
            --table-stripe: #1e293b;
            --bg-light: #0f172a;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            color: var(--text-primary);
            background: var(--bg-light);
            line-height: 1.6;
            overflow-x: hidden;
        }

        /* Hero Section */
        .article-hero {
            background: linear-gradient(135deg, #0b1220 0%, #1e3a5f 50%, #2d5a87 100%);
            padding: 7rem 2rem 3.5rem;
            color: #fff;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .article-hero::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            background:
                radial-gradient(circle at 20% 80%, rgba(245, 158, 11, 0.15) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(6, 182, 212, 0.1) 0%, transparent 50%);
            z-index: 0;
        }

        .article-hero::after {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            background: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M30 5 L32 15 L42 17 L32 19 L30 29 L28 19 L18 17 L28 15 Z' fill='%23f59e0b' fill-opacity='0.03'/%3E%3C/svg%3E");
            z-index: 0;
        }

        .article-hero > * { position: relative; z-index: 1; }
        .article-hero .container { max-width: 1000px; margin: 0 auto; }

        .article-badge {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            background: rgba(245, 158, 11, 0.2);
            color: #fbbf24;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
            margin-bottom: 1.5rem;
            border: 1px solid rgba(245, 158, 11, 0.3);
        }

        .article-title {
            font-size: clamp(1.6rem, 3.2vw, 2.35rem);
            font-weight: 800;
            margin-bottom: 1.25rem;
            line-height: 1.25;
            color: #fff;
            letter-spacing: -0.01em;
        }

        .article-subtitle {
            font-size: clamp(0.95rem, 1.6vw, 1.15rem);
            color: #94a3b8;
            max-width: 800px;
            margin: 0 auto 2rem;
            line-height: 1.7;
        }

        .article-meta {
            display: flex;
            justify-content: center;
            gap: 2rem;
            flex-wrap: wrap;
            color: #94a3b8;
            font-size: 0.9rem;
        }

        .article-meta-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        /* Table of Contents */
        .toc-section {
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            padding: 3rem 2rem;
            border-bottom: 1px solid #e2e8f0;
        }

        [data-theme="dark"] .toc-section {
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
            border-bottom-color: #334155;
        }

        .toc-container {
            max-width: 1100px;
            margin: 0 auto;
        }

        .toc-title {
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--primary-blue);
            margin-bottom: 1.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        [data-theme="dark"] .toc-title { color: var(--accent-gold); }

        .toc-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 0.625rem;
        }

        .toc-item {
            background: var(--card-bg);
            padding: 0.75rem 1rem;
            border-radius: 10px;
            border-left: 4px solid var(--accent-gold);
            transition: all 0.2s ease;
            text-decoration: none;
            color: var(--text-primary);
            display: block;
        }

        .toc-item:hover {
            transform: translateX(4px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        .toc-item-number {
            font-size: 0.7rem;
            color: var(--accent-gold);
            font-weight: 700;
            text-transform: uppercase;
        }

        .toc-item-title {
            font-weight: 600;
            font-size: 0.88rem;
        }

        /* TOC Calculator Highlight */
        .toc-item.toc-calculator {
            background: linear-gradient(135deg, #fffbeb 0%, #fef3c7 100%);
            border-left-color: #f59e0b;
            border-left-width: 5px;
        }
        .toc-item.toc-calculator .toc-item-number { display: flex; align-items: center; gap: 6px; }
        .toc-item.toc-calculator .toc-calc-badge {
            font-size: 0.6rem; background: #f59e0b; color: #fff; padding: 1px 6px; border-radius: 4px; font-weight: 700; letter-spacing: 0.5px;
        }
        [data-theme="dark"] .toc-item.toc-calculator {
            background: linear-gradient(135deg, rgba(245,158,11,0.15) 0%, rgba(245,158,11,0.08) 100%);
        }

        /* Article Content */
        .article-content {
            padding: 4rem 2rem;
            background: var(--card-bg);
        }

        [data-theme="dark"] .article-content {
            background: var(--bg-dark);
        }

        .article-content .container {
            max-width: 1100px;
            margin: 0 auto;
        }

        .article-body {
            font-size: 0.95rem;
            line-height: 1.7;
            color: var(--text-primary);
        }

        .article-body p { margin-bottom: 1rem; }

        .article-body h2 {
            font-size: 1.4rem;
            color: var(--primary-blue);
            margin: 3rem 0 1.25rem;
            padding-bottom: 0.5rem;
            border-bottom: 3px solid var(--accent-gold);
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        [data-theme="dark"] .article-body h2 { color: #93c5fd; }

        .article-body h2 .section-number {
            background: var(--accent-gold);
            color: #fff;
            width: 32px; height: 32px;
            border-radius: 8px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            font-size: 0.85rem;
            font-weight: 700;
            flex-shrink: 0;
        }

        .article-body h3 {
            font-size: 1.1rem;
            color: #334155;
            margin: 2rem 0 0.75rem;
        }

        [data-theme="dark"] .article-body h3 { color: #cbd5e1; }

        /* Formula Box */
        .formula-box {
            background: linear-gradient(135deg, #1e3a5f 0%, #2d5a87 100%);
            color: #fff;
            padding: 2rem;
            border-radius: 12px;
            margin: 1.5rem 0;
            text-align: center;
        }

        .formula-box .formula {
            font-family: 'JetBrains Mono', monospace;
            font-size: 1.2rem;
            font-weight: 600;
            margin: 1rem 0;
            color: var(--accent-gold);
        }

        .formula-box .formula-label {
            font-size: 0.85rem;
            color: #94a3b8;
        }

        /* Revenue Scale */
        .revenue-scale {
            display: flex;
            gap: 1rem;
            margin: 1.5rem 0;
            flex-wrap: wrap;
        }

        .scale-item {
            flex: 1;
            min-width: 140px;
            padding: 1rem;
            border-radius: 10px;
            text-align: center;
            font-weight: 600;
            font-size: 0.85rem;
        }

        .scale-high {
            background: rgba(245, 158, 11, 0.15);
            border: 2px solid var(--accent-gold);
            color: var(--accent-gold);
        }

        .scale-medium {
            background: rgba(6, 182, 212, 0.15);
            border: 2px solid var(--accent-cyan);
            color: var(--accent-cyan);
        }

        .scale-low {
            background: rgba(16, 185, 129, 0.15);
            border: 2px solid var(--accent-emerald);
            color: var(--accent-emerald);
        }

        /* Category Header */
        .category-header {
            background: linear-gradient(135deg, var(--primary-blue), #2d5a87);
            color: #fff;
            padding: 1.5rem 2rem;
            border-radius: 12px 12px 0 0;
            margin-top: 2.5rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 0.5rem;
        }

        .category-header h3 {
            font-size: 1.15rem;
            font-weight: 700;
            color: #fff;
            margin: 0;
        }

        .category-header .cat-range {
            font-size: 0.8rem;
            background: rgba(245, 158, 11, 0.3);
            color: #fbbf24;
            padding: 0.25rem 0.75rem;
            border-radius: 12px;
            font-weight: 600;
        }

        /* Service Cards */
        .service-list {
            border: 1px solid var(--card-border);
            border-top: none;
            border-radius: 0 0 12px 12px;
            overflow: hidden;
            margin-bottom: 1.5rem;
        }

        .service-row {
            display: grid;
            grid-template-columns: 50px 1fr 180px 100px;
            gap: 1rem;
            padding: 1rem 1.5rem;
            border-bottom: 1px solid var(--card-border);
            align-items: center;
            transition: background 0.15s;
            background: var(--card-bg);
        }

        .service-row:last-child { border-bottom: none; }

        .service-row:hover { background: var(--table-stripe); }

        .service-rank {
            width: 36px; height: 36px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 0.8rem;
            color: #fff;
            flex-shrink: 0;
        }

        .rank-high { background: linear-gradient(135deg, #f59e0b, #d97706); }
        .rank-medium { background: linear-gradient(135deg, #06b6d4, #0891b2); }
        .rank-low { background: linear-gradient(135deg, #10b981, #059669); }

        .service-info h4 {
            font-size: 0.9rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 0.2rem;
        }

        .service-info .svc-desc {
            font-size: 0.8rem;
            color: var(--text-secondary);
            line-height: 1.4;
        }

        .service-price {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.85rem;
            font-weight: 600;
            color: var(--accent-gold);
            text-align: right;
        }

        .service-unit {
            font-size: 0.75rem;
            color: var(--text-secondary);
            text-align: right;
        }

        .revenue-badge {
            display: inline-block;
            font-size: 0.65rem;
            font-weight: 700;
            padding: 0.15rem 0.5rem;
            border-radius: 4px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .rev-high { background: rgba(245,158,11,0.15); color: #d97706; }
        .rev-medium { background: rgba(6,182,212,0.15); color: #0891b2; }
        .rev-low { background: rgba(16,185,129,0.15); color: #059669; }

        [data-theme="dark"] .rev-high { color: #fbbf24; }
        [data-theme="dark"] .rev-medium { color: #22d3ee; }
        [data-theme="dark"] .rev-low { color: #34d399; }

        /* Calculator Section */
        .calculator-section {
            background: var(--section-bg);
            padding: 3rem 2rem;
            margin: 2rem 0;
            border-radius: 16px;
            border: 1px solid var(--card-border);
        }

        .calc-controls {
            display: flex;
            flex-wrap: wrap;
            gap: 1rem;
            margin-bottom: 1.5rem;
            align-items: flex-end;
        }

        .calc-control-group {
            flex: 1;
            min-width: 180px;
        }

        .calc-control-group label {
            display: block;
            font-size: 0.75rem;
            font-weight: 600;
            color: var(--text-secondary);
            margin-bottom: 0.4rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .calc-control-group select,
        .calc-control-group input[type="text"] {
            width: 100%;
            padding: 0.65rem 1rem;
            border-radius: 8px;
            border: 1px solid var(--card-border);
            background: var(--card-bg);
            color: var(--text-primary);
            font-size: 0.9rem;
            font-family: inherit;
        }

        .calc-control-group select:focus,
        .calc-control-group input:focus {
            outline: none;
            border-color: var(--accent-gold);
            box-shadow: 0 0 0 3px rgba(245,158,11,0.15);
        }

        /* Category Pills */
        .category-pills {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-bottom: 1.5rem;
        }

        .cat-pill {
            padding: 0.4rem 0.9rem;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
            cursor: pointer;
            border: 2px solid var(--card-border);
            background: var(--card-bg);
            color: var(--text-secondary);
            transition: all 0.2s;
        }

        .cat-pill:hover { border-color: var(--accent-gold); color: var(--accent-gold); }

        .cat-pill.active {
            background: var(--accent-gold);
            color: #fff;
            border-color: var(--accent-gold);
        }

        /* Calculator Results Grid */
        .calc-results {
            display: grid;
            grid-template-columns: 1fr;
            gap: 0.5rem;
            max-height: 600px;
            overflow-y: auto;
            padding-right: 0.5rem;
        }

        .calc-card {
            display: grid;
            grid-template-columns: 44px 1fr 160px 120px 100px;
            gap: 0.75rem;
            padding: 0.875rem 1rem;
            background: var(--card-bg);
            border: 1px solid var(--card-border);
            border-radius: 8px;
            align-items: center;
            transition: all 0.15s;
        }

        .calc-card:hover {
            border-color: var(--accent-gold);
            box-shadow: 0 2px 8px rgba(245,158,11,0.1);
        }

        .calc-card .c-rank {
            width: 36px; height: 36px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 0.8rem;
            color: #fff;
        }

        .calc-card .c-name {
            font-weight: 600;
            font-size: 0.88rem;
            color: var(--text-primary);
        }

        .calc-card .c-desc {
            font-size: 0.75rem;
            color: var(--text-secondary);
            margin-top: 0.15rem;
        }

        .calc-card .c-price {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.85rem;
            font-weight: 600;
            color: var(--accent-gold);
        }

        .calc-card .c-unit {
            font-size: 0.72rem;
            color: var(--text-secondary);
        }

        .btn-add-quote {
            padding: 0.4rem 0.8rem;
            border-radius: 6px;
            border: 1px solid var(--accent-gold);
            background: transparent;
            color: var(--accent-gold);
            font-size: 0.75rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.15s;
            white-space: nowrap;
        }

        .btn-add-quote:hover {
            background: var(--accent-gold);
            color: #fff;
        }

        .btn-add-quote.added {
            background: var(--accent-emerald);
            border-color: var(--accent-emerald);
            color: #fff;
        }

        .calc-count {
            font-size: 0.85rem;
            color: var(--text-secondary);
            margin-bottom: 1rem;
        }

        .no-results {
            text-align: center;
            padding: 3rem 1rem;
            color: var(--text-secondary);
        }

        /* Quote Builder */
        .quote-builder {
            position: sticky;
            bottom: 0;
            background: var(--card-bg);
            border-top: 2px solid var(--accent-gold);
            padding: 1rem 2rem;
            z-index: 50;
            box-shadow: 0 -4px 20px rgba(0,0,0,0.1);
            display: none;
        }

        .quote-builder.active { display: block; }

        .quote-inner {
            max-width: 1100px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .quote-summary {
            display: flex;
            gap: 2rem;
            align-items: center;
            flex-wrap: wrap;
        }

        .quote-stat {
            text-align: center;
        }

        .quote-stat-label {
            font-size: 0.7rem;
            color: var(--text-secondary);
            text-transform: uppercase;
            font-weight: 600;
        }

        .quote-stat-value {
            font-family: 'JetBrains Mono', monospace;
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--accent-gold);
        }

        .quote-actions {
            display: flex;
            gap: 0.75rem;
        }

        .btn-quote {
            padding: 0.5rem 1.25rem;
            border-radius: 8px;
            font-size: 0.85rem;
            font-weight: 600;
            cursor: pointer;
            border: none;
            transition: all 0.15s;
        }

        .btn-copy-quote {
            background: var(--accent-gold);
            color: #fff;
        }

        .btn-copy-quote:hover { background: #d97706; }

        .btn-clear-quote {
            background: transparent;
            border: 1px solid var(--accent-red);
            color: var(--accent-red);
        }

        .btn-clear-quote:hover { background: var(--accent-red); color: #fff; }

        .btn-view-quote {
            background: transparent;
            border: 1px solid var(--accent-cyan);
            color: var(--accent-cyan);
        }

        .btn-view-quote:hover { background: var(--accent-cyan); color: #fff; }

        /* Quote Detail Modal */
        .quote-modal {
            display: none;
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(0,0,0,0.6);
            z-index: 100;
            justify-content: center;
            align-items: center;
            padding: 2rem;
        }

        .quote-modal.active { display: flex; }

        .quote-modal-content {
            background: var(--card-bg);
            border-radius: 16px;
            width: 100%;
            max-width: 800px;
            max-height: 80vh;
            overflow-y: auto;
            padding: 2rem;
        }

        .quote-modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid var(--accent-gold);
        }

        .quote-modal-header h3 {
            font-size: 1.2rem;
            color: var(--text-primary);
        }

        .btn-close-modal {
            width: 32px; height: 32px;
            border-radius: 8px;
            border: none;
            background: var(--section-bg);
            color: var(--text-secondary);
            cursor: pointer;
            font-size: 1.2rem;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .quote-item-row {
            display: grid;
            grid-template-columns: 1fr 80px 140px 60px;
            gap: 1rem;
            padding: 0.75rem 0;
            border-bottom: 1px solid var(--card-border);
            align-items: center;
            font-size: 0.88rem;
        }

        .quote-item-row .qi-name { font-weight: 600; }
        .quote-item-row .qi-price {
            font-family: 'JetBrains Mono', monospace;
            color: var(--accent-gold);
            font-weight: 600;
            text-align: right;
        }

        .qty-control {
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }

        .qty-btn {
            width: 24px; height: 24px;
            border-radius: 4px;
            border: 1px solid var(--card-border);
            background: var(--card-bg);
            cursor: pointer;
            font-size: 0.85rem;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--text-primary);
        }

        .qty-val {
            width: 30px;
            text-align: center;
            font-weight: 600;
            font-size: 0.85rem;
        }

        .btn-remove-item {
            border: none;
            background: none;
            color: var(--accent-red);
            cursor: pointer;
            font-size: 1rem;
        }

        .quote-regional {
            margin-top: 1.5rem;
            padding-top: 1.5rem;
            border-top: 2px solid var(--card-border);
        }

        .regional-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 1rem;
            margin-top: 1rem;
        }

        .regional-card {
            background: var(--section-bg);
            padding: 1rem;
            border-radius: 8px;
            text-align: center;
        }

        .regional-card .rc-region {
            font-size: 0.75rem;
            font-weight: 600;
            color: var(--text-secondary);
            text-transform: uppercase;
        }

        .regional-card .rc-total {
            font-family: 'JetBrains Mono', monospace;
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--accent-gold);
            margin-top: 0.25rem;
        }

        .regional-card .rc-mult {
            font-size: 0.7rem;
            color: var(--text-secondary);
        }

        /* Regional Comparison Chart */
        .region-chart-container {
            margin: 2rem 0;
        }

        .region-bar-chart {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            max-width: 700px;
        }

        .rbc-row {
            display: grid;
            grid-template-columns: 120px 1fr 80px;
            gap: 1rem;
            align-items: center;
        }

        .rbc-label {
            font-weight: 600;
            font-size: 0.85rem;
            color: var(--text-primary);
        }

        .rbc-bar-bg {
            height: 28px;
            background: var(--card-border);
            border-radius: 14px;
            overflow: hidden;
        }

        .rbc-bar {
            height: 100%;
            border-radius: 14px;
            background: linear-gradient(90deg, var(--accent-gold), #d97706);
            transition: width 0.6s ease;
        }

        .rbc-val {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.85rem;
            font-weight: 600;
            color: var(--accent-gold);
        }

        /* Conclusion Section */
        .conclusion-box {
            background: linear-gradient(135deg, #1e3a5f 0%, #2d5a87 100%);
            color: #fff;
            padding: 2.5rem;
            border-radius: 16px;
            margin: 2rem 0;
        }

        .conclusion-box h3 {
            color: var(--accent-gold);
            margin-bottom: 1rem;
            font-size: 1.2rem;
        }

        .conclusion-box p {
            color: #cbd5e1;
            line-height: 1.7;
        }

        .conclusion-box ul {
            color: #cbd5e1;
            margin: 1rem 0;
            padding-left: 1.25rem;
        }

        .conclusion-box li { margin-bottom: 0.5rem; }

        /* Key Insight Box */
        .key-insight {
            background: rgba(245,158,11,0.08);
            border-left: 4px solid var(--accent-gold);
            padding: 1.25rem 1.5rem;
            border-radius: 0 10px 10px 0;
            margin: 1.5rem 0;
        }

        .key-insight strong {
            color: var(--accent-gold);
            display: block;
            margin-bottom: 0.25rem;
            font-size: 0.8rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        /* Responsive */
        @media (max-width: 900px) {
            .service-row {
                grid-template-columns: 40px 1fr 120px;
                gap: 0.5rem;
                padding: 0.75rem 1rem;
            }
            .service-unit { display: none; }
            .calc-card {
                grid-template-columns: 40px 1fr 100px;
                gap: 0.5rem;
            }
            .calc-card .c-unit { display: none; }
            .calc-card .btn-add-quote { display: none; }
            .regional-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            .quote-item-row {
                grid-template-columns: 1fr 80px 100px 40px;
                font-size: 0.8rem;
            }
        }

        @media (max-width: 600px) {
            .article-hero { padding: 6rem 1rem 3rem; }
            .article-content { padding: 2rem 1rem; }
            .calc-controls { flex-direction: column; }
            .service-row {
                grid-template-columns: 36px 1fr;
                gap: 0.5rem;
            }
            .service-price { display: none; }
            .calc-card {
                grid-template-columns: 36px 1fr;
            }
            .calc-card .c-price { display: none; }
            .category-header { padding: 1rem 1.25rem; }
            .rbc-row {
                grid-template-columns: 80px 1fr 60px;
            }
            .regional-grid {
                grid-template-columns: 1fr 1fr;
            }
            .quote-inner { flex-direction: column; text-align: center; }
            .quote-summary { justify-content: center; }
            .quote-item-row {
                grid-template-columns: 1fr 70px 40px;
            }
            .quote-item-row .qi-price { display: none; }
        }

        /* Tooltip System */
        .tip {
            position: relative;
            border-bottom: 1px dashed var(--accent-gold);
            cursor: help;
            font-weight: 600;
        }
        .tip::after {
            content: attr(data-tip);
            position: absolute;
            bottom: 125%;
            left: 50%;
            transform: translateX(-50%);
            background: #1e293b;
            color: #e2e8f0;
            padding: 0.5rem 0.85rem;
            border-radius: 8px;
            font-size: 0.75rem;
            font-weight: 400;
            white-space: nowrap;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.2s;
            z-index: 60;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            max-width: 320px;
            white-space: normal;
            line-height: 1.5;
        }
        .tip:hover::after { opacity: 1; }

        [data-theme="dark"] .tip::after {
            background: #334155;
            color: #f1f5f9;
        }

        /* Source Reference Link */
        .src-ref {
            font-size: 0.7rem;
            vertical-align: super;
            color: var(--accent-cyan);
            text-decoration: none;
            font-weight: 700;
            cursor: pointer;
        }
        .src-ref:hover { text-decoration: underline; }

        /* References Section */
        .ref-list {
            list-style: none;
            padding: 0;
            counter-reset: ref-counter;
        }
        .ref-list li {
            counter-increment: ref-counter;
            padding: 0.75rem 0 0.75rem 2.5rem;
            border-bottom: 1px solid var(--card-border);
            font-size: 0.85rem;
            line-height: 1.7;
            position: relative;
        }
        .ref-list li::before {
            content: "[" counter(ref-counter) "]";
            color: var(--accent-gold);
            font-weight: 700;
            font-size: 0.8rem;
            position: absolute;
            left: 0;
            top: 0.75rem;
        }
        .ref-list a {
            color: var(--accent-cyan);
            text-decoration: none;
            word-break: break-all;
        }
        .ref-list a:hover { text-decoration: underline; }

        /* Sub-options in calculator */
        .calc-suboptions {
            display: flex;
            flex-wrap: wrap;
            gap: 0.75rem;
            margin-bottom: 1.25rem;
            padding: 1rem;
            background: var(--card-bg);
            border: 1px solid var(--card-border);
            border-radius: 10px;
        }
        .calc-suboptions .calc-control-group { min-width: 160px; }

        /* Export buttons */
        .btn-export-pdf {
            background: var(--accent-cyan);
            color: #fff;
            padding: 0.5rem 1.25rem;
            border-radius: 8px;
            font-size: 0.85rem;
            font-weight: 600;
            cursor: pointer;
            border: none;
            transition: all 0.15s;
        }
        .btn-export-pdf:hover { background: #0891b2; }

        /* Scrollbar */
        .calc-results::-webkit-scrollbar { width: 6px; }
        .calc-results::-webkit-scrollbar-track { background: var(--section-bg); border-radius: 3px; }
        .calc-results::-webkit-scrollbar-thumb { background: var(--card-border); border-radius: 3px; }

        /* Article Nav */
        .article-nav {
            display: flex;
            justify-content: space-between;
            padding: 2rem 0;
            border-top: 1px solid var(--card-border);
            margin-top: 3rem;
        }
        .article-nav a {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: var(--primary-blue);
            font-weight: 600;
            transition: color 0.3s ease;
            text-decoration: none;
        }
        [data-theme="dark"] .article-nav a { color: #93c5fd; }
        .article-nav a:hover { color: #60a5fa; }

        /* Print / PDF Export */
        @media print {
            .navbar, .quote-builder, .calculator-section, .quote-modal, .toc-section, .article-nav { display: none !important; }
            .article-hero { padding: 1.5rem 1rem; background: #1e3a5f !important; -webkit-print-color-adjust: exact; print-color-adjust: exact; }
            .article-hero .article-badge, .article-hero .article-meta { display: none; }
            .article-content { padding: 1rem; }
            .service-row { break-inside: avoid; page-break-inside: avoid; }
            .category-header { break-after: avoid; page-break-after: avoid; }
            body { font-size: 10pt; color: #000; }
            .key-insight, .formula-box, .conclusion-box { break-inside: avoid; }
            .article-body h2 { break-after: avoid; }
            a { color: inherit; text-decoration: none; }
            footer { display: none !important; }
        }

        /* ============================================
           Pro Enhancement Mode — MCL (Mission Critical Leadership)
           Theme: #ec4899 (pink)
           ============================================ */
        .mcl-cta-block {
            background: linear-gradient(135deg, rgba(236,72,153,0.12) 0%, rgba(236,72,153,0.04) 100%);
            border: 1px solid rgba(236,72,153,0.25);
            border-radius: 14px; padding: 2rem; margin: 2.5rem 0; text-align: center;
        }
        .mcl-cta-block h3 { color: #ec4899; font-size: 1.15rem; margin-bottom: 0.5rem; }
        .mcl-cta-block p { color: var(--text-secondary); font-size: 0.88rem; margin-bottom: 1rem; line-height: 1.6; }
        .mcl-cta-block .mcl-cta-btn {
            display: inline-flex; align-items: center; gap: 8px;
            background: linear-gradient(135deg, #ec4899, #db2777); color: #fff;
            padding: 0.7rem 1.5rem; border-radius: 10px; border: none; font-weight: 700;
            font-size: 0.88rem; cursor: pointer; transition: all 0.3s; font-family: inherit;
        }
        .mcl-cta-block .mcl-cta-btn:hover { transform: translateY(-1px); box-shadow: 0 6px 20px rgba(236,72,153,0.3); }
        .mcl-cta-features { display: flex; flex-wrap: wrap; gap: 0.75rem; justify-content: center; margin-top: 1rem; }
        .mcl-cta-features span { font-size: 0.75rem; color: var(--text-secondary); background: rgba(236,72,153,0.08); padding: 4px 10px; border-radius: 6px; display: flex; align-items: center; gap: 4px; }
        .mcl-cta-features span i { color: #ec4899; font-size: 0.7rem; }

        /* Toolbar */
        .mcl-toolbar-row {
            display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap;
            gap: 1rem; margin-bottom: 1.5rem; padding: 1rem;
            background: linear-gradient(135deg, rgba(236,72,153,0.08) 0%, rgba(236,72,153,0.03) 100%);
            border-radius: 12px; border: 1px solid rgba(236,72,153,0.15);
        }
        .mcl-mode-bar { display: flex; align-items: center; gap: 0.5rem; }
        .mcl-mode-toggle {
            display: flex; background: var(--card-bg); border-radius: 10px; overflow: hidden;
            border: 1px solid var(--card-border);
        }
        .mcl-mode-btn {
            padding: 8px 18px; font-size: 0.8rem; font-weight: 600; cursor: pointer; border: none;
            background: transparent; color: var(--text-secondary); transition: all 0.3s; font-family: inherit;
        }
        .mcl-mode-btn.active { background: linear-gradient(135deg, #ec4899, #db2777); color: #fff; box-shadow: 0 4px 15px rgba(236,72,153,0.4), 0 0 20px rgba(236,72,153,0.2); border-color: #ec4899; font-weight: 700; }
        .mcl-toolbar-actions { display: flex; gap: 0.5rem; align-items: center; }
        .mcl-toolbar-btn {
            padding: 8px 16px; border-radius: 8px; border: none; font-size: 0.78rem;
            font-weight: 600; cursor: pointer; font-family: inherit; display: flex; align-items: center; gap: 6px;
        }
        .mcl-btn-pdf {
            background: linear-gradient(135deg, rgba(236,72,153,0.15), rgba(236,72,153,0.08));
            color: #ec4899; border: 1px solid rgba(236,72,153,0.25) !important;
        }
        .mcl-btn-pdf:hover { background: linear-gradient(135deg, rgba(236,72,153,0.25), rgba(236,72,153,0.12)); }
        .mcl-privacy-badge {
            display: flex; align-items: center; gap: 6px; font-size: 0.72rem; color: var(--text-secondary);
        }
        .mcl-privacy-badge i { color: #10b981; font-size: 0.8rem; }

        /* Pro Strategic Inputs */
        .mcl-pro-inputs {
            display: none; padding: 1.25rem; background: linear-gradient(135deg, rgba(236,72,153,0.06) 0%, rgba(236,72,153,0.02) 100%);
            border: 1px solid rgba(236,72,153,0.12); border-radius: 12px; margin-bottom: 1.5rem;
        }
        .mcl-pro-inputs.active { display: block; }
        .mcl-pro-inputs h4 {
            font-size: 0.85rem; font-weight: 700; color: #ec4899; margin-bottom: 1rem;
            display: flex; align-items: center; gap: 8px;
        }
        .mcl-input-grid {
            display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;
        }
        .mcl-input-group { position: relative; }
        .mcl-input-group label {
            display: flex; align-items: center; gap: 4px;
            font-size: 0.75rem; font-weight: 600; color: var(--text-secondary);
            margin-bottom: 0.35rem; text-transform: uppercase; letter-spacing: 0.5px;
        }
        .mcl-input-group select, .mcl-input-group input {
            width: 100%; padding: 0.6rem 0.9rem; border-radius: 8px;
            border: 1px solid var(--card-border); background: var(--card-bg);
            color: var(--text-primary); font-size: 0.88rem; font-family: inherit;
        }
        .mcl-input-group select:focus, .mcl-input-group input:focus {
            outline: none; border-color: #ec4899; box-shadow: 0 0 0 3px rgba(236,72,153,0.15);
        }

        /* Tooltips */
        .mcl-tooltip-trigger {
            display: inline-flex; align-items: center; justify-content: center;
            width: 16px; height: 16px; border-radius: 50%; background: rgba(236,72,153,0.2);
            color: #ec4899; font-size: 0.6rem; font-weight: 700; cursor: help;
            position: relative; flex-shrink: 0;
        }
        .mcl-tooltip-content {
            display: none; position: absolute; bottom: calc(100% + 10px); left: 50%; transform: translateX(-50%);
            background: #1e293b; border: 1px solid rgba(236,72,153,0.3); border-radius: 10px;
            padding: 0.85rem; width: 240px; z-index: 100; box-shadow: 0 8px 30px rgba(0,0,0,0.4);
            pointer-events: none;
        }
        .mcl-tooltip-content::after {
            content: ''; position: absolute; top: 100%; left: 50%; transform: translateX(-50%);
            border: 6px solid transparent; border-top-color: rgba(236,72,153,0.3);
        }
        .mcl-tooltip-trigger:hover .mcl-tooltip-content,
        .mcl-tooltip-trigger:focus .mcl-tooltip-content { display: block; }
        .mcl-tooltip-title { font-size: 0.78rem; font-weight: 700; color: #ec4899; margin-bottom: 0.3rem; }
        .mcl-tooltip-desc { font-size: 0.7rem; color: #94a3b8; line-height: 1.5; }
        .mcl-tooltip-formula { font-size: 0.65rem; color: #f9a8d4; font-family: 'JetBrains Mono', monospace; background: rgba(236,72,153,0.1); padding: 3px 6px; border-radius: 4px; margin-top: 0.3rem; display: block; }

        /* Pro Panels */
        .mcl-pro-panel {
            margin: 1.5rem 0; padding: 1.5rem;
            background: linear-gradient(135deg, #fdf2f8 0%, #fce7f3 100%);
            border-radius: 14px; border: 1px solid rgba(236,72,153,0.15);
            position: relative;
        }
        .mcl-pro-panel.gated { filter: blur(3px); pointer-events: none; user-select: none; }
        .mcl-pro-panel .mcl-panel-title {
            font-size: 0.95rem; font-weight: 700; color: #9d174d; margin-bottom: 0.75rem;
            display: flex; align-items: center; gap: 8px;
        }
        .mcl-pro-panel .mcl-panel-title i { color: #ec4899; }
        .mcl-gate-overlay {
            position: absolute; inset: 0; background: rgba(255,255,255,0.85); border-radius: 14px;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            gap: 0.5rem; z-index: 5; cursor: pointer;
        }
        .mcl-gate-overlay i { font-size: 1.5rem; color: #ec4899; }
        .mcl-gate-overlay span { font-size: 0.8rem; color: var(--text-secondary); font-weight: 600; }
        .mcl-kpi-grid {
            display: grid; grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); gap: 0.75rem;
        }
        .mcl-kpi-card {
            background: rgba(255,255,255,0.7); border-radius: 10px; padding: 1rem; text-align: center;
            border: 1px solid rgba(236,72,153,0.1);
        }
        .mcl-kpi-value { font-size: 1.4rem; font-weight: 800; color: #9d174d; }
        .mcl-kpi-label { font-size: 0.7rem; color: var(--text-secondary); margin-top: 0.2rem; }
        .mcl-kpi-sublabel { font-size: 0.6rem; color: #94a3b8; margin-top: 0.15rem; }

        /* Chart containers */
        .mcl-chart-container { margin-top: 1rem; background: rgba(255,255,255,0.5); border-radius: 10px; padding: 1rem; }
        .mcl-chart-container canvas { width: 100% !important; max-height: 240px; }

        /* Narrative */
        .mcl-narrative {
            background: rgba(236,72,153,0.06); border: 1px solid rgba(236,72,153,0.15);
            border-radius: 12px; padding: 1.25rem; margin-top: 1rem;
        }
        .mcl-narrative h4 { color: #9d174d; font-size: 0.85rem; margin: 0 0 0.75rem; display: flex; align-items: center; gap: 6px; }
        .mcl-narrative h4 i { color: #ec4899; }
        .mcl-narrative p { color: var(--text-secondary); font-size: 0.78rem; line-height: 1.7; margin: 0 0 0.75rem; }
        .mcl-narrative p:last-child { margin-bottom: 0; }
        .mcl-narrative p strong { color: #9d174d; }

        /* Score bars */
        .mcl-score-bar-bg { width: 100%; height: 6px; background: rgba(236,72,153,0.1); border-radius: 3px; margin-top: 0.4rem; overflow: hidden; }
        .mcl-score-bar-fill { height: 100%; border-radius: 3px; transition: width 0.5s ease; }
        .mcl-score-bar-fill.risk-high { background: linear-gradient(90deg, #dc2626, #ef4444); }
        .mcl-score-bar-fill.risk-med { background: linear-gradient(90deg, #f59e0b, #fbbf24); }
        .mcl-score-bar-fill.risk-low { background: linear-gradient(90deg, #10b981, #34d399); }

        /* Login Modal */
        .mcl-login-overlay {
            display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.75); backdrop-filter: blur(8px);
            z-index: 9999; align-items: center; justify-content: center;
        }
        .mcl-login-overlay.active { display: flex; }
        .mcl-login-box {
            background: #0f172a; border-radius: 16px; padding: 2.5rem; max-width: 380px; width: 90%;
            border: 1px solid rgba(236,72,153,0.3); box-shadow: 0 20px 60px rgba(0,0,0,0.5);
            position: relative;
        }
        .mcl-login-box h3 { color: #e2e8f0; margin: 0 0 0.5rem; font-size: 1.1rem; }
        .mcl-login-box p { color: #64748b; font-size: 0.8rem; margin: 0 0 1.5rem; }
        .mcl-login-box input {
            width: 100%; padding: 0.75rem 1rem; background: #1e293b; border: 1px solid #334155;
            border-radius: 8px; color: #e2e8f0; font-size: 0.9rem; margin-bottom: 0.75rem; box-sizing: border-box;
        }
        .mcl-login-box input:focus { outline: none; border-color: #ec4899; }
        .mcl-login-box button.mcl-login-submit {
            width: 100%; padding: 0.75rem; background: linear-gradient(135deg, #ec4899, #db2777); color: #fff;
            border: none; border-radius: 8px; font-weight: 700; cursor: pointer; font-size: 0.9rem; margin-top: 0.5rem;
        }
        .mcl-login-box .demo-hint { font-size: 0.7rem; color: #64748b; margin-top: 0.75rem; text-align: center; }
        .mcl-login-box .demo-hint code { background: rgba(236,72,153,0.12); padding: 1px 5px; border-radius: 3px; color: #ec4899; }
        .mcl-login-close {
            position: absolute; top: 12px; right: 16px; background: none; border: none;
            color: #64748b; font-size: 1.2rem; cursor: pointer;
        }
        .mcl-login-error { color: #f87171; font-size: 0.75rem; margin-top: 0.5rem; text-align: center; display: none; }
        [data-theme="light"] .mcl-login-box { background: #ffffff; border-color: #e2e8f0; }
        [data-theme="light"] .mcl-login-box h3 { color: #1e293b; }
        [data-theme="light"] .mcl-login-box p { color: #64748b; }
        [data-theme="light"] .mcl-login-box input { background: #f1f5f9; border-color: #e2e8f0; color: #1e293b; }

        /* Benchmark tags */
        .mcl-benchmark-meta { display: flex; flex-wrap: wrap; gap: 0.75rem; margin-top: 0.75rem; padding-top: 0.75rem; border-top: 1px solid var(--card-border); }
        .mcl-benchmark-tag { font-size: 0.65rem; color: var(--text-secondary); background: rgba(236,72,153,0.06); padding: 3px 8px; border-radius: 4px; display: flex; align-items: center; gap: 4px; }
        .mcl-benchmark-tag i { font-size: 0.6rem; color: #ec4899; }

        /* Dark mode */
        [data-theme="dark"] .mcl-pro-panel { background: linear-gradient(135deg, #1a0812 0%, #2d1025 100%); }
        [data-theme="dark"] .mcl-pro-panel .mcl-panel-title { color: #f9a8d4; }
        [data-theme="dark"] .mcl-kpi-value { color: #f9a8d4; }
        [data-theme="dark"] .mcl-kpi-card { background: rgba(255,255,255,0.05); border-color: rgba(236,72,153,0.15); }
        [data-theme="dark"] .mcl-gate-overlay { background: rgba(15,23,42,0.85); }
        [data-theme="dark"] .mcl-cta-block { background: linear-gradient(135deg, rgba(236,72,153,0.15) 0%, rgba(236,72,153,0.05) 100%); }
        [data-theme="dark"] .mcl-pro-inputs { background: linear-gradient(135deg, rgba(236,72,153,0.08) 0%, rgba(236,72,153,0.02) 100%); }
        [data-theme="dark"] .mcl-narrative { background: rgba(236,72,153,0.08); }
        [data-theme="dark"] .mcl-narrative h4 { color: #f9a8d4; }
        [data-theme="dark"] .mcl-narrative p strong { color: #f9a8d4; }
        [data-theme="dark"] .mcl-chart-container { background: rgba(0,0,0,0.2); }
        [data-theme="dark"] .mcl-login-box { background: #0f172a; border-color: rgba(236,72,153,0.4); }
        [data-theme="dark"] .mcl-toolbar-row { background: linear-gradient(135deg, rgba(236,72,153,0.1) 0%, rgba(236,72,153,0.04) 100%); }

        @media (max-width: 768px) {
            .mcl-toolbar-row { flex-direction: column; align-items: stretch; }
            .mcl-toolbar-actions { justify-content: center; }
            .mcl-input-grid { grid-template-columns: 1fr; }
            .mcl-kpi-grid { grid-template-columns: repeat(2, 1fr); }
            .mcl-cta-features { flex-direction: column; align-items: center; }
            .mcl-tooltip-content { width: 200px; left: auto; right: -10px; transform: none; }
            .mcl-tooltip-content::after { left: auto; right: 16px; transform: none; }
        }

        /* Quote Print (separate print mode for quotes) */
        body.print-quote .article-hero,
        body.print-quote .toc-section,
        body.print-quote .article-content,
        body.print-quote footer,
        body.print-quote .navbar { display: none !important; }
        body.print-quote .quote-builder { display: none !important; }
        body.print-quote .quote-modal {
            display: block !important;
            position: static !important;
            background: none !important;
            padding: 0 !important;
        }
        body.print-quote .quote-modal-content {
            max-height: none !important;
            max-width: none !important;
            padding: 1rem !important;
            border-radius: 0 !important;
            box-shadow: none !important;
        }
        body.print-quote .btn-close-modal,
        body.print-quote .btn-export-pdf { display: none !important; }
    </style>
</head>
<body>
    <a href="#main-content" class="skip-link">Skip to main content</a>
    <!-- Navigation -->
    <nav class="navbar">
        <div class="nav-container">
            <a href="index.html" class="nav-logo">
                <img loading="lazy" src="assets/profile-photo.jpg" alt="Bagus Dwi Permana" class="nav-avatar">
            </a>
            <ul class="nav-menu">
                <li><a href="index.html" class="nav-link">Home</a></li>
                <li class="nav-dropdown">
                    <a href="datacenter-solutions.html" class="nav-link">
                        DC Solutions
                        <svg class="dropdown-arrow" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polyline points="6 9 12 15 18 9"></polyline>
                        </svg>
                    </a>
                    <ul class="dropdown-menu">
                        <li><a href="datacenter-solutions.html" style="color: #06b6d4; font-weight: 600;">DC Solutions Hub</a></li>
                        <li style="border-bottom: 1px solid rgba(255,255,255,0.1); margin: 4px 0;"></li>
                        <li><a href="datahallAI.html" style="color: #8b5cf6;">DC AI/HPC</a></li>
                        <li><a href="dc-conventional.html">DC Conventional</a></li>
                        <li style="border-bottom: 1px solid rgba(255,255,255,0.1); margin: 4px 0;"></li>
                        <li><a href="capex-calculator.html" style="color: #f59e0b;">CAPEX Calculator</a></li>
                        <li><a href="opex-calculator.html" style="color: #10b981;">OPEX Calculator</a></li>
                    </ul>
                </li>
                <li class="nav-dropdown">
                    <a href="articles.html" class="nav-link active">
                        Insights
                        <svg class="dropdown-arrow" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polyline points="6 9 12 15 18 9"></polyline>
                        </svg>
                    </a>
                    <ul class="dropdown-menu">
                        <li><a href="articles.html" style="color: #06b6d4; font-weight: 600;">Engineering Journal</a></li>
                        <li><a href="geopolitics.html" style="color: #ef4444;">Global Analysis</a></li>
                        <li style="border-bottom: 1px solid rgba(255,255,255,0.1); margin: 4px 0;"></li>
                        <li><a href="insights.html" style="color: #64748b; font-size: 0.85rem;">All Insights</a></li>
                    </ul>
                </li>
                <li><a href="index.html#contact" class="nav-link">Contact</a></li>
            </ul>
            <button class="theme-toggle" id="themeToggle" aria-label="Toggle dark mode">
                <svg class="moon-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                </svg>
                <svg class="sun-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="5"></circle>
                    <line x1="12" y1="1" x2="12" y2="3"></line>
                    <line x1="12" y1="21" x2="12" y2="23"></line>
                    <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                    <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                    <line x1="1" y1="12" x2="3" y2="12"></line>
                    <line x1="21" y1="12" x2="23" y2="12"></line>
                    <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                    <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                </svg>
            </button>
            <div class="hamburger">
                <span class="bar"></span>
                <span class="bar"></span>
                <span class="bar"></span>
            </div>
        </div>
    </nav>

    <main id="main-content">
    <!-- Hero Section -->
    <section class="article-hero">
        <div class="container">
            <a href="articles.html" style="display: inline-flex; align-items: center; gap: 0.5rem; color: #94a3b8; margin-bottom: 1.5rem; font-size: 0.9rem; text-decoration: none;">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <polyline points="15 18 9 12 15 6"></polyline>
                </svg>
                Back to Engineering Journal
            </a>

            <span class="article-badge">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"/>
                </svg>
                Operations Engineering Journal #15
            </span>

            <h1 class="article-title">Data Center Service Catalog:<br>135+ Services Ranked by Revenue</h1>

            <p class="article-subtitle">
                The definitive guide to data center services &mdash; 135+ items across 12 categories, ranked by Annual Revenue Potential, with regional pricing for Americas, Europe, SEA, and Australia
            </p>

            <div class="article-meta">
                <span class="article-meta-item">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>
                    Bagus Dwi Permana
                </span>
                <span class="article-meta-item">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>
                    14 February 2026
                </span>
                <span class="article-meta-item">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>
                    35 min read
                </span>
                <span class="article-meta-item">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"/></svg>
                    120 Services | 12 Categories
                </span>
            </div>
        </div>
    </section>

    <!-- Table of Contents -->
    <section class="toc-section">
        <div class="toc-container">
            <div class="toc-title">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="8" y1="6" x2="21" y2="6"/><line x1="8" y1="12" x2="21" y2="12"/><line x1="8" y1="18" x2="21" y2="18"/><line x1="3" y1="6" x2="3.01" y2="6"/><line x1="3" y1="12" x2="3.01" y2="12"/><line x1="3" y1="18" x2="3.01" y2="18"/></svg>
                Table of Contents
            </div>
            <div class="toc-grid">
                <a href="#sec1" class="toc-item"><div class="toc-item-number">Section 1</div><div class="toc-item-title">Revenue Ranking Methodology</div></a>
                <a href="#sec2" class="toc-item"><div class="toc-item-number">Section 2</div><div class="toc-item-title">Cat A: Colocation & Hosting (#1-10)</div></a>
                <a href="#sec3" class="toc-item"><div class="toc-item-number">Section 3</div><div class="toc-item-title">Cat B: Consulting & Advisory (#11-25)</div></a>
                <a href="#sec4" class="toc-item"><div class="toc-item-number">Section 4</div><div class="toc-item-title">Cat C: Testing & Commissioning (#26-40)</div></a>
                <a href="#sec5" class="toc-item"><div class="toc-item-number">Section 5</div><div class="toc-item-title">Cat D: Electrical Services (#41-55)</div></a>
                <a href="#sec6" class="toc-item"><div class="toc-item-number">Section 6</div><div class="toc-item-title">Cat E: Mechanical / Cooling (#56-70)</div></a>
                <a href="#sec7" class="toc-item"><div class="toc-item-number">Section 7</div><div class="toc-item-title">Cat F: Monitoring, DCIM & Automation (#71-80)</div></a>
                <a href="#sec8" class="toc-item"><div class="toc-item-number">Section 8</div><div class="toc-item-title">Cat G: Safety & Compliance (#81-90)</div></a>
                <a href="#sec9" class="toc-item"><div class="toc-item-number">Section 9</div><div class="toc-item-title">Cat H: Operations & Managed Services (#91-100)</div></a>
                <a href="#sec10" class="toc-item"><div class="toc-item-number">Section 10</div><div class="toc-item-title">Cat I: Emergency & Recovery (#101-107)</div></a>
                <a href="#sec11" class="toc-item"><div class="toc-item-number">Section 11</div><div class="toc-item-title">Cat J: Training & Certification (#108-114)</div></a>
                <a href="#sec12" class="toc-item"><div class="toc-item-number">Section 12</div><div class="toc-item-title">Cat K: Sustainability & Energy (#115-120)</div></a>
                <a href="#sec13" class="toc-item toc-calculator"><div class="toc-item-number">Section 13 <span class="toc-calc-badge"><i class="fas fa-calculator" style="font-size:0.5rem;"></i> Interactive</span></div><div class="toc-item-title">Interactive Service Catalog Calculator</div></a>
                <a href="#sec14" class="toc-item"><div class="toc-item-number">Section 14</div><div class="toc-item-title">Regional Pricing Analysis</div></a>
                <a href="#sec15" class="toc-item"><div class="toc-item-number">Section 15</div><div class="toc-item-title">Conclusion & Revenue Strategy</div></a>
                <a href="#sec16" class="toc-item"><div class="toc-item-number">Section 16</div><div class="toc-item-title">References & Sources</div></a>
            </div>
        </div>
    </section>

    <!-- Main Content -->
    <section class="article-content">
        <div class="container">
            <div class="article-body">

                <!-- Article Infographic -->
                <div style="margin: 0 -2rem 2.5rem; border-radius: 12px; overflow: hidden; box-shadow: 0 4px 20px rgba(0,0,0,0.12);">
                    <img src="assets/article-15-infographic.jpg" alt="Data Center Service Catalog Overview — 135+ services across 12 categories, 4 regional pricing zones, ranked by Annual Revenue Potential" style="width: 100%; display: block;" loading="lazy">
                </div>

                <!-- Section 1: Methodology -->
                <h2 id="sec1"><span class="section-number">1</span> Revenue Ranking Methodology</h2>
                <p>
                    This catalog ranks 120 data center services by their <strong>Annual Revenue Potential (<span class="tip" data-tip="Annual Revenue Potential — composite score factoring unit price, engagement volume, total addressable market, and revenue recurrence">ARP</span>)</strong> &mdash; a composite metric developed from analysis of industry pricing data from <span class="tip" data-tip="CBRE Group Inc — world's largest commercial real estate services firm, publishes annual data center cost benchmarks">CBRE</span>, <span class="tip" data-tip="Cushman & Wakefield — global commercial real estate services firm tracking data center markets">Cushman &amp; Wakefield</span>, <span class="tip" data-tip="Jones Lang LaSalle — global professional services firm specializing in real estate and investment management">JLL</span>, and <span class="tip" data-tip="Uptime Institute — advisory organization focused on data center performance, efficiency, and resilience">Uptime Institute</span> benchmarks. The ARP considers not just the unit price, but the volume of engagements, total addressable market, and whether the revenue is recurring or one-time.<a href="#ref1" class="src-ref" title="CBRE Data Center Solutions">[1]</a>
                </p>

                <div class="formula-box">
                    <div class="formula-label">Annual Revenue Potential</div>
                    <div class="formula">ARP = Base Price &times; Volume &times; Market Size &times; Recurring Multiplier</div>
                    <div class="formula-label" style="margin-top:0.75rem;">
                        Where: Base Price = Americas baseline (USD) | Volume = typical annual engagements per client |
                        Market Size = relative addressable market (0.1&ndash;1.0) | Recurring Multiplier = 1.0 (one-time) to 3.0 (monthly recurring)
                    </div>
                </div>

                <p>
                    Services are ranked #1 (highest ARP) through #135 (lowest ARP). Each service is also tagged with a revenue category:
                </p>

                <div class="revenue-scale">
                    <div class="scale-item scale-high">HIGH<br><span style="font-size:0.75rem;font-weight:400;">Rank #1&ndash;40</span></div>
                    <div class="scale-item scale-medium">MEDIUM<br><span style="font-size:0.75rem;font-weight:400;">Rank #41&ndash;80</span></div>
                    <div class="scale-item scale-low">LOW<br><span style="font-size:0.75rem;font-weight:400;">Rank #81&ndash;120</span></div>
                </div>

                <div class="key-insight">
                    <strong>Key Insight</strong>
                    Recurring services (colocation, managed operations, monitoring) consistently outperform higher-priced one-time engagements in ARP because of the recurring multiplier. A $100/kW/month colocation contract generates more annual revenue than a $500K one-time consulting project.
                </div>

                <!-- Section 2: Category A -->
                <h2 id="sec2"><span class="section-number">2</span> Category A: Colocation & Hosting (#1&ndash;10)</h2>
                <p>Colocation and hosting services form the foundation of data center revenue, representing approximately <strong>65&ndash;75% of total industry revenue</strong> globally.<a href="#ref2" class="src-ref" title="Cushman & Wakefield">[2]</a> These recurring, high-volume services dominate the top ranks due to their monthly billing model and large addressable market. The global colocation market reached <strong>$63.5 billion in 2025</strong> and is projected to exceed $100 billion by 2028, driven by hyperscaler expansion and AI workload growth.<a href="#ref3" class="src-ref" title="Structure Research">[3]</a></p>

                <p>Wholesale colocation (1MW+) commands the #1 rank because a single 5MW deal at $120&ndash;220/kW/month generates <strong>$7.2M&ndash;$13.2M annual recurring revenue</strong>. The rise of <span class="tip" data-tip="Artificial Intelligence / Graphics Processing Unit — high-density compute workloads requiring 50-100+ kW per rack with liquid cooling support">AI/GPU</span> colocation has introduced a premium tier: purpose-built facilities with <span class="tip" data-tip="Rear-Door Heat Exchanger or Direct-to-Chip liquid cooling systems for racks exceeding 30kW">liquid cooling</span> infrastructure command 30&ndash;60% premiums over traditional colocation.</p>

                <div class="key-insight">
                    <strong>Key Insight</strong>
                    Americas wholesale colocation rates: $120&ndash;$220/kW/month (CBRE 2025). AI/GPU colocation premium: $200&ndash;$400/kW/month for liquid-cooled, purpose-built facilities. Northern Virginia remains the world's largest market at 2.2 GW+ of operational capacity.<a href="#ref2" class="src-ref" title="Cushman & Wakefield">[2]</a>
                </div>

                <div class="category-header">
                    <h3>A &mdash; Colocation & Hosting</h3>
                    <span class="cat-range">Rank #1&ndash;10 | Highest Revenue</span>
                </div>
                <div class="service-list" id="catA-list"></div>

                <!-- Section 3: Category B -->
                <h2 id="sec3"><span class="section-number">3</span> Category B: Consulting & Advisory (#11&ndash;25)</h2>
                <p>Advisory services command premium pricing ($15K&ndash;$500K per engagement) but are typically project-based. The data center consulting market was valued at <strong>$9.8 billion in 2025</strong>, growing at 12% CAGR as operators navigate increasingly complex design decisions around AI readiness, sustainability mandates, and regulatory compliance.<a href="#ref4" class="src-ref" title="McKinsey & Company">[4]</a></p>

                <p>Master planning and feasibility studies drive the highest revenue within this category. A campus-scale master plan for a 100MW+ development can command $250K&ndash;$500K, while <span class="tip" data-tip="Uptime Institute Tier Certification — independent certification of data center design (Tier I-IV) measuring redundancy and fault tolerance">Tier Certification</span> consulting is a high-margin niche requiring specialized expertise. Due diligence assessments for M&amp;A transactions have surged as the sector consolidates &mdash; over $45 billion in DC transactions closed in 2024 alone.<a href="#ref5" class="src-ref" title="Synergy Research Group">[5]</a></p>

                <div class="key-insight">
                    <strong>Key Insight</strong>
                    <span class="tip" data-tip="Total Cost of Ownership — CAPEX + OPEX over facility lifecycle, typically modeled over 15-20 years">TCO</span> financial modeling is the highest-margin advisory service (70%+ gross margin) because it requires minimal equipment but deep domain expertise. Operators increasingly demand 20-year TCO models that include carbon pricing scenarios and renewable energy integration costs.
                </div>

                <div class="category-header">
                    <h3>B &mdash; Consulting & Advisory</h3>
                    <span class="cat-range">Rank #11&ndash;25 | High Revenue</span>
                </div>
                <div class="service-list" id="catB-list"></div>

                <!-- Section 4: Category C -->
                <h2 id="sec4"><span class="section-number">4</span> Category C: Testing & Commissioning (#26&ndash;40)</h2>
                <p>Testing and commissioning (<span class="tip" data-tip="Testing, Adjusting, and Balancing — the process of verifying installed systems perform to design specifications before handover to operations">T&amp;C</span>) services are critical for new builds and major upgrades. With global data center construction spending exceeding <strong>$350 billion annually by 2027</strong>, the commissioning pipeline is massive.<a href="#ref6" class="src-ref" title="JLL Research">[6]</a></p>

                <p><span class="tip" data-tip="Integrated Systems Testing — end-to-end testing of all critical infrastructure under simulated failure scenarios (utility loss, generator start, UPS transfer, cooling failure)">IST</span> engagements generate the highest revenue at <strong>$50K&ndash;$150K per MW</strong> of commissioned capacity. A typical 20MW data hall IST program runs $1M&ndash;$3M including all sub-tests. <span class="tip" data-tip="Factory Acceptance Testing — verification of equipment performance at the manufacturer's facility before delivery to site">FAT</span> and <span class="tip" data-tip="Site Acceptance Testing — on-site verification that installed equipment meets design specs after delivery and installation">SAT</span> activities generate $10K&ndash;$30K per event but occur in high volume across multi-phase builds.</p>

                <div class="key-insight">
                    <strong>Key Insight</strong>
                    <span class="tip" data-tip="Computational Fluid Dynamics — simulation of airflow and thermal behavior in data halls to validate cooling design">CFD</span> validation and thermal testing are increasingly required by insurance underwriters (FM Global, Zurich) as a condition of coverage. This makes thermal testing quasi-mandatory rather than optional, supporting premium pricing of $15K&ndash;$40K per data hall.
                </div>

                <div class="category-header">
                    <h3>C &mdash; Testing & Commissioning</h3>
                    <span class="cat-range">Rank #26&ndash;40 | High Revenue</span>
                </div>
                <div class="service-list" id="catC-list"></div>

                <!-- Section 5: Category D -->
                <h2 id="sec5"><span class="section-number">5</span> Category D: Electrical Services (#41&ndash;55)</h2>
                <p>Electrical maintenance and engineering services are the backbone of facility reliability. Annual maintenance contracts for <span class="tip" data-tip="High Voltage / Medium Voltage — HV typically 33kV+, MV typically 11-33kV. Switchgear at these voltages requires specialized authorized personnel">HV/MV</span> switchgear, <span class="tip" data-tip="Uninterruptible Power Supply — provides battery backup power during utility failures, typically 10-15 minutes runtime to bridge to generator start">UPS</span> systems, and generators provide predictable recurring revenue streams, while emergency repairs command 2&ndash;3x premium pricing due to urgency.</p>

                <p>A typical 10MW data center spends <strong>$400K&ndash;$800K annually</strong> on electrical maintenance alone.<a href="#ref7" class="src-ref" title="Schneider Electric">[7]</a> <span class="tip" data-tip="Arc Flash Study — IEEE 1584-based analysis calculating incident energy levels at each electrical bus, determining required PPE and safe working distances">Arc flash studies</span> ($15K&ndash;$40K per facility) are required by <span class="tip" data-tip="National Fire Protection Association 70E — Standard for Electrical Safety in the Workplace, defines shock and arc flash protection requirements">NFPA 70E</span> and must be updated every 5 years or after any significant electrical modification. <span class="tip" data-tip="Electrical Power Monitoring System — real-time monitoring of voltage, current, power factor, harmonics across the electrical distribution system">EPMS</span> deployment ($50K&ndash;$150K) is increasingly bundled with maintenance contracts.</p>

                <div class="key-insight">
                    <strong>Key Insight</strong>
                    UPS battery replacement is the single largest predictable maintenance expense. Lead-acid batteries require replacement every 5&ndash;7 years at $15K&ndash;$80K per string. Lithium-ion adoption is growing (20% of new installations) with 10&ndash;15 year lifecycles, reducing long-term replacement revenue but increasing initial deployment value.
                </div>

                <div class="category-header">
                    <h3>D &mdash; Electrical Services</h3>
                    <span class="cat-range">Rank #41&ndash;55 | Medium Revenue</span>
                </div>
                <div class="service-list" id="catD-list"></div>

                <!-- Section 6: Category E -->
                <h2 id="sec6"><span class="section-number">6</span> Category E: Mechanical / Cooling (#56&ndash;70)</h2>
                <p>Mechanical and cooling services are the <strong>fastest-evolving category</strong> as rack densities climb from traditional 5&ndash;8 kW to 40&ndash;100+ kW for <span class="tip" data-tip="NVIDIA GB200 NVL72 — Blackwell-architecture GPU system consuming ~120kW per rack for AI training workloads">AI/GPU workloads</span>. The data center cooling market reached <strong>$22.5 billion in 2025</strong> and is growing at 14% CAGR.<a href="#ref8" class="src-ref" title="IEA">[8]</a></p>

                <p><span class="tip" data-tip="Computer Room Air Handler / Computer Room Air Conditioner — precision cooling units designed for data center environments, typically providing 30-100kW cooling capacity per unit">CRAH/CRAC</span> maintenance remains the volume leader, but <strong>liquid cooling system maintenance</strong> (direct-to-chip, rear-door heat exchangers, immersion) is the growth driver. Chiller plant maintenance at $8K&ndash;$25K per chiller/year represents the highest per-unit spend. <span class="tip" data-tip="Building Management System — centralized control system monitoring and managing HVAC, electrical, fire, and security systems">BMS</span> controls optimization ($15K&ndash;$40K) delivers measurable ROI: a well-tuned BMS can reduce cooling energy consumption by 15&ndash;25%.</p>

                <div class="key-insight">
                    <strong>Key Insight</strong>
                    Water treatment programs ($10K&ndash;$30K/year) are often underpriced relative to the risk they mitigate. A single Legionella outbreak or cooling tower scaling event can cause millions in damage and weeks of reduced capacity. Proper chemical treatment and monitoring has 10:1 ROI in avoided failure costs.<a href="#ref9" class="src-ref" title="ASHRAE">[9]</a>
                </div>

                <div class="category-header">
                    <h3>E &mdash; Mechanical / Cooling</h3>
                    <span class="cat-range">Rank #56&ndash;70 | Medium Revenue</span>
                </div>
                <div class="service-list" id="catE-list"></div>

                <!-- Section 7: Category F -->
                <h2 id="sec7"><span class="section-number">7</span> Category F: Monitoring, DCIM & Automation (#71&ndash;80)</h2>
                <p><span class="tip" data-tip="Data Center Infrastructure Management — software platform providing real-time monitoring, capacity planning, and asset management for physical data center infrastructure">DCIM</span> and monitoring services bridge the gap between physical infrastructure and digital operations. The DCIM market is projected to reach <strong>$5.4 billion by 2028</strong>, driven by the need for real-time visibility into increasingly dense and complex facilities.<a href="#ref10" class="src-ref" title="Verdantix">[10]</a></p>

                <p>Full DCIM implementation ($100K&ndash;$500K) is a high-value engagement that creates long-term lock-in &mdash; once deployed, clients rarely switch platforms. <span class="tip" data-tip="Supervisory Control and Data Acquisition — industrial control system used for monitoring and controlling HV/MV electrical distribution, generator controls, and critical alarms">SCADA</span> upgrades and <span class="tip" data-tip="Network Operations Center — 24/7 remote monitoring facility staffed with engineers who manage alarms, escalations, and first-response actions">NOC</span> monitoring services ($5K&ndash;$20K/month) provide high-margin recurring revenue. Alarm rationalization ($15K&ndash;$40K) has emerged as a critical service &mdash; the average data center generates <strong>3,000&ndash;10,000 alarms per day</strong>, of which 85&ndash;95% are actionable noise.<a href="#ref11" class="src-ref" title="Uptime Institute — Outage Analysis">[11]</a></p>

                <div class="key-insight">
                    <strong>Key Insight</strong>
                    Predictive analytics platforms ($50K&ndash;$150K/year) are the highest-growth service in this category. AI/ML-powered tools that predict equipment failures 2&ndash;4 weeks before they occur can save operators $500K+ per avoided unplanned outage. The ROI case is compelling: a single avoided UPS failure justifies 3&ndash;5 years of platform costs.
                </div>

                <div class="category-header">
                    <h3>F &mdash; Monitoring, DCIM & Automation</h3>
                    <span class="cat-range">Rank #71&ndash;80 | Medium Revenue</span>
                </div>
                <div class="service-list" id="catF-list"></div>

                <!-- Section 8: Category G -->
                <h2 id="sec8"><span class="section-number">8</span> Category G: Safety & Compliance (#81&ndash;90)</h2>
                <p>Compliance and certification services are driven by regulatory requirements, insurance mandates, and customer due diligence demands. The three most requested certifications are: <span class="tip" data-tip="Uptime Institute Tier Certification — independent third-party certification of data center design (Tier I-IV) measuring redundancy, fault tolerance, and concurrent maintainability">Uptime Tier</span>, <span class="tip" data-tip="ISO/IEC 27001 — international standard for Information Security Management Systems (ISMS), requiring systematic risk assessment and security controls">ISO 27001</span>, and <span class="tip" data-tip="Service Organization Control 2 Type II — audit standard evaluating security, availability, processing integrity, confidentiality, and privacy controls over a minimum 6-month period">SOC 2 Type II</span>.</p>

                <p>Uptime Institute reports <strong>over 3,100 active Tier certifications</strong> globally, with 400+ new certifications annually.<a href="#ref12" class="src-ref" title="Uptime Institute — Tier Certification">[12]</a> Full Tier certification support ($50K&ndash;$150K) is highly specialized work requiring certified <span class="tip" data-tip="Accredited Tier Designer — Uptime Institute certification for engineers qualified to design Tier-rated data center facilities">ATD</span> professionals. <span class="tip" data-tip="Surat Layak Operasi — Indonesian Electrical Operating License required for operating high-voltage electrical installations, issued by the Ministry of Energy and Mineral Resources">SLO</span> licensing support is critical in regulated markets like Indonesia, where operating without proper electrical permits carries severe penalties.</p>

                <div class="key-insight">
                    <strong>Key Insight</strong>
                    SOC 2 Type II audit support ($25K&ndash;$60K per cycle) is the most recurring compliance service — the audit cycle repeats annually. Clients who achieve certification rarely discontinue, creating a predictable annual revenue stream. Bundling SOC 2 + ISO 27001 support commands a 20&ndash;30% premium over individual engagements.
                </div>

                <div class="category-header">
                    <h3>G &mdash; Safety & Compliance</h3>
                    <span class="cat-range">Rank #81&ndash;90 | Low Revenue</span>
                </div>
                <div class="service-list" id="catG-list"></div>

                <!-- Section 9: Category H -->
                <h2 id="sec9"><span class="section-number">9</span> Category H: Operations & Managed Services (#91&ndash;100)</h2>
                <p>Managed services transform one-time engagements into long-term partnerships with typical contract terms of <strong>3&ndash;5 years</strong>. Full facility operations management at $15&ndash;$30/kW/month may appear as "low" per-unit pricing, but scales massively: a 10MW facility generates <strong>$1.8M&ndash;$3.6M annually</strong> from operations management alone.</p>

                <p><span class="tip" data-tip="Computerized Maintenance Management System — software platform for managing preventive maintenance schedules, work orders, spare parts inventory, and compliance documentation">CMMS</span> operation ($5K&ndash;$15K/month) and vendor management ($3K&ndash;$10K/month) are high-margin services with strong retention. <span class="tip" data-tip="Management of Change — formal process for evaluating, approving, and documenting changes to critical infrastructure, preventing unauthorized modifications">MOC</span> and <span class="tip" data-tip="Root Cause Analysis — systematic investigation methodology (5-Why, Fishbone, Fault Tree) to identify the fundamental cause of equipment failures or incidents">RCA</span> services are priced per-event but are essential for maintaining operational discipline. Embedded shift staffing ($8K&ndash;$15K per <span class="tip" data-tip="Full-Time Equivalent — one employee working full-time. Shift operations typically require 4.5-5.5 FTE per 24/7 shift position to cover all rotations, leave, and training">FTE</span>/month) is the largest volume driver in this category.</p>

                <div class="key-insight">
                    <strong>Key Insight</strong>
                    <span class="tip" data-tip="Standard Operating Procedures / Emergency Operating Procedures — documented step-by-step instructions for routine operations and emergency response actions">SOP/EOP</span> development ($2K&ndash;$8K per procedure) is the gateway service for managed operations — once you write the procedures, the client naturally needs someone to execute them. A typical data center requires 80&ndash;150 SOPs and 20&ndash;40 EOPs, representing $200K&ndash;$600K in development alone.
                </div>

                <div class="category-header">
                    <h3>H &mdash; Operations & Managed Services</h3>
                    <span class="cat-range">Rank #91&ndash;100 | Low Revenue</span>
                </div>
                <div class="service-list" id="catH-list"></div>

                <!-- Section 10: Category I -->
                <h2 id="sec10"><span class="section-number">10</span> Category I: Emergency & Recovery (#101&ndash;107)</h2>
                <p>Emergency services carry the <strong>highest gross margins (60&ndash;80%)</strong> in the entire catalog due to urgency premiums and the critical nature of the work. A single unplanned data center outage costs an average of <strong>$9,000 per minute</strong> according to Uptime Institute's 2024 survey &mdash; making rapid response services extremely valuable.<a href="#ref13" class="src-ref" title="Uptime Institute — Global Survey">[13]</a></p>

                <p>The retainer model ($5K&ndash;$15K/month) is the foundation: clients pay for guaranteed response times (typically 2&ndash;4 hour SLA) and on-call engineering resources. Temporary power deployment ($3K&ndash;$10K/day) and <span class="tip" data-tip="Disaster Recovery — strategies and procedures for restoring critical IT operations following a catastrophic event, including failover to secondary sites">DR</span> site activation ($50K&ndash;$200K per event) are the highest-value emergency engagements. Post-incident forensic investigation ($15K&ndash;$50K) builds deep trust and often leads to long-term retainer contracts.</p>

                <div class="key-insight">
                    <strong>Key Insight</strong>
                    Emergency fuel delivery services ($2K&ndash;$8K per delivery) may seem low-value, but during extended utility outages (hurricanes, grid failures), a single large data center can consume 10,000&ndash;50,000 liters of diesel per day. Pre-positioned fuel contracts with guaranteed supply chains are worth 5&ndash;10x spot rates during crisis events.
                </div>

                <div class="category-header">
                    <h3>I &mdash; Emergency & Recovery</h3>
                    <span class="cat-range">Rank #101&ndash;107 | Low Revenue</span>
                </div>
                <div class="service-list" id="catI-list"></div>

                <!-- Section 11: Category J -->
                <h2 id="sec11"><span class="section-number">11</span> Category J: Training & Certification (#108&ndash;114)</h2>
                <p>Training services have lower per-unit pricing ($500&ndash;$4,000 per attendee) but scale effectively through group sessions. A 20-person <span class="tip" data-tip="NFPA 70E — National Fire Protection Association Standard for Electrical Safety in the Workplace, covering shock/arc flash hazard analysis, safe work practices, and PPE requirements">NFPA 70E</span> training session generates $10K&ndash;$30K per event. The data center workforce gap is widening: the industry needs an estimated <strong>300,000 additional skilled workers by 2030</strong>, making training services a structural growth market.<a href="#ref14" class="src-ref" title="Uptime Institute — Staffing Forecast">[14]</a></p>

                <p><span class="tip" data-tip="Certified Data Centre Facilities Operations Manager — EPI certification for DC operations professionals covering all aspects of facility management">CDFOM</span> and <span class="tip" data-tip="Accredited Tier Designer — Uptime Institute certification for engineers qualified to design Tier-certified data centers">ATD</span> certification preparation ($2K&ndash;$4K per attendee) carry premium positioning because they lead to formal industry certifications. Emergency response tabletop exercises ($5K&ndash;$15K per event) are increasingly required by insurance underwriters on an annual basis, creating predictable recurring demand.</p>

                <div class="key-insight">
                    <strong>Key Insight</strong>
                    Custom technical workshops ($3K&ndash;$8K/day) are the highest-margin training service because content can be reused across clients. A well-designed workshop on topics like "Liquid Cooling Operations" or "HV Switching Safety" can be delivered 20+ times per year with minimal incremental cost.
                </div>

                <div class="category-header">
                    <h3>J &mdash; Training & Certification</h3>
                    <span class="cat-range">Rank #108&ndash;114 | Low Revenue</span>
                </div>
                <div class="service-list" id="catJ-list"></div>

                <!-- Section 12: Category K -->
                <h2 id="sec12"><span class="section-number">12</span> Category K: Sustainability & Energy (#115&ndash;120)</h2>
                <p>Sustainability services are the <strong>fastest-growing category at 25&ndash;30% CAGR</strong>, driven by <span class="tip" data-tip="Environmental, Social, and Governance — framework for evaluating corporate sustainability and ethical impact, increasingly required by investors and regulators">ESG</span> mandates, EU Energy Efficiency Directive requirements, and corporate net-zero commitments. Over <strong>85% of major data center operators</strong> have published sustainability targets for 2030, creating massive demand for advisory and implementation services.<a href="#ref15" class="src-ref" title="S&P Global">[15]</a></p>

                <p><span class="tip" data-tip="Power Purchase Agreement — long-term contract (10-20 years) to buy renewable energy directly from a generator at a fixed price, enabling carbon reduction without on-site generation">PPA</span> advisory ($30K&ndash;$100K per project) is the highest-value sustainability service, as operators seek to lock in renewable energy at competitive rates. Carbon footprint assessments (Scope 1, 2, 3) and <span class="tip" data-tip="Water Usage Effectiveness — metric measuring total water consumption divided by IT equipment energy consumption, similar to PUE but for water">WUE</span> optimization are growing rapidly as reporting requirements tighten. <span class="tip" data-tip="Leadership in Energy and Environmental Design — green building certification program by the U.S. Green Building Council, with levels: Certified, Silver, Gold, Platinum">LEED</span> certification support ($25K&ndash;$75K) adds measurable property value: LEED-certified facilities command 5&ndash;10% rent premiums.</p>

                <div class="key-insight">
                    <strong>Key Insight</strong>
                    Waste heat recovery feasibility studies ($15K&ndash;$50K) are an emerging high-growth service. European regulations are beginning to mandate waste heat reuse for data centers above 1MW. Nordic operators like Equinix and DigiPlex already supply district heating from DC waste heat, creating a model that will expand globally.<a href="#ref16" class="src-ref" title="European Commission">[16]</a>
                </div>

                <div class="category-header">
                    <h3>K &mdash; Sustainability & Energy</h3>
                    <span class="cat-range">Rank #115&ndash;120 | Low Revenue</span>
                </div>
                <div class="service-list" id="catK-list"></div>

                <!-- Pro Mode CTA Teaser -->
                <div class="mcl-cta-block" id="mclCtaBlock">
                    <h3><i class="fas fa-crown"></i> Unlock Pro OPEX & Workforce Intelligence</h3>
                    <p>Go beyond service pricing. Model annual OPEX, optimize staffing, assess financial risk, and generate executive reports with Monte Carlo simulation — all client-side, no data leaves your browser.</p>
                    <button class="mcl-cta-btn" onclick="mclShowLogin()"><i class="fas fa-lock-open"></i> Activate Pro Analysis</button>
                    <div class="mcl-cta-features">
                        <span><i class="fas fa-calculator"></i> OPEX Financial Intelligence</span>
                        <span><i class="fas fa-users"></i> Staffing Resilience Model</span>
                        <span><i class="fas fa-chart-area"></i> 10K Monte Carlo Sim</span>
                        <span><i class="fas fa-shield-alt"></i> Risk & Reliability Score</span>
                        <span><i class="fas fa-robot"></i> AI Narrative Report</span>
                    </div>
                </div>

                <!-- Section 13: Interactive Calculator -->
                <h2 id="sec13"><span class="section-number">13</span> Interactive Service Catalog Calculator</h2>
                <p>Use this interactive tool to explore all 120 services, filter by category and region, and build a custom service quote with regional pricing comparisons.</p>

                <div class="calculator-section">

                    <!-- Pro Mode Toolbar -->
                    <div class="mcl-toolbar-row">
                        <div class="mcl-mode-bar">
                            <div class="mcl-mode-toggle">
                                <button class="mcl-mode-btn active" id="mclFreeBtn" data-mode="free" onclick="mclSetMode('free')">Free Mode</button>
                                <button class="mcl-mode-btn" id="mclProBtn" data-mode="pro" onclick="mclSetMode('pro')">Pro Analysis</button>
                            </div>
                        </div>
                        <div class="mcl-toolbar-actions">
                            <button class="mcl-toolbar-btn mcl-btn-pdf" onclick="mclExportPDF()" style="display:none" id="mclBtnPdf"><i class="fas fa-file-pdf"></i> Export PDF</button>
                            <span class="mcl-privacy-badge"><i class="fas fa-shield-alt"></i> Client-Side Only</span>
                        </div>
                    </div>

                    <!-- Pro Strategic Inputs (hidden until Pro mode) -->
                    <div class="mcl-pro-inputs" id="mclProInputs">
                        <h4><i class="fas fa-sliders-h"></i> Strategic OPEX Parameters</h4>
                        <div class="mcl-input-grid">
                            <div class="mcl-input-group">
                                <label>Country / Region
                                    <span class="mcl-tooltip-trigger" tabindex="0">?
                                        <span class="mcl-tooltip-content">
                                            <div class="mcl-tooltip-title">SI-01: Country / Region</div>
                                            <div class="mcl-tooltip-desc">Determines labor rates, energy costs, currency, and climate adjustment factors. Tropical regions have ~10-15% higher cooling OPEX.</div>
                                            <span class="mcl-tooltip-formula">Affects: laborRate, energyRate, tropicalFactor</span>
                                        </span>
                                    </span>
                                </label>
                                <select id="mclCountry">
                                    <option value="Indonesia">Indonesia (IDR)</option>
                                    <option value="Singapore">Singapore (SGD)</option>
                                    <option value="Malaysia">Malaysia (MYR)</option>
                                    <option value="Thailand">Thailand (THB)</option>
                                    <option value="Vietnam">Vietnam (VND)</option>
                                    <option value="Philippines">Philippines (PHP)</option>
                                    <option value="India">India (INR)</option>
                                    <option value="Japan">Japan (JPY)</option>
                                    <option value="Australia">Australia (AUD)</option>
                                    <option value="US-Virginia" selected>US - Virginia (USD)</option>
                                    <option value="US-Texas">US - Texas (USD)</option>
                                    <option value="US-Oregon">US - Oregon (USD)</option>
                                    <option value="EU-Germany">EU - Germany (EUR)</option>
                                    <option value="EU-Netherlands">EU - Netherlands (EUR)</option>
                                    <option value="EU-Ireland">EU - Ireland (EUR)</option>
                                    <option value="UK">UK (GBP)</option>
                                    <option value="UAE">UAE (AED)</option>
                                    <option value="Saudi-Arabia">Saudi Arabia (SAR)</option>
                                    <option value="Brazil">Brazil (BRL)</option>
                                    <option value="Chile">Chile (CLP)</option>
                                </select>
                            </div>
                            <div class="mcl-input-group">
                                <label>Critical Load (MW)
                                    <span class="mcl-tooltip-trigger" tabindex="0">?
                                        <span class="mcl-tooltip-content">
                                            <div class="mcl-tooltip-title">SI-02: Critical IT Load</div>
                                            <div class="mcl-tooltip-desc">Total IT power demand in megawatts. Drives energy cost, staffing requirements, and maintenance budgets. 1 MW = ~200 racks at 5kW avg.</div>
                                            <span class="mcl-tooltip-formula">Energy = MW x 1000 x PUE x rate x 8760</span>
                                        </span>
                                    </span>
                                </label>
                                <input type="number" id="mclLoad" value="10" min="0.1" max="100" step="0.1">
                            </div>
                            <div class="mcl-input-group">
                                <label>Target PUE
                                    <span class="mcl-tooltip-trigger" tabindex="0">?
                                        <span class="mcl-tooltip-content">
                                            <div class="mcl-tooltip-title">SI-03: Target PUE</div>
                                            <div class="mcl-tooltip-desc">Power Usage Effectiveness. Industry avg 1.58 (Uptime 2024). Hyperscalers achieve 1.10-1.20. Tropical locations typically 1.35-1.60.</div>
                                            <span class="mcl-tooltip-formula">Total Power = IT Load x PUE</span>
                                        </span>
                                    </span>
                                </label>
                                <input type="number" id="mclPUE" value="1.40" min="1.10" max="3.00" step="0.01">
                            </div>
                            <div class="mcl-input-group">
                                <label>Staffing Model
                                    <span class="mcl-tooltip-trigger" tabindex="0">?
                                        <span class="mcl-tooltip-content">
                                            <div class="mcl-tooltip-title">SI-04: Staffing Model</div>
                                            <div class="mcl-tooltip-desc">In-house provides control; outsourced reduces fixed cost. Hybrid models balance both. 4.2x multiplier for 24/7 coverage per position.</div>
                                            <span class="mcl-tooltip-formula">Shift staff = positions x 4.2 (24/7)</span>
                                        </span>
                                    </span>
                                </label>
                                <select id="mclStaffModel">
                                    <option value="inhouse" selected>Full In-House</option>
                                    <option value="hybrid70">Hybrid 70/30 (In/Out)</option>
                                    <option value="hybrid50">Hybrid 50/50</option>
                                    <option value="outsourced">Full Outsourced</option>
                                </select>
                            </div>
                            <div class="mcl-input-group">
                                <label>Retention Target (%)
                                    <span class="mcl-tooltip-trigger" tabindex="0">?
                                        <span class="mcl-tooltip-content">
                                            <div class="mcl-tooltip-title">SI-05: Staff Retention Rate</div>
                                            <div class="mcl-tooltip-desc">Target annual retention rate. Industry avg ~82%. Each turnover costs 50-200% of annual salary (recruitment, training, knowledge loss).</div>
                                            <span class="mcl-tooltip-formula">Turnover Cost = (1 - rate) x headcount x 1.5x salary</span>
                                        </span>
                                    </span>
                                </label>
                                <input type="number" id="mclRetention" value="85" min="60" max="99" step="1">
                            </div>
                            <div class="mcl-input-group">
                                <label>PM/CM Ratio (% Preventive)
                                    <span class="mcl-tooltip-trigger" tabindex="0">?
                                        <span class="mcl-tooltip-content">
                                            <div class="mcl-tooltip-title">SI-06: PM/CM Ratio Target</div>
                                            <div class="mcl-tooltip-desc">Percentage of maintenance that is preventive vs corrective. Best-in-class: 80%+ PM. Industry avg: 55-65%. Higher PM = lower failure risk.</div>
                                            <span class="mcl-tooltip-formula">PM Compliance = PM_hours / total_maint_hours</span>
                                        </span>
                                    </span>
                                </label>
                                <input type="number" id="mclPMRatio" value="75" min="30" max="95" step="1">
                            </div>
                        </div>
                    </div>

                    <div class="calc-controls">
                        <div class="calc-control-group">
                            <label>Region
                                <span class="mcl-tooltip-trigger" tabindex="0">?<span class="mcl-tooltip-content"><div class="mcl-tooltip-title">Regional Cost Multiplier</div><div class="mcl-tooltip-desc">Adjusts service pricing based on regional labor rates, energy costs, and market maturity. Americas = baseline 1.00x, Europe +20%, SEA -40%, Australia +15%.</div><div class="mcl-tooltip-formula">Price = Base &times; Region Multiplier</div></span></span>
                            </label>
                            <select id="calcRegion">
                                <option value="americas">Americas (Virginia/Texas) &mdash; 1.00x</option>
                                <option value="europe">Europe (Frankfurt/London) &mdash; 1.20x</option>
                                <option value="sea">SEA (Jakarta/KL) &mdash; 0.60x</option>
                                <option value="australia">Australia (Sydney) &mdash; 1.15x</option>
                            </select>
                        </div>
                        <div class="calc-control-group">
                            <label>Search
                                <span class="mcl-tooltip-trigger" tabindex="0">?<span class="mcl-tooltip-content"><div class="mcl-tooltip-title">Service Search</div><div class="mcl-tooltip-desc">Filter the 120 maintenance services by name, description, or keyword. Matches are highlighted in real-time across all visible service cards.</div></span></span>
                            </label>
                            <input type="text" id="calcSearch" placeholder="Search by name, description, or keyword...">
                        </div>
                        <div class="calc-control-group">
                            <label>Sort By
                                <span class="mcl-tooltip-trigger" tabindex="0">?<span class="mcl-tooltip-content"><div class="mcl-tooltip-title">Sort Order</div><div class="mcl-tooltip-desc">Reorder the service catalog. Revenue Rank sorts by industry revenue impact (#1 = highest revenue service). Price sorts by estimated annual cost.</div></span></span>
                            </label>
                            <select id="calcSort">
                                <option value="rank">Revenue Rank (#1 first)</option>
                                <option value="price-high">Price: High to Low</option>
                                <option value="price-low">Price: Low to High</option>
                                <option value="alpha">Alphabetical (A&ndash;Z)</option>
                            </select>
                        </div>
                    </div>

                    <div class="calc-suboptions">
                        <div class="calc-control-group">
                            <label>Contract Term
                                <span class="mcl-tooltip-trigger" tabindex="0">?<span class="mcl-tooltip-content"><div class="mcl-tooltip-title">Contract Duration Discount</div><div class="mcl-tooltip-desc">Longer commitments reduce per-year cost through volume discounts. Spot = no discount (1.00x), 3-year = 12% discount (0.88x), 5-year = 18% discount (0.82x).</div><div class="mcl-tooltip-formula">Discount = 1 - (0.05 &times; years)</div></span></span>
                            </label>
                            <select id="calcTerm">
                                <option value="1">Spot / One-time (1.00x)</option>
                                <option value="0.95">1-Year Contract (0.95x)</option>
                                <option value="0.88" selected>3-Year Contract (0.88x)</option>
                                <option value="0.82">5-Year Contract (0.82x)</option>
                            </select>
                        </div>
                        <div class="calc-control-group">
                            <label>Facility Size
                                <span class="mcl-tooltip-trigger" tabindex="0">?<span class="mcl-tooltip-content"><div class="mcl-tooltip-title">Facility Scale Factor</div><div class="mcl-tooltip-desc">Larger facilities have economies of scale for maintenance services. Small (&lt;2 MW) = higher unit cost, Hyperscale (50+ MW) = bulk pricing and dedicated teams.</div><div class="mcl-tooltip-formula">Affects staffing, spare inventory, SLA tiers</div></span></span>
                            </label>
                            <select id="calcSize">
                                <option value="small">Small (&lt;2 MW)</option>
                                <option value="medium" selected>Medium (2&ndash;10 MW)</option>
                                <option value="large">Large (10&ndash;50 MW)</option>
                                <option value="hyperscale">Hyperscale (50+ MW)</option>
                            </select>
                        </div>
                        <div class="calc-control-group">
                            <label>Revenue Tier
                                <span class="mcl-tooltip-trigger" tabindex="0">?<span class="mcl-tooltip-content"><div class="mcl-tooltip-title">Revenue Tier Filter</div><div class="mcl-tooltip-desc">Filter services by their industry revenue ranking. High (#1-40) = critical revenue-generating services, Medium (#41-80) = standard operations, Low (#81+) = niche/specialized.</div></span></span>
                            </label>
                            <select id="calcRevTier">
                                <option value="all" selected>All Tiers</option>
                                <option value="high">High Revenue Only (#1&ndash;40)</option>
                                <option value="medium">Medium Revenue (#41&ndash;80)</option>
                                <option value="low">Low Revenue (#81&ndash;120)</option>
                            </select>
                        </div>
                    </div>

                    <div class="category-pills" id="categoryPills">
                        <button class="cat-pill active" data-cat="all">All (120)</button>
                        <button class="cat-pill" data-cat="A">Colocation</button>
                        <button class="cat-pill" data-cat="B">Consulting</button>
                        <button class="cat-pill" data-cat="C">Testing</button>
                        <button class="cat-pill" data-cat="D">Electrical</button>
                        <button class="cat-pill" data-cat="E">Mechanical</button>
                        <button class="cat-pill" data-cat="F">DCIM</button>
                        <button class="cat-pill" data-cat="G">Compliance</button>
                        <button class="cat-pill" data-cat="H">Operations</button>
                        <button class="cat-pill" data-cat="I">Emergency</button>
                        <button class="cat-pill" data-cat="J">Training</button>
                        <button class="cat-pill" data-cat="K">Sustainability</button>
                    </div>

                    <div class="calc-count" id="calcCount">Showing 120 of 120 services</div>
                    <div class="calc-results" id="calcResults"></div>

                    <!-- ====== PRO PANEL 1: OPEX Financial Intelligence ====== -->
                    <div class="mcl-pro-panel gated" id="mclPanel1" style="display:none">
                        <div class="mcl-gate-overlay" onclick="mclShowLogin()">
                            <i class="fas fa-lock"></i>
                            <span>Pro Feature — Log in to unlock</span>
                        </div>
                        <div class="mcl-panel-title"><i class="fas fa-dollar-sign"></i> OPEX Financial Intelligence</div>
                        <div class="mcl-kpi-grid">
                            <div class="mcl-kpi-card">
                                <div class="mcl-kpi-value" id="mclEnergyCost">--</div>
                                <div class="mcl-kpi-label">Annual Energy Cost</div>
                                <div class="mcl-kpi-sublabel">Load x PUE x rate x 8760</div>
                            </div>
                            <div class="mcl-kpi-card">
                                <div class="mcl-kpi-value" id="mclLaborBudget">--</div>
                                <div class="mcl-kpi-label">Annual Labor Budget</div>
                                <div class="mcl-kpi-sublabel">Headcount x burdened rate</div>
                            </div>
                            <div class="mcl-kpi-card">
                                <div class="mcl-kpi-value" id="mclMaintBudget">--</div>
                                <div class="mcl-kpi-label">Maintenance Budget</div>
                                <div class="mcl-kpi-sublabel">PM + CM + vendor</div>
                            </div>
                            <div class="mcl-kpi-card">
                                <div class="mcl-kpi-value" id="mclTotalOpex">--</div>
                                <div class="mcl-kpi-label">Total Annual OPEX</div>
                            </div>
                            <div class="mcl-kpi-card">
                                <div class="mcl-kpi-value" id="mclOpexPerMW">--</div>
                                <div class="mcl-kpi-label">OPEX per MW</div>
                            </div>
                            <div class="mcl-kpi-card">
                                <div class="mcl-kpi-value" id="mclCostPerKW">--</div>
                                <div class="mcl-kpi-label">Cost per kW/month</div>
                                <div class="mcl-kpi-sublabel">Industry: $8-15/kW</div>
                            </div>
                            <div class="mcl-kpi-card">
                                <div class="mcl-kpi-value" id="mclCashVariance">--</div>
                                <div class="mcl-kpi-label">Cash Flow Variance</div>
                                <div class="mcl-kpi-sublabel">Target: &lt;2%</div>
                            </div>
                            <div class="mcl-kpi-card">
                                <div class="mcl-kpi-value" id="mclAFFO">--</div>
                                <div class="mcl-kpi-label">AFFO Impact</div>
                                <div class="mcl-kpi-sublabel">FFO - Maint CapEx</div>
                            </div>
                        </div>
                    </div>

                    <!-- ====== PRO PANEL 2: Staffing Resilience Analysis ====== -->
                    <div class="mcl-pro-panel gated" id="mclPanel2" style="display:none">
                        <div class="mcl-gate-overlay" onclick="mclShowLogin()">
                            <i class="fas fa-lock"></i>
                            <span>Pro Feature — Log in to unlock</span>
                        </div>
                        <div class="mcl-panel-title"><i class="fas fa-users"></i> Staffing Resilience Analysis</div>
                        <div class="mcl-kpi-grid">
                            <div class="mcl-kpi-card">
                                <div class="mcl-kpi-value" id="mclHeadcount">--</div>
                                <div class="mcl-kpi-label">Optimal Headcount</div>
                                <div class="mcl-kpi-sublabel">SAP / Tech / FM</div>
                            </div>
                            <div class="mcl-kpi-card">
                                <div class="mcl-kpi-value" id="mclUtilization">--</div>
                                <div class="mcl-kpi-label">Utilization Rate</div>
                                <div class="mcl-kpi-sublabel">Target: 85%</div>
                            </div>
                            <div class="mcl-kpi-card">
                                <div class="mcl-kpi-value" id="mclBurnout">--</div>
                                <div class="mcl-kpi-label">Burnout Probability</div>
                                <div class="mcl-kpi-sublabel">Logistic model</div>
                            </div>
                            <div class="mcl-kpi-card">
                                <div class="mcl-kpi-value" id="mclBreakeven">--</div>
                                <div class="mcl-kpi-label">In/Out Break-Even</div>
                                <div class="mcl-kpi-sublabel">FTE threshold</div>
                            </div>
                            <div class="mcl-kpi-card">
                                <div class="mcl-kpi-value" id="mclRetentionCost">--</div>
                                <div class="mcl-kpi-label">Retention Premium</div>
                                <div class="mcl-kpi-sublabel">Cost of turnover/yr</div>
                            </div>
                            <div class="mcl-kpi-card">
                                <div class="mcl-kpi-value" id="mclSkillGap">--</div>
                                <div class="mcl-kpi-label">Single Points of Failure</div>
                                <div class="mcl-kpi-sublabel">Skill gap risk</div>
                            </div>
                            <div class="mcl-kpi-card">
                                <div class="mcl-kpi-value" id="mclResilienceIdx">--</div>
                                <div class="mcl-kpi-label">Staffing Resilience Index</div>
                                <div class="mcl-kpi-sublabel">0-100 score</div>
                            </div>
                            <div class="mcl-kpi-card">
                                <div class="mcl-kpi-value" id="mclHEP">--</div>
                                <div class="mcl-kpi-label">HEP Modifier</div>
                                <div class="mcl-kpi-sublabel">Human Error Probability</div>
                            </div>
                        </div>
                    </div>

                    <!-- ====== PRO PANEL 3: Risk & Reliability ====== -->
                    <div class="mcl-pro-panel gated" id="mclPanel3" style="display:none">
                        <div class="mcl-gate-overlay" onclick="mclShowLogin()">
                            <i class="fas fa-lock"></i>
                            <span>Pro Feature — Log in to unlock</span>
                        </div>
                        <div class="mcl-panel-title"><i class="fas fa-shield-alt"></i> Risk & Reliability Dashboard</div>
                        <div class="mcl-kpi-grid">
                            <div class="mcl-kpi-card">
                                <div class="mcl-kpi-value" id="mclFinExposure">--</div>
                                <div class="mcl-kpi-label">Financial Exposure</div>
                                <div class="mcl-kpi-sublabel">Score 0-100</div>
                            </div>
                            <div class="mcl-kpi-card">
                                <div class="mcl-kpi-value" id="mclCOI">--</div>
                                <div class="mcl-kpi-label">Cost of Inaction</div>
                                <div class="mcl-kpi-sublabel">Prevented losses x multiplier</div>
                            </div>
                            <div class="mcl-kpi-card">
                                <div class="mcl-kpi-value" id="mclOHS">--</div>
                                <div class="mcl-kpi-label">Operational Health Score</div>
                                <div class="mcl-kpi-sublabel">Grade A-F</div>
                            </div>
                            <div class="mcl-kpi-card">
                                <div class="mcl-kpi-value" id="mclPMCompliance">--</div>
                                <div class="mcl-kpi-label">PM Compliance Rate</div>
                            </div>
                            <div class="mcl-kpi-card">
                                <div class="mcl-kpi-value" id="mclAlarmEff">--</div>
                                <div class="mcl-kpi-label">Alarm Efficiency</div>
                                <div class="mcl-kpi-sublabel">Signal-to-noise</div>
                            </div>
                            <div class="mcl-kpi-card">
                                <div class="mcl-kpi-value" id="mclMaintDebt">--</div>
                                <div class="mcl-kpi-label">5-Year Maint. Debt</div>
                                <div class="mcl-kpi-sublabel">Deferred projection</div>
                            </div>
                            <div class="mcl-kpi-card">
                                <div class="mcl-kpi-value" id="mclAFFOPotential">--</div>
                                <div class="mcl-kpi-label">AFFO Optimization</div>
                                <div class="mcl-kpi-sublabel">Annual savings potential</div>
                            </div>
                        </div>
                    </div>

                    <!-- ====== PRO PANEL 4: Monte Carlo (10K) ====== -->
                    <div class="mcl-pro-panel gated" id="mclPanel4" style="display:none">
                        <div class="mcl-gate-overlay" onclick="mclShowLogin()">
                            <i class="fas fa-lock"></i>
                            <span>Pro Feature — Log in to unlock</span>
                        </div>
                        <div class="mcl-panel-title"><i class="fas fa-chart-area"></i> Monte Carlo OPEX Simulation (10K Iterations)</div>
                        <div class="mcl-kpi-grid">
                            <div class="mcl-kpi-card">
                                <div class="mcl-kpi-value" id="mclMCP5">--</div>
                                <div class="mcl-kpi-label">P5 (Best Case)</div>
                            </div>
                            <div class="mcl-kpi-card">
                                <div class="mcl-kpi-value" id="mclMCP25">--</div>
                                <div class="mcl-kpi-label">P25</div>
                            </div>
                            <div class="mcl-kpi-card">
                                <div class="mcl-kpi-value" id="mclMCP50">--</div>
                                <div class="mcl-kpi-label">P50 (Median)</div>
                            </div>
                            <div class="mcl-kpi-card">
                                <div class="mcl-kpi-value" id="mclMCP75">--</div>
                                <div class="mcl-kpi-label">P75</div>
                            </div>
                            <div class="mcl-kpi-card">
                                <div class="mcl-kpi-value" id="mclMCP95">--</div>
                                <div class="mcl-kpi-label">P95 (Worst Case)</div>
                            </div>
                            <div class="mcl-kpi-card">
                                <div class="mcl-kpi-value" id="mclMCCVaR">--</div>
                                <div class="mcl-kpi-label">CVaR @ 95%</div>
                                <div class="mcl-kpi-sublabel">Expected Shortfall</div>
                            </div>
                            <div class="mcl-kpi-card">
                                <div class="mcl-kpi-value" id="mclMCExceed">--</div>
                                <div class="mcl-kpi-label">Budget Exceedance</div>
                                <div class="mcl-kpi-sublabel">P(cost > 120% budget)</div>
                            </div>
                            <div class="mcl-kpi-card">
                                <div class="mcl-kpi-value" id="mclMCTopDriver">--</div>
                                <div class="mcl-kpi-label">Highest Impact Factor</div>
                            </div>
                        </div>
                        <div class="mcl-chart-container">
                            <canvas id="mclMonteCarloChart" height="220"></canvas>
                        </div>
                        <div class="mcl-chart-container" style="margin-top:0.75rem">
                            <canvas id="mclTornadoChart" height="200"></canvas>
                        </div>
                    </div>

                    <!-- ====== PRO PANEL 5: AI-Generated Narrative ====== -->
                    <div class="mcl-pro-panel gated" id="mclPanel5" style="display:none">
                        <div class="mcl-gate-overlay" onclick="mclShowLogin()">
                            <i class="fas fa-lock"></i>
                            <span>Pro Feature — Log in to unlock</span>
                        </div>
                        <div class="mcl-panel-title"><i class="fas fa-robot"></i> AI-Generated Executive Report</div>
                        <div class="mcl-narrative" id="mclNarrative">
                            <h4><i class="fas fa-file-alt"></i> OPEX & Workforce Intelligence Report</h4>
                            <div id="mclNarrativeText">Activate Pro Mode to generate assessment...</div>
                        </div>
                    </div>

                    <!-- Benchmark Meta -->
                    <div class="mcl-benchmark-meta" id="mclBenchmarkMeta" style="display:none">
                        <span class="mcl-benchmark-tag"><i class="fas fa-database"></i> CBRE H2 2025</span>
                        <span class="mcl-benchmark-tag"><i class="fas fa-users"></i> Uptime Staffing 2025</span>
                        <span class="mcl-benchmark-tag"><i class="fas fa-chart-bar"></i> 10K MC Iterations</span>
                        <span class="mcl-benchmark-tag"><i class="fas fa-globe"></i> 20 Regions</span>
                        <span class="mcl-benchmark-tag"><i class="fas fa-calendar"></i> Feb 2026 Data</span>
                    </div>

                </div>

                <!-- Section 14: Regional Pricing Analysis -->
                <h2 id="sec14"><span class="section-number">14</span> Regional Pricing Analysis</h2>
                <p>
                    Data center service pricing varies significantly across global regions, driven by labor costs, regulatory complexity, market maturity, and supply/demand dynamics. The following multipliers are derived from <span class="tip" data-tip="Bureau of Labor Statistics — US federal agency providing labor market statistics used as baseline for international labor cost comparisons">BLS</span> labor cost indices, <span class="tip" data-tip="International Labour Organization — UN agency providing global labor statistics and employment data across 180+ countries">ILO</span> international data, and commercial real estate benchmarks from CBRE and JLL across 15+ data center markets.<a href="#ref1" class="src-ref" title="CBRE Data Center Solutions">[1]</a>
                </p>

                <div class="region-chart-container">
                    <div class="region-bar-chart">
                        <div class="rbc-row">
                            <span class="rbc-label">Americas</span>
                            <div class="rbc-bar-bg"><div class="rbc-bar" style="width:83%"></div></div>
                            <span class="rbc-val">1.00x</span>
                        </div>
                        <div class="rbc-row">
                            <span class="rbc-label">Europe</span>
                            <div class="rbc-bar-bg"><div class="rbc-bar" style="width:100%"></div></div>
                            <span class="rbc-val">1.20x</span>
                        </div>
                        <div class="rbc-row">
                            <span class="rbc-label">SEA</span>
                            <div class="rbc-bar-bg"><div class="rbc-bar" style="width:50%"></div></div>
                            <span class="rbc-val">0.60x</span>
                        </div>
                        <div class="rbc-row">
                            <span class="rbc-label">Australia</span>
                            <div class="rbc-bar-bg"><div class="rbc-bar" style="width:96%"></div></div>
                            <span class="rbc-val">1.15x</span>
                        </div>
                    </div>
                </div>

                <div class="key-insight">
                    <strong>Regional Pricing Drivers</strong>
                    <strong style="display:inline; font-size: inherit; text-transform: none; letter-spacing: normal;">Europe (1.20x):</strong> Higher labor costs, GDPR compliance overhead, and stringent environmental regulations push pricing 20% above the Americas baseline. Frankfurt and London markets command premium rates.<br><br>
                    <strong style="display:inline; font-size: inherit; text-transform: none; letter-spacing: normal;">SEA (0.60x):</strong> Lower labor costs in Indonesia, Malaysia, and Thailand significantly reduce service pricing. However, the gap is narrowing as the region matures and demand from hyperscalers drives up skilled labor rates.<br><br>
                    <strong style="display:inline; font-size: inherit; text-transform: none; letter-spacing: normal;">Australia (1.15x):</strong> High labor costs and geographic isolation push pricing 15% above baseline. The concentrated market (primarily Sydney and Melbourne) supports premium positioning.
                </div>

                <!-- Section 15: Conclusion -->
                <h2 id="sec15"><span class="section-number">15</span> Conclusion & Revenue Strategy</h2>

                <div class="conclusion-box">
                    <h3>Strategic Revenue Optimization Framework</h3>
                    <p>This comprehensive catalog of 120 data center services reveals several critical patterns for revenue optimization:</p>
                    <ul>
                        <li><strong>Recurring beats one-time:</strong> Monthly colocation and managed services generate the highest ARP despite lower unit prices. Prioritize building recurring revenue streams.</li>
                        <li><strong>Bundle for value:</strong> Combining complementary services (e.g., colocation + remote hands + monitoring) increases per-customer revenue by 40&ndash;60% while improving retention.</li>
                        <li><strong>Regional arbitrage:</strong> Deliver high-value consulting and design services from lower-cost regions (SEA) to higher-priced markets (Europe/Australia) to maximize margins.</li>
                        <li><strong>Sustainability premium:</strong> ESG-related services (Category K) are growing at 25&ndash;30% annually. Early positioning in PPA advisory and carbon assessment creates competitive moats.</li>
                        <li><strong>Emergency readiness:</strong> While emergency services (Category I) rank lower in volume, they carry 60&ndash;80% gross margins and build deep client relationships.</li>
                    </ul>
                    <p style="margin-top: 1.5rem; color: #fbbf24; font-weight: 600;">
                        The most successful data center service providers will master the balance between high-volume recurring services and high-margin specialized engagements, while expanding regionally to capture market-specific opportunities.
                    </p>
                </div>

                <!-- Section 16: References & Sources -->
                <h2 id="sec16"><span class="section-number">16</span> References & Sources</h2>
                <p>All pricing ranges in this catalog are derived from analysis of the following industry sources, benchmarking reports, and market data. Prices represent Americas baseline as of Q1 2026. Actual pricing varies by scope, complexity, vendor, and specific market conditions.</p>

                <ol class="ref-list">
                    <li id="ref1"><strong>CBRE Data Center Solutions</strong> &mdash; "North American Data Center Report H2 2025: Pricing, Supply, and Demand Trends." CBRE Research, 2025. <a href="https://www.cbre.com/insights/reports/north-america-data-center-report" target="_blank" rel="noopener">cbre.com/insights</a></li>
                    <li id="ref2"><strong>Cushman & Wakefield</strong> &mdash; "Global Data Center Market Comparison 2025." Includes colocation pricing, vacancy rates, and absorption across 40+ markets. <a href="https://www.cushmanwakefield.com/en/insights/global-data-center-market-comparison" target="_blank" rel="noopener">cushmanwakefield.com/insights</a></li>
                    <li id="ref3"><strong>Structure Research</strong> &mdash; "Global Colocation Market Report 2025." Market sizing, revenue projections, and regional growth analysis. Published Q1 2025.</li>
                    <li id="ref4"><strong>McKinsey & Company</strong> &mdash; "Investing in the Rising Data Center Economy," January 2023. Advisory market sizing and growth projections for infrastructure consulting.</li>
                    <li id="ref5"><strong>Synergy Research Group</strong> &mdash; "Data Center M&A and Leasing Tracker 2024." Transaction volumes, deal values, and market consolidation analysis.</li>
                    <li id="ref6"><strong>JLL Research</strong> &mdash; "Data Center Outlook 2025: Construction Pipeline and Capital Investment." Global construction spending and commissioning pipeline analysis. <a href="https://www.jll.com/en/trends-and-insights/research" target="_blank" rel="noopener">jll.com/research</a></li>
                    <li id="ref7"><strong>Schneider Electric</strong> &mdash; "White Paper 37: Electrical Efficiency Modeling of Data Centers." OPEX benchmarks for electrical maintenance across facility sizes. 2024 revision.</li>
                    <li id="ref8"><strong>IEA (International Energy Agency)</strong> &mdash; "Data Centres and Data Transmission Networks." Energy consumption, cooling market projections, and efficiency benchmarks. <a href="https://www.iea.org/energy-system/buildings/data-centres-and-data-transmission-networks" target="_blank" rel="noopener">iea.org</a></li>
                    <li id="ref9"><strong>ASHRAE</strong> &mdash; "Guideline 12-2024: Managing the Risk of Legionella in Building Water Systems." Water treatment ROI analysis and compliance requirements.</li>
                    <li id="ref10"><strong>Verdantix</strong> &mdash; "Green Quadrant: DCIM Software 2025." Market sizing and vendor analysis for DCIM and monitoring platforms.</li>
                    <li id="ref11"><strong>Uptime Institute</strong> &mdash; "Annual Outage Analysis 2024: The Causes and Costs of Data Center Disruptions." Alarm management best practices and outage cost analysis. <a href="https://uptimeinstitute.com/resources/research-and-reports" target="_blank" rel="noopener">uptimeinstitute.com</a></li>
                    <li id="ref12"><strong>Uptime Institute</strong> &mdash; "Tier Certification Database and Annual Report 2025." Global certification statistics, trends, and compliance analysis.</li>
                    <li id="ref13"><strong>Uptime Institute</strong> &mdash; "Uptime Institute Global Data Center Survey 2024." Cost of outages, staffing trends, and operational maturity metrics.</li>
                    <li id="ref14"><strong>Uptime Institute</strong> &mdash; "Data Center Staffing Forecast 2025&ndash;2030." Workforce gap analysis and training market projections.</li>
                    <li id="ref15"><strong>S&P Global</strong> &mdash; "Data Center ESG and Sustainability Tracker 2025." Corporate sustainability targets, PPA adoption rates, and ESG reporting requirements across operators.</li>
                    <li id="ref16"><strong>European Commission</strong> &mdash; "EU Energy Efficiency Directive (EED) Recast 2023." Waste heat reuse mandates for data centers above 1MW effective 2025. <a href="https://energy.ec.europa.eu/topics/energy-efficiency_en" target="_blank" rel="noopener">energy.ec.europa.eu</a></li>
                </ol>

                <p style="margin-top: 1.5rem; font-size: 0.85rem; color: var(--text-secondary);">
                    <strong>Methodology note:</strong> Regional multipliers (Americas 1.00x, Europe 1.20x, SEA 0.60x, Australia 1.15x) are derived from labor cost indices (Bureau of Labor Statistics, ILO), commercial real estate benchmarks (CBRE, JLL), and regulatory compliance overhead analysis across 15+ data center markets.
                </p>

                <!-- Newsletter Signup -->
                <div class="newsletter-signup">
                    <h3>Stay Updated</h3>
                    <p>Get notified when new articles on data center operations and engineering excellence are published.</p>
                    <form class="newsletter-form" onsubmit="return subscribeNewsletter(event)">
                        <input type="email" placeholder="Enter your email" required>
                        <button type="submit">Subscribe</button>
                    </form>
                    <p class="newsletter-privacy">No spam. Unsubscribe anytime.</p>
                </div>

                <!-- Author Bio -->
                <div class="author-bio">
                    <div class="author-bio-image">
                        <img loading="lazy" src="assets/profile-photo.jpg" alt="Bagus Dwi Permana">
                    </div>
                    <div class="author-bio-content">
                        <h4>Bagus Dwi Permana</h4>
                        <p class="author-bio-title">Engineering Operations Manager | Ahli K3 Listrik</p>
                        <p>12+ years professional experience in critical infrastructure and operations. CDFOM certified. Transforming operations through systematic excellence and safety-first engineering.</p>
                        <div class="author-bio-links">
                            <a href="https://www.linkedin.com/in/bagus-dwi-permana-ba90b092" target="_blank">
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/></svg>
                                LinkedIn
                            </a>
                            <a href="https://github.com/baguspermana7-cpu" target="_blank">
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/></svg>
                                GitHub
                            </a>
                            <a href="mailto:baguspermana7@gmail.com">
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg>
                                Email
                            </a>
                        </div>
                    </div>
                </div>

                <!-- Related Articles -->
                <div class="related-articles">
                    <h3>Continue Reading</h3>
                    <div class="related-grid">
                        <a href="article-14.html" class="related-card">
                            <div class="related-card-number">14</div>
                            <div class="related-card-content">
                                <h4>The $64 Billion Rebellion: Why Communities Worldwide Are Fighting Data Centers</h4>
                                <p>Community resistance to data center expansion</p>
                            </div>
                        </a>
                        <a href="article-1.html" class="related-card">
                            <div class="related-card-number">01</div>
                            <div class="related-card-content">
                                <h4>When Nothing Happens, Engineering Is Working</h4>
                                <p>The invisible work of reliability engineering</p>
                            </div>
                        </a>
                    </div>
                </div>

                <p style="text-align: center; color: var(--text-secondary); margin-top: 2rem; font-size: 0.85rem;">
                    &mdash; End of Article 15 &mdash;<br>
                    <span style="font-size: 0.8rem;">All pricing data represents Americas baseline ranges as of Q1 2026. Actual pricing varies by scope, complexity, and vendor.</span>
                </p>

                <!-- Article Navigation -->
                <div class="article-nav">
                    <a href="article-14.html">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M19 12H5M12 19l-7-7 7-7"/></svg>
                        Previous Article
                    </a>
                    <a href="article-16.html">
                        Next Article
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M5 12h14M12 5l7 7-7 7"/></svg>
                    </a>
                </div>

            </div>
        </div>
    </section>
    </main>

    <!-- Footer (consistent with article-13) -->
    <footer class="footer footer-enhanced">
        <div class="container">
            <div class="footer-grid">
                <div class="footer-brand">
                    <p class="footer-tagline-main">BUILT FOR MISSION CRITICAL INFRASTRUCTURE<br>MANAGEMENT // 2026</p>
                    <p class="footer-tagline-sub">ALL OPERATIONAL DATASETS PRESERVED.</p>
                    <p class="footer-copyright">&copy; 2026 Bagus Dwi Permana. All rights reserved.</p>
                </div>
                <div class="footer-nav">
                    <h4 class="footer-heading">NAVIGATION</h4>
                    <ul class="footer-links">
                        <li><a href="index.html">Home Dashboard</a></li>
                        <li><a href="articles.html">Technical Journal</a></li>
                        <li><a href="index.html#case-studies">Case Studies</a></li>
                        <li><a href="datacenter-solutions.html">DC Solutions</a></li>
                    </ul>
                </div>
                <div class="footer-connect">
                    <h4 class="footer-heading">CONNECT</h4>
                    <ul class="footer-links">
                        <li><a href="https://www.linkedin.com/in/bagus-dwi-permana-ba90b092" target="_blank" rel="noopener">LinkedIn Profile</a></li>
                        <li><a href="articles.html">Technical Journal</a></li>
                        <li><a href="mailto:baguspermana7@gmail.com">Direct Contact</a></li>
                        <li><a href="https://github.com/baguspermana7-cpu" target="_blank" rel="noopener">GitHub</a></li>
                    </ul>
                </div>
            </div>
        </div>
    </footer>

    <!-- Quote Builder (sticky bottom bar) -->
    <div class="quote-builder" id="quoteBuilder">
        <div class="quote-inner">
            <div class="quote-summary">
                <div class="quote-stat">
                    <div class="quote-stat-label">Services</div>
                    <div class="quote-stat-value" id="quoteCount">0</div>
                </div>
                <div class="quote-stat">
                    <div class="quote-stat-label">Est. Total (Low)</div>
                    <div class="quote-stat-value" id="quoteTotalLow">$0</div>
                </div>
                <div class="quote-stat">
                    <div class="quote-stat-label">Est. Total (High)</div>
                    <div class="quote-stat-value" id="quoteTotalHigh">$0</div>
                </div>
            </div>
            <div class="quote-actions">
                <button class="btn-quote btn-view-quote" onclick="openQuoteModal()">View Details</button>
                <button class="btn-export-pdf" onclick="exportQuotePDF()">Export PDF</button>
                <button class="btn-quote btn-copy-quote" onclick="copyQuoteSummary()">Copy Summary</button>
                <button class="btn-quote btn-clear-quote" onclick="clearQuote()">Clear All</button>
            </div>
        </div>
    </div>

    <!-- Quote Detail Modal -->
    <div class="quote-modal" id="quoteModal">
        <div class="quote-modal-content">
            <div class="quote-modal-header">
                <h3>Quote Builder &mdash; Service Summary</h3>
                <button class="btn-close-modal" onclick="closeQuoteModal()">&times;</button>
            </div>
            <div id="quoteModalBody"></div>
        </div>
    </div>

    <script src="script.js"></script>

    <script>
    // ============================================================
    // Article 15 - Complete Service Catalog Data (120 items)
    // ============================================================
    const ALL_SERVICES = [
        // Category A: Colocation & Hosting (#1-10) — Pricing per CBRE H2 2025, Cushman & Wakefield 2025
        {rank:1,name:"Wholesale Colocation (1MW+)",desc:"Large-scale colocation for enterprise and hyperscaler deployments, typically 1MW+ per hall. Includes power, cooling, physical security, 99.999% SLA.",priceLow:120,priceHigh:220,unit:"per kW/month",cat:"A",rev:"high",delivery:"4-12 weeks",complexity:"medium"},
        {rank:2,name:"Retail Colocation (Full Cabinet)",desc:"Single or multi-cabinet colocation with power (5-10kW), cooling, connectivity, 24/7 NOC, and remote hands. Standard 42U lockable cabinet.",priceLow:1500,priceHigh:3500,unit:"per cabinet/month",cat:"A",rev:"high",delivery:"1-4 weeks",complexity:"low"},
        {rank:3,name:"High-Density Colocation (20-50kW)",desc:"Specialized colocation for HPC, VDI, and high-density workloads at 20-50kW per rack. Enhanced cooling (in-row or rear-door), dedicated power whips.",priceLow:180,priceHigh:300,unit:"per kW/month",cat:"A",rev:"high",delivery:"4-8 weeks",complexity:"medium"},
        {rank:4,name:"AI/GPU Colocation (50-100kW)",desc:"Purpose-built colocation for AI/ML training clusters (NVIDIA DGX, GB200 NVL72). Includes liquid cooling (direct-to-chip or immersion), dedicated power, enhanced SLA.",priceLow:220,priceHigh:450,unit:"per kW/month",cat:"A",rev:"high",delivery:"8-16 weeks",complexity:"high"},
        {rank:5,name:"Powered Shell / Warm Shell",desc:"Pre-built data center shell with utility power, MV distribution, cooling plant, and shell structure ready for tenant internal fit-out.",priceLow:8000,priceHigh:15000,unit:"per kW one-time",cat:"A",rev:"high",delivery:"12-24 months",complexity:"high"},
        {rank:6,name:"Build-to-Suit Data Center",desc:"Custom-designed and built turnkey data center facility. Includes site selection support, design, construction management, commissioning, and handover.",priceLow:8000000,priceHigh:15000000,unit:"per MW total",cat:"A",rev:"high",delivery:"18-36 months",complexity:"high"},
        {rank:7,name:"Remote Hands Service",desc:"On-site technical staff for basic physical tasks: cable patching, hardware reboots, visual inspections, shipping/receiving, tape rotations.",priceLow:75,priceHigh:150,unit:"per hour",cat:"A",rev:"high",delivery:"15-60 min SLA",complexity:"low"},
        {rank:8,name:"Smart Hands (Advanced)",desc:"Skilled L2/L3 technicians for complex tasks: server hardware installation, network troubleshooting, OS-level diagnostics, firmware updates.",priceLow:125,priceHigh:275,unit:"per hour",cat:"A",rev:"high",delivery:"1-4 hour SLA",complexity:"medium"},
        {rank:9,name:"Cross-Connect / Interconnection",desc:"Physical fiber (SC/LC) or copper (Cat6a) cross-connects between tenant cages, carrier MMR, or cloud on-ramps. Includes installation and testing.",priceLow:200,priceHigh:500,unit:"per connection/month",cat:"A",rev:"high",delivery:"3-10 business days",complexity:"low"},
        {rank:10,name:"Meet-Me Room Access",desc:"Dedicated port access in carrier-neutral meet-me rooms for peering, transit, and cloud interconnection. Multiple carriers available.",priceLow:500,priceHigh:2000,unit:"per port/month",cat:"A",rev:"high",delivery:"5-15 business days",complexity:"low"},

        // Category B: Consulting & Advisory (#11-25) — Pricing per McKinsey, JLL, Uptime Institute
        {rank:11,name:"Data Center Master Planning",desc:"Comprehensive multi-phase master plan for campus-scale DC developments. Includes site assessment, phasing strategy, power/cooling architecture, and 20-year growth model.",priceLow:150000,priceHigh:500000,unit:"per project",cat:"B",rev:"high",delivery:"8-16 weeks",complexity:"high"},
        {rank:12,name:"Feasibility Study",desc:"Technical and financial feasibility for proposed DC sites. Covers power availability, fiber connectivity, climate analysis, zoning, and preliminary cost estimates.",priceLow:50000,priceHigh:150000,unit:"per study",cat:"B",rev:"high",delivery:"4-8 weeks",complexity:"medium"},
        {rank:13,name:"Tier Certification Consulting",desc:"End-to-end advisory for Uptime Institute Tier II/III/IV certification. Includes gap analysis, documentation prep, design review, and testing oversight.",priceLow:75000,priceHigh:200000,unit:"per project",cat:"B",rev:"high",delivery:"12-24 weeks",complexity:"high"},
        {rank:14,name:"PUE/Energy Optimization Audit",desc:"Detailed PUE audit: metering verification, airflow analysis, cooling efficiency assessment, free cooling potential. Delivers prioritized savings roadmap.",priceLow:25000,priceHigh:75000,unit:"per audit",cat:"B",rev:"high",delivery:"3-6 weeks",complexity:"medium"},
        {rank:15,name:"Capacity Planning & Forecasting",desc:"Power, cooling, and space capacity modeling with 3/5/10-year growth scenarios. Includes stranded capacity analysis and densification roadmap.",priceLow:30000,priceHigh:80000,unit:"per engagement",cat:"B",rev:"high",delivery:"4-8 weeks",complexity:"medium"},
        {rank:16,name:"Electrical System Design Review",desc:"Peer review of SLD, protection coordination studies, selectivity analysis, redundancy architecture, and arc flash calculations. Per IEEE/IEC standards.",priceLow:20000,priceHigh:60000,unit:"per review",cat:"B",rev:"high",delivery:"2-4 weeks",complexity:"high"},
        {rank:17,name:"Mechanical/Cooling Design Review",desc:"Independent review of cooling system design: chiller plant sizing, pipe/pump selection, air distribution, controls sequences, and N+1 redundancy.",priceLow:20000,priceHigh:60000,unit:"per review",cat:"B",rev:"high",delivery:"2-4 weeks",complexity:"high"},
        {rank:18,name:"Business Continuity & DR Planning",desc:"BC/DR strategy development with BIA, RTO/RPO definitions, failover procedures, and annual tabletop testing protocols. Aligned to ISO 22301.",priceLow:40000,priceHigh:120000,unit:"per project",cat:"B",rev:"high",delivery:"6-12 weeks",complexity:"high"},
        {rank:19,name:"Due Diligence (Acquisition)",desc:"Technical DD for DC M&A: asset condition assessment, remaining useful life, deferred maintenance quantification, environmental liability, and regulatory compliance.",priceLow:50000,priceHigh:200000,unit:"per assessment",cat:"B",rev:"high",delivery:"2-6 weeks",complexity:"high"},
        {rank:20,name:"Sustainability / ESG Advisory",desc:"Strategic ESG advisory: carbon baseline, Science-Based Targets, RE100 pathway, ESG reporting framework setup (GRI, SASB, CDP), and green bond eligibility.",priceLow:30000,priceHigh:100000,unit:"per project",cat:"B",rev:"high",delivery:"6-12 weeks",complexity:"medium"},
        {rank:21,name:"Regulatory & Compliance Advisory",desc:"Navigation of local building codes, electrical regulations (PUIL, BS 7671, NEC), environmental permits, and operational licensing requirements.",priceLow:25000,priceHigh:75000,unit:"per project",cat:"B",rev:"high",delivery:"4-8 weeks",complexity:"medium"},
        {rank:22,name:"Operational Readiness Assessment",desc:"Pre-launch readiness review: staffing gaps, SOP completeness, training status, spare parts inventory, vendor contracts, and emergency procedures.",priceLow:30000,priceHigh:80000,unit:"per assessment",cat:"B",rev:"high",delivery:"2-4 weeks",complexity:"medium"},
        {rank:23,name:"Risk Assessment & Mitigation",desc:"Comprehensive risk register development with FMEA methodology, risk scoring (likelihood x impact), mitigation plans, and residual risk acceptance framework.",priceLow:25000,priceHigh:75000,unit:"per project",cat:"B",rev:"high",delivery:"4-8 weeks",complexity:"medium"},
        {rank:24,name:"Financial Modeling (CAPEX/OPEX/TCO)",desc:"20-year financial model: CAPEX phasing, OPEX forecasting, TCO analysis, IRR/NPV calculations, sensitivity analysis, and carbon pricing scenarios.",priceLow:20000,priceHigh:60000,unit:"per model",cat:"B",rev:"high",delivery:"3-6 weeks",complexity:"medium"},
        {rank:25,name:"Space & Power Density Planning",desc:"Optimization of floor space utilization and power density distribution. Includes migration planning for legacy-to-high-density conversion.",priceLow:15000,priceHigh:50000,unit:"per engagement",cat:"B",rev:"high",delivery:"2-4 weeks",complexity:"medium"},

        // Category C: Testing & Commissioning (#26-40) — Pricing per industry benchmarks
        {rank:26,name:"Integrated Systems Testing (IST)",desc:"End-to-end testing of all critical systems under simulated failure conditions: utility loss, generator start/transfer, UPS bypass, cooling failure, fire suppression.",priceLow:50000,priceHigh:150000,unit:"per MW",cat:"C",rev:"high",delivery:"2-6 weeks",complexity:"high"},
        {rank:27,name:"Factory Acceptance Testing (FAT)",desc:"Verification testing of UPS, generators, switchgear, and chillers at manufacturer facilities before shipment. Includes test protocols and punch list.",priceLow:10000,priceHigh:30000,unit:"per event",cat:"C",rev:"high",delivery:"1-3 days per event",complexity:"medium"},
        {rank:28,name:"Site Acceptance Testing (SAT)",desc:"On-site verification that installed equipment meets design specs: performance parameters, alarm setpoints, control sequences, and safety interlocks.",priceLow:8000,priceHigh:25000,unit:"per system",cat:"C",rev:"high",delivery:"1-5 days per system",complexity:"medium"},
        {rank:29,name:"Generator Load Bank Testing",desc:"Full-load (100%) and step-load (25/50/75/100%) testing of diesel generators using resistive/reactive load banks. Includes fuel consumption verification.",priceLow:5000,priceHigh:15000,unit:"per genset",cat:"C",rev:"high",delivery:"1-2 days per genset",complexity:"medium"},
        {rank:30,name:"UPS Performance Testing",desc:"UPS testing under various load conditions (25/50/75/100%), battery discharge test (10-min to full autonomy), bypass transfer, and harmonic analysis.",priceLow:3000,priceHigh:10000,unit:"per unit",cat:"C",rev:"high",delivery:"1 day per unit",complexity:"medium"},
        {rank:31,name:"Thermal Testing / CFD Validation",desc:"Physical thermal mapping (ASHRAE sensor grid) and CFD model validation. Includes hot spot identification, bypass airflow analysis, and containment effectiveness.",priceLow:15000,priceHigh:40000,unit:"per data hall",cat:"C",rev:"high",delivery:"1-2 weeks",complexity:"high"},
        {rank:32,name:"ATS/STS Transfer Testing",desc:"Automatic/Static transfer switch testing: transfer time verification (<10ms STS, <100ms ATS), retransfer, load acceptance, and sync verification.",priceLow:2000,priceHigh:8000,unit:"per unit",cat:"C",rev:"high",delivery:"0.5-1 day per unit",complexity:"medium"},
        {rank:33,name:"Fire Suppression Discharge Test",desc:"Full discharge testing of clean agent (FM-200, Novec 1230, IG-541) systems. Concentration hold time verification, door fan integrity test, and agent quantity check.",priceLow:5000,priceHigh:15000,unit:"per zone",cat:"C",rev:"high",delivery:"1 day per zone",complexity:"high"},
        {rank:34,name:"BMS/EPMS Integration Testing",desc:"End-to-end testing of BMS/EPMS integration: point-to-point verification, alarm routing, graphics validation, trend logging, and report generation.",priceLow:10000,priceHigh:30000,unit:"per system",cat:"C",rev:"high",delivery:"1-3 weeks",complexity:"high"},
        {rank:35,name:"Protection Coordination Study",desc:"IEEE/IEC protective device coordination analysis: time-current curves, selectivity verification, short-circuit calculations, and relay settings.",priceLow:15000,priceHigh:40000,unit:"per study",cat:"C",rev:"high",delivery:"3-6 weeks",complexity:"high"},
        {rank:36,name:"Power Quality Analysis",desc:"7-day minimum power quality monitoring per IEEE 519/IEC 61000: harmonics (THD), sags/swells, transients, power factor, and flicker analysis.",priceLow:8000,priceHigh:25000,unit:"per facility",cat:"C",rev:"high",delivery:"2-4 weeks",complexity:"medium"},
        {rank:37,name:"Thermographic Survey (Electrical)",desc:"Infrared thermal imaging survey of all electrical connections, switchgear, bus bars, and distribution equipment per NETA MTS standards.",priceLow:3000,priceHigh:10000,unit:"per survey",cat:"C",rev:"high",delivery:"1-3 days",complexity:"low"},
        {rank:38,name:"Witness Testing & QA Oversight",desc:"Third-party witness testing and quality assurance oversight. Includes test protocol review, real-time documentation, and punch list management.",priceLow:2000,priceHigh:5000,unit:"per day",cat:"C",rev:"high",delivery:"as scheduled",complexity:"medium"},
        {rank:39,name:"Pre-Commissioning Inspection",desc:"Detailed visual and mechanical inspection prior to energization: torque verification, clearance checks, cleanliness, labeling, and safety compliance.",priceLow:10000,priceHigh:30000,unit:"per facility",cat:"C",rev:"high",delivery:"1-2 weeks",complexity:"medium"},
        {rank:40,name:"Recommissioning / Retro-Cx",desc:"Re-verification of existing systems against original design intent. Performance benchmarking, degradation analysis, and optimization roadmap.",priceLow:30000,priceHigh:100000,unit:"per MW",cat:"C",rev:"high",delivery:"4-8 weeks",complexity:"high"},

        // Category D: Electrical Services (#41-55) — Pricing per Schneider Electric WP37, industry benchmarks
        {rank:41,name:"HV/MV Switchgear Maintenance",desc:"Annual PM of HV/MV switchgear: contact resistance testing, insulation resistance, vacuum bottle integrity, SF6 gas analysis, relay calibration, and arc chute inspection.",priceLow:5000,priceHigh:15000,unit:"per unit/year",cat:"D",rev:"medium",delivery:"1-3 days per unit",complexity:"high"},
        {rank:42,name:"Transformer Maintenance (Oil-filled)",desc:"Comprehensive transformer PM: oil sampling & DGA, insulation resistance (Megger), turns ratio test, winding resistance, tap changer servicing, and bushing inspection.",priceLow:4000,priceHigh:12000,unit:"per unit/year",cat:"D",rev:"medium",delivery:"1-2 days per unit",complexity:"high"},
        {rank:43,name:"UPS Preventive Maintenance",desc:"Biannual UPS PM: capacitor inspection, fan replacement, firmware updates, battery connection torque check, harmonic filter verification, and bypass testing.",priceLow:3000,priceHigh:10000,unit:"per unit/year",cat:"D",rev:"medium",delivery:"4-8 hours per visit",complexity:"medium"},
        {rank:44,name:"Generator Preventive Maintenance",desc:"Quarterly genset PM: oil/filter change, coolant analysis, belt inspection, load test, control system verification, fuel polishing, and exhaust back-pressure check.",priceLow:4000,priceHigh:12000,unit:"per genset/year",cat:"D",rev:"medium",delivery:"4-6 hours per visit",complexity:"medium"},
        {rank:45,name:"Battery System Maintenance",desc:"Quarterly battery PM: impedance/conductance testing, cell voltage monitoring, connection torque verification, thermal imaging, and electrolyte level checks (VRLA/wet cell).",priceLow:2000,priceHigh:6000,unit:"per string/year",cat:"D",rev:"medium",delivery:"2-4 hours per string",complexity:"medium"},
        {rank:46,name:"PDU/RPP Maintenance",desc:"Annual PDU/RPP PM: breaker exercising, thermal scanning, connection torque verification, metering calibration, and surge protection device inspection.",priceLow:1000,priceHigh:3000,unit:"per unit/year",cat:"D",rev:"medium",delivery:"2-3 hours per unit",complexity:"low"},
        {rank:47,name:"Arc Flash Study & Labeling",desc:"IEEE 1584-2018 arc flash hazard analysis: short-circuit calculations, incident energy at each bus, PPE category determination, approach boundaries, and label production.",priceLow:15000,priceHigh:40000,unit:"per facility",cat:"D",rev:"medium",delivery:"4-8 weeks",complexity:"high"},
        {rank:48,name:"Electrical Safety Program Dev",desc:"NFPA 70E-compliant program: hazard analysis procedures, energized work permits, lock-out/tag-out procedures, PPE matrix, training requirements, and audit protocols.",priceLow:10000,priceHigh:30000,unit:"per program",cat:"D",rev:"medium",delivery:"4-8 weeks",complexity:"medium"},
        {rank:49,name:"Power Monitoring System (EPMS)",desc:"Full EPMS: meter specification, panel/CT installation, communication network, SCADA integration, dashboard development, alarm configuration, and operator training.",priceLow:50000,priceHigh:150000,unit:"per facility",cat:"D",rev:"medium",delivery:"8-16 weeks",complexity:"high"},
        {rank:50,name:"Cable Testing (VLF/Tan Delta)",desc:"MV cable insulation testing using VLF (very low frequency) and tan delta methods. Identifies degradation before failure. Per IEEE 400.2.",priceLow:3000,priceHigh:8000,unit:"per cable run",cat:"D",rev:"medium",delivery:"0.5-1 day per cable",complexity:"medium"},
        {rank:51,name:"Grounding / Earthing System Audit",desc:"Fall-of-potential ground resistance testing, continuity measurements, bonding verification, step/touch voltage calculations, and soil resistivity survey.",priceLow:5000,priceHigh:15000,unit:"per audit",cat:"D",rev:"medium",delivery:"1-3 days",complexity:"medium"},
        {rank:52,name:"Lightning Protection Assessment",desc:"Risk assessment per IEC 62305 / NFPA 780: rolling sphere analysis, down conductor routing, earth termination network, and SPD coordination review.",priceLow:3000,priceHigh:10000,unit:"per assessment",cat:"D",rev:"medium",delivery:"1-2 weeks",complexity:"medium"},
        {rank:53,name:"Relay Protection Testing",desc:"Secondary injection testing of protective relays: pickup/dropout verification, timing tests, communication protocols (IEC 61850), and trip circuit supervision.",priceLow:1000,priceHigh:4000,unit:"per relay",cat:"D",rev:"medium",delivery:"2-4 hours per relay",complexity:"high"},
        {rank:54,name:"Emergency Generator Repair",desc:"24/7 emergency response for generator failures: diagnostics, control board repair, injector/turbo replacement, coolant leak repair, and load testing post-repair.",priceLow:5000,priceHigh:25000,unit:"per incident",cat:"D",rev:"medium",delivery:"2-24 hour response",complexity:"high"},
        {rank:55,name:"UPS Battery Replacement",desc:"Full string replacement: safe disconnection, removal, installation (VRLA/Li-ion), torque to spec, commissioning, equalization charge, and proper disposal/recycling.",priceLow:15000,priceHigh:80000,unit:"per string",cat:"D",rev:"medium",delivery:"1-3 days per string",complexity:"medium"},

        // Category E: Mechanical / Cooling (#56-70) — Pricing per ASHRAE, IEA cooling market data
        {rank:56,name:"Chiller Plant Maintenance",desc:"Annual chiller PM: compressor oil analysis, refrigerant charge verification, condenser/evaporator cleaning, VFD checks, controls calibration, and performance trending.",priceLow:8000,priceHigh:25000,unit:"per chiller/year",cat:"E",rev:"medium",delivery:"1-2 days per chiller",complexity:"high"},
        {rank:57,name:"Cooling Tower Maintenance",desc:"Quarterly tower PM: fill media inspection, basin cleaning, fan/motor servicing, drift eliminator check, water treatment verification, and structural assessment.",priceLow:3000,priceHigh:10000,unit:"per tower/year",cat:"E",rev:"medium",delivery:"0.5-1 day per tower",complexity:"medium"},
        {rank:58,name:"CRAH/CRAC Unit Maintenance",desc:"Biannual CRAH/CRAC PM: coil cleaning, fan bearing inspection, belt/VFD check, humidifier service, condensate drain verification, and controls calibration.",priceLow:2000,priceHigh:6000,unit:"per unit/year",cat:"E",rev:"medium",delivery:"2-4 hours per unit",complexity:"low"},
        {rank:59,name:"In-Row Cooling Maintenance",desc:"Biannual in-row PM: EC fan inspection, coil cleaning, leak detection, control valve check, condensate management, and setpoint optimization.",priceLow:1500,priceHigh:4000,unit:"per unit/year",cat:"E",rev:"medium",delivery:"1-2 hours per unit",complexity:"low"},
        {rank:60,name:"Liquid Cooling System Maintenance",desc:"Specialized maintenance of direct-to-chip (CDU), rear-door HEX, or immersion systems: coolant quality testing, pump inspection, leak detection, and flow balancing.",priceLow:5000,priceHigh:15000,unit:"per system/year",cat:"E",rev:"medium",delivery:"4-8 hours per system",complexity:"high"},
        {rank:61,name:"Water Treatment Program",desc:"Ongoing chemical treatment: biocide dosing, corrosion/scale inhibitors, Legionella testing, glycol concentration management, and monthly water quality reporting.",priceLow:10000,priceHigh:30000,unit:"per year",cat:"E",rev:"medium",delivery:"ongoing monthly",complexity:"medium"},
        {rank:62,name:"Refrigerant Management",desc:"EPA Section 608 / F-gas regulation compliance: leak rate tracking, recovery/reclaim, type/quantity logging, annual reporting, and phase-down planning.",priceLow:5000,priceHigh:15000,unit:"per year",cat:"E",rev:"medium",delivery:"ongoing quarterly",complexity:"medium"},
        {rank:63,name:"BMS Controls Optimization",desc:"Sequencing optimization: chiller staging, economizer setpoints, supply air temperature reset, variable pump speed tuning, and PUE reduction targeting.",priceLow:15000,priceHigh:40000,unit:"per engagement",cat:"E",rev:"medium",delivery:"2-6 weeks",complexity:"high"},
        {rank:64,name:"Vibration Analysis Program",desc:"Quarterly vibration monitoring (ISO 10816) of pumps, fans, compressors: trending, bearing defect frequency analysis, alignment verification, and balancing.",priceLow:5000,priceHigh:15000,unit:"per year",cat:"E",rev:"medium",delivery:"1 day per quarter",complexity:"medium"},
        {rank:65,name:"Pipe/Valve Maintenance Program",desc:"Annual piping PM: valve exercising, strainer cleaning, expansion joint inspection, insulation integrity check, and pressure/flow verification at test points.",priceLow:8000,priceHigh:20000,unit:"per system/year",cat:"E",rev:"medium",delivery:"2-5 days per system",complexity:"medium"},
        {rank:66,name:"Heat Rejection Optimization",desc:"Analysis of condenser water approach, tower fan staging, free cooling hours, adiabatic pre-cooling potential, and waterside economizer integration opportunities.",priceLow:10000,priceHigh:30000,unit:"per project",cat:"E",rev:"medium",delivery:"3-6 weeks",complexity:"high"},
        {rank:67,name:"Humidification System Maintenance",desc:"Biannual PM: electrode/infrared element replacement, water quality management, drain flush, steam distribution inspection, and humidity sensor calibration.",priceLow:2000,priceHigh:6000,unit:"per unit/year",cat:"E",rev:"medium",delivery:"2-3 hours per unit",complexity:"low"},
        {rank:68,name:"Airflow Containment Assessment",desc:"Hot/cold aisle containment effectiveness: temperature delta mapping, CFD validation, bypass airflow quantification, blanking panel audit, and cable cutout sealing.",priceLow:5000,priceHigh:15000,unit:"per data hall",cat:"E",rev:"medium",delivery:"1-3 days",complexity:"medium"},
        {rank:69,name:"Rear-Door Heat Exchanger Maintenance",desc:"Annual RDHx PM: coil cleaning, quick-disconnect leak testing, hose inspection, flow verification, and condensation management check. Per CoolIT/Motivair specs.",priceLow:2000,priceHigh:5000,unit:"per unit/year",cat:"E",rev:"medium",delivery:"1-2 hours per unit",complexity:"low"},
        {rank:70,name:"Emergency Chiller/Cooling Rental",desc:"Emergency deployment of trailer-mounted chillers (100-500 RT) or portable DX units. Includes piping connections, electrical hookup, and 24/7 monitoring.",priceLow:5000,priceHigh:20000,unit:"per week",cat:"E",rev:"medium",delivery:"4-48 hour deployment",complexity:"high"},

        // Category F: Monitoring, DCIM & Automation (#71-80) — Pricing per Verdantix, industry data
        {rank:71,name:"DCIM Implementation",desc:"Full DCIM deployment: asset discovery, floor plan modeling, power chain mapping, capacity planning module, change management workflows, API integration, and user training.",priceLow:100000,priceHigh:500000,unit:"per project",cat:"F",rev:"medium",delivery:"12-24 weeks",complexity:"high"},
        {rank:72,name:"BMS/SCADA System Upgrade",desc:"Legacy to modern platform migration: controller replacement, graphics redesign, alarm re-engineering, historian setup, reporting dashboards, and operator training.",priceLow:50000,priceHigh:200000,unit:"per project",cat:"F",rev:"medium",delivery:"8-20 weeks",complexity:"high"},
        {rank:73,name:"Environmental Monitoring Deployment",desc:"Per-rack sensor installation: inlet/outlet temperature, humidity, differential pressure, water leak detection cables, and door contact sensors with central aggregation.",priceLow:200,priceHigh:600,unit:"per rack",cat:"F",rev:"medium",delivery:"1-4 weeks (facility)",complexity:"low"},
        {rank:74,name:"Power Monitoring (EPMS)",desc:"Power meter deployment at panel/PDU/branch circuit level: Schneider PM8000/ION, Raritan, or equivalent. Dashboard integration and PUE auto-calculation.",priceLow:500,priceHigh:2000,unit:"per panel",cat:"F",rev:"medium",delivery:"2-8 weeks",complexity:"medium"},
        {rank:75,name:"Alarm Rationalization Service",desc:"ISA-18.2 / IEC 62682 alarm management: priority matrix, nuisance alarm elimination, state-based suppression, chattering filter, and KPI dashboard (alarms/day/operator).",priceLow:15000,priceHigh:40000,unit:"per facility",cat:"F",rev:"medium",delivery:"4-8 weeks",complexity:"high"},
        {rank:76,name:"Predictive Analytics Platform",desc:"AI/ML platform: vibration pattern recognition, thermal anomaly detection, power consumption forecasting, battery degradation modeling, and failure probability scoring.",priceLow:50000,priceHigh:150000,unit:"per year",cat:"F",rev:"medium",delivery:"8-16 weeks setup",complexity:"high"},
        {rank:77,name:"Remote Monitoring Service (NOC)",desc:"24/7 NOC monitoring: alarm acknowledgment (<5 min), escalation management, first-response protocols, monthly reporting, and quarterly review meetings.",priceLow:5000,priceHigh:20000,unit:"per month",cat:"F",rev:"medium",delivery:"2-4 weeks setup",complexity:"medium"},
        {rank:78,name:"Capacity Management Dashboard",desc:"Custom dashboard: real-time power/cooling/space utilization, stranded capacity visualization, what-if scenario modeling, and automated threshold alerting.",priceLow:30000,priceHigh:80000,unit:"per implementation",cat:"F",rev:"medium",delivery:"4-10 weeks",complexity:"medium"},
        {rank:79,name:"Energy Management System (EMS)",desc:"ISO 50001-aligned EMS: sub-metering deployment, PUE/WUE auto-calculation, energy billing allocation, regression modeling, and continuous improvement tracking.",priceLow:40000,priceHigh:120000,unit:"per implementation",cat:"F",rev:"medium",delivery:"8-16 weeks",complexity:"high"},
        {rank:80,name:"Network/IT Monitoring Integration",desc:"Bridge IT and facilities: ServiceNow/CMDB integration, automated ticket creation from BMS alarms, change management workflow linkage, and unified NOC dashboard.",priceLow:20000,priceHigh:60000,unit:"per project",cat:"F",rev:"medium",delivery:"4-12 weeks",complexity:"high"},

        // Category G: Safety & Compliance (#81-90) — Pricing per Uptime Institute, ISO certification bodies
        {rank:81,name:"Uptime Institute Tier Certification",desc:"Full Tier certification support: TCCF/TCDD document preparation, design review alignment, testing oversight, and Uptime Institute liaison throughout the process.",priceLow:50000,priceHigh:150000,unit:"per certification",cat:"G",rev:"low",delivery:"16-40 weeks",complexity:"high"},
        {rank:82,name:"ISO 27001 Implementation Support",desc:"ISMS implementation: gap analysis, risk assessment methodology, Statement of Applicability, control implementation, internal audit, and certification body liaison.",priceLow:30000,priceHigh:80000,unit:"per project",cat:"G",rev:"low",delivery:"16-32 weeks",complexity:"high"},
        {rank:83,name:"SOC 2 Type II Audit Support",desc:"Annual SOC 2 support: control matrix development, evidence collection automation, management assertion letter, auditor liaison, and remediation tracking.",priceLow:25000,priceHigh:60000,unit:"per cycle",cat:"G",rev:"low",delivery:"ongoing (6+ month period)",complexity:"medium"},
        {rank:84,name:"OSHA/Safety Compliance Audit",desc:"Workplace safety audit: hazard identification, PPE compliance, confined space procedures, fall protection, chemical storage, and emergency egress review.",priceLow:10000,priceHigh:30000,unit:"per audit",cat:"G",rev:"low",delivery:"2-5 days",complexity:"medium"},
        {rank:85,name:"Fire Code Compliance Audit",desc:"Fire protection audit: NFPA 72/75/76 compliance, detection/suppression adequacy, egress paths, fire barrier integrity, and authority having jurisdiction (AHJ) alignment.",priceLow:8000,priceHigh:25000,unit:"per audit",cat:"G",rev:"low",delivery:"2-5 days",complexity:"medium"},
        {rank:86,name:"Environmental Compliance Audit",desc:"Environmental review: generator emission permits (NOx, PM), hazardous waste management (batteries, e-waste), water discharge permits, and noise ordinance compliance.",priceLow:10000,priceHigh:30000,unit:"per audit",cat:"G",rev:"low",delivery:"1-3 weeks",complexity:"medium"},
        {rank:87,name:"Electrical Safety Audit (NFPA 70E)",desc:"Electrical safety audit: arc flash label verification, PPE inventory check, energized work permit review, LOTO procedure validation, and qualified person documentation.",priceLow:8000,priceHigh:25000,unit:"per audit",cat:"G",rev:"low",delivery:"2-4 days",complexity:"medium"},
        {rank:88,name:"Electrical Operating License (SLO)",desc:"SLO application support: technical documentation, single-line diagram preparation, safety equipment verification, inspector coordination, and annual renewal management.",priceLow:5000,priceHigh:20000,unit:"per license",cat:"G",rev:"low",delivery:"4-12 weeks",complexity:"medium"},
        {rank:89,name:"Insurance Risk Assessment",desc:"Technical risk assessment per FM Global / Zurich frameworks: natural hazard exposure, MFL/PML calculations, protection adequacy, and recommendation compliance tracking.",priceLow:10000,priceHigh:30000,unit:"per assessment",cat:"G",rev:"low",delivery:"1-3 weeks",complexity:"medium"},
        {rank:90,name:"PCI-DSS Compliance Support",desc:"PCI physical security support: access control validation, CCTV coverage assessment, visitor management, media destruction procedures, and penetration test coordination.",priceLow:20000,priceHigh:50000,unit:"per project",cat:"G",rev:"low",delivery:"8-16 weeks",complexity:"medium"},

        // Category H: Operations & Managed Services (#91-100) — Pricing per industry benchmarks
        {rank:91,name:"Full Facility Operations Management",desc:"Complete outsourced operations: 24/7 staffing, preventive/corrective maintenance, vendor coordination, compliance management, and SLA reporting. 3-5 year contracts typical.",priceLow:15,priceHigh:30,unit:"per kW/month",cat:"H",rev:"low",delivery:"4-8 week mobilization",complexity:"high"},
        {rank:92,name:"Maintenance Management (CMMS)",desc:"CMMS operation: PM schedule management, work order processing, compliance tracking, KPI reporting (PM completion %, backlog, MTTR), and continuous improvement.",priceLow:5000,priceHigh:15000,unit:"per month",cat:"H",rev:"low",delivery:"2-4 week setup",complexity:"medium"},
        {rank:93,name:"Vendor Management Service",desc:"Third-party coordination: RFP management, contract negotiation, performance SLA tracking, invoice verification, and annual vendor review. Typically 20-50 vendors.",priceLow:3000,priceHigh:10000,unit:"per month",cat:"H",rev:"low",delivery:"ongoing",complexity:"medium"},
        {rank:94,name:"Change Management / MOC",desc:"Formal MOC process: change request, risk assessment (HAZOP-lite), approval workflow, implementation oversight, post-change verification, and documentation update.",priceLow:1000,priceHigh:5000,unit:"per change",cat:"H",rev:"low",delivery:"1-5 days per change",complexity:"medium"},
        {rank:95,name:"Incident Management & RCA",desc:"Full incident lifecycle: triage, containment, resolution, 5-Why/Fishbone RCA, corrective action tracking (CAPA), and executive summary report. Per Uptime methodology.",priceLow:2000,priceHigh:10000,unit:"per incident",cat:"H",rev:"low",delivery:"24-72 hours (RCA report)",complexity:"high"},
        {rank:96,name:"SOP/EOP Development",desc:"Procedure development: task analysis, step-by-step instructions, decision trees, safety warnings, competency requirements, and version-controlled document management.",priceLow:2000,priceHigh:8000,unit:"per procedure",cat:"H",rev:"low",delivery:"1-3 weeks per procedure",complexity:"medium"},
        {rank:97,name:"Shift Staffing (Embedded Engineers)",desc:"Dedicated on-site engineers on 24/7 rotation (4-shift pattern). Includes recruitment, training, supervision, and performance management. L2/L3 skill level.",priceLow:8000,priceHigh:15000,unit:"per FTE/month",cat:"H",rev:"low",delivery:"4-8 week recruitment",complexity:"medium"},
        {rank:98,name:"Spare Parts Management",desc:"Critical spares program: BOM development, min/max inventory levels, vendor supply agreements, automated reorder points, and annual obsolescence review.",priceLow:10000,priceHigh:30000,unit:"per year",cat:"H",rev:"low",delivery:"4-8 week setup",complexity:"medium"},
        {rank:99,name:"Lifecycle / Asset Management",desc:"Asset lifecycle: asset register, condition monitoring, depreciation tracking, replacement forecasting (10-year capex plan), and end-of-life disposal coordination.",priceLow:15000,priceHigh:50000,unit:"per year",cat:"H",rev:"low",delivery:"ongoing",complexity:"medium"},
        {rank:100,name:"Decommissioning / Migration Support",desc:"Safe decommissioning: risk-assessed shutdown sequence, environmental remediation, asset disposition (ITAD), and migration project management with zero-downtime planning.",priceLow:20000,priceHigh:100000,unit:"per project",cat:"H",rev:"low",delivery:"4-16 weeks",complexity:"high"},

        // Category I: Emergency & Recovery (#101-107) — High-margin, urgency-priced
        {rank:101,name:"24/7 Emergency Response Retainer",desc:"Monthly retainer: guaranteed 2-4 hour response SLA, on-call senior engineer, pre-staged diagnostic equipment, and priority parts access. Activation fees additional.",priceLow:5000,priceHigh:15000,unit:"per month",cat:"I",rev:"low",delivery:"2-4 hour SLA",complexity:"high"},
        {rank:102,name:"Temporary Power (Emergency)",desc:"Rapid deployment of trailer-mounted generators (500kW-2MW) with distribution panels, fuel tank, and ATS integration. Includes 24/7 monitoring and fueling.",priceLow:3000,priceHigh:10000,unit:"per day",cat:"I",rev:"low",delivery:"4-24 hour deployment",complexity:"high"},
        {rank:103,name:"Disaster Recovery Site Activation",desc:"DR site activation: systems power-up, network cutover coordination, application failover support, and ongoing operations management during the declared event.",priceLow:50000,priceHigh:200000,unit:"per activation",cat:"I",rev:"low",delivery:"4-48 hours",complexity:"high"},
        {rank:104,name:"Post-Incident Forensic Investigation",desc:"Forensic investigation: evidence preservation, timeline reconstruction, failure mode identification, expert witness report, and root cause determination for insurance/legal.",priceLow:15000,priceHigh:50000,unit:"per investigation",cat:"I",rev:"low",delivery:"2-6 weeks",complexity:"high"},
        {rank:105,name:"Emergency Fuel Delivery",desc:"Emergency diesel procurement and delivery: pre-contracted supply chain, tanker dispatch, quality verification, and tank filling. 24/7 availability during extended outages.",priceLow:2000,priceHigh:8000,unit:"per delivery",cat:"I",rev:"low",delivery:"2-8 hours",complexity:"low"},
        {rank:106,name:"Temporary Cooling (Emergency)",desc:"Emergency portable cooling: spot coolers (5-50kW), trailer chillers (100-500 RT), flexible ductwork, and quick-connect piping. 24/7 monitoring during deployment.",priceLow:5000,priceHigh:20000,unit:"per week",cat:"I",rev:"low",delivery:"4-48 hours",complexity:"medium"},
        {rank:107,name:"Infrastructure Recovery Consulting",desc:"Post-disaster recovery: damage assessment, insurance claim support (scope of loss documentation), rebuild specification, contractor procurement, and project management.",priceLow:20000,priceHigh:80000,unit:"per project",cat:"I",rev:"low",delivery:"1-4 weeks start",complexity:"high"},

        // Category J: Training & Certification (#108-114) — Pricing per training provider benchmarks
        {rank:108,name:"DC Fundamentals Training (3-day)",desc:"3-day intensive: power distribution architecture, cooling systems overview, fire protection, physical security, monitoring/DCIM, and operational best practices. Certificate of completion.",priceLow:1500,priceHigh:3000,unit:"per attendee",cat:"J",rev:"low",delivery:"3 days",complexity:"low"},
        {rank:109,name:"Electrical Safety Training (NFPA 70E)",desc:"NFPA 70E compliance training: arc flash hazard awareness, approach boundaries, PPE selection, LOTO procedures, energized work permits. Qualified/unqualified person tracks.",priceLow:500,priceHigh:1500,unit:"per attendee",cat:"J",rev:"low",delivery:"1-2 days",complexity:"low"},
        {rank:110,name:"HVAC/Mechanical Systems Training",desc:"DC cooling systems: chiller plant operations, cooling tower management, CRAH/CRAC troubleshooting, liquid cooling basics, water treatment, and BMS setpoint management.",priceLow:800,priceHigh:2000,unit:"per attendee",cat:"J",rev:"low",delivery:"2 days",complexity:"low"},
        {rank:111,name:"BMS/DCIM Operator Training",desc:"Hands-on platform training: alarm management, trend analysis, report generation, capacity views, change management workflows, and mobile app operation. Vendor-specific.",priceLow:1000,priceHigh:2500,unit:"per attendee",cat:"J",rev:"low",delivery:"2-3 days",complexity:"medium"},
        {rank:112,name:"Emergency Response Tabletop Exercise",desc:"Facilitated tabletop: utility failure, fire event, security breach, or environmental disaster scenario. Tests communication chains, decision-making, and procedure adequacy.",priceLow:5000,priceHigh:15000,unit:"per event",cat:"J",rev:"low",delivery:"0.5-1 day",complexity:"medium"},
        {rank:113,name:"CDFOM/ATD Certification Prep",desc:"Exam preparation: EPI CDFOM or Uptime ATD curriculum review, practice exams, study materials, and exam scheduling support. 80%+ first-attempt pass rate.",priceLow:2000,priceHigh:4000,unit:"per attendee",cat:"J",rev:"low",delivery:"3-5 days",complexity:"medium"},
        {rank:114,name:"Custom Technical Workshop",desc:"Tailored workshops: HV switching operations, liquid cooling operations, generator paralleling, BMS programming, or any client-specific technical topic. Materials included.",priceLow:3000,priceHigh:8000,unit:"per day",cat:"J",rev:"low",delivery:"1-3 days",complexity:"medium"},

        // Category K: Sustainability & Energy (#115-120) — Pricing per S&P Global, EU EED requirements
        {rank:115,name:"PPA / Renewable Energy Advisory",desc:"PPA advisory: market analysis, RFP development, term sheet negotiation, financial modeling (LCOE, hedge value), regulatory compliance, and contract execution support.",priceLow:30000,priceHigh:100000,unit:"per project",cat:"K",rev:"low",delivery:"8-16 weeks",complexity:"high"},
        {rank:116,name:"Carbon Footprint Assessment",desc:"GHG Protocol-aligned assessment: Scope 1 (generators, refrigerants), Scope 2 (grid electricity), Scope 3 (supply chain, embodied carbon), and reduction roadmap.",priceLow:15000,priceHigh:40000,unit:"per assessment",cat:"K",rev:"low",delivery:"4-8 weeks",complexity:"medium"},
        {rank:117,name:"Water Usage Optimization",desc:"WUE optimization: cooling tower cycles of concentration, blowdown minimization, alternative water sources, dry/adiabatic cooling feasibility, and rainwater harvesting.",priceLow:10000,priceHigh:30000,unit:"per project",cat:"K",rev:"low",delivery:"4-8 weeks",complexity:"medium"},
        {rank:118,name:"Waste Heat Recovery Feasibility",desc:"Feasibility study: heat source characterization (temperature, flow rate), district heating integration, heat pump sizing, ROI modeling, and regulatory incentive mapping.",priceLow:15000,priceHigh:50000,unit:"per study",cat:"K",rev:"low",delivery:"6-12 weeks",complexity:"high"},
        {rank:119,name:"Green Building Certification (LEED)",desc:"LEED/BREEAM/Green Mark certification: prerequisite compliance, credit optimization strategy, documentation preparation, and certification body liaison. Silver through Platinum.",priceLow:25000,priceHigh:75000,unit:"per project",cat:"K",rev:"low",delivery:"16-40 weeks",complexity:"high"},
        {rank:120,name:"Energy Audit (ISO 50001)",desc:"ISO 50001-aligned energy audit: energy baseline, significant energy use identification, EnPI development, improvement opportunities (ranked by ROI), and management review preparation.",priceLow:15000,priceHigh:40000,unit:"per audit",cat:"K",rev:"low",delivery:"3-6 weeks",complexity:"medium"},
        {rank:121,name:"Rack Installation & Energizing",desc:"Full rack deployment: physical mounting, PDU whip termination, grounding bonding, circuit breaker energization, labeling, and as-built documentation per BICSI standards.",priceLow:300,priceHigh:800,unit:"per rack",cat:"H",rev:"high",delivery:"2-4 hours per rack",complexity:"low"},
        {rank:122,name:"Hot/Cold Aisle Containment Installation",desc:"Physical containment deployment: ceiling panel installation, end-of-row door hardware, blanking panel enforcement, brush strip sealing, and CFD-validated airflow optimization.",priceLow:1500,priceHigh:4000,unit:"per aisle",cat:"H",rev:"medium",delivery:"1-3 days per aisle",complexity:"medium"},
        {rank:123,name:"Power Whip Installation & Termination",desc:"Final power distribution whip from RPP/PDU to rack: cable sizing verification, connector termination, phase balancing, torque spec compliance, and IR verification post-energization.",priceLow:200,priceHigh:600,unit:"per whip",cat:"D",rev:"high",delivery:"1-2 hours per whip",complexity:"low"},
        {rank:124,name:"Structured Cabling Installation",desc:"Cat6A/fiber structured cabling: pathway routing, cable tray loading verification, termination and testing (Fluke certification), labeling per TIA-606-C, and as-built updates.",priceLow:150,priceHigh:400,unit:"per drop",cat:"H",rev:"high",delivery:"0.5-1 hour per drop",complexity:"low"},
        {rank:125,name:"Data Hall Deep Cleaning (Quarterly)",desc:"Specialized data hall cleaning: HEPA-filtered vacuuming, raised floor tile cleaning, equipment surface decontamination, air handler pre-filter replacement, and particle count verification.",priceLow:4000,priceHigh:12000,unit:"per data hall/quarter",cat:"H",rev:"medium",delivery:"4-8 hours (off-peak)",complexity:"low"},
        {rank:126,name:"Plenum & Sub-Floor Cleaning",desc:"Below raised-floor cleaning: debris removal, cable pathway clearing, leak detection, contamination assessment, and post-clean airflow pressure differential validation.",priceLow:5000,priceHigh:15000,unit:"per data hall",cat:"H",rev:"low",delivery:"8-16 hours (off-peak)",complexity:"medium"},
        {rank:127,name:"Pest Control Program",desc:"Quarterly integrated pest management: perimeter treatment, rodent monitoring stations, insect traps near cable penetrations, biocide application, and compliance documentation.",priceLow:1500,priceHigh:4000,unit:"per quarter",cat:"H",rev:"low",delivery:"4-6 hours per visit",complexity:"low"},
        {rank:128,name:"Fuel Polishing & Tank Maintenance",desc:"Diesel fuel quality management: microbial contamination testing, fuel polishing/filtration, water separation, tank interior inspection, and fuel sample lab analysis per ASTM D975.",priceLow:8000,priceHigh:20000,unit:"per facility/year",cat:"D",rev:"medium",delivery:"1-2 days per visit",complexity:"medium"},
        {rank:129,name:"Switchgear Partial Discharge Testing",desc:"Online/offline PD testing using UltraTEV, acoustic emission, and HFCT sensors: baseline measurement, trending analysis, defect localization, and insulation condition assessment per IEC 60270.",priceLow:2000,priceHigh:6000,unit:"per unit/year",cat:"D",rev:"medium",delivery:"2-4 hours per unit",complexity:"high"},
        {rank:130,name:"Cable Lifecycle Replacement Program",desc:"Planned replacement of aging MV/LV cables: insulation condition assessment (VLF/tan delta), prioritized replacement schedule, outage coordination, and acceptance testing.",priceLow:10000,priceHigh:30000,unit:"per year",cat:"D",rev:"low",delivery:"planned outage windows",complexity:"high"},
        {rank:131,name:"Cooling Tower Legionella Management",desc:"Legionella risk management: monthly biocide dosing, quarterly Legionella testing (culture + PCR), drift eliminator inspection, biofilm treatment, and compliance reporting per ASHRAE 188.",priceLow:2000,priceHigh:5000,unit:"per tower/quarter",cat:"E",rev:"low",delivery:"ongoing monthly",complexity:"medium"},
        {rank:132,name:"Network Patching & Port Management",desc:"Ongoing fiber/copper cross-connect management: port assignments, patch cable documentation, OTDR testing, connector cleaning, and port utilization tracking via DCIM.",priceLow:100,priceHigh:300,unit:"per port/month",cat:"A",rev:"medium",delivery:"ongoing",complexity:"low"},
        {rank:133,name:"Fire System Annual Maintenance",desc:"Comprehensive fire system PM: agent bottle weighing/hydrostatic test, detection panel calibration, VESDA aspirating system cleaning, manual call point testing, and authority inspection coordination.",priceLow:3000,priceHigh:8000,unit:"per facility/year",cat:"G",rev:"medium",delivery:"1-2 days annually",complexity:"medium"},
        {rank:134,name:"Equipment Decommissioning & Disposal",desc:"Secure rack/equipment removal: data destruction certification, asset tag reconciliation, cable removal and pathway restoration, e-waste compliance per R2/e-Stewards, and load rebalancing.",priceLow:500,priceHigh:2000,unit:"per rack",cat:"H",rev:"medium",delivery:"2-4 hours per rack",complexity:"low"},
        {rank:135,name:"Chiller Refrigerant Reclamation",desc:"EPA 608-compliant refrigerant recovery from decommissioned chillers: certified technician, reclamation equipment, proper cylinder handling, manifest documentation, and environmental reporting.",priceLow:8000,priceHigh:25000,unit:"per chiller",cat:"E",rev:"low",delivery:"1-2 days",complexity:"high"}
    ];

    // ============================================================
    // Region multipliers
    // ============================================================
    const REGIONS = {
        americas: { name: "Americas", mult: 1.00, cities: "Virginia / Texas" },
        europe:   { name: "Europe",   mult: 1.20, cities: "Frankfurt / London" },
        sea:      { name: "SEA",      mult: 0.60, cities: "Jakarta / KL" },
        australia:{ name: "Australia", mult: 1.15, cities: "Sydney" }
    };

    // ============================================================
    // Category labels map
    // ============================================================
    const CAT_LABELS = {
        A:"Colocation & Hosting", B:"Consulting & Advisory", C:"Testing & Commissioning",
        D:"Electrical Services", E:"Mechanical / Cooling", F:"Monitoring, DCIM & Automation",
        G:"Safety & Compliance", H:"Operations & Managed Services", I:"Emergency & Recovery",
        J:"Training & Certification", K:"Sustainability & Energy"
    };

    // ============================================================
    // Quote state
    // ============================================================
    let quoteItems = {}; // { rank: { qty: N } }

    // ============================================================
    // Utility: format price
    // ============================================================
    function fmtPrice(val) {
        if (val >= 1000000) return '$' + (val / 1000000).toFixed(val % 1000000 === 0 ? 0 : 1) + 'M';
        if (val >= 1000) return '$' + (val / 1000).toFixed(val % 1000 === 0 ? 0 : 1) + 'K';
        return '$' + val.toLocaleString('en-US');
    }

    function fmtPriceRange(low, high, mult) {
        return fmtPrice(Math.round(low * mult)) + ' - ' + fmtPrice(Math.round(high * mult));
    }

    function rankClass(rev) {
        if (rev === 'high') return 'rank-high';
        if (rev === 'medium') return 'rank-medium';
        return 'rank-low';
    }

    function revBadge(rev) {
        if (rev === 'high') return '<span class="revenue-badge rev-high">HIGH</span>';
        if (rev === 'medium') return '<span class="revenue-badge rev-medium">MEDIUM</span>';
        return '<span class="revenue-badge rev-low">LOW</span>';
    }

    // ============================================================
    // Render static service lists (Sections 2-12)
    // ============================================================
    function renderStaticLists() {
        const catGroups = {};
        ALL_SERVICES.forEach(s => {
            if (!catGroups[s.cat]) catGroups[s.cat] = [];
            catGroups[s.cat].push(s);
        });

        const catMap = {A:'catA-list',B:'catB-list',C:'catC-list',D:'catD-list',E:'catE-list',
                        F:'catF-list',G:'catG-list',H:'catH-list',I:'catI-list',J:'catJ-list',K:'catK-list'};

        Object.keys(catMap).forEach(cat => {
            const el = document.getElementById(catMap[cat]);
            if (!el || !catGroups[cat]) return;
            el.innerHTML = catGroups[cat].map(s => `
                <div class="service-row">
                    <div class="service-rank ${rankClass(s.rev)}">#${s.rank}</div>
                    <div class="service-info">
                        <h4>${s.name}</h4>
                        <div class="svc-desc">${s.desc}</div>
                        ${s.delivery ? `<div style="font-size:0.7rem;color:var(--accent-cyan);margin-top:0.3rem;">Delivery: ${s.delivery} | Complexity: ${s.complexity || 'N/A'}</div>` : ''}
                    </div>
                    <div class="service-price">${fmtPriceRange(s.priceLow, s.priceHigh, 1.0)}<br>${revBadge(s.rev)}</div>
                    <div class="service-unit">${s.unit}</div>
                </div>
            `).join('');
        });
    }

    // ============================================================
    // Calculator logic
    // ============================================================
    let calcState = { region: 'americas', cat: 'all', search: '', sort: 'rank', term: 0.88, size: 'medium', revTier: 'all' };

    // Size multipliers: larger facilities get volume discounts
    const SIZE_MULTS = { small: 1.10, medium: 1.00, large: 0.92, hyperscale: 0.85 };

    function getFilteredServices() {
        let list = [...ALL_SERVICES];
        if (calcState.cat !== 'all') {
            list = list.filter(s => s.cat === calcState.cat);
        }
        if (calcState.revTier !== 'all') {
            list = list.filter(s => s.rev === calcState.revTier);
        }
        if (calcState.search.trim()) {
            const q = calcState.search.trim().toLowerCase();
            list = list.filter(s => s.name.toLowerCase().includes(q) || s.desc.toLowerCase().includes(q) || s.cat.toLowerCase().includes(q) || (CAT_LABELS[s.cat] || '').toLowerCase().includes(q));
        }
        const mult = REGIONS[calcState.region].mult;
        switch (calcState.sort) {
            case 'rank': list.sort((a,b) => a.rank - b.rank); break;
            case 'price-high': list.sort((a,b) => (b.priceHigh * mult) - (a.priceHigh * mult)); break;
            case 'price-low': list.sort((a,b) => (a.priceLow * mult) - (b.priceLow * mult)); break;
            case 'alpha': list.sort((a,b) => a.name.localeCompare(b.name)); break;
        }
        return list;
    }

    function getEffectiveMult() {
        return REGIONS[calcState.region].mult * calcState.term * SIZE_MULTS[calcState.size];
    }

    function renderCalcResults() {
        const list = getFilteredServices();
        const effMult = getEffectiveMult();
        const regionMult = REGIONS[calcState.region].mult;
        const container = document.getElementById('calcResults');
        const countEl = document.getElementById('calcCount');

        const termLabel = calcState.term < 1 ? ` | ${calcState.term}x term` : '';
        const sizeLabel = SIZE_MULTS[calcState.size] !== 1 ? ` | ${SIZE_MULTS[calcState.size]}x size` : '';
        countEl.textContent = `Showing ${list.length} of ${ALL_SERVICES.length} services (${REGIONS[calcState.region].name} ${regionMult.toFixed(2)}x${termLabel}${sizeLabel} = ${effMult.toFixed(2)}x effective)`;

        if (list.length === 0) {
            container.innerHTML = '<div class="no-results">No services match your criteria. Try adjusting filters.</div>';
            return;
        }

        container.innerHTML = list.map(s => {
            const isAdded = quoteItems[s.rank];
            return `
            <div class="calc-card">
                <div class="c-rank ${rankClass(s.rev)}">#${s.rank}</div>
                <div>
                    <div class="c-name">${s.name}</div>
                    <div class="c-desc">${s.desc}</div>
                    ${s.delivery ? `<div style="font-size:0.65rem;color:var(--accent-cyan);margin-top:0.2rem;">${s.delivery} | ${(s.complexity||'').charAt(0).toUpperCase()+(s.complexity||'').slice(1)} complexity</div>` : ''}
                </div>
                <div class="c-price">${fmtPriceRange(s.priceLow, s.priceHigh, effMult)}</div>
                <div class="c-unit">${s.unit}</div>
                <button class="btn-add-quote ${isAdded ? 'added' : ''}" onclick="toggleQuote(${s.rank})">${isAdded ? 'Added' : '+ Quote'}</button>
            </div>`;
        }).join('');
    }

    // Category pills
    document.getElementById('categoryPills').addEventListener('click', function(e) {
        const pill = e.target.closest('.cat-pill');
        if (!pill) return;
        document.querySelectorAll('.cat-pill').forEach(p => p.classList.remove('active'));
        pill.classList.add('active');
        calcState.cat = pill.dataset.cat;
        renderCalcResults();
    });

    // Region select
    document.getElementById('calcRegion').addEventListener('change', function() {
        calcState.region = this.value;
        renderCalcResults();
    });

    // Search
    document.getElementById('calcSearch').addEventListener('input', function() {
        calcState.search = this.value;
        renderCalcResults();
    });

    // Sort
    document.getElementById('calcSort').addEventListener('change', function() {
        calcState.sort = this.value;
        renderCalcResults();
    });

    // Contract Term
    document.getElementById('calcTerm').addEventListener('change', function() {
        calcState.term = parseFloat(this.value);
        renderCalcResults();
    });

    // Facility Size
    document.getElementById('calcSize').addEventListener('change', function() {
        calcState.size = this.value;
        renderCalcResults();
    });

    // Revenue Tier filter
    document.getElementById('calcRevTier').addEventListener('change', function() {
        calcState.revTier = this.value;
        renderCalcResults();
    });

    // ============================================================
    // Quote management
    // ============================================================
    function toggleQuote(rank) {
        if (quoteItems[rank]) {
            delete quoteItems[rank];
        } else {
            quoteItems[rank] = { qty: 1 };
        }
        updateQuoteBar();
        renderCalcResults();
    }

    function updateQuoteBar() {
        const bar = document.getElementById('quoteBuilder');
        const keys = Object.keys(quoteItems);
        if (keys.length === 0) {
            bar.classList.remove('active');
            return;
        }
        bar.classList.add('active');

        const effMult = getEffectiveMult();
        let totalLow = 0, totalHigh = 0;
        keys.forEach(rank => {
            const svc = ALL_SERVICES.find(s => s.rank == rank);
            if (!svc) return;
            const qty = quoteItems[rank].qty;
            totalLow += svc.priceLow * effMult * qty;
            totalHigh += svc.priceHigh * effMult * qty;
        });

        document.getElementById('quoteCount').textContent = keys.length;
        document.getElementById('quoteTotalLow').textContent = fmtPrice(Math.round(totalLow));
        document.getElementById('quoteTotalHigh').textContent = fmtPrice(Math.round(totalHigh));
    }

    function clearQuote() {
        quoteItems = {};
        updateQuoteBar();
        renderCalcResults();
        closeQuoteModal();
    }

    function openQuoteModal() {
        const modal = document.getElementById('quoteModal');
        const body = document.getElementById('quoteModalBody');
        const keys = Object.keys(quoteItems);

        if (keys.length === 0) {
            body.innerHTML = '<p style="color:var(--text-secondary);text-align:center;padding:2rem;">No services added to quote yet. Use the "+ Quote" button to add services.</p>';
            modal.classList.add('active');
            return;
        }

        const effMult = getEffectiveMult();
        const termDiscount = calcState.term;
        const sizeMult = SIZE_MULTS[calcState.size];
        const termLabels = {'1':'Spot/One-time','0.95':'1-Year','0.88':'3-Year','0.82':'5-Year'};
        const sizeLabels = {small:'<2 MW',medium:'2-10 MW',large:'10-50 MW',hyperscale:'50+ MW'};

        let html = '';
        let totalLow = 0, totalHigh = 0;

        // Quote parameters summary
        html += `
        <div style="background:var(--section-bg);padding:1rem;border-radius:8px;margin-bottom:1rem;font-size:0.8rem;color:var(--text-secondary);">
            <strong style="color:var(--text-primary);">Quote Parameters:</strong>
            Region: <strong>${REGIONS[calcState.region].name}</strong> (${REGIONS[calcState.region].mult}x) |
            Contract: <strong>${termLabels[String(termDiscount)] || 'Custom'}</strong> (${termDiscount}x) |
            Facility: <strong>${sizeLabels[calcState.size]}</strong> (${sizeMult}x) |
            Effective: <strong style="color:var(--accent-gold);">${effMult.toFixed(2)}x</strong>
        </div>`;

        keys.forEach(rank => {
            const svc = ALL_SERVICES.find(s => s.rank == rank);
            if (!svc) return;
            const qty = quoteItems[rank].qty;
            const lo = Math.round(svc.priceLow * effMult * qty);
            const hi = Math.round(svc.priceHigh * effMult * qty);
            totalLow += lo;
            totalHigh += hi;

            html += `
            <div class="quote-item-row">
                <div class="qi-name">#${svc.rank} ${svc.name}<br><span style="font-size:0.75rem;color:var(--text-secondary)">${svc.unit} | Cat ${svc.cat}: ${CAT_LABELS[svc.cat]}</span></div>
                <div class="qty-control">
                    <button class="qty-btn" onclick="changeQty(${svc.rank},-1)">-</button>
                    <span class="qty-val">${qty}</span>
                    <button class="qty-btn" onclick="changeQty(${svc.rank},1)">+</button>
                </div>
                <div class="qi-price">${fmtPrice(lo)} - ${fmtPrice(hi)}</div>
                <button class="btn-remove-item" onclick="removeFromQuote(${svc.rank})">x</button>
            </div>`;
        });

        html += `
        <div style="display:flex;justify-content:space-between;padding:1rem 0;font-weight:700;border-top:2px solid var(--accent-gold);margin-top:0.5rem;">
            <span>Total (${REGIONS[calcState.region].name}, ${effMult.toFixed(2)}x)</span>
            <span style="font-family:'JetBrains Mono',monospace;color:var(--accent-gold);">${fmtPrice(Math.round(totalLow))} - ${fmtPrice(Math.round(totalHigh))}</span>
        </div>`;

        // Regional comparison (uses term + size multipliers on each region)
        html += `<div class="quote-regional"><h4 style="font-size:0.95rem;font-weight:700;color:var(--text-primary);">Regional Comparison (with ${termLabels[String(termDiscount)] || ''} term, ${sizeLabels[calcState.size]} facility)</h4><div class="regional-grid">`;
        Object.keys(REGIONS).forEach(rk => {
            const r = REGIONS[rk];
            const rEffMult = r.mult * termDiscount * sizeMult;
            let rLow = 0, rHigh = 0;
            keys.forEach(rank => {
                const svc = ALL_SERVICES.find(s => s.rank == rank);
                if (!svc) return;
                const qty = quoteItems[rank].qty;
                rLow += svc.priceLow * rEffMult * qty;
                rHigh += svc.priceHigh * rEffMult * qty;
            });
            html += `
            <div class="regional-card">
                <div class="rc-region">${r.name}</div>
                <div class="rc-total">${fmtPrice(Math.round(rLow))} - ${fmtPrice(Math.round(rHigh))}</div>
                <div class="rc-mult">${rEffMult.toFixed(2)}x eff | ${r.cities}</div>
            </div>`;
        });
        html += '</div></div>';

        // Export PDF button
        html += `
        <div style="display:flex;gap:0.75rem;justify-content:flex-end;margin-top:1.5rem;">
            <button class="btn-export-pdf" onclick="exportQuotePDF()">Export to PDF</button>
            <button class="btn-quote btn-copy-quote" onclick="copyQuoteSummary()" style="margin:0;">Copy Summary</button>
        </div>`;

        body.innerHTML = html;
        modal.classList.add('active');
    }

    function closeQuoteModal() {
        document.getElementById('quoteModal').classList.remove('active');
    }

    function changeQty(rank, delta) {
        if (!quoteItems[rank]) return;
        quoteItems[rank].qty = Math.max(1, quoteItems[rank].qty + delta);
        updateQuoteBar();
        openQuoteModal();
    }

    function removeFromQuote(rank) {
        delete quoteItems[rank];
        updateQuoteBar();
        renderCalcResults();
        if (Object.keys(quoteItems).length === 0) {
            closeQuoteModal();
        } else {
            openQuoteModal();
        }
    }

    function copyQuoteSummary() {
        const keys = Object.keys(quoteItems);
        if (keys.length === 0) return;

        const effMult = getEffectiveMult();
        const termDiscount = calcState.term;
        const sizeMult = SIZE_MULTS[calcState.size];
        const termLabels = {'1':'Spot/One-time','0.95':'1-Year','0.88':'3-Year','0.82':'5-Year'};
        const sizeLabels = {small:'<2 MW',medium:'2-10 MW',large:'10-50 MW',hyperscale:'50+ MW'};

        let text = 'DATA CENTER SERVICE QUOTE SUMMARY\n';
        text += '================================\n';
        text += `Date: ${new Date().toLocaleDateString('en-US', {year:'numeric',month:'long',day:'numeric'})}\n`;
        text += `Region: ${REGIONS[calcState.region].name} (${REGIONS[calcState.region].mult.toFixed(2)}x)\n`;
        text += `Contract Term: ${termLabels[String(termDiscount)] || 'Custom'} (${termDiscount}x)\n`;
        text += `Facility Size: ${sizeLabels[calcState.size]} (${sizeMult}x)\n`;
        text += `Effective Multiplier: ${effMult.toFixed(2)}x\n\n`;
        text += 'SERVICES:\n';

        let totalLow = 0, totalHigh = 0;

        keys.forEach(rank => {
            const svc = ALL_SERVICES.find(s => s.rank == rank);
            if (!svc) return;
            const qty = quoteItems[rank].qty;
            const lo = Math.round(svc.priceLow * effMult * qty);
            const hi = Math.round(svc.priceHigh * effMult * qty);
            totalLow += lo;
            totalHigh += hi;
            text += `  #${svc.rank} ${svc.name} (x${qty})\n`;
            text += `     ${fmtPrice(lo)} - ${fmtPrice(hi)} ${svc.unit}\n`;
            text += `     Category: ${CAT_LABELS[svc.cat]}\n\n`;
        });

        text += '--------------------------------\n';
        text += `TOTAL: ${fmtPrice(Math.round(totalLow))} - ${fmtPrice(Math.round(totalHigh))}\n\n`;

        text += 'REGIONAL COMPARISON:\n';
        Object.keys(REGIONS).forEach(rk => {
            const r = REGIONS[rk];
            const rEffMult = r.mult * termDiscount * sizeMult;
            let rLow = 0, rHigh = 0;
            keys.forEach(rank => {
                const svc = ALL_SERVICES.find(s => s.rank == rank);
                if (!svc) return;
                const qty = quoteItems[rank].qty;
                rLow += svc.priceLow * rEffMult * qty;
                rHigh += svc.priceHigh * rEffMult * qty;
            });
            text += `  ${r.name} (${rEffMult.toFixed(2)}x eff): ${fmtPrice(Math.round(rLow))} - ${fmtPrice(Math.round(rHigh))}\n`;
        });

        text += '\nDisclaimer: Pricing is indicative and based on Americas baseline Q1 2026.\n';
        text += 'Actual pricing varies by scope, complexity, and vendor.\n';
        text += 'Generated from: resistancezero.com/article-15.html\n';

        navigator.clipboard.writeText(text).then(() => {
            const btns = document.querySelectorAll('.btn-copy-quote');
            btns.forEach(btn => { btn.textContent = 'Copied!'; setTimeout(() => { btn.textContent = 'Copy Summary'; }, 2000); });
        }).catch(() => {
            const ta = document.createElement('textarea');
            ta.value = text;
            document.body.appendChild(ta);
            ta.select();
            document.execCommand('copy');
            document.body.removeChild(ta);
            const btns = document.querySelectorAll('.btn-copy-quote');
            btns.forEach(btn => { btn.textContent = 'Copied!'; setTimeout(() => { btn.textContent = 'Copy Summary'; }, 2000); });
        });
    }

    // PDF Export - uses print dialog
    function exportQuotePDF() {
        document.body.classList.add('print-quote');
        // Ensure modal is visible for printing
        const modal = document.getElementById('quoteModal');
        modal.classList.add('active');
        setTimeout(() => {
            window.print();
            setTimeout(() => {
                document.body.classList.remove('print-quote');
            }, 500);
        }, 200);
    }

    // Close modal on outside click
    document.getElementById('quoteModal').addEventListener('click', function(e) {
        if (e.target === this) closeQuoteModal();
    });

    // ============================================================
    // Initialize
    // ============================================================
    document.addEventListener('DOMContentLoaded', function() {
        renderStaticLists();
        renderCalcResults();
    });
    </script>
<!-- Share Buttons -->
<div class="share-buttons">
    <button class="share-btn linkedin" data-tooltip="Share on LinkedIn" onclick="shareLinkedIn()" aria-label="Share on LinkedIn">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="20" height="20"><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/></svg>
    </button>
    <button class="share-btn twitter" data-tooltip="Share on X" onclick="shareTwitter()" aria-label="Share on X">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="20" height="20"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/></svg>
    </button>
    <button class="share-btn whatsapp" data-tooltip="Share on WhatsApp" onclick="shareWhatsApp()" aria-label="Share on WhatsApp">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="20" height="20"><path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"/></svg>
    </button>
    <button class="share-btn copy" data-tooltip="Copy link" onclick="copyLink()" aria-label="Copy article link">
        <svg class="copy-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="20" height="20"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"/><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"/></svg>
        <svg class="check-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="20" height="20" style="display:none"><polyline points="20 6 9 17 4 12"/></svg>
    </button>
</div>
<script>
function shareLinkedIn(){window.open('https://www.linkedin.com/sharing/share-offsite/?url='+encodeURIComponent(window.location.href),'_blank')}
function shareTwitter(){window.open('https://twitter.com/intent/tweet?url='+encodeURIComponent(window.location.href)+'&text='+encodeURIComponent(document.title),'_blank')}
function shareWhatsApp(){window.open('https://wa.me/?text='+encodeURIComponent(document.title+' '+window.location.href),'_blank')}
function copyLink(){var b=document.querySelector('.share-btn.copy'),c=b.querySelector('.copy-icon'),k=b.querySelector('.check-icon');navigator.clipboard.writeText(window.location.href).then(function(){b.classList.add('copied');c.style.display='none';k.style.display='block';b.setAttribute('data-tooltip','Copied!');setTimeout(function(){b.classList.remove('copied');c.style.display='block';k.style.display='none';b.setAttribute('data-tooltip','Copy link')},2000)})}
</script>
<!-- MCL Pro Mode Login Modal -->
<div class="mcl-login-overlay" id="mclLoginOverlay">
    <div class="mcl-login-box">
        <button class="mcl-login-close" onclick="mclHideLogin()">&times;</button>
        <h3><i class="fas fa-crown" style="color:#ec4899"></i> Pro Analysis Access</h3>
        <p>Unlock OPEX intelligence, staffing resilience, Monte Carlo simulation, and executive reporting.</p>
        <input type="email" id="mclLoginEmail" placeholder="Email address">
        <input type="password" id="mclLoginPass" placeholder="Password">
        <button class="mcl-login-submit" onclick="mclDoLogin()">Unlock Pro Mode</button>
        <div class="mcl-login-error" id="mclLoginError">Invalid credentials. Please try again.</div>
        <div class="demo-hint">Demo: <code>demo@resistancezero.com</code> / <code>demo2026</code></div>
        <div style="text-align:center;margin-top:6px;"><a href="https://bagus-dwi-permana.myr.id/membership/resistancezero-pro" target="_blank" rel="noopener" style="font-size:0.62rem;color:#64748b;text-decoration:none;">Unlock Pro Mode &rarr;</a></div>
    </div>
</div>

<!-- MCL Pro Mode Engine -->
<script>
(function() {
    'use strict';

    // ============================================================
    // COUNTRY / REGION DATA (20 regions)
    // ============================================================
    var MCL_COUNTRIES = {
        'Indonesia':       { currency:'IDR', symbol:'Rp',  laborRate:18000,  energyRate:0.085, fxToUSD:0.000063, climate:'tropical',  tropFactor:1.12, laborIdx:0.35 },
        'Singapore':       { currency:'SGD', symbol:'S$',  laborRate:72000,  energyRate:0.168, fxToUSD:0.74,     climate:'tropical',  tropFactor:1.10, laborIdx:1.05 },
        'Malaysia':        { currency:'MYR', symbol:'RM',  laborRate:48000,  energyRate:0.082, fxToUSD:0.22,     climate:'tropical',  tropFactor:1.11, laborIdx:0.45 },
        'Thailand':        { currency:'THB', symbol:'\u0E3F', laborRate:36000, energyRate:0.098, fxToUSD:0.028,  climate:'tropical',  tropFactor:1.10, laborIdx:0.42 },
        'Vietnam':         { currency:'VND', symbol:'\u20AB', laborRate:15000, energyRate:0.078, fxToUSD:0.000040, climate:'tropical', tropFactor:1.13, laborIdx:0.30 },
        'Philippines':     { currency:'PHP', symbol:'\u20B1', laborRate:22000, energyRate:0.142, fxToUSD:0.018,  climate:'tropical',  tropFactor:1.14, laborIdx:0.38 },
        'India':           { currency:'INR', symbol:'\u20B9', laborRate:24000, energyRate:0.075, fxToUSD:0.012,  climate:'tropical',  tropFactor:1.08, laborIdx:0.32 },
        'Japan':           { currency:'JPY', symbol:'\u00A5', laborRate:82000, energyRate:0.210, fxToUSD:0.0067, climate:'temperate', tropFactor:1.00, laborIdx:1.10 },
        'Australia':       { currency:'AUD', symbol:'A$',  laborRate:88000,  energyRate:0.185, fxToUSD:0.65,     climate:'arid',      tropFactor:1.05, laborIdx:1.15 },
        'US-Virginia':     { currency:'USD', symbol:'$',   laborRate:95000,  energyRate:0.068, fxToUSD:1.00,     climate:'temperate', tropFactor:1.00, laborIdx:1.00 },
        'US-Texas':        { currency:'USD', symbol:'$',   laborRate:88000,  energyRate:0.058, fxToUSD:1.00,     climate:'hot-arid',  tropFactor:1.06, laborIdx:0.95 },
        'US-Oregon':       { currency:'USD', symbol:'$',   laborRate:90000,  energyRate:0.042, fxToUSD:1.00,     climate:'temperate', tropFactor:1.00, laborIdx:0.98 },
        'EU-Germany':      { currency:'EUR', symbol:'\u20AC', laborRate:78000, energyRate:0.235, fxToUSD:1.08,   climate:'temperate', tropFactor:1.00, laborIdx:1.12 },
        'EU-Netherlands':  { currency:'EUR', symbol:'\u20AC', laborRate:75000, energyRate:0.195, fxToUSD:1.08,   climate:'temperate', tropFactor:1.00, laborIdx:1.08 },
        'EU-Ireland':      { currency:'EUR', symbol:'\u20AC', laborRate:70000, energyRate:0.178, fxToUSD:1.08,   climate:'cool',      tropFactor:0.95, laborIdx:1.02 },
        'UK':              { currency:'GBP', symbol:'\u00A3', laborRate:72000, energyRate:0.215, fxToUSD:1.26,   climate:'cool',      tropFactor:0.96, laborIdx:1.06 },
        'UAE':             { currency:'AED', symbol:'AED ', laborRate:65000,  energyRate:0.082, fxToUSD:0.27,    climate:'hot-arid',  tropFactor:1.15, laborIdx:0.75 },
        'Saudi-Arabia':    { currency:'SAR', symbol:'SAR ', laborRate:60000,  energyRate:0.048, fxToUSD:0.27,    climate:'hot-arid',  tropFactor:1.18, laborIdx:0.70 },
        'Brazil':          { currency:'BRL', symbol:'R$',  laborRate:32000,  energyRate:0.110, fxToUSD:0.18,     climate:'tropical',  tropFactor:1.09, laborIdx:0.40 },
        'Chile':           { currency:'CLP', symbol:'CLP ', laborRate:28000, energyRate:0.095, fxToUSD:0.0011,   climate:'temperate', tropFactor:1.00, laborIdx:0.42 }
    };

    // ============================================================
    // STAFFING MODELS
    // ============================================================
    var MCL_STAFF_MODELS = {
        'inhouse':    { label: 'Full In-House',    costMult: 1.00, qualityMult: 1.00, retentionMod: 0,    ftePerMW: 4.2 },
        'hybrid70':   { label: 'Hybrid 70/30',     costMult: 0.88, qualityMult: 0.95, retentionMod: -3,   ftePerMW: 3.8 },
        'hybrid50':   { label: 'Hybrid 50/50',     costMult: 0.78, qualityMult: 0.88, retentionMod: -6,   ftePerMW: 3.5 },
        'outsourced': { label: 'Full Outsourced',   costMult: 0.65, qualityMult: 0.80, retentionMod: -12,  ftePerMW: 3.0 }
    };

    // Shift multiplier for 24/7 coverage
    var SHIFT_MULT = 4.2;

    // State
    var mclProMode = false;

    // ============================================================
    // UTILITY FUNCTIONS
    // ============================================================
    function fmt(v) {
        if (Math.abs(v) >= 1e9) return '$' + (v / 1e9).toFixed(2) + 'B';
        if (Math.abs(v) >= 1e6) return '$' + (v / 1e6).toFixed(2) + 'M';
        if (Math.abs(v) >= 1e3) return '$' + (v / 1e3).toFixed(1) + 'K';
        return '$' + Math.round(v).toLocaleString();
    }

    function pctFmt(v) { return v.toFixed(1) + '%'; }

    function clamp(v, lo, hi) { return Math.max(lo, Math.min(hi, v)); }

    // Box-Muller transform for normal random
    function boxMuller() {
        var u1 = 0, u2 = 0;
        while (u1 === 0) u1 = Math.random();
        while (u2 === 0) u2 = Math.random();
        return Math.sqrt(-2.0 * Math.log(u1)) * Math.cos(2.0 * Math.PI * u2);
    }

    function percentile(sortedArr, p) {
        var idx = (p / 100) * (sortedArr.length - 1);
        var lo = Math.floor(idx), hi = Math.ceil(idx);
        if (lo === hi) return sortedArr[lo];
        return sortedArr[lo] + (sortedArr[hi] - sortedArr[lo]) * (idx - lo);
    }

    // ============================================================
    // GET INPUTS
    // ============================================================
    function getInputs() {
        var countryKey = document.getElementById('mclCountry').value;
        var region = MCL_COUNTRIES[countryKey] || MCL_COUNTRIES['US-Virginia'];
        var loadMW = parseFloat(document.getElementById('mclLoad').value) || 10;
        var pue = parseFloat(document.getElementById('mclPUE').value) || 1.40;
        var staffModelKey = document.getElementById('mclStaffModel').value;
        var staffModel = MCL_STAFF_MODELS[staffModelKey] || MCL_STAFF_MODELS['inhouse'];
        var retention = parseFloat(document.getElementById('mclRetention').value) || 85;
        var pmRatio = parseFloat(document.getElementById('mclPMRatio').value) || 75;

        return {
            countryKey: countryKey,
            region: region,
            loadMW: clamp(loadMW, 0.1, 100),
            pue: clamp(pue, 1.10, 3.00),
            staffModelKey: staffModelKey,
            staffModel: staffModel,
            retention: clamp(retention, 60, 99),
            pmRatio: clamp(pmRatio, 30, 95)
        };
    }

    // ============================================================
    // PANEL 1: OPEX FINANCIAL INTELLIGENCE
    // ============================================================
    function calcOpex(inp) {
        var r = inp.region;
        var loadKW = inp.loadMW * 1000;

        // Annual energy cost: MW * 1000 * PUE * rate * 8760
        var annualEnergy = loadKW * inp.pue * r.energyRate * 8760;
        // Convert to USD
        var energyCostUSD = annualEnergy * r.fxToUSD;

        // Staffing
        var baseFTE = Math.ceil(inp.loadMW * inp.staffModel.ftePerMW);
        var shiftFTE = Math.ceil(baseFTE * SHIFT_MULT);
        var laborRateUSD = r.laborRate * r.fxToUSD;
        var burdenedRate = laborRateUSD * 1.35; // 35% burden (benefits, insurance, training)
        var laborBudget = shiftFTE * burdenedRate * inp.staffModel.costMult;

        // Maintenance budget: base per MW + tropical adjustment
        var maintPerMW = 180000; // $180K base per MW for comprehensive DC maintenance
        var maintBudget = inp.loadMW * maintPerMW * r.tropFactor;
        // PM/CM split affects total: higher PM = lower total (fewer failures)
        var pmEfficiency = 1.0 - (inp.pmRatio / 100 - 0.50) * 0.30; // max 15% savings at 95% PM
        maintBudget = maintBudget * pmEfficiency;

        var totalOpex = energyCostUSD + laborBudget + maintBudget;
        var opexPerMW = totalOpex / inp.loadMW;
        var costPerKW = totalOpex / (loadKW * 12);

        // Cash flow variance (stochastic estimate): higher PM = lower variance
        var baseVariance = 3.5; // % baseline
        var varianceReduction = (inp.pmRatio / 100 - 0.50) * 4.0;
        var cashVariance = Math.max(0.5, baseVariance - varianceReduction);

        // AFFO impact: FFO - Maintenance CapEx (assume 15% of maintenance is CapEx)
        var maintCapex = maintBudget * 0.15;
        var ffo = totalOpex * 0.12; // approximate FFO as fraction of revenue-like OPEX
        var affo = ffo - maintCapex;

        return {
            energyCost: energyCostUSD,
            laborBudget: laborBudget,
            maintBudget: maintBudget,
            totalOpex: totalOpex,
            opexPerMW: opexPerMW,
            costPerKW: costPerKW,
            cashVariance: cashVariance,
            affo: affo,
            baseFTE: baseFTE,
            shiftFTE: shiftFTE,
            laborRateUSD: laborRateUSD,
            burdenedRate: burdenedRate,
            maintCapex: maintCapex
        };
    }

    // ============================================================
    // PANEL 2: STAFFING RESILIENCE ANALYSIS
    // ============================================================
    function calcStaffing(inp, opex) {
        var sm = inp.staffModel;
        var headcount = opex.shiftFTE;

        // Utilization rate: driven by load and model
        var baseUtil = 78 + (inp.loadMW / 100) * 12; // larger = higher util
        var utilization = clamp(baseUtil * sm.qualityMult, 55, 98);

        // Burnout probability: logistic function of utilization
        // P(burnout) = 1 / (1 + exp(-0.12*(util - 88)))
        var burnoutLogit = -0.12 * (utilization - 88);
        var burnoutProb = 1.0 / (1.0 + Math.exp(burnoutLogit)) * 100;

        // In/Out break-even FTE threshold
        var inhouseCost = opex.burdenedRate * SHIFT_MULT;
        var outsourcedCostPerFTE = opex.burdenedRate * SHIFT_MULT * 0.65;
        var managementOverhead = 25000; // annual management overhead per outsourced FTE
        var breakevenFTE = managementOverhead / (inhouseCost - outsourcedCostPerFTE);
        breakevenFTE = Math.max(1, Math.round(breakevenFTE));

        // Retention cost: turnover * replacement cost
        var turnoverRate = (100 - inp.retention) / 100;
        var replacementCost = opex.laborRateUSD * 1.5; // 150% of salary
        var retentionCost = Math.round(headcount * turnoverRate * replacementCost);

        // Single points of failure (skill gap): inversely related to headcount and retention
        var spofBase = Math.max(0, 8 - headcount * 0.08);
        var skillGapAdj = (100 - inp.retention) / 40;
        var spof = Math.max(0, Math.round(spofBase + skillGapAdj));

        // Staffing Resilience Index (0-100)
        var sri = clamp(
            (inp.retention * 0.35) +
            ((100 - burnoutProb) * 0.25) +
            (inp.pmRatio * 0.20) +
            (sm.qualityMult * 100 * 0.20) -
            (spof * 3),
            0, 100
        );

        // HEP Modifier (Human Error Probability): affected by utilization, retention, burnout
        var hepBase = 0.003; // base HEP for well-trained DC staff
        var hepMod = hepBase * (1 + (burnoutProb / 100) * 0.5) * (1 + turnoverRate * 0.3) * (2.0 - sm.qualityMult);
        var hepResult = hepMod;

        return {
            headcount: headcount,
            utilization: utilization,
            burnoutProb: burnoutProb,
            breakevenFTE: breakevenFTE,
            retentionCost: retentionCost,
            spof: spof,
            resilienceIdx: Math.round(sri),
            hep: hepResult
        };
    }

    // ============================================================
    // PANEL 3: RISK & RELIABILITY DASHBOARD
    // ============================================================
    function calcRisk(inp, opex, staff) {
        // Financial Exposure Score (0-100): composite of cost concentration, variance, labor dependency
        var energyShare = opex.energyCost / opex.totalOpex;
        var laborShare = opex.laborBudget / opex.totalOpex;
        var finExposure = clamp(
            (energyShare * 40) + (laborShare * 35) + ((100 - inp.retention) / 100 * 25) +
            (opex.cashVariance * 3),
            0, 100
        );

        // Cost of Inaction: estimated annual losses prevented by proper maintenance
        var baseDowntimeCost = inp.loadMW * 350000; // $350K per MW per hour downtime avg
        var annualDowntimeHrs = (100 - inp.pmRatio) / 100 * 8; // estimated hours per year
        var coi = baseDowntimeCost * annualDowntimeHrs * (1 + (100 - inp.retention) / 200);

        // Operational Health Score (A-F grade)
        var ohsPoints = (inp.pmRatio * 0.35) + (inp.retention * 0.30) +
            ((100 - staff.burnoutProb) * 0.20) + (staff.resilienceIdx * 0.15);
        var ohsGrade, ohsLabel;
        if (ohsPoints >= 85) { ohsGrade = 'A'; ohsLabel = 'A (Excellent)'; }
        else if (ohsPoints >= 72) { ohsGrade = 'B'; ohsLabel = 'B (Good)'; }
        else if (ohsPoints >= 60) { ohsGrade = 'C'; ohsLabel = 'C (Adequate)'; }
        else if (ohsPoints >= 45) { ohsGrade = 'D'; ohsLabel = 'D (At Risk)'; }
        else { ohsGrade = 'F'; ohsLabel = 'F (Critical)'; }

        // PM Compliance: directly from input with quality adjustment
        var pmCompliance = inp.pmRatio * inp.staffModel.qualityMult;

        // Alarm Efficiency (signal-to-noise ratio): related to PM compliance and staff quality
        var alarmBase = 60 + inp.pmRatio * 0.25;
        var alarmEff = clamp(alarmBase * inp.staffModel.qualityMult, 30, 98);

        // 5-Year Maintenance Debt: deferred maintenance accumulation
        var deferralRate = (100 - inp.pmRatio) / 100;
        var annualDeferred = opex.maintBudget * deferralRate * 0.30;
        var maintDebt5yr = annualDeferred * 5 * 1.15; // 15% compounding effect

        // AFFO Optimization Potential: annual savings from reaching best-in-class
        var currentEfficiency = (inp.pmRatio / 95) * (inp.retention / 99);
        var affoPotential = opex.totalOpex * (1 - currentEfficiency) * 0.08;

        return {
            finExposure: Math.round(finExposure),
            coi: coi,
            ohsLabel: ohsLabel,
            ohsGrade: ohsGrade,
            ohsPoints: ohsPoints,
            pmCompliance: Math.round(pmCompliance),
            alarmEff: Math.round(alarmEff),
            maintDebt5yr: maintDebt5yr,
            affoPotential: affoPotential
        };
    }

    // ============================================================
    // PANEL 4: MONTE CARLO SIMULATION (10K)
    // ============================================================
    function runMonteCarlo(inp, opex) {
        var N = 10000;
        var results = [];
        var baseTotal = opex.totalOpex;

        // Volatility factors
        var energyVol = 0.15;   // +/-15% energy price volatility
        var pueVol = 0.05;      // +/-5% PUE variance
        var laborVol = 0.10;    // +/-10% labor cost variance
        var retentionVol = 0.08; // retention impact on costs
        var pmVol = 0.12;       // PM ratio impact on unplanned costs

        for (var i = 0; i < N; i++) {
            var eFactor = 1 + boxMuller() * energyVol;
            var pFactor = 1 + boxMuller() * pueVol;
            var lFactor = 1 + boxMuller() * laborVol;
            var rFactor = 1 + boxMuller() * retentionVol * ((100 - inp.retention) / 100);
            var mFactor = 1 + boxMuller() * pmVol * ((100 - inp.pmRatio) / 100);

            var simEnergy = opex.energyCost * eFactor * pFactor;
            var simLabor = opex.laborBudget * lFactor * rFactor;
            var simMaint = opex.maintBudget * mFactor;

            results.push(simEnergy + simLabor + simMaint);
        }

        results.sort(function(a, b) { return a - b; });

        var p5 = percentile(results, 5);
        var p25 = percentile(results, 25);
        var p50 = percentile(results, 50);
        var p75 = percentile(results, 75);
        var p95 = percentile(results, 95);

        // Mean
        var sum = 0;
        for (var j = 0; j < N; j++) sum += results[j];
        var mean = sum / N;

        // CVaR @ 95%: average of worst 5%
        var tail5idx = Math.floor(N * 0.95);
        var tailSum = 0, tailCount = 0;
        for (var k = tail5idx; k < N; k++) { tailSum += results[k]; tailCount++; }
        var cvar95 = tailCount > 0 ? tailSum / tailCount : p95;

        // Budget exceedance probability: P(cost > 120% of base)
        var threshold120 = baseTotal * 1.20;
        var exceedCount = 0;
        for (var m = 0; m < N; m++) { if (results[m] > threshold120) exceedCount++; }
        var exceedProb = (exceedCount / N) * 100;

        return {
            results: results,
            p5: p5, p25: p25, p50: p50, p75: p75, p95: p95,
            mean: mean, cvar95: cvar95,
            exceedProb: exceedProb,
            baseTotal: baseTotal
        };
    }

    // ============================================================
    // SENSITIVITY ANALYSIS (5 factors)
    // ============================================================
    function runSensitivity(inp, opex) {
        var factors = [
            { name: 'Energy Price', field: 'energy' },
            { name: 'PUE', field: 'pue' },
            { name: 'Labor Cost', field: 'labor' },
            { name: 'Retention Rate', field: 'retention' },
            { name: 'PM Ratio', field: 'pmRatio' }
        ];

        var swing = 0.20; // +/-20% swing
        var baseCost = opex.totalOpex;
        var results = [];

        factors.forEach(function(f) {
            var upCost, downCost;

            // Recalculate with +20% and -20% perturbation
            var upInp = JSON.parse(JSON.stringify(inp));
            var downInp = JSON.parse(JSON.stringify(inp));

            // We need to re-reference region objects since JSON stringify loses references
            upInp.region = MCL_COUNTRIES[upInp.countryKey];
            upInp.staffModel = MCL_STAFF_MODELS[upInp.staffModelKey];
            downInp.region = MCL_COUNTRIES[downInp.countryKey];
            downInp.staffModel = MCL_STAFF_MODELS[downInp.staffModelKey];

            switch (f.field) {
                case 'energy':
                    var origRate = upInp.region.energyRate;
                    upInp.region = Object.assign({}, upInp.region, { energyRate: origRate * (1 + swing) });
                    downInp.region = Object.assign({}, downInp.region, { energyRate: origRate * (1 - swing) });
                    break;
                case 'pue':
                    upInp.pue = inp.pue * (1 + swing);
                    downInp.pue = inp.pue * (1 - swing);
                    break;
                case 'labor':
                    var origLabor = upInp.region.laborRate;
                    upInp.region = Object.assign({}, upInp.region, { laborRate: origLabor * (1 + swing) });
                    downInp.region = Object.assign({}, downInp.region, { laborRate: origLabor * (1 - swing) });
                    break;
                case 'retention':
                    upInp.retention = clamp(inp.retention + 10, 60, 99);
                    downInp.retention = clamp(inp.retention - 10, 60, 99);
                    break;
                case 'pmRatio':
                    upInp.pmRatio = clamp(inp.pmRatio + 15, 30, 95);
                    downInp.pmRatio = clamp(inp.pmRatio - 15, 30, 95);
                    break;
            }

            upCost = calcOpex(upInp).totalOpex;
            downCost = calcOpex(downInp).totalOpex;

            results.push({
                name: f.name,
                upVal: upCost,
                downVal: downCost,
                absSwing: Math.abs(upCost - downCost)
            });
        });

        // Sort by absolute swing descending
        results.sort(function(a, b) { return b.absSwing - a.absSwing; });

        return results;
    }

    // ============================================================
    // CANVAS: MONTE CARLO HISTOGRAM
    // ============================================================
    function drawMonteCarloChart(mc) {
        var canvas = document.getElementById('mclMonteCarloChart');
        if (!canvas) return;
        var ctx = canvas.getContext('2d');
        var W = canvas.width = canvas.offsetWidth || 600;
        var H = canvas.height = 220;
        ctx.clearRect(0, 0, W, H);

        var results = mc.results;
        var minV = results[0], maxV = results[results.length - 1];
        var range = maxV - minV || 1;
        var numBins = 50;
        var bins = new Array(numBins).fill(0);

        results.forEach(function(v) {
            var b = Math.min(Math.floor((v - minV) / range * numBins), numBins - 1);
            bins[b]++;
        });

        var maxBin = Math.max.apply(null, bins);
        var padL = 50, padR = 20, padT = 30, padB = 35;
        var chartW = W - padL - padR;
        var chartH = H - padT - padB;
        var barW = chartW / numBins;

        // Background
        ctx.fillStyle = 'rgba(15,23,42,0.6)';
        ctx.fillRect(0, 0, W, H);

        // Title
        ctx.fillStyle = '#e2e8f0';
        ctx.font = 'bold 12px Inter, sans-serif';
        ctx.textAlign = 'center';
        ctx.fillText('Monte Carlo OPEX Distribution (10K Simulations)', W / 2, 18);

        // Bars
        bins.forEach(function(c, i) {
            var x = padL + i * barW;
            var barH = maxBin > 0 ? (c / maxBin) * chartH : 0;
            var y = padT + chartH - barH;

            // Color based on percentile zone
            var binCenter = minV + (i + 0.5) * (range / numBins);
            if (binCenter <= mc.p25) ctx.fillStyle = 'rgba(16,185,129,0.8)';       // green - favorable
            else if (binCenter <= mc.p75) ctx.fillStyle = 'rgba(236,72,153,0.7)';   // pink - typical
            else if (binCenter <= mc.p95) ctx.fillStyle = 'rgba(245,158,11,0.8)';   // amber - elevated
            else ctx.fillStyle = 'rgba(239,68,68,0.8)';                              // red - tail risk

            ctx.fillRect(x + 0.5, y, barW - 1, barH);
        });

        // P50 line
        var p50x = padL + ((mc.p50 - minV) / range) * chartW;
        ctx.strokeStyle = '#fff';
        ctx.lineWidth = 1.5;
        ctx.setLineDash([4, 3]);
        ctx.beginPath();
        ctx.moveTo(p50x, padT);
        ctx.lineTo(p50x, padT + chartH);
        ctx.stroke();
        ctx.setLineDash([]);
        ctx.fillStyle = '#fff';
        ctx.font = '9px Inter, sans-serif';
        ctx.textAlign = 'center';
        ctx.fillText('P50: ' + fmt(mc.p50), p50x, padT - 4);

        // P95 line
        var p95x = padL + ((mc.p95 - minV) / range) * chartW;
        ctx.strokeStyle = '#ef4444';
        ctx.lineWidth = 1;
        ctx.setLineDash([3, 3]);
        ctx.beginPath();
        ctx.moveTo(p95x, padT);
        ctx.lineTo(p95x, padT + chartH);
        ctx.stroke();
        ctx.setLineDash([]);
        ctx.fillStyle = '#fca5a5';
        ctx.font = '9px Inter, sans-serif';
        ctx.fillText('P95: ' + fmt(mc.p95), p95x, padT + chartH + 12);

        // X-axis labels
        ctx.fillStyle = '#94a3b8';
        ctx.font = '9px Inter, sans-serif';
        ctx.textAlign = 'center';
        for (var t = 0; t <= 4; t++) {
            var xVal = minV + (range / 4) * t;
            var xPos = padL + (chartW / 4) * t;
            ctx.fillText(fmt(xVal), xPos, H - 5);
        }
    }

    // ============================================================
    // CANVAS: TORNADO CHART (Sensitivity)
    // ============================================================
    function drawTornadoChart(sensitivity, baseCost) {
        var canvas = document.getElementById('mclTornadoChart');
        if (!canvas) return;
        var ctx = canvas.getContext('2d');
        var W = canvas.width = canvas.offsetWidth || 600;
        var H = canvas.height = 200;
        ctx.clearRect(0, 0, W, H);

        // Background
        ctx.fillStyle = 'rgba(15,23,42,0.6)';
        ctx.fillRect(0, 0, W, H);

        // Title
        ctx.fillStyle = '#e2e8f0';
        ctx.font = 'bold 12px Inter, sans-serif';
        ctx.textAlign = 'center';
        ctx.fillText('Sensitivity Analysis (\u00B120% Factor Perturbation)', W / 2, 18);

        var padL = 110, padR = 30, padT = 32, padB = 10;
        var chartW = W - padL - padR;
        var barH = 22;
        var gap = 8;
        var startY = padT;
        var centerX = padL + chartW / 2;

        var maxSwing = 0;
        sensitivity.forEach(function(d) {
            var upDelta = Math.abs(d.upVal - baseCost);
            var downDelta = Math.abs(baseCost - d.downVal);
            maxSwing = Math.max(maxSwing, upDelta, downDelta);
        });
        if (maxSwing === 0) maxSwing = 1;
        var maxBarW = chartW / 2 - 20;

        // Baseline marker
        ctx.strokeStyle = 'rgba(255,255,255,0.3)';
        ctx.lineWidth = 1;
        ctx.setLineDash([2, 2]);
        ctx.beginPath();
        ctx.moveTo(centerX, startY - 4);
        ctx.lineTo(centerX, startY + sensitivity.length * (barH + gap));
        ctx.stroke();
        ctx.setLineDash([]);

        ctx.fillStyle = '#94a3b8';
        ctx.font = '9px Inter, sans-serif';
        ctx.textAlign = 'center';
        ctx.fillText('Baseline: ' + fmt(baseCost), centerX, startY - 8);

        sensitivity.forEach(function(d, i) {
            var y = startY + i * (barH + gap);
            var upWidth = d.absSwing > 0 ? (((d.upVal - baseCost) / maxSwing) * maxBarW) : 0;
            var downWidth = d.absSwing > 0 ? (((baseCost - d.downVal) / maxSwing) * maxBarW) : 0;

            // Handle cases where up is actually decrease and vice versa
            var rightBar = Math.max(0, upWidth);
            var leftBar = Math.max(0, downWidth);

            // Right bar (cost increase) - red
            if (rightBar > 0) {
                ctx.fillStyle = '#ef4444';
                ctx.beginPath();
                var rr = 3;
                ctx.moveTo(centerX, y);
                ctx.lineTo(centerX + rightBar - rr, y);
                ctx.quadraticCurveTo(centerX + rightBar, y, centerX + rightBar, y + rr);
                ctx.lineTo(centerX + rightBar, y + barH - rr);
                ctx.quadraticCurveTo(centerX + rightBar, y + barH, centerX + rightBar - rr, y + barH);
                ctx.lineTo(centerX, y + barH);
                ctx.closePath();
                ctx.fill();

                ctx.fillStyle = '#fca5a5';
                ctx.font = 'bold 9px Inter, sans-serif';
                ctx.textAlign = 'left';
                ctx.fillText('+' + fmt(d.upVal - baseCost), centerX + rightBar + 4, y + barH / 2 + 3);
            }

            // Left bar (cost decrease) - teal
            if (leftBar > 0) {
                ctx.fillStyle = '#06b6d4';
                ctx.beginPath();
                var rl = 3;
                ctx.moveTo(centerX, y);
                ctx.lineTo(centerX - leftBar + rl, y);
                ctx.quadraticCurveTo(centerX - leftBar, y, centerX - leftBar, y + rl);
                ctx.lineTo(centerX - leftBar, y + barH - rl);
                ctx.quadraticCurveTo(centerX - leftBar, y + barH, centerX - leftBar + rl, y + barH);
                ctx.lineTo(centerX, y + barH);
                ctx.closePath();
                ctx.fill();

                ctx.fillStyle = '#67e8f9';
                ctx.font = 'bold 9px Inter, sans-serif';
                ctx.textAlign = 'right';
                ctx.fillText('-' + fmt(baseCost - d.downVal), centerX - leftBar - 4, y + barH / 2 + 3);
            }

            // Label
            ctx.fillStyle = '#e2e8f0';
            ctx.font = '10px Inter, sans-serif';
            ctx.textAlign = 'right';
            ctx.fillText(d.name, centerX - maxBarW - 12, y + barH / 2 + 3);
        });
    }

    // ============================================================
    // PANEL 5: NARRATIVE GENERATOR (4 paragraphs)
    // ============================================================
    function generateNarrative(inp, opex, staff, risk, mc, sensitivity) {
        var r = inp.region;
        var countryLabel = inp.countryKey.replace(/-/g, ' ');
        var modelLabel = inp.staffModel.label || inp.staffModelKey;

        // 1. Executive Summary
        var execSummary = '<h5>Executive Summary</h5><p>' +
            'This ' + inp.loadMW.toFixed(1) + ' MW data center facility in <strong>' + countryLabel +
            '</strong> operating at PUE ' + inp.pue.toFixed(2) + ' with a <strong>' + modelLabel +
            '</strong> staffing model projects annual OPEX of <strong>' + fmt(opex.totalOpex) + '</strong> (' +
            fmt(opex.opexPerMW) + '/MW). Energy costs represent ' +
            pctFmt(opex.energyCost / opex.totalOpex * 100) + ' of total expenditure at a regional rate of $' +
            r.energyRate.toFixed(3) + '/kWh. The Monte Carlo simulation (10K iterations) indicates a P50 median cost of ' +
            fmt(mc.p50) + ' with 95th-percentile tail risk at ' + fmt(mc.p95) +
            ', yielding a CVaR-95 of ' + fmt(mc.cvar95) + '. The operational health score is <strong>' +
            risk.ohsLabel + '</strong>.</p>';

        // 2. Financial Analysis
        var finAnalysis = '<h5>Financial Analysis</h5><p>' +
            'The facility\'s OPEX structure breaks down to: energy ' + fmt(opex.energyCost) +
            ' (' + pctFmt(opex.energyCost / opex.totalOpex * 100) + '), labor ' + fmt(opex.laborBudget) +
            ' (' + pctFmt(opex.laborBudget / opex.totalOpex * 100) + '), and maintenance ' +
            fmt(opex.maintBudget) + ' (' + pctFmt(opex.maintBudget / opex.totalOpex * 100) +
            '). At ' + fmt(opex.costPerKW) + '/kW/month, this positions the facility ';

        if (opex.costPerKW < 8) finAnalysis += '<strong>below</strong> the industry benchmark range ($8\u201315/kW). ';
        else if (opex.costPerKW <= 15) finAnalysis += '<strong>within</strong> the industry benchmark range ($8\u201315/kW). ';
        else finAnalysis += '<strong>above</strong> the industry benchmark range ($8\u201315/kW), suggesting optimization opportunity. ';

        finAnalysis += 'Cash flow variance is estimated at ' + pctFmt(opex.cashVariance) +
            ' (target: <2%). The top sensitivity driver is <strong>' + sensitivity[0].name +
            '</strong> with \u00B1' + fmt(sensitivity[0].absSwing / 2) +
            ' impact per 20% swing. Financial exposure score is ' + risk.finExposure +
            '/100, and the cost of inaction (deferred maintenance) is estimated at ' +
            fmt(risk.coi) + '/year in prevented downtime losses.</p>';

        // 3. Workforce Assessment
        var workforceAssess = '<h5>Workforce Assessment</h5><p>' +
            'The ' + modelLabel + ' model requires <strong>' + staff.headcount + ' FTE</strong> for 24/7 operations ' +
            '(base positions \u00D7 4.2x shift multiplier). Staff utilization is projected at ' +
            pctFmt(staff.utilization) + ' with a burnout probability of ' + pctFmt(staff.burnoutProb) +
            ' (logistic model). ';

        if (staff.burnoutProb > 60) workforceAssess += '<span style="color:#f87171">Burnout risk is elevated \u2014 consider headcount augmentation or workload redistribution.</span> ';
        else if (staff.burnoutProb > 35) workforceAssess += 'Burnout risk is moderate \u2014 monitor fatigue indicators. ';
        else workforceAssess += 'Burnout risk is within acceptable range. ';

        workforceAssess += 'At ' + inp.retention + '% retention target, annual turnover cost is ' +
            fmt(staff.retentionCost) + '. Single points of failure (skill gap vulnerabilities): <strong>' +
            staff.spof + '</strong>. The Staffing Resilience Index is ' + staff.resilienceIdx +
            '/100, and HEP modifier is ' + (staff.hep * 1000).toFixed(2) + '\u00D710\u207B\u00B3 ' +
            '(industry baseline: 3.0\u00D710\u207B\u00B3). In/out-source break-even occurs at ' +
            staff.breakevenFTE + ' FTE.</p>';

        // 4. Strategic Recommendations
        var stratRec = '<h5>Strategic Recommendations</h5><p>';
        var recs = [];

        if (opex.energyCost / opex.totalOpex > 0.45)
            recs.push('Energy dominates OPEX at ' + pctFmt(opex.energyCost / opex.totalOpex * 100) + ' \u2014 prioritize PPA negotiations and PUE optimization');
        if (inp.pmRatio < 70)
            recs.push('PM ratio of ' + inp.pmRatio + '% is below best-in-class (80%+) \u2014 increasing preventive maintenance will reduce 5-year maintenance debt of ' + fmt(risk.maintDebt5yr));
        if (staff.burnoutProb > 50)
            recs.push('Burnout probability of ' + pctFmt(staff.burnoutProb) + ' is critical \u2014 add ' + Math.ceil(staff.headcount * 0.15) + ' FTE or implement rotation protocols');
        if (inp.retention < 80)
            recs.push('Retention target ' + inp.retention + '% is below industry benchmark (82%) \u2014 retention premium investment of ' + fmt(staff.retentionCost * 0.3) + ' could yield 2-3x ROI');
        if (mc.exceedProb > 15)
            recs.push('Budget exceedance probability at ' + pctFmt(mc.exceedProb) + ' \u2014 contingency reserve of ' + fmt(mc.cvar95 - mc.p50) + ' recommended');
        if (risk.affoPotential > 50000)
            recs.push('AFFO optimization potential: ' + fmt(risk.affoPotential) + '/year achievable through operational efficiency gains');
        if (recs.length === 0)
            recs.push('Facility metrics are within benchmark ranges \u2014 focus on continuous improvement and predictive maintenance adoption');

        stratRec += recs.map(function(r, i) { return '<strong>' + (i + 1) + '.</strong> ' + r; }).join('. ') + '.</p>';

        return execSummary + finAnalysis + workforceAssess + stratRec;
    }

    // ============================================================
    // MASTER UPDATE FUNCTION
    // ============================================================
    function updateAllPanels() {
        var inp = getInputs();
        var opex = calcOpex(inp);
        var staff = calcStaffing(inp, opex);
        var risk = calcRisk(inp, opex, staff);
        var mc = runMonteCarlo(inp, opex);
        var sensitivity = runSensitivity(inp, opex);

        // Panel 1: OPEX Financial Intelligence
        document.getElementById('mclEnergyCost').textContent = fmt(opex.energyCost);
        document.getElementById('mclLaborBudget').textContent = fmt(opex.laborBudget);
        document.getElementById('mclMaintBudget').textContent = fmt(opex.maintBudget);
        document.getElementById('mclTotalOpex').textContent = fmt(opex.totalOpex);
        document.getElementById('mclOpexPerMW').textContent = fmt(opex.opexPerMW);
        document.getElementById('mclCostPerKW').textContent = '$' + opex.costPerKW.toFixed(2);
        document.getElementById('mclCashVariance').textContent = pctFmt(opex.cashVariance);
        document.getElementById('mclAFFO').textContent = fmt(opex.affo);

        // Panel 2: Staffing Resilience
        document.getElementById('mclHeadcount').textContent = staff.headcount + ' FTE';
        document.getElementById('mclUtilization').textContent = pctFmt(staff.utilization);
        document.getElementById('mclBurnout').textContent = pctFmt(staff.burnoutProb);
        document.getElementById('mclBreakeven').textContent = staff.breakevenFTE + ' FTE';
        document.getElementById('mclRetentionCost').textContent = fmt(staff.retentionCost);
        document.getElementById('mclSkillGap').textContent = staff.spof + ' SPOFs';
        document.getElementById('mclResilienceIdx').textContent = staff.resilienceIdx + '/100';
        document.getElementById('mclHEP').textContent = (staff.hep * 1000).toFixed(2) + '\u00D710\u207B\u00B3';

        // Panel 3: Risk & Reliability
        document.getElementById('mclFinExposure').textContent = risk.finExposure + '/100';
        document.getElementById('mclCOI').textContent = fmt(risk.coi);
        document.getElementById('mclOHS').textContent = risk.ohsLabel;
        document.getElementById('mclPMCompliance').textContent = pctFmt(risk.pmCompliance);
        document.getElementById('mclAlarmEff').textContent = pctFmt(risk.alarmEff);
        document.getElementById('mclMaintDebt').textContent = fmt(risk.maintDebt5yr);
        document.getElementById('mclAFFOPotential').textContent = fmt(risk.affoPotential);

        // Panel 4: Monte Carlo
        document.getElementById('mclMCP5').textContent = fmt(mc.p5);
        document.getElementById('mclMCP25').textContent = fmt(mc.p25);
        document.getElementById('mclMCP50').textContent = fmt(mc.p50);
        document.getElementById('mclMCP75').textContent = fmt(mc.p75);
        document.getElementById('mclMCP95').textContent = fmt(mc.p95);
        document.getElementById('mclMCCVaR').textContent = fmt(mc.cvar95);
        document.getElementById('mclMCExceed').textContent = pctFmt(mc.exceedProb);
        document.getElementById('mclMCTopDriver').textContent = sensitivity[0].name;

        // Panel 5: Narrative
        document.getElementById('mclNarrativeText').innerHTML = generateNarrative(inp, opex, staff, risk, mc, sensitivity);

        // Draw charts if Pro mode is active
        if (mclProMode) {
            drawMonteCarloChart(mc);
            drawTornadoChart(sensitivity, opex.totalOpex);
        }

        // Show benchmark meta
        document.getElementById('mclBenchmarkMeta').style.display = mclProMode ? '' : 'none';
    }

    // ============================================================
    // AUTH FUNCTIONS
    // ============================================================
    function mclCheckAuth() {
        try {
            var s = JSON.parse(localStorage.getItem('rz_premium_session') || 'null');
            if (s && s.tier === 'pro' && new Date(s.expires) > new Date()) return true;
        } catch (e) {}
        return false;
    }

    function mclUnlockPanels() {
        mclProMode = true;
        document.querySelectorAll('.mcl-pro-panel').forEach(function(p) {
            p.style.display = '';
            p.classList.remove('gated');
            var overlay = p.querySelector('.mcl-gate-overlay');
            if (overlay) overlay.style.display = 'none';
        });
        document.getElementById('mclProBtn').classList.add('active');
        document.getElementById('mclFreeBtn').classList.remove('active');
        document.getElementById('mclProInputs').style.display = '';
        document.getElementById('mclBtnPdf').style.display = '';
        document.getElementById('mclCtaBlock').style.display = 'none';
        updateAllPanels();
    }

    function mclLockPanels() {
        mclProMode = false;
        document.querySelectorAll('.mcl-pro-panel').forEach(function(p) {
            p.style.display = 'none';
            p.classList.add('gated');
            var overlay = p.querySelector('.mcl-gate-overlay');
            if (overlay) overlay.style.display = '';
        });
        document.getElementById('mclFreeBtn').classList.add('active');
        document.getElementById('mclProBtn').classList.remove('active');
        document.getElementById('mclProInputs').style.display = 'none';
        document.getElementById('mclBtnPdf').style.display = 'none';
        document.getElementById('mclCtaBlock').style.display = '';
        document.getElementById('mclBenchmarkMeta').style.display = 'none';
    }

    // ============================================================
    // WINDOW-LEVEL FUNCTIONS (onclick handlers)
    // ============================================================
    window.mclSetMode = function(mode) {
        if (mode === 'pro') {
            if (mclCheckAuth()) { mclUnlockPanels(); }
            else { mclShowLogin(); }
        } else {
            mclLockPanels();
        }
    };

    window.mclShowLogin = function() {
        document.getElementById('mclLoginOverlay').classList.add('active');
        document.getElementById('mclLoginError').style.display = 'none';
        document.getElementById('mclLoginEmail').value = '';
        document.getElementById('mclLoginPass').value = '';
        setTimeout(function() { document.getElementById('mclLoginEmail').focus(); }, 100);
    };

    window.mclHideLogin = function() {
        document.getElementById('mclLoginOverlay').classList.remove('active');
    };

    window.mclDoLogin = function() {
        var email = document.getElementById('mclLoginEmail').value.trim().toLowerCase();
        var pass = document.getElementById('mclLoginPass').value;
        if (email === 'demo@resistancezero.com' && pass === 'demo2026') {
            var session = { email: email, tier: 'pro', expires: new Date(Date.now() + 24 * 60 * 60 * 1000).toISOString() };
            localStorage.setItem('rz_premium_session', JSON.stringify(session));
            window.dispatchEvent(new Event('rz-auth-change'));
            mclHideLogin();
            mclUnlockPanels();
        } else {
            document.getElementById('mclLoginError').style.display = 'block';
        }
    };

    // ============================================================
    // PDF EXPORT
    // ============================================================
    window.mclExportPDF = function() {
        if (!mclCheckAuth()) { mclShowLogin(); return; }
        var win = window.open('', '_blank');
        if (!win) { alert('Please allow popups for this site to export PDF.'); return; }

        var inp = getInputs();
        var opex = calcOpex(inp);
        var staff = calcStaffing(inp, opex);
        var risk = calcRisk(inp, opex, staff);
        var mc = runMonteCarlo(inp, opex);
        var sensitivity = runSensitivity(inp, opex);
        var narrativeHTML = generateNarrative(inp, opex, staff, risk, mc, sensitivity);

        var countryLabel = inp.countryKey.replace(/-/g, ' ');
        var modelLabel = inp.staffModel.label || inp.staffModelKey;

        // Build SVG histogram
        function buildHistogramSVG() {
            var results = mc.results;
            var minV = results[0], maxV = results[results.length - 1], range = maxV - minV || 1;
            var numBins = 40, bins = new Array(numBins).fill(0);
            results.forEach(function(v) { var b = Math.min(Math.floor((v - minV) / range * numBins), numBins - 1); bins[b]++; });
            var maxBin = Math.max.apply(null, bins);
            var svgW = 520, svgH = 200, barW = (svgW - 60) / numBins;
            var svg = '<svg xmlns="http://www.w3.org/2000/svg" width="' + svgW + '" height="' + svgH + '" viewBox="0 0 ' + svgW + ' ' + svgH + '">';
            svg += '<rect width="' + svgW + '" height="' + svgH + '" fill="#f8fafc"/>';
            svg += '<text x="' + (svgW / 2) + '" y="18" text-anchor="middle" fill="#1f2937" font-family="Inter,sans-serif" font-size="12" font-weight="bold">Monte Carlo OPEX Distribution (10K Simulations)</text>';
            bins.forEach(function(c, i) {
                var x = 30 + i * barW;
                var barH = maxBin > 0 ? (c / maxBin) * 140 : 0;
                var y = 175 - barH;
                var binCenter = minV + (i + 0.5) * (range / numBins);
                var color = binCenter <= mc.p25 ? '#10b981' : binCenter <= mc.p75 ? '#ec4899' : binCenter <= mc.p95 ? '#f59e0b' : '#ef4444';
                svg += '<rect x="' + x + '" y="' + y + '" width="' + (barW - 1) + '" height="' + barH + '" fill="' + color + '" rx="1"/>';
            });
            // P50 line
            var p50x = 30 + ((mc.p50 - minV) / range) * (svgW - 60);
            svg += '<line x1="' + p50x + '" y1="30" x2="' + p50x + '" y2="175" stroke="#1f2937" stroke-width="1.5" stroke-dasharray="4,3"/>';
            svg += '<text x="' + p50x + '" y="192" text-anchor="middle" fill="#1f2937" font-family="Inter,sans-serif" font-size="9">P50: ' + fmt(mc.p50) + '</text>';
            svg += '</svg>';
            return svg;
        }

        // Build SVG tornado
        function buildTornadoSVG() {
            var baseCost = opex.totalOpex;
            var svgW = 520, svgH = 200;
            var svg = '<svg xmlns="http://www.w3.org/2000/svg" width="' + svgW + '" height="' + svgH + '" viewBox="0 0 ' + svgW + ' ' + svgH + '">';
            svg += '<rect width="' + svgW + '" height="' + svgH + '" fill="#f8fafc"/>';
            svg += '<text x="' + (svgW / 2) + '" y="18" text-anchor="middle" fill="#1f2937" font-family="Inter,sans-serif" font-size="12" font-weight="bold">Sensitivity Analysis (\u00B120% Factor Perturbation)</text>';

            var centerX = svgW / 2 + 30;
            var startY = 35;
            var barH = 22, gap = 6;
            var maxSwing = 0;
            sensitivity.forEach(function(d) {
                maxSwing = Math.max(maxSwing, Math.abs(d.upVal - baseCost), Math.abs(baseCost - d.downVal));
            });
            if (maxSwing === 0) maxSwing = 1;
            var maxBarW = (svgW / 2) - 60;

            // Center line
            svg += '<line x1="' + centerX + '" y1="28" x2="' + centerX + '" y2="' + (startY + sensitivity.length * (barH + gap)) + '" stroke="#cbd5e1" stroke-width="1" stroke-dasharray="2,2"/>';

            sensitivity.forEach(function(d, i) {
                var y = startY + i * (barH + gap);
                var rightW = Math.max(0, ((d.upVal - baseCost) / maxSwing) * maxBarW);
                var leftW = Math.max(0, ((baseCost - d.downVal) / maxSwing) * maxBarW);

                if (rightW > 0) {
                    svg += '<rect x="' + centerX + '" y="' + y + '" width="' + rightW + '" height="' + barH + '" fill="#ef4444" rx="3"/>';
                    svg += '<text x="' + (centerX + rightW + 4) + '" y="' + (y + barH / 2 + 4) + '" fill="#ef4444" font-family="Inter,sans-serif" font-size="9" font-weight="bold">+' + fmt(d.upVal - baseCost) + '</text>';
                }
                if (leftW > 0) {
                    svg += '<rect x="' + (centerX - leftW) + '" y="' + y + '" width="' + leftW + '" height="' + barH + '" fill="#06b6d4" rx="3"/>';
                    svg += '<text x="' + (centerX - leftW - 4) + '" y="' + (y + barH / 2 + 4) + '" fill="#0891b2" font-family="Inter,sans-serif" font-size="9" font-weight="bold" text-anchor="end">-' + fmt(baseCost - d.downVal) + '</text>';
                }
                svg += '<text x="' + (centerX - maxBarW - 14) + '" y="' + (y + barH / 2 + 4) + '" fill="#1f2937" font-family="Inter,sans-serif" font-size="10" text-anchor="end">' + d.name + '</text>';
            });
            svg += '</svg>';
            return svg;
        }

        // Build PDF HTML
        var html = '<!DOCTYPE html><html><head><meta charset="UTF-8">' +
            '<title>MCL Pro OPEX Intelligence Report</title>' +
            '<style>' +
            'body{font-family:Inter,Segoe UI,sans-serif;color:#1f2937;margin:0;padding:30px 40px;font-size:11px;line-height:1.5}' +
            '.header{background:linear-gradient(135deg,#ec4899,#be185d);color:#fff;padding:24px 30px;border-radius:12px;margin-bottom:24px}' +
            '.header h1{margin:0 0 4px;font-size:20px}' +
            '.header p{margin:0;opacity:0.9;font-size:11px}' +
            '.meta-row{display:flex;gap:16px;margin-top:10px;flex-wrap:wrap}' +
            '.meta-tag{background:rgba(255,255,255,0.2);padding:3px 10px;border-radius:20px;font-size:9px}' +
            '.section{margin-bottom:18px;page-break-inside:avoid}' +
            '.section h2{font-size:14px;color:#be185d;border-bottom:2px solid #fce7f3;padding-bottom:4px;margin:0 0 10px}' +
            '.kpi-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:8px;margin-bottom:12px}' +
            '.kpi-card{background:#fdf2f8;border:1px solid #fbcfe8;border-radius:8px;padding:8px 10px;text-align:center}' +
            '.kpi-value{font-size:14px;font-weight:700;color:#be185d}' +
            '.kpi-label{font-size:8px;color:#6b7280;margin-top:2px}' +
            '.chart-container{text-align:center;margin:10px 0;page-break-inside:avoid}' +
            '.narrative{background:#fdf2f8;border-left:4px solid #ec4899;padding:12px 16px;border-radius:0 8px 8px 0;margin:8px 0;font-size:10px;line-height:1.6}' +
            '.narrative h5{color:#be185d;margin:8px 0 4px;font-size:11px}' +
            '.narrative p{margin:0 0 8px}' +
            '.chart-row{display:flex;gap:16px;margin:10px 0;page-break-inside:avoid}.chart-row>div{flex:1;min-width:0}' +
            '.input-table{width:100%;border-collapse:collapse;margin:10px 0}.input-table td{padding:6px 10px;border:1px solid #fce7f3;font-size:10px}.input-table td:nth-child(odd){font-weight:600;background:#fdf2f8;width:30%}' +
            '.rec-badge{display:inline-block;padding:2px 8px;border-radius:4px;font-size:9px;font-weight:700;margin-right:4px}.rec-p1{background:#fef2f2;color:#dc2626}.rec-p2{background:#fffbeb;color:#d97706}.rec-p3{background:#ecfdf5;color:#059669}' +
            '.footer{margin-top:20px;padding-top:12px;border-top:2px solid #fce7f3;font-size:8px;color:#9ca3af;text-align:center}' +
            '@media print{body{padding:15px 20px}@page{margin:12mm;size:A4}}' +
            '</style></head><body>' +
            '<div class="header">' +
            '<h1>Mission Critical Lifecycle \u2014 OPEX Intelligence Report</h1>' +
            '<p>' + countryLabel + ' | ' + inp.loadMW.toFixed(1) + ' MW | PUE ' + inp.pue.toFixed(2) + ' | ' + modelLabel + ' | Retention ' + inp.retention + '% | PM Ratio ' + inp.pmRatio + '%</p>' +
            '<div class="meta-row">' +
            '<span class="meta-tag">CBRE H2 2025</span>' +
            '<span class="meta-tag">Uptime Staffing 2025</span>' +
            '<span class="meta-tag">10K MC Iterations</span>' +
            '<span class="meta-tag">20 Regions</span>' +
            '<span class="meta-tag">Generated: ' + new Date().toLocaleDateString() + '</span>' +
            '</div></div>' +

            // Input Parameters Table (2-col)
            '<div class="section"><h2>Input Parameters</h2>' +
            '<table class="input-table"><tr><td>Country / Region</td><td>' + countryLabel + '</td><td>IT Load</td><td>' + inp.loadMW.toFixed(1) + ' MW</td></tr>' +
            '<tr><td>Power Usage Effectiveness</td><td>' + inp.pue.toFixed(2) + '</td><td>Staffing Model</td><td>' + modelLabel + '</td></tr>' +
            '<tr><td>Staff Retention Rate</td><td>' + inp.retention + '%</td><td>PM Ratio (Preventive)</td><td>' + inp.pmRatio + '%</td></tr></table></div>' +

            // Panel 1 KPIs
            '<div class="section"><h2>OPEX Financial Intelligence</h2>' +
            '<div class="kpi-grid">' +
            '<div class="kpi-card"><div class="kpi-value">' + fmt(opex.energyCost) + '</div><div class="kpi-label">Annual Energy Cost</div></div>' +
            '<div class="kpi-card"><div class="kpi-value">' + fmt(opex.laborBudget) + '</div><div class="kpi-label">Annual Labor Budget</div></div>' +
            '<div class="kpi-card"><div class="kpi-value">' + fmt(opex.maintBudget) + '</div><div class="kpi-label">Maintenance Budget</div></div>' +
            '<div class="kpi-card"><div class="kpi-value">' + fmt(opex.totalOpex) + '</div><div class="kpi-label">Total Annual OPEX</div></div>' +
            '<div class="kpi-card"><div class="kpi-value">' + fmt(opex.opexPerMW) + '</div><div class="kpi-label">OPEX per MW</div></div>' +
            '<div class="kpi-card"><div class="kpi-value">$' + opex.costPerKW.toFixed(2) + '</div><div class="kpi-label">Cost per kW/month</div></div>' +
            '<div class="kpi-card"><div class="kpi-value">' + pctFmt(opex.cashVariance) + '</div><div class="kpi-label">Cash Flow Variance</div></div>' +
            '<div class="kpi-card"><div class="kpi-value">' + fmt(opex.affo) + '</div><div class="kpi-label">AFFO Impact</div></div>' +
            '</div></div>' +

            // Panel 2 KPIs
            '<div class="section"><h2>Staffing Resilience Analysis</h2>' +
            '<div class="kpi-grid">' +
            '<div class="kpi-card"><div class="kpi-value">' + staff.headcount + ' FTE</div><div class="kpi-label">Optimal Headcount</div></div>' +
            '<div class="kpi-card"><div class="kpi-value">' + pctFmt(staff.utilization) + '</div><div class="kpi-label">Utilization Rate</div></div>' +
            '<div class="kpi-card"><div class="kpi-value">' + pctFmt(staff.burnoutProb) + '</div><div class="kpi-label">Burnout Probability</div></div>' +
            '<div class="kpi-card"><div class="kpi-value">' + staff.breakevenFTE + ' FTE</div><div class="kpi-label">In/Out Break-Even</div></div>' +
            '<div class="kpi-card"><div class="kpi-value">' + fmt(staff.retentionCost) + '</div><div class="kpi-label">Retention Premium</div></div>' +
            '<div class="kpi-card"><div class="kpi-value">' + staff.spof + ' SPOFs</div><div class="kpi-label">Single Points of Failure</div></div>' +
            '<div class="kpi-card"><div class="kpi-value">' + staff.resilienceIdx + '/100</div><div class="kpi-label">Staffing Resilience Index</div></div>' +
            '<div class="kpi-card"><div class="kpi-value">' + (staff.hep * 1000).toFixed(2) + '\u00D710\u207B\u00B3</div><div class="kpi-label">HEP Modifier</div></div>' +
            '</div></div>' +

            // Panel 3 KPIs
            '<div class="section"><h2>Risk & Reliability Dashboard</h2>' +
            '<div class="kpi-grid">' +
            '<div class="kpi-card"><div class="kpi-value">' + risk.finExposure + '/100</div><div class="kpi-label">Financial Exposure</div></div>' +
            '<div class="kpi-card"><div class="kpi-value">' + fmt(risk.coi) + '</div><div class="kpi-label">Cost of Inaction</div></div>' +
            '<div class="kpi-card"><div class="kpi-value">' + risk.ohsLabel + '</div><div class="kpi-label">Operational Health Score</div></div>' +
            '<div class="kpi-card"><div class="kpi-value">' + pctFmt(risk.pmCompliance) + '</div><div class="kpi-label">PM Compliance Rate</div></div>' +
            '<div class="kpi-card"><div class="kpi-value">' + pctFmt(risk.alarmEff) + '</div><div class="kpi-label">Alarm Efficiency</div></div>' +
            '<div class="kpi-card"><div class="kpi-value">' + fmt(risk.maintDebt5yr) + '</div><div class="kpi-label">5-Year Maint. Debt</div></div>' +
            '<div class="kpi-card"><div class="kpi-value">' + fmt(risk.affoPotential) + '</div><div class="kpi-label">AFFO Optimization</div></div>' +
            '</div></div>' +

            // Panel 4 KPIs + Charts
            '<div class="section"><h2>Monte Carlo OPEX Simulation (10K Iterations)</h2>' +
            '<div class="kpi-grid">' +
            '<div class="kpi-card"><div class="kpi-value">' + fmt(mc.p5) + '</div><div class="kpi-label">P5 (Best Case)</div></div>' +
            '<div class="kpi-card"><div class="kpi-value">' + fmt(mc.p50) + '</div><div class="kpi-label">P50 (Median)</div></div>' +
            '<div class="kpi-card"><div class="kpi-value">' + fmt(mc.p95) + '</div><div class="kpi-label">P95 (Worst Case)</div></div>' +
            '<div class="kpi-card"><div class="kpi-value">' + fmt(mc.cvar95) + '</div><div class="kpi-label">CVaR @ 95%</div></div>' +
            '<div class="kpi-card"><div class="kpi-value">' + pctFmt(mc.exceedProb) + '</div><div class="kpi-label">Budget Exceedance</div></div>' +
            '<div class="kpi-card"><div class="kpi-value">' + fmt(mc.p25) + '</div><div class="kpi-label">P25</div></div>' +
            '<div class="kpi-card"><div class="kpi-value">' + fmt(mc.p75) + '</div><div class="kpi-label">P75</div></div>' +
            '<div class="kpi-card"><div class="kpi-value">' + sensitivity[0].name + '</div><div class="kpi-label">Highest Impact Factor</div></div>' +
            '</div>' +
            '<div class="chart-row"><div>' + buildHistogramSVG() + '</div><div>' + buildTornadoSVG() + '</div></div>' +
            '</div>' +

            // Recommendations
            '<div class="section"><h2>Priority Recommendations</h2>' +
            '<table style="width:100%;border-collapse:collapse"><tr><th style="padding:6px 10px;text-align:left;background:#fdf2f8;border:1px solid #fce7f3;font-size:10px">Priority</th><th style="padding:6px 10px;text-align:left;background:#fdf2f8;border:1px solid #fce7f3;font-size:10px">Action</th><th style="padding:6px 10px;text-align:left;background:#fdf2f8;border:1px solid #fce7f3;font-size:10px">Impact</th></tr>';
        // Dynamic recommendations based on results
        var recs = [];
        if (opex.costPerKW > 200) recs.push({p:1,a:'Optimize power chain efficiency — cost per kW exceeds industry benchmark',i:'$' + fmt(opex.costPerKW * inp.loadMW * 1000 * 0.1) + ' annual savings'});
        else recs.push({p:3,a:'Power cost within benchmark — maintain current procurement strategy',i:'Cost efficiency maintained'});
        if (staff.burnoutProb > 0.3) recs.push({p:1,a:'Address staffing burnout risk (' + (staff.burnoutProb * 100).toFixed(0) + '%) — increase headcount or reduce shift overlap',i:'Reduce turnover cost by ' + fmt(staff.retentionCost * 0.3)});
        if (staff.spof > 2) recs.push({p:2,a:'Mitigate ' + staff.spof + ' single points of failure in staffing — cross-train critical roles',i:'Reduce operational risk by ' + (staff.spof * 8) + '%'});
        if (risk.pmCompliance < 0.85) recs.push({p:1,a:'PM compliance at ' + (risk.pmCompliance * 100).toFixed(0) + '% — below 85% threshold, implement CMMS tracking',i:'Avoid ' + fmt(risk.maintDebt5yr * 0.2) + ' in deferred maintenance'});
        else recs.push({p:3,a:'PM compliance strong at ' + (risk.pmCompliance * 100).toFixed(0) + '% — sustain current maintenance cadence',i:'5yr debt controlled'});
        if (mc.exceedProb > 0.2) recs.push({p:2,a:'Budget exceedance probability ' + (mc.exceedProb * 100).toFixed(0) + '% — set contingency reserve at P75 (' + fmt(mc.p75) + ')',i:'Reduce budget overrun risk'});
        recs.sort(function(a, b) { return a.p - b.p; });
        recs.forEach(function(rc) {
            html += '<tr><td style="padding:6px 10px;border:1px solid #fce7f3;font-size:10px"><span class="rec-badge rec-p' + rc.p + '">' + (rc.p === 1 ? 'P1-Critical' : rc.p === 2 ? 'P2-High' : 'P3-Sustain') + '</span></td><td style="padding:6px 10px;border:1px solid #fce7f3;font-size:10px">' + rc.a + '</td><td style="padding:6px 10px;border:1px solid #fce7f3;font-size:10px">' + rc.i + '</td></tr>';
        });
        html += '</table></div>' +

            // Panel 5 Narrative
            '<div class="section"><h2>AI-Generated Executive Report</h2>' +
            '<div class="narrative">' + narrativeHTML + '</div>' +
            '</div>' +

            // Footer
            '<div class="footer">' +
            'ResistanceZero \u2014 Mission Critical Lifecycle Pro Report | Generated ' + new Date().toISOString().slice(0, 10) +
            ' | Client-side computation, no data transmitted | \u00A9 2026 ResistanceZero' +
            '</div>' +

        html+='</body></html>';

        win.document.write(html);
        win.document.close();
        setTimeout(function() { win.print(); }, 600);
    };

    // ============================================================
    // EVENT LISTENERS
    // ============================================================

    // Enter key in login
    document.getElementById('mclLoginPass').addEventListener('keydown', function(e) {
        if (e.key === 'Enter') mclDoLogin();
    });
    document.getElementById('mclLoginEmail').addEventListener('keydown', function(e) {
        if (e.key === 'Enter') document.getElementById('mclLoginPass').focus();
    });

    // Close on overlay click
    document.getElementById('mclLoginOverlay').addEventListener('click', function(e) {
        if (e.target === this) mclHideLogin();
    });

    // Pro input change listeners
    ['mclCountry', 'mclLoad', 'mclPUE', 'mclStaffModel', 'mclRetention', 'mclPMRatio'].forEach(function(id) {
        var el = document.getElementById(id);
        if (el) {
            el.addEventListener('change', function() { if (mclProMode) updateAllPanels(); });
            el.addEventListener('input', function() { if (mclProMode) updateAllPanels(); });
        }
    });

    // Listen for auth changes (from auth.js or other articles)
    window.addEventListener('rz-auth-change', function() {
        if (mclCheckAuth()) mclUnlockPanels();
        else mclLockPanels();
    });

    // Auto-unlock on load if already authenticated
    if (mclCheckAuth()) {
        mclUnlockPanels();
    }

})();
</script>
<script src="auth.js"></script>
<script src="rz-tracker.js"></script>
</body>
</html>
