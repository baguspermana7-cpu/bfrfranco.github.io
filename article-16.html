<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-GED7FX8RTV"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-GED7FX8RTV');
    </script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <!-- SEO Meta Tags -->
    <title>The SEA Data Center Bubble | $37B Risk | ResistanceZero</title>
    <meta name="description" content="6,068 MW pipeline in Southeast Asia. Johor's 5.8 GW gamble, Indonesia at 1,717 MW. Interactive bubble risk calculator and market analysis.">
    <meta name="keywords" content="Data Center Bubble, Southeast Asia, Oversupply, Colocation, Hyperscaler, Johor Malaysia, Indonesia DCII, Investment Risk, AI Infrastructure, Data Center Market">
    <meta name="author" content="Bagus Dwi Permana">
    <meta name="robots" content="index, follow">
    <meta name="theme-color" content="#d97706">
    <link rel="canonical" href="https://resistancezero.com/article-16.html">

    <link rel="alternate" hreflang="en" href="https://resistancezero.com/article-16.html">

    <!-- Resource Hints -->
    <link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin>
    <link rel="preconnect" href="https://www.googletagmanager.com" crossorigin>
    <link rel="dns-prefetch" href="https://cdn.jsdelivr.net">
    <link rel="dns-prefetch" href="https://www.googletagmanager.com">
    <!-- Open Graph Meta Tags -->
    <meta property="og:type" content="article">
    <meta property="og:url" content="https://resistancezero.com/article-16.html">
    <meta property="og:title" content="The Great SEA Data Center Bubble: When $37 Billion Bets on a Promise">
    <meta property="og:description" content="6,068 MW pipeline. $37B invested. Is Southeast Asia's data center boom heading for a crash? Interactive bubble risk calculator inside.">
    <meta property="og:image" content="https://resistancezero.com/assets/article-16-cover.jpg">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="669">
    <meta property="og:image:alt" content="Southeast Asia Data Center Bubble Analysis - Supply vs Demand visualization">
    <meta property="og:locale" content="en_US">
    <meta property="og:site_name" content="Bagus Dwi Permana Portfolio">
    <meta property="article:author" content="Bagus Dwi Permana">
    <meta property="article:published_time" content="2026-02-14T00:00:00Z">
    <meta property="article:modified_time" content="2026-02-17T00:00:00Z">
    <meta property="article:section" content="Industry Analysis">
    <meta property="article:tag" content="Data Center Bubble">
    <meta property="article:tag" content="Southeast Asia">
    <meta property="article:tag" content="Investment Risk">
    <meta property="article:tag" content="Oversupply">

    <!-- Twitter Card Meta Tags -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@BagusDPermana">
    <meta name="twitter:creator" content="@BagusDPermana">
    <meta name="twitter:title" content="The Great SEA Data Center Bubble: $37B Bets on a Promise">
    <meta name="twitter:description" content="6,068 MW pipeline. Johor's 5.8 GW gamble. Is SEA building a DC bubble? Deep analysis + interactive calculator.">
    <meta name="twitter:image" content="https://resistancezero.com/assets/article-16-cover.jpg">
    <meta name="twitter:image:alt" content="Southeast Asia Data Center Bubble Analysis">

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
    <link rel="icon" type="image/png" href="assets/Favicon.png">
    <link rel="apple-touch-icon" href="assets/Favicon.png">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link rel="stylesheet" href="styles.css">
    <link rel="preload" as="image" href="assets/article-16-cover.jpg">

    <!-- Structured Data -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "TechnicalArticle",
        "headline": "The Great Southeast Asian Data Center Bubble: When $37 Billion Bets on a Promise",
        "description": "Deep analysis of SEA data center oversupply risk, Indonesia market dynamics, hyperscaler dependency, legacy DC stranded assets, and investment implications with interactive bubble risk calculator.",
        "image": "https://resistancezero.com/assets/article-16-cover.jpg",
        "author": {
            "@type": "Person",
            "name": "Bagus Dwi Permana",
            "jobTitle": "Engineering Operations Manager",
            "sameAs": ["https://www.linkedin.com/in/bagus-dwi-permana-ba90b092/", "https://resistancezero.com"]
        },
        "publisher": {
            "@type": "Organization",
            "name": "ResistanceZero",
            "url": "https://resistancezero.com",
            "logo": {"@type": "ImageObject", "url": "https://resistancezero.com/assets/Favicon.png"}
        },
        "datePublished": "2026-02-14",
        "dateModified": "2026-02-14",
        "wordCount": "10000",
        "articleSection": "Industry Analysis",
        "keywords": ["Data Center Bubble", "Southeast Asia", "Oversupply", "Colocation", "Hyperscaler Dependency", "Indonesia", "Malaysia Johor", "Investment Risk"],
        "mainEntityOfPage": {"@type": "WebPage", "@id": "https://resistancezero.com/article-16.html"}
    }
    </script>

    <!-- FAQ Schema -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "FAQPage",
        "mainEntity": [
            {
                "@type": "Question",
                "name": "Is Southeast Asia experiencing a data center bubble?",
                "acceptedAnswer": {"@type": "Answer", "text": "With 6,068 MW of new capacity planned across SEA and $37B+ invested, there are significant oversupply indicators — particularly in Johor, Malaysia (5.8 GW pipeline) and parts of Thailand. While Singapore remains undersupplied (2% vacancy), speculative builds without anchor tenants face material risk of oversupply by 2027-2029."}
            },
            {
                "@type": "Question",
                "name": "How much data center capacity is being built in Johor, Malaysia?",
                "acceptedAnswer": {"@type": "Answer", "text": "Johor has a staggering 5.8 GW pipeline: 487 MW operational, 422 MW under construction, 1.4 GW committed (land and power secured), and 3.4 GW in early-stage planning — for a state with only 3.8 million residents."}
            },
            {
                "@type": "Question",
                "name": "What is the Indonesia data center market size in 2026?",
                "acceptedAnswer": {"@type": "Answer", "text": "Indonesia's installed data center capacity reached approximately 1,717 MW in 2026, with Jakarta retaining 56.7% of national capacity. The market is forecast to reach 4,145 MW by 2031 at a 19.27% CAGR."}
            },
            {
                "@type": "Question",
                "name": "What happens to legacy data centers that cannot support AI workloads?",
                "acceptedAnswer": {"@type": "Answer", "text": "Legacy data centers (pre-2015, 5-10 kW/rack) face stranded asset risk. They cannot support modern AI workloads requiring 50-100 kW/rack with liquid cooling. Retrofit to AI-ready specs is largely impractical due to structural, electrical, and cooling limitations. These facilities face a dual squeeze: losing enterprise tenants to cloud and unable to attract hyperscaler tenants."}
            }
        ]
    }
    </script>

    <!-- BreadcrumbList Schema -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "BreadcrumbList",
        "itemListElement": [
            {"@type": "ListItem", "position": 1, "name": "Home", "item": "https://resistancezero.com/"},
            {"@type": "ListItem", "position": 2, "name": "Articles", "item": "https://resistancezero.com/articles.html"},
            {"@type": "ListItem", "position": 3, "name": "The Great SEA Data Center Bubble", "item": "https://resistancezero.com/article-16.html"}
        ]
    }
    </script>

    <style>
        :root {
            --bubble-amber: #d97706;
            --bubble-orange: #ea580c;
            --bubble-yellow: #eab308;
            --bubble-red: #dc2626;
            --bubble-dark: #78350f;
            --safe-green: #059669;
            --safe-blue: #2563eb;
            --spacing-xs: 0.25rem;
            --spacing-sm: 0.5rem;
            --spacing-md: 1rem;
            --spacing-lg: 1.5rem;
            --spacing-xl: 2rem;
            --spacing-2xl: 3rem;
        }

        .article-hero {
            background: linear-gradient(135deg, #1a0f00 0%, #451a03 40%, #78350f 70%, #92400e 100%);
            padding: 7rem 2rem 3.5rem;
            color: #fff;
            text-align: center;
            position: relative;
            overflow: hidden;
        }
        .article-hero::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            background:
                radial-gradient(circle at 20% 80%, rgba(217, 119, 6, 0.3) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(234, 88, 12, 0.2) 0%, transparent 50%);
            z-index: 0;
        }
        .article-hero::after {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            background: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M30 5 L35 25 L55 30 L35 35 L30 55 L25 35 L5 30 L25 25 Z' fill='%23d97706' fill-opacity='0.04'/%3E%3C/svg%3E");
            opacity: 0.5;
            z-index: 0;
        }
        .article-hero > * { position: relative; z-index: 1; }
        .article-hero .container { max-width: 1000px; margin: 0 auto; }

        .article-category {
            display: inline-block;
            background: rgba(217, 119, 6, 0.2);
            color: #fcd34d;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-size: 0.875rem;
            font-weight: 600;
            margin-bottom: 1.5rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            border: 1px solid rgba(217, 119, 6, 0.3);
        }
        .article-title {
            font-size: clamp(1.6rem, 3.2vw, 2.35rem);
            font-weight: 800;
            margin-bottom: 1.25rem;
            line-height: 1.25;
            color: #fff;
            letter-spacing: -0.01em;
        }
        .article-title .highlight {
            background: linear-gradient(90deg, #f59e0b, #ef4444);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        .article-subtitle {
            font-size: clamp(0.95rem, 1.6vw, 1.15rem);
            color: #94a3b8;
            max-width: 720px;
            margin: 0 auto 1.75rem;
            line-height: 1.7;
        }
        .article-meta {
            display: flex;
            justify-content: center;
            gap: 2rem;
            flex-wrap: wrap;
            color: #94a3b8;
            font-size: 0.9375rem;
        }
        .article-meta-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        .back-link {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            color: #94a3b8;
            margin-bottom: 2rem;
            font-weight: 500;
            transition: color 0.3s ease;
            text-decoration: none;
        }
        .back-link:hover { color: #fff; }

        .jump-to-calc {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            margin-top: 1.5rem;
            padding: 0.875rem 1.75rem;
            background: linear-gradient(135deg, #d97706 0%, #ea580c 100%);
            color: #fff;
            border: none;
            border-radius: 30px;
            font-size: 0.9rem;
            font-weight: 700;
            text-decoration: none;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 20px rgba(217, 119, 6, 0.4);
            animation: pulse-glow 2s ease-in-out infinite;
        }
        .jump-to-calc:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 30px rgba(217, 119, 6, 0.6);
        }
        @keyframes pulse-glow {
            0%, 100% { box-shadow: 0 4px 20px rgba(217, 119, 6, 0.4); }
            50% { box-shadow: 0 4px 30px rgba(217, 119, 6, 0.7); }
        }

        .bubble-badge {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            background: linear-gradient(135deg, #d97706 0%, #ea580c 100%);
            color: #fff;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 700;
            margin-bottom: 1rem;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        /* Article Content */
        .article-content {
            padding: 4rem 2rem;
            background: #fff;
        }
        .article-content .container { max-width: 900px; margin: 0 auto; }
        .article-body {
            font-size: 0.95rem;
            line-height: 1.7;
            color: #374151;
        }
        .article-body p { margin-bottom: 1rem; }
        .article-body h2 {
            font-size: 1.4rem;
            color: #92400e;
            margin: var(--spacing-xl) 0 var(--spacing-md);
            padding-bottom: var(--spacing-sm);
            border-bottom: 3px solid #fde68a;
        }
        .article-body h3 {
            font-size: 1.1rem;
            color: #b45309;
            margin: var(--spacing-lg) 0 var(--spacing-sm);
        }
        .article-body h4 {
            font-size: 0.9rem;
            color: #92400e;
            margin: var(--spacing-md) 0 var(--spacing-sm);
        }
        .article-body blockquote {
            background: linear-gradient(135deg, #fffbeb 0%, #fef3c7 100%);
            border-left: 4px solid #d97706;
            padding: var(--spacing-lg) var(--spacing-xl);
            margin: var(--spacing-lg) 0;
            border-radius: 0 12px 12px 0;
            font-style: italic;
            color: #92400e;
            font-size: 1rem;
        }
        .article-body ul, .article-body ol {
            margin: 1.5rem 0;
            padding-left: 1.5rem;
        }
        .article-body li {
            margin-bottom: 0.5rem;
            color: #374151;
        }
        .article-body a {
            color: #d97706;
            text-decoration: none;
            border-bottom: 1px solid rgba(217, 119, 6, 0.3);
            transition: all 0.3s ease;
        }
        .article-body a:hover { border-bottom-color: #d97706; }

        /* Warning Box */
        .warning-box {
            background: linear-gradient(135deg, #451a03 0%, #78350f 100%);
            border-radius: 16px;
            padding: 2rem;
            margin: 2.5rem 0;
            border: 2px solid #d97706;
            position: relative;
            overflow: hidden;
        }
        .warning-box::before {
            content: '';
            position: absolute;
            top: 0; right: 0;
            width: 150px; height: 150px;
            background: radial-gradient(circle, rgba(217, 119, 6, 0.3) 0%, transparent 70%);
        }
        .warning-box h4 {
            color: #fcd34d;
            font-size: 0.95rem;
            margin-bottom: 0.75rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        .warning-box p {
            color: #e5e7eb;
            margin-bottom: 0.5rem;
            font-size: 0.9rem;
        }
        .warning-box .stat-highlight {
            color: #fbbf24;
            font-weight: 700;
            font-size: 1.25rem;
            font-family: 'JetBrains Mono', monospace;
        }

        /* Danger Box */
        .danger-box {
            background: linear-gradient(135deg, #fef2f2 0%, #fecaca 100%);
            border-radius: 12px;
            padding: 1.5rem 2rem;
            margin: 2rem 0;
            border-left: 4px solid #dc2626;
        }
        .danger-box p { margin: 0; color: #991b1b; }

        /* Caution Box */
        .caution-box {
            background: linear-gradient(135deg, #fffbeb 0%, #fef3c7 100%);
            border-radius: 12px;
            padding: 1.5rem 2rem;
            margin: 2rem 0;
            border-left: 4px solid #d97706;
        }
        .caution-box p { margin: 0; color: #92400e; }

        /* Safe Box */
        .safe-box {
            background: linear-gradient(135deg, #ecfdf5 0%, #d1fae5 100%);
            border-radius: 12px;
            padding: 1.5rem 2rem;
            margin: 2rem 0;
            border-left: 4px solid #059669;
        }
        .safe-box p { margin: 0; color: #065f46; }

        /* Policy Box */
        .policy-box {
            background: linear-gradient(135deg, #eff6ff 0%, #dbeafe 100%);
            border-radius: 12px;
            padding: 1.5rem 2rem;
            margin: 2rem 0;
            border-left: 4px solid #2563eb;
        }
        .policy-box p { margin: 0; color: #1e40af; }

        /* Data Tables */
        .data-table-container { overflow-x: auto; margin: 2rem 0; }
        .data-table { width: 100%; border-collapse: collapse; font-size: 0.85rem; }
        .data-table th, .data-table td { padding: 0.875rem 1rem; text-align: left; border-bottom: 1px solid #e2e8f0; }
        .data-table th { background: #78350f; color: #fff; font-weight: 600; white-space: nowrap; }
        .data-table tr:hover { background: #fffbeb; }
        .data-table .highlight-row { background: #fef3c7; font-weight: 600; }
        .table-source { font-size: 0.8rem; color: #64748b; margin-top: 0.5rem; font-style: italic; }

        /* Comparison Grid */
        .comparison-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
            margin: 2rem 0;
        }
        .comparison-card {
            background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
            border-radius: 12px;
            padding: 1.5rem;
            border: 1px solid #e2e8f0;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        .comparison-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 12px 40px rgba(0,0,0,0.1);
        }
        .comparison-card.risk-high {
            background: linear-gradient(135deg, #fef2f2 0%, #fecaca 100%);
            border-color: #fca5a5;
        }
        .comparison-card.risk-medium {
            background: linear-gradient(135deg, #fffbeb 0%, #fef3c7 100%);
            border-color: #fde68a;
        }
        .comparison-card.risk-low {
            background: linear-gradient(135deg, #ecfdf5 0%, #d1fae5 100%);
            border-color: #a7f3d0;
        }
        .comparison-card .card-icon { font-size: 2rem; margin-bottom: 0.75rem; }
        .comparison-card .card-title { font-size: 0.95rem; font-weight: 700; margin-bottom: 0.5rem; }
        .comparison-card .card-value {
            font-size: 1.5rem;
            font-weight: 800;
            font-family: 'JetBrains Mono', monospace;
            margin-bottom: 0.25rem;
        }
        .comparison-card .card-desc { font-size: 0.8rem; color: #64748b; }

        /* Bubble Calculator */
        .bubble-calculator {
            background: linear-gradient(135deg, #451a03 0%, #78350f 100%);
            border-radius: 20px;
            padding: 2.5rem;
            margin: 3rem 0;
            color: #fff;
        }
        .calc-title {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }
        .calc-subtitle { color: #d6d3d1; margin-bottom: 2rem; font-size: 0.9rem; }
        .calc-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }
        .calc-input-group {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }
        .calc-input-group label {
            font-size: 0.8rem;
            color: #d6d3d1;
            font-weight: 500;
        }
        .calc-input-group select,
        .calc-input-group input {
            background: rgba(255,255,255,0.1);
            border: 1px solid rgba(255,255,255,0.2);
            border-radius: 8px;
            padding: 0.75rem 1rem;
            color: #fff;
            font-size: 0.95rem;
            font-family: 'JetBrains Mono', monospace;
            transition: all 0.3s ease;
        }
        .calc-input-group select:focus,
        .calc-input-group input:focus {
            outline: none;
            border-color: #f59e0b;
            background: rgba(245, 158, 11, 0.1);
        }
        .calc-input-group select option { background: #451a03; color: #fff; }
        .calc-button {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            background: linear-gradient(135deg, #d97706 0%, #ea580c 100%);
            color: #fff;
            border: none;
            border-radius: 10px;
            padding: 0.875rem 1.75rem;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(217, 119, 6, 0.3);
        }
        .calc-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(217, 119, 6, 0.4);
        }
        .calc-results {
            display: none;
            margin-top: 2rem;
        }
        .calc-results.show { display: block; }
        .results-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
            gap: 1rem;
            background: rgba(0,0,0,0.3);
            border-radius: 12px;
            padding: 1.5rem;
        }
        .result-item {
            text-align: center;
            padding: 1rem;
            background: rgba(255,255,255,0.05);
            border-radius: 8px;
        }
        .result-item .label {
            font-size: 0.7rem;
            color: #d6d3d1;
            margin-bottom: 0.5rem;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        .result-item .value {
            font-size: 1.4rem;
            font-weight: 700;
            font-family: 'JetBrains Mono', monospace;
        }
        .result-item .value.green { color: #34d399; }
        .result-item .value.amber { color: #fbbf24; }
        .result-item .value.red { color: #f87171; }
        .result-item .subtext { font-size: 0.7rem; color: #a8a29e; margin-top: 0.25rem; }
        .result-item .value.blue { color: #60a5fa; }

        /* Tooltips */
        .calc-tooltip {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 16px;
            height: 16px;
            background: rgba(255,255,255,0.15);
            color: #fbbf24;
            border-radius: 50%;
            font-size: 0.65rem;
            font-weight: 700;
            cursor: help;
            position: relative;
            flex-shrink: 0;
            line-height: 1;
        }
        .calc-tooltip .tip-text {
            visibility: hidden;
            opacity: 0;
            position: absolute;
            bottom: calc(100% + 8px);
            left: 50%;
            transform: translateX(-50%);
            background: #1c1917;
            color: #d6d3d1;
            padding: 0.75rem 1rem;
            border-radius: 8px;
            font-size: 0.72rem;
            font-weight: 400;
            line-height: 1.5;
            width: 260px;
            z-index: 100;
            box-shadow: 0 8px 25px rgba(0,0,0,0.5);
            border: 1px solid rgba(255,255,255,0.1);
            transition: opacity 0.2s ease;
            pointer-events: none;
        }
        .calc-tooltip:hover .tip-text {
            visibility: visible;
            opacity: 1;
        }
        .calc-label-row {
            display: flex;
            align-items: center;
            gap: 2px;
        }
        .calc-methodology {
            background: rgba(0,0,0,0.35);
            border-radius: 12px;
            padding: 1.5rem;
            margin-top: 1.5rem;
            font-size: 0.8rem;
            color: #e7e5e4;
            border: 1px solid rgba(255,255,255,0.08);
        }
        .calc-methodology summary {
            cursor: pointer;
            font-weight: 700;
            color: #fbbf24;
            font-size: 0.9rem;
            padding: 0.25rem 0;
        }
        .calc-methodology p {
            color: #d6d3d1;
            margin: 0.75rem 0 0.25rem;
            font-weight: 600;
        }
        .calc-methodology ul { margin: 0.5rem 0; padding-left: 1.2rem; }
        .calc-methodology li { margin-bottom: 0.4rem; color: #d6d3d1; line-height: 1.6; }
        .calc-methodology li strong { color: #fbbf24; }
        .calc-methodology code {
            background: rgba(251,191,36,0.12);
            color: #fde68a;
            padding: 0.15rem 0.4rem;
            border-radius: 4px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.72rem;
            border: 1px solid rgba(251,191,36,0.15);
        }
        .term-tip {
            position: relative;
            border-bottom: 1px dashed rgba(251,191,36,0.5);
            cursor: help;
            color: #fbbf24;
            font-weight: 600;
        }
        .term-tip .term-def {
            visibility: hidden;
            opacity: 0;
            position: absolute;
            bottom: calc(100% + 6px);
            left: 50%;
            transform: translateX(-50%);
            background: #1c1917;
            color: #e7e5e4;
            padding: 0.6rem 0.85rem;
            border-radius: 8px;
            font-size: 0.72rem;
            font-weight: 400;
            line-height: 1.5;
            width: 240px;
            z-index: 100;
            box-shadow: 0 8px 25px rgba(0,0,0,0.6);
            border: 1px solid rgba(251,191,36,0.2);
            transition: opacity 0.2s ease;
            pointer-events: none;
            text-align: left;
        }
        .term-tip:hover .term-def {
            visibility: visible;
            opacity: 1;
        }
        .sensitivity-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 0.75rem;
            margin-top: 1rem;
        }
        .sensitivity-card {
            background: rgba(255,255,255,0.04);
            border-radius: 10px;
            padding: 1rem;
            border: 1px solid rgba(255,255,255,0.08);
        }

        /* Risk Gauge */
        .risk-gauge {
            margin-top: 1.5rem;
            padding: 1.5rem;
            background: rgba(0,0,0,0.3);
            border-radius: 12px;
            text-align: center;
        }
        .gauge-bar {
            width: 100%;
            height: 20px;
            background: linear-gradient(90deg, #059669 0%, #eab308 33%, #d97706 66%, #dc2626 100%);
            border-radius: 10px;
            position: relative;
            margin: 1rem 0;
        }
        .gauge-needle {
            position: absolute;
            top: -6px;
            width: 4px;
            height: 32px;
            background: #fff;
            border-radius: 2px;
            transition: left 0.5s ease;
            box-shadow: 0 0 10px rgba(255,255,255,0.5);
        }
        .gauge-labels {
            display: flex;
            justify-content: space-between;
            font-size: 0.7rem;
            color: #a8a29e;
        }
        .risk-verdict {
            font-size: 1.2rem;
            font-weight: 700;
            margin-top: 1rem;
        }
        .risk-verdict.low { color: #34d399; }
        .risk-verdict.medium { color: #fbbf24; }
        .risk-verdict.high { color: #fb923c; }
        .risk-verdict.critical { color: #f87171; }

        /* Supply-Demand Chart */
        .sd-chart {
            margin-top: 1.5rem;
            padding: 1rem;
            background: rgba(0,0,0,0.2);
            border-radius: 12px;
        }
        .sd-bar-container { margin-bottom: 0.75rem; }
        .sd-bar-label {
            font-size: 0.75rem;
            color: #d6d3d1;
            margin-bottom: 0.25rem;
            display: flex;
            justify-content: space-between;
        }
        .sd-bar {
            height: 24px;
            border-radius: 6px;
            transition: width 0.8s ease;
            display: flex;
            align-items: center;
            padding-left: 8px;
            font-size: 0.7rem;
            font-weight: 600;
            font-family: 'JetBrains Mono', monospace;
        }
        .sd-bar.supply { background: linear-gradient(90deg, #d97706, #ea580c); }
        .sd-bar.demand { background: linear-gradient(90deg, #059669, #10b981); }
        .sd-bar.committed { background: linear-gradient(90deg, #2563eb, #3b82f6); }

        /* Timeline */
        .bubble-timeline {
            position: relative;
            padding: 2rem 0;
            margin: 2rem 0;
        }
        .bubble-timeline::before {
            content: '';
            position: absolute;
            left: 20px;
            top: 0;
            bottom: 0;
            width: 3px;
            background: linear-gradient(180deg, #059669, #eab308, #d97706, #dc2626);
        }
        .timeline-item {
            position: relative;
            padding-left: 50px;
            margin-bottom: 2rem;
        }
        .timeline-dot {
            position: absolute;
            left: 12px;
            top: 4px;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            border: 3px solid #fff;
        }
        .timeline-year {
            font-size: 0.8rem;
            font-weight: 700;
            font-family: 'JetBrains Mono', monospace;
            margin-bottom: 0.25rem;
        }
        .timeline-content {
            font-size: 0.85rem;
            color: #374151;
            background: #f8fafc;
            padding: 1rem;
            border-radius: 8px;
            border-left: 3px solid;
        }

        /* References */
        .references {
            background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
            padding: 2rem;
            border-radius: 12px;
            margin-top: 3rem;
            border-left: 4px solid #d97706;
        }
        .references h3 { font-size: 1.1rem; margin-bottom: 1.25rem; color: #78350f; }
        .references ol { font-size: 0.8rem; color: #475569; padding-left: 1.5rem; line-height: 1.6; }
        .references ol li { margin-bottom: 0.5rem; }
        .references a { color: #d97706; text-decoration: none; }
        .references a:hover { text-decoration: underline; }

        /* Author Bio */
        .author-section {
            display: flex;
            gap: 1.5rem;
            align-items: center;
            padding: 2rem;
            background: linear-gradient(135deg, #fffbeb 0%, #fef3c7 100%);
            border-radius: 16px;
            margin-top: 3rem;
            border: 1px solid #fde68a;
        }
        .author-section img {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            object-fit: cover;
            border: 3px solid #d97706;
        }
        .author-info h4 { font-size: 1rem; color: #78350f; margin-bottom: 0.25rem; }
        .author-info p { font-size: 0.85rem; color: #92400e; margin: 0; }
        .author-info a { color: #d97706; }

        /* Article Nav */
        .article-nav {
            display: flex;
            justify-content: space-between;
            padding: 2rem 0;
            border-top: 1px solid #e2e8f0;
            margin-top: 3rem;
        }
        .article-nav a {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: #d97706;
            font-weight: 600;
            transition: color 0.3s ease;
            text-decoration: none;
        }
        .article-nav a:hover { color: #f59e0b; }

        /* Table of Contents */
        .toc-section {
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            padding: 1.25rem;
            border-radius: 10px;
            margin-bottom: 2rem;
            border: 1px solid #e2e8f0;
        }
        .toc-container {
            max-width: 900px;
            margin: 0 auto;
        }
        .toc-title {
            font-size: 1rem;
            font-weight: 700;
            color: var(--bubble-amber);
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 0.75rem;
        }
        .toc-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 0.5rem;
        }
        .toc-item {
            background: #fff;
            padding: 0.5rem 0.75rem;
            border-radius: 8px;
            text-decoration: none;
            color: inherit;
            border-left: 3px solid var(--bubble-amber);
            transition: all 0.2s ease;
            display: block;
        }
        .toc-item:hover {
            transform: translateX(4px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        .toc-item-number {
            font-size: 0.62rem;
            color: var(--bubble-amber);
            font-weight: 700;
            letter-spacing: 1px;
            margin-bottom: 1px;
        }
        .toc-item-title {
            font-weight: 600;
            font-size: 0.78rem;
        }
        .toc-item.toc-calculator {
            background: linear-gradient(135deg, #fffbeb 0%, #fef3c7 100%);
            border-left-color: #d97706;
            border-left-width: 5px;
        }
        .toc-item.toc-calculator .toc-item-number { display: flex; align-items: center; gap: 6px; }
        .toc-item.toc-calculator .toc-calc-badge {
            font-size: 0.6rem; background: #d97706; color: #fff; padding: 1px 6px; border-radius: 4px; font-weight: 700; letter-spacing: 0.5px;
        }
        [data-theme="dark"] .toc-item.toc-calculator {
            background: linear-gradient(135deg, rgba(217,119,6,0.15) 0%, rgba(217,119,6,0.08) 100%);
        }
        /* Dark Mode — Content */
        [data-theme="dark"] .article-content { background: #0f172a; }
        [data-theme="dark"] .article-body { background: #0f172a; color: #e2e8f0; }
        [data-theme="dark"] .article-body h2 { color: #93c5fd; }
        [data-theme="dark"] .article-body h3 { color: #cbd5e1; }
        [data-theme="dark"] .article-body p { color: #cbd5e1; }
        [data-theme="dark"] .article-body blockquote { background: rgba(30,58,95,0.3); border-color: rgba(96,165,250,0.4); color: #cbd5e1; }
        [data-theme="dark"] .article-body .info-box,
        [data-theme="dark"] .article-body .key-insight { background: rgba(15,23,42,0.8); border-color: rgba(255,255,255,0.1); color: #cbd5e1; }
        [data-theme="dark"] .highlight-box { background: rgba(245,158,11,0.1); border-color: rgba(245,158,11,0.4); }
        [data-theme="dark"] .highlight-box p { color: #fbbf24; }
        [data-theme="dark"] .warning-box { background: rgba(239,68,68,0.1); border-color: rgba(239,68,68,0.4); }
        [data-theme="dark"] .warning-box p { color: #fca5a5; }
        [data-theme="dark"] .result-box { background: rgba(16,185,129,0.1); border-color: rgba(16,185,129,0.4); }
        [data-theme="dark"] .result-box h4 { color: #34d399; }
        [data-theme="dark"] .result-box p { color: #6ee7b7; }
        [data-theme="dark"] .references { background: rgba(15,23,42,0.8); border-color: rgba(6,182,212,0.4); }
        [data-theme="dark"] .references h3 { color: #93c5fd; }
        [data-theme="dark"] .references ol { color: #94a3b8; }
        [data-theme="dark"] .article-body table th { background: #0f172a; color: #e2e8f0; }
        [data-theme="dark"] .article-body table td { color: #cbd5e1; border-color: rgba(255,255,255,0.1); }
        [data-theme="dark"] .article-body ul li,
        [data-theme="dark"] .article-body ol li { color: #cbd5e1; }
        [data-theme="dark"] .article-body a { color: #60a5fa; }
        [data-theme="dark"] .article-body strong { color: #f1f5f9; }

        /* Dark Mode — Danger/Caution/Safe/Policy Boxes */
        [data-theme="dark"] .danger-box { background: linear-gradient(135deg, rgba(239,68,68,0.1) 0%, rgba(185,28,28,0.15) 100%); border-color: #dc2626; }
        [data-theme="dark"] .danger-box p { color: #fca5a5; }
        [data-theme="dark"] .caution-box { background: linear-gradient(135deg, rgba(245,158,11,0.1) 0%, rgba(217,119,6,0.15) 100%); border-color: #d97706; }
        [data-theme="dark"] .caution-box p { color: #fcd34d; }
        [data-theme="dark"] .safe-box { background: linear-gradient(135deg, rgba(16,185,129,0.1) 0%, rgba(5,150,105,0.15) 100%); border-color: #059669; }
        [data-theme="dark"] .safe-box p { color: #6ee7b7; }
        [data-theme="dark"] .policy-box { background: linear-gradient(135deg, rgba(37,99,235,0.1) 0%, rgba(29,78,216,0.15) 100%); border-color: #2563eb; }
        [data-theme="dark"] .policy-box p { color: #93c5fd; }

        /* Dark Mode — Comparison Cards */
        [data-theme="dark"] .comparison-card { background: linear-gradient(135deg, #1e293b 0%, #0f172a 100%); border-color: rgba(255,255,255,0.1); }
        [data-theme="dark"] .comparison-card:hover { box-shadow: 0 12px 40px rgba(0,0,0,0.4); }
        [data-theme="dark"] .comparison-card .card-title { color: #e2e8f0; }
        [data-theme="dark"] .comparison-card .card-desc { color: #94a3b8; }
        [data-theme="dark"] .comparison-card.risk-high { background: linear-gradient(135deg, rgba(239,68,68,0.12) 0%, rgba(185,28,28,0.15) 100%); border-color: rgba(248,113,113,0.3); }
        [data-theme="dark"] .comparison-card.risk-medium { background: linear-gradient(135deg, rgba(245,158,11,0.12) 0%, rgba(217,119,6,0.15) 100%); border-color: rgba(251,191,36,0.3); }
        [data-theme="dark"] .comparison-card.risk-low { background: linear-gradient(135deg, rgba(16,185,129,0.12) 0%, rgba(5,150,105,0.15) 100%); border-color: rgba(52,211,153,0.3); }

        /* Dark Mode — Data Table */
        [data-theme="dark"] .data-table th { background: #451a03; }
        [data-theme="dark"] .data-table td { border-color: rgba(255,255,255,0.1); color: #cbd5e1; }
        [data-theme="dark"] .data-table tr:hover { background: rgba(217,119,6,0.08); }
        [data-theme="dark"] .data-table .highlight-row { background: rgba(217,119,6,0.12); }

        /* Responsive */
        @media (max-width: 768px) {
            .article-hero { padding: 6rem 1rem 3rem; }
            .article-content { padding: 3rem 1rem; }
            .bubble-calculator { padding: 1.5rem; }
            .calc-grid { grid-template-columns: 1fr; }
            .comparison-grid { grid-template-columns: 1fr; }
            .results-grid { grid-template-columns: repeat(2, 1fr); }
            .author-section { flex-direction: column; text-align: center; }
            .toc-grid { grid-template-columns: 1fr; }
        }
        @media (max-width: 480px) {
            .article-title { font-size: 1.5rem; }
            .results-grid { grid-template-columns: 1fr; }
        }

        /* ═══ EVIDENCE BLOCK ═══ */
        .bub-evidence-block{padding:2rem;background:linear-gradient(135deg,#fffbeb 0%,#fef3c7 100%);border-left:4px solid #d97706}
        .bub-evidence-grid{display:grid;grid-template-columns:repeat(5,1fr);gap:1rem;max-width:1000px;margin:0 auto}
        .bub-evidence-card{background:rgba(255,255,255,0.7);backdrop-filter:blur(12px);border:1px solid rgba(217,119,6,0.15);border-top:3px solid #d97706;border-radius:10px;padding:1rem;text-align:center;position:relative;overflow:hidden;transition:all 0.3s}
        .bub-evidence-card::before{content:'';position:absolute;top:0;left:0;right:0;bottom:0;background:linear-gradient(135deg,rgba(217,119,6,0.03),rgba(234,88,12,0.06));pointer-events:none}
        .bub-evidence-card:hover{transform:translateY(-2px);box-shadow:0 8px 25px rgba(217,119,6,0.15)}
        .bub-evidence-value{font-size:1.8rem;font-weight:800;background:linear-gradient(135deg,#d97706,#ea580c);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;position:relative}
        .bub-evidence-label{font-size:0.78rem;font-weight:600;color:#92400e;margin-top:4px}
        .bub-evidence-sub{font-size:0.68rem;color:#b45309;margin-top:2px}
        .bub-evidence-source{text-align:center;font-size:0.68rem;color:#92400e;margin-top:1rem;max-width:1000px;margin-left:auto;margin-right:auto}
        [data-theme="dark"] .bub-evidence-block{background:linear-gradient(135deg,rgba(120,53,15,0.15),rgba(69,26,3,0.2));border-color:#d97706}
        [data-theme="dark"] .bub-evidence-card{background:rgba(15,23,42,0.7);border-color:rgba(255,255,255,0.06);border-top-color:#d97706}
        [data-theme="dark"] .bub-evidence-label{color:#fcd34d}
        [data-theme="dark"] .bub-evidence-sub{color:#fbbf24}
        [data-theme="dark"] .bub-evidence-source{color:#fbbf24}

        /* ═══ PRO MODE TOOLBAR ═══ */
        .bub-toolbar{display:flex;align-items:center;justify-content:space-between;background:rgba(217,119,6,0.08);border:1px solid rgba(217,119,6,0.2);border-radius:10px;padding:0.75rem 1rem;margin-bottom:1.5rem;flex-wrap:wrap;gap:0.5rem}
        .bub-mode-bar{display:flex;gap:4px}
        .bub-toolbar-btn{padding:8px 18px;border-radius:8px;border:1px solid rgba(217,119,6,0.2);background:transparent;color:#d6d3d1;font-size:0.8rem;font-weight:600;cursor:pointer;font-family:inherit;transition:all 0.2s}
        .bub-toolbar-btn:hover{color:#fff;border-color:#d97706}
        .bub-btn-free.active{background:linear-gradient(135deg,#d97706,#ea580c);color:#fff;border-color:transparent;box-shadow:0 2px 8px rgba(217,119,6,0.25)}
        .bub-btn-pro.active{background:linear-gradient(135deg,#d97706,#f59e0b);color:#fff;border-color:transparent;box-shadow:0 2px 8px rgba(245,158,11,0.25)}
        .bub-toolbar-actions{display:flex;gap:6px}
        .bub-btn-reset,.bub-btn-pdf{padding:6px 14px;border-radius:8px;border:1px solid rgba(255,255,255,0.12);background:transparent;color:#d6d3d1;font-size:0.75rem;font-weight:600;cursor:pointer;font-family:inherit;transition:all 0.2s;display:inline-flex;align-items:center;gap:5px}
        .bub-btn-reset:hover,.bub-btn-pdf:hover{color:#fff;border-color:rgba(255,255,255,0.25)}

        /* ═══ PRO PANELS ═══ */
        .bub-pro-panel{margin:1.5rem 0;padding:1.25rem;background:linear-gradient(135deg,rgba(217,119,6,0.06),rgba(234,88,12,0.03));border:1px solid rgba(217,119,6,0.2);border-radius:12px;position:relative;overflow:hidden}
        .bub-pro-panel.gated .bub-panel-inner{filter:blur(4px);pointer-events:none;user-select:none}
        .bub-gate-overlay{position:absolute;top:0;left:0;right:0;bottom:0;background:rgba(120,53,15,0.85);display:flex;flex-direction:column;align-items:center;justify-content:center;gap:8px;cursor:pointer;z-index:5;border-radius:12px}
        .bub-gate-overlay i{font-size:1.5rem;color:#fbbf24}
        .bub-gate-overlay span{color:#fbbf24;font-weight:700;font-size:0.9rem}
        .bub-panel-title{font-size:0.95rem;font-weight:700;color:#fbbf24;margin-bottom:0.75rem;display:flex;align-items:center;gap:8px}
        .bub-panel-title i{font-size:0.85rem}
        .bub-kpi-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(140px,1fr));gap:0.75rem;margin-bottom:1rem}
        .bub-kpi-card{background:rgba(0,0,0,0.3);border:1px solid rgba(217,119,6,0.15);border-radius:10px;padding:0.875rem;text-align:center}
        .bub-kpi-value{font-size:1.4rem;font-weight:800;color:#fbbf24}
        .bub-kpi-value.good{color:#34d399}
        .bub-kpi-value.warn{color:#fbbf24}
        .bub-kpi-value.bad{color:#f87171}
        .bub-kpi-label{font-size:0.72rem;color:#a8a29e;margin-top:2px}
        .bub-narrative{background:rgba(0,0,0,0.35);border:1px solid rgba(217,119,6,0.15);border-radius:10px;padding:1.25rem;margin-top:1rem;font-size:0.85rem;line-height:1.7;color:#d6d3d1}
        .bub-narrative p{margin-bottom:0.75rem;color:#d6d3d1}
        .bub-narrative strong{color:#fbbf24}
        .bub-scenario-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:1rem;margin:1rem 0}
        .bub-scenario-card{background:rgba(0,0,0,0.3);border:1px solid rgba(255,255,255,0.08);border-radius:10px;padding:1rem}
        .bub-scenario-card h5{font-size:0.82rem;font-weight:700;margin-bottom:0.5rem}
        .bub-scenario-card p{font-size:0.75rem;color:#a8a29e;line-height:1.5}

        /* ═══ LOGIN MODAL ═══ */
        .bub-login-overlay{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.85);z-index:9999;align-items:center;justify-content:center}
        .bub-login-overlay.show{display:flex}
        .bub-login-box{background:#451a03;border:2px solid rgba(217,119,6,0.5);border-radius:16px;padding:2.5rem;max-width:420px;width:90%;text-align:center;box-shadow:0 24px 60px rgba(0,0,0,0.6),0 0 40px rgba(217,119,6,0.15);position:relative}
        .bub-login-box h3{font-size:1.2rem;color:#fbbf24;margin-bottom:0.5rem}
        .bub-login-box p{font-size:0.82rem;color:#a8a29e;margin-bottom:1.25rem}
        .bub-login-box input{width:100%;padding:12px 16px;margin-bottom:12px;background:rgba(255,255,255,0.1);border:1px solid rgba(217,119,6,0.3);border-radius:8px;color:#e2e8f0;font-size:0.88rem;font-family:inherit;outline:none;box-sizing:border-box}
        .bub-login-box input:focus{border-color:#d97706}
        .bub-login-submit{width:100%;padding:12px;background:linear-gradient(135deg,#d97706,#ea580c);color:#fff;border:none;border-radius:10px;font-weight:700;font-size:0.9rem;cursor:pointer;font-family:inherit;transition:all 0.2s;margin-top:4px}
        .bub-login-submit:hover{box-shadow:0 4px 16px rgba(217,119,6,0.3)}
        .bub-login-close{position:absolute;top:12px;right:16px;background:none;border:none;color:#a8a29e;font-size:1.5rem;cursor:pointer}
        .bub-login-error{display:none;color:#f87171;font-size:0.78rem;margin-top:8px}
        .bub-login-demo{font-size:0.72rem;color:#78716c;margin-top:12px}
        .bub-login-demo code{background:rgba(217,119,6,0.12);padding:2px 6px;border-radius:4px;color:#fbbf24;font-size:0.7rem}

        /* ═══ PRIVACY / BENCHMARK ═══ */
        .bub-privacy-badge{text-align:center;font-size:0.72rem;color:#78716c;padding:0.75rem;display:flex;align-items:center;justify-content:center;gap:6px}
        .bub-privacy-badge i{color:#d97706}
        .bub-benchmark-meta{display:flex;flex-wrap:wrap;justify-content:center;gap:0.5rem;margin-top:0.5rem}
        .bub-benchmark-tag{font-size:0.68rem;padding:3px 10px;background:rgba(217,119,6,0.08);border:1px solid rgba(217,119,6,0.15);border-radius:50px;color:#a8a29e;display:inline-flex;align-items:center;gap:4px}
        .bub-benchmark-tag i{font-size:0.6rem;color:#d97706}

        /* ═══ TOAST ═══ */
        .bub-toast{position:fixed;bottom:2rem;right:2rem;padding:12px 20px;border-radius:10px;font-size:0.82rem;font-weight:600;z-index:9999;transform:translateY(100px);opacity:0;transition:all 0.3s;font-family:inherit}
        .bub-toast.show{transform:translateY(0);opacity:1}
        .bub-toast.success{background:#451a03;color:#fbbf24;border:1px solid #78350f}
        .bub-toast.error{background:#7f1d1d;color:#fca5a5;border:1px solid #991b1b}

        /* ═══ DARK MODE PRO ═══ */
        [data-theme="dark"] .bub-pro-panel{background:rgba(217,119,6,0.03)}
        [data-theme="dark"] .bub-kpi-card{background:rgba(15,23,42,0.8)}
        [data-theme="dark"] .bub-narrative{background:rgba(15,23,42,0.8)}
        [data-theme="dark"] .bub-login-box{background:#0f172a;border-color:rgba(217,119,6,0.5);box-shadow:0 24px 60px rgba(0,0,0,0.7),0 0 40px rgba(217,119,6,0.12)}
        [data-theme="dark"] .bub-gate-overlay{background:rgba(15,23,42,0.85)}

        /* ═══ RESPONSIVE PRO ═══ */
        @media (max-width:768px){
            .bub-evidence-grid{grid-template-columns:repeat(2,1fr)}
            .bub-toolbar{flex-direction:column;align-items:stretch}
            .bub-mode-bar{justify-content:center}
            .bub-toolbar-actions{justify-content:center}
            .bub-kpi-grid{grid-template-columns:repeat(2,1fr)}
            .bub-scenario-grid{grid-template-columns:1fr}
        }
        @media (max-width:480px){.bub-evidence-grid{grid-template-columns:1fr}}
    
        /* Result Card Tooltip System */
        .res-tip {
            display: inline-flex; align-items: center; justify-content: center;
            width: 14px; height: 14px;
            background: rgba(245,158,11,0.15); border: 1px solid rgba(245,158,11,0.3);
            border-radius: 50%; font-size: 0.6rem; font-weight: 700;
            color: #fbbf24; margin-left: 4px; cursor: help;
            position: relative; flex-shrink: 0; vertical-align: middle;
            line-height: 1;
        }
        .res-tip:hover { background: rgba(245,158,11,0.3); transform: scale(1.15); }
        .res-tip .res-tip-body {
            visibility: hidden; opacity: 0;
            position: absolute; bottom: calc(100% + 8px); left: 50%;
            transform: translateX(-50%);
            background: #1e293b; color: #e2e8f0;
            padding: 0.7rem 0.9rem; border-radius: 8px;
            font-size: 0.72rem; font-weight: 400; line-height: 1.5;
            width: 260px; z-index: 100;
            box-shadow: 0 8px 25px rgba(0,0,0,0.5);
            border: 1px solid rgba(245,158,11,0.2);
            transition: opacity 0.2s ease; pointer-events: none;
            text-transform: none; letter-spacing: normal;
        }
        .res-tip:hover .res-tip-body { visibility: visible; opacity: 1; }
        .res-tip-body .rtt { font-weight: 700; color: #fbbf24; margin-bottom: 3px; font-size: 0.75rem; }
        .res-tip-body .rtd { color: #cbd5e1; }
        .res-tip-body .rtf {
            font-family: 'JetBrains Mono', monospace; font-size: 0.68rem;
            background: rgba(0,0,0,0.3); padding: 3px 7px; border-radius: 4px;
            color: #67e8f9; margin-top: 4px; display: block;
        }
</style>
    <script src="https://cdn.jsdelivr.net/npm/fuse.js@7.0.0" defer></script>
</head>
<body>
    <!-- Reading Progress Bar -->
    <div class="scroll-progress" id="scrollProgress"></div>

    <!-- Search Overlay & Modal -->
    <div class="search-overlay" id="searchOverlay"></div>
    <div class="search-modal" id="searchModal">
        <div class="search-input-wrap">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg>
            <input type="text" class="search-input" id="searchInput" placeholder="Search articles, calculators, tools..." autocomplete="off">
            <kbd class="search-kbd">ESC</kbd>
        </div>
        <div class="search-results" id="searchResults">
            <div class="search-empty">Type to search across all content</div>
        </div>
        <div class="search-footer">
            <span><kbd class="search-kbd">&uarr;&darr;</kbd> Navigate</span>
            <span><kbd class="search-kbd">Enter</kbd> Open</span>
        </div>
    </div>

    <!-- TOC Sidebar (desktop, wide screens) -->
    <nav class="toc-sidebar" id="tocSidebar" aria-label="Table of Contents">
        <div class="toc-sidebar-label">On this page</div>
        <ul class="toc-sidebar-list" id="tocSidebarList"></ul>
    </nav>

    <!-- TOC Mobile Toggle -->
    <button class="toc-mobile-toggle" id="tocMobileToggle" aria-label="Table of contents">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="8" y1="6" x2="21" y2="6"/><line x1="8" y1="12" x2="21" y2="12"/><line x1="8" y1="18" x2="21" y2="18"/><line x1="3" y1="6" x2="3.01" y2="6"/><line x1="3" y1="12" x2="3.01" y2="12"/><line x1="3" y1="18" x2="3.01" y2="18"/></svg>
    </button>
    <div class="toc-mobile-backdrop" id="tocMobileBackdrop"></div>
    <div class="toc-mobile-drawer" id="tocMobileDrawer">
        <div class="toc-drawer-header">
            <span class="toc-drawer-title">Table of Contents</span>
            <button class="toc-drawer-close" id="tocDrawerClose" aria-label="Close">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>
            </button>
        </div>
        <ul class="toc-mobile-list" id="tocMobileList"></ul>
    </div>


<a href="#main-content" class="skip-link">Skip to main content</a>

<!-- Navigation (shared) -->
<nav class="navbar">
    <div class="nav-container">
        <a href="index.html" class="nav-logo">
            <img loading="lazy" src="assets/profile-photo.jpg" alt="Bagus Dwi Permana" class="nav-avatar">
        </a>
        <ul class="nav-menu">
            <li><a href="index.html" class="nav-link">Home</a></li>
            <li class="nav-dropdown">
                <a href="datacenter-solutions.html" class="nav-link">
                    DC Solutions
                    <svg class="dropdown-arrow" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"></polyline></svg>
                </a>
                <ul class="dropdown-menu">
                    <li><a href="datacenter-solutions.html" style="color: #06b6d4; font-weight: 600;">DC Solutions Hub</a></li>
                    <li style="border-bottom: 1px solid rgba(255,255,255,0.1); margin: 4px 0;"></li>
                    <li><a href="datahallAI.html" style="color: #8b5cf6;">DC AI/HPC</a></li>
                    <li><a href="dc-conventional.html">DC Conventional</a></li>
                    <li style="border-bottom: 1px solid rgba(255,255,255,0.1); margin: 4px 0;"></li>
                    <li><a href="capex-calculator.html" style="color: #f59e0b;">CAPEX Calculator</a></li>
                    <li><a href="opex-calculator.html" style="color: #10b981;">OPEX Calculator</a></li>
                    <li style="border-bottom: 1px solid rgba(255,255,255,0.1); margin: 4px 0;"></li>
                    <li><a href="dcmoc/" style="color: #ef4444; font-weight: 600;">DC MOC</a></li>
                </ul>
            </li>
            <li><a href="index.html#metrics" class="nav-link">Results</a></li>
            <li><a href="index.html#case-studies" class="nav-link">Case Studies</a></li>
            <li><a href="articles.html" class="nav-link">Articles</a></li>
            <li><a href="index.html#faq" class="nav-link">FAQ</a></li>
            <li><a href="index.html#contact" class="nav-link">Contact</a></li>
        </ul>
                    <button class="nav-search-btn" id="navSearchBtn" aria-label="Search" title="Search (Ctrl+K)">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg>
            </button>
            <button class="theme-toggle" id="themeToggle" aria-label="Toggle dark mode" title="Toggle dark/light mode">
            <svg class="moon-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path></svg>
            <svg class="sun-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"></circle><line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line><line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line></svg>
        </button>
        <button class="hamburger" aria-label="Open navigation menu" aria-expanded="false">
            <span class="bar"></span>
            <span class="bar"></span>
            <span class="bar"></span>
        </button>
    </div>
</nav>

<main id="main-content">
<!-- Hero Section -->
<section class="article-hero">
    <div class="container">
        <a href="articles.html" class="back-link">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M19 12H5M12 19l-7-7 7-7"/></svg>
            Back to Articles
        </a>

        <span class="bubble-badge">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/><line x1="12" y1="9" x2="12" y2="13"/><line x1="12" y1="17" x2="12.01" y2="17"/></svg>
            Market Risk Analysis
        </span>

        <span class="article-category">Industry Analysis</span>

        <h1 class="article-title">
            The Great SEA Data Center Bubble: <span class="highlight">When $37 Billion Bets on a Promise</span>
        </h1>

        <p class="article-subtitle">
            6,068 MW of new capacity. $37 billion invested. Johor's 5.8 GW gamble. Indonesia at 1,717 MW and climbing. A deep investigation into whether Southeast Asia is building the infrastructure of the future &mdash; or repeating the telecom crash of 2001.
        </p>

        <div class="article-meta">
            <span class="article-meta-item">
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><path d="M12 6v6l4 2"/></svg>
                25 min read
            </span>
            <span class="article-meta-item">
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>
                February 14, 2026
            </span>
            <span class="article-meta-item">
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>
                Bagus Dwi Permana
            </span>
        </div>

        <a href="#section-9" class="jump-to-calc">
            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="4" y="2" width="16" height="20" rx="2"/><line x1="8" y1="6" x2="16" y2="6"/><line x1="8" y1="10" x2="10" y2="10"/><line x1="14" y1="10" x2="16" y2="10"/><line x1="8" y1="14" x2="10" y2="14"/><line x1="14" y1="14" x2="16" y2="14"/><line x1="8" y1="18" x2="10" y2="18"/><line x1="14" y1="18" x2="16" y2="18"/></svg>
            Try the Bubble Risk Calculator
        </a>
    </div>
</section>
    <!-- Series Navigation -->
    <div class="series-nav" style="margin-top: 1rem;">
        <div class="series-badge">
            <span class="series-badge-icon">16</span>
            Engineering Journal &mdash; Article 16 of 18
        </div>
        <span class="series-title"></span>
        <div class="series-links">
            <a href="article-15.html" class="series-link"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="15 18 9 12 15 6"/></svg>Prev</a>
            <a href="article-17.html" class="series-link">Next<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="9 18 15 12 9 6"/></svg></a>
        </div>
    </div>


<!-- Evidence Block -->
<div class="bub-evidence-block">
    <div class="bub-evidence-grid">
        <div class="bub-evidence-card">
            <div class="bub-evidence-value">$37B+</div>
            <div class="bub-evidence-label">Capital Committed</div>
            <div class="bub-evidence-sub">SEA DC Pipeline Investment</div>
        </div>
        <div class="bub-evidence-card">
            <div class="bub-evidence-value">6,068 MW</div>
            <div class="bub-evidence-label">Total Pipeline</div>
            <div class="bub-evidence-sub">Announced + Under Construction</div>
        </div>
        <div class="bub-evidence-card">
            <div class="bub-evidence-value">5.8 GW</div>
            <div class="bub-evidence-label">Johor Pipeline</div>
            <div class="bub-evidence-sub">Population: 3.8M</div>
        </div>
        <div class="bub-evidence-card">
            <div class="bub-evidence-value">1,717 MW</div>
            <div class="bub-evidence-label">Indonesia Capacity</div>
            <div class="bub-evidence-sub">Greater Jakarta + DCII</div>
        </div>
        <div class="bub-evidence-card">
            <div class="bub-evidence-value">~47%</div>
            <div class="bub-evidence-label">Absorption Gap</div>
            <div class="bub-evidence-sub">3-Year Projected Vacancy</div>
        </div>
    </div>
    <div class="bub-evidence-source">Sources: Cushman &amp; Wakefield H1 2025, Arizton 2025-2030, CBRE SEA Data Center Report 2025</div>
</div>

<!-- Article Content -->
<article class="article-content">
    <div class="container">
        <div class="article-body">

            <!-- Table of Contents -->
            <section class="toc-section">
                <div class="toc-container">
                    <h2 class="toc-title">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <line x1="8" y1="6" x2="21" y2="6"></line>
                            <line x1="8" y1="12" x2="21" y2="12"></line>
                            <line x1="8" y1="18" x2="21" y2="18"></line>
                            <line x1="3" y1="6" x2="3.01" y2="6"></line>
                            <line x1="3" y1="12" x2="3.01" y2="12"></line>
                            <line x1="3" y1="18" x2="3.01" y2="18"></line>
                        </svg>
                        Table of Contents
                    </h2>
                    <div class="toc-grid">
                        <a href="#section-1" class="toc-item">
                            <div class="toc-item-number">SECTION 1</div>
                            <div class="toc-item-title">The Supply Explosion: $37 Billion and Counting</div>
                        </a>
                        <a href="#section-2" class="toc-item">
                            <div class="toc-item-number">SECTION 2</div>
                            <div class="toc-item-title">Indonesia: The 1,717 MW Frontier</div>
                        </a>
                        <a href="#section-3" class="toc-item">
                            <div class="toc-item-number">SECTION 3</div>
                            <div class="toc-item-title">Johor: Boom or Bubble?</div>
                        </a>
                        <a href="#section-4" class="toc-item">
                            <div class="toc-item-number">SECTION 4</div>
                            <div class="toc-item-title">Building on Borrowed Promises: The Hyperscaler Dependency Trap</div>
                        </a>
                        <a href="#section-5" class="toc-item">
                            <div class="toc-item-number">SECTION 5</div>
                            <div class="toc-item-title">The Stranded Assets Nobody Talks About</div>
                        </a>
                        <a href="#section-6" class="toc-item">
                            <div class="toc-item-number">SECTION 6</div>
                            <div class="toc-item-title">Is This a Bubble? The Historical Parallels</div>
                        </a>
                        <a href="#section-7" class="toc-item">
                            <div class="toc-item-number">SECTION 7</div>
                            <div class="toc-item-title">Investment Analysis: The Numbers Behind the Bets</div>
                        </a>
                        <a href="#section-8" class="toc-item">
                            <div class="toc-item-number">SECTION 8</div>
                            <div class="toc-item-title">What Happens When the Music Stops</div>
                        </a>
                        <a href="#section-9" class="toc-item toc-calculator">
                            <div class="toc-item-number">SECTION 9 <span class="toc-calc-badge">INTERACTIVE</span></div>
                            <div class="toc-item-title">SEA DC Bubble Risk Calculator</div>
                        </a>
                    </div>
                </div>
            </section>

            <!-- Cover Image -->
            <figure style="margin: 0 0 2.5rem 0; text-align: center;">
                <img src="assets/article-16-infographic.jpg" alt="Southeast Asia Data Center Bubble — supply pipeline vs demand analysis across 6 markets" style="max-width: 100%; height: auto; border-radius: 12px; box-shadow: 0 4px 20px rgba(0,0,0,0.15);" loading="eager">
                <figcaption style="margin-top: 0.75rem; font-size: 0.875rem; color: #64748b; font-style: italic;">SEA Data Center Market: $37B invested across 6,068 MW of new capacity pipeline</figcaption>
            </figure>

            <!-- Executive Summary -->
            <div class="warning-box">
                <h4>
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/><line x1="12" y1="9" x2="12" y2="13"/><line x1="12" y1="17" x2="12.01" y2="17"/></svg>
                    Executive Summary
                </h4>
                <p>Southeast Asia's data center market is undergoing an unprecedented expansion: <span class="stat-highlight">$37B+</span> committed across <span class="stat-highlight">6,068 MW</span> of new capacity. Johor alone has a <span class="stat-highlight">5.8 GW</span> pipeline &mdash; enough to power 4.6 million homes &mdash; in a state of 3.8 million people. Indonesia's installed capacity reached <span class="stat-highlight">1,717 MW</span> with operators racing to build ahead of demand. The critical question: does committed hyperscaler demand actually materialize at the pace needed, or does the region face a Southeast Asian version of the mid-2000s fiber-optic overbuild? For the bull case counter-argument, see our companion analysis of <a href="article-17.html">the $37 billion SEA data center opportunity</a>.</p>
            </div>

            <!-- 1. The Numbers -->
            <h2 id="section-1">1. The Supply Explosion: $37 Billion and Counting</h2>

            <p>Between 2024 and 2026, Southeast Asia witnessed the largest wave of data center investment in its history. The numbers are staggering: 135 upcoming facilities joining 290 existing ones, involving 149 major operators and investors, with a combined pipeline exceeding 6 GW of IT power capacity.</p>

            <div class="data-table-container">
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Market</th>
                            <th>Operational (MW)</th>
                            <th>Under Construction</th>
                            <th>Pipeline/Planned</th>
                            <th>Vacancy</th>
                            <th>Risk Level</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>Singapore</strong></td>
                            <td>~780 MW</td>
                            <td>Limited</td>
                            <td>~900 MW</td>
                            <td style="color: #059669; font-weight: 700;">2%</td>
                            <td><span style="background: #d1fae5; color: #065f46; padding: 2px 8px; border-radius: 4px; font-size: 0.75rem; font-weight: 600;">LOW</span></td>
                        </tr>
                        <tr class="highlight-row">
                            <td><strong>Malaysia (Johor)</strong></td>
                            <td>487 MW</td>
                            <td>422 MW</td>
                            <td>5.8 GW total</td>
                            <td style="color: #059669; font-weight: 700;">1.1%*</td>
                            <td><span style="background: #fecaca; color: #991b1b; padding: 2px 8px; border-radius: 4px; font-size: 0.75rem; font-weight: 600;">CRITICAL</span></td>
                        </tr>
                        <tr>
                            <td><strong>Indonesia</strong></td>
                            <td>1,717 MW</td>
                            <td>Active</td>
                            <td>4,145 MW by 2031</td>
                            <td style="color: #d97706;">~14%</td>
                            <td><span style="background: #fef3c7; color: #92400e; padding: 2px 8px; border-radius: 4px; font-size: 0.75rem; font-weight: 600;">MEDIUM-HIGH</span></td>
                        </tr>
                        <tr>
                            <td><strong>Thailand</strong></td>
                            <td>~200 MW</td>
                            <td>Rapid</td>
                            <td>~1,092 MW by 2030</td>
                            <td style="color: #d97706;">~12%</td>
                            <td><span style="background: #fef3c7; color: #92400e; padding: 2px 8px; border-radius: 4px; font-size: 0.75rem; font-weight: 600;">MEDIUM</span></td>
                        </tr>
                        <tr>
                            <td><strong>Vietnam</strong></td>
                            <td>Growing</td>
                            <td>11 facilities</td>
                            <td>560 MW by 2030</td>
                            <td style="color: #059669;">Low</td>
                            <td><span style="background: #d1fae5; color: #065f46; padding: 2px 8px; border-radius: 4px; font-size: 0.75rem; font-weight: 600;">LOW-MED</span></td>
                        </tr>
                        <tr>
                            <td><strong>Philippines</strong></td>
                            <td>~100 MW</td>
                            <td>13 upcoming</td>
                            <td>~1 GW target</td>
                            <td style="color: #d97706;">Moderate</td>
                            <td><span style="background: #fef3c7; color: #92400e; padding: 2px 8px; border-radius: 4px; font-size: 0.75rem; font-weight: 600;">MEDIUM</span></td>
                        </tr>
                    </tbody>
                </table>
                <p class="table-source">*Johor vacancy at 1.1% reflects current state; pipeline absorption is the risk. Sources: Cushman &amp; Wakefield H1 2025, ResearchAndMarkets, Arizton. For educational and research purposes only.</p>
            </div>

            <div class="danger-box">
                <p><strong>The math that should concern everyone:</strong> Johor's 5.8 GW pipeline is 12x its current operational capacity. Even at aggressive 20% annual absorption, it would take until 2035+ to fill. Much of this capacity is carrier-neutral and speculative &mdash; tenants not yet secured.</p>
            </div>

            <!-- 2. Indonesia Deep Dive -->
            <h2 id="section-2">2. Indonesia: The 1,717 MW Frontier</h2>

            <p>Indonesia's data center market is the largest in Southeast Asia by installed capacity, reaching an estimated 1,717 MW in 2026. Jakarta retains 56.7% of national capacity, but the geography of investment is shifting rapidly toward Greater Jakarta's industrial corridors: Bekasi, Cibitung, Cikarang, and Karawang.</p>

            <h3>2.1 The Operator Landscape</h3>

            <p>Indonesia's DC market is dominated by a mix of domestic and regional players. To illustrate the competitive dynamics without commercial bias, we anonymize the operators:</p>

            <div class="data-table-container">
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Operator</th>
                            <th>Location</th>
                            <th>Capacity</th>
                            <th>Status</th>
                            <th>Key Note</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr class="highlight-row">
                            <td><strong>DC-IDX-1 (Listed)</strong></td>
                            <td>Cibitung, Karawang, Jakarta</td>
                            <td>119 MW (live) + 36 MW (H1'25)</td>
                            <td>Expanding</td>
                            <td>Rev +36% YoY; NI margin 54%</td>
                        </tr>
                        <tr>
                            <td>DC-Global-2</td>
                            <td>Bekasi (Greater Jakarta)</td>
                            <td>120 MW campus</td>
                            <td>$1B investment</td>
                            <td>AI-ready hyperscale</td>
                        </tr>
                        <tr>
                            <td>DC-Telco-3</td>
                            <td>Multiple cities</td>
                            <td>~150 MW (est.)</td>
                            <td>Expanding</td>
                            <td>State-owned telco subsidiary</td>
                        </tr>
                        <tr>
                            <td>DC-Regional-4</td>
                            <td>Greater Jakarta, Batam</td>
                            <td>500 MW planned (AI Campus)</td>
                            <td>PPAs signed</td>
                            <td>Wholesale deals 250+ MW</td>
                        </tr>
                        <tr>
                            <td>DC-US-5</td>
                            <td>Jakarta</td>
                            <td>New entrant</td>
                            <td>$403M financing</td>
                            <td>Sustainability-linked</td>
                        </tr>
                        <tr>
                            <td>DC-Japan-6</td>
                            <td>Greater Jakarta</td>
                            <td>Multiple facilities</td>
                            <td>Established</td>
                            <td>Enterprise + cloud focus</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <p class="table-source" style="font-size:0.72rem;color:#64748b;font-style:italic;margin:0.4rem 0 1.2rem;">Source: Publicly available industry data and published standards. For educational and research purposes only.</p>

            <h3>2.2 DC-IDX-1: The Indonesian Market Benchmark</h3>

            <p>The most visible indicator of Indonesia's DC market health is its only publicly listed pure-play data center operator, which we designate DC-IDX-1. With a portfolio spanning three campuses (Cibitung at 73 MW being the largest, Karawang at 27 MW, and Jakarta CBD at 19 MW), this operator provides the rare transparency of public financial reporting in an otherwise opaque market.</p>

            <div class="comparison-grid">
                <div class="comparison-card risk-low">
                    <div class="card-title">2024 Revenue</div>
                    <div class="card-value" style="color: #059669;">Rp 1.81T</div>
                    <div class="card-desc">+36% year-over-year growth</div>
                </div>
                <div class="comparison-card risk-low">
                    <div class="card-title">Q1 2025 Revenue</div>
                    <div class="card-value" style="color: #059669;">Rp 774B</div>
                    <div class="card-desc">+119% YoY acceleration</div>
                </div>
                <div class="comparison-card risk-low">
                    <div class="card-title">Net Income Margin</div>
                    <div class="card-value" style="color: #059669;">54%</div>
                    <div class="card-desc">Q1 2025 profitability</div>
                </div>
                <div class="comparison-card risk-medium">
                    <div class="card-title">2025 Capex</div>
                    <div class="card-value" style="color: #d97706;">Rp 1T</div>
                    <div class="card-desc">JK6 (36 MW) + DCI-E2 Surabaya</div>
                </div>
            </div>

            <p>The JK6 facility at their Cibitung campus adds 36 MW of AI-ready capacity with liquid cooling support, bringing total capacity to 155 MW by mid-2025. Beyond that, the company has disclosed plans for a massive <strong>DCI-H3 in Bintan</strong> with projected capacity exceeding <strong>1,000 MW</strong> &mdash; a tenfold increase over their current portfolio.</p>

            <div class="caution-box">
                <p><strong>The question DC-IDX-1 investors should ask:</strong> Current financials are exceptional (54% net margin, triple-digit revenue growth). But the 1,000 MW Bintan ambition represents a $8-10B capex commitment over the next decade. Can a company generating ~Rp 3T annual revenue fund this without massive dilution or debt? And who are the pre-committed tenants for a 1,000 MW facility on an island?</p>
            </div>

            <h3>2.3 The PLN Power Bottleneck</h3>

            <p>Jakarta's transmission backbone is near saturation, a constraint that compounds the <a href="article-11.html">electricity cost pressures on citizens</a> already facing rising tariffs. Data center bookings are forecast to absorb <strong>2,200 MW by 2030</strong> &mdash; more than one-third of PLN's incremental substation additions. The state utility's RUPTL 2025-2034 calls for 69.5 GW of new generation, but the gap between data center demand and grid capacity is a binding constraint that could determine which projects succeed and which stall.</p>

            <p>Greater Jakarta (covering 70% of Indonesia's DC capacity) is particularly vulnerable. Operators in Bekasi and Cikarang are already competing for limited transformer capacity, and new substations take 2-3 years to commission.</p>

            <!-- 3. The Johor Question -->
            <h2 id="section-3">3. Johor: Boom or Bubble?</h2>

            <p>No market in Southeast Asia demands more scrutiny than Johor. The numbers are extraordinary: from a standing start of near-zero five years ago, Johor now has 487 MW of live capacity, 422 MW under construction, and a total pipeline of <strong>5.8 GW</strong>.</p>

            <h3>3.1 The Bull Case</h3>
            <div class="safe-box">
                <p><strong>Proximity to Singapore</strong> (~2ms fiber latency) makes Johor a natural overflow market for the world's tightest DC hub (2% vacancy). Land costs are a fraction of Singapore's. Hyperscaler commitments are real: Microsoft ($2.2B), AWS ($6B by 2037), Google active. Malaysia's data center capacity is set to <strong>double by end-2026</strong> (Nikkei Asia). Current vacancy in Johor: just 1.1%.</p>
            </div>

            <h3>3.2 The Bear Case</h3>
            <div class="danger-box">
                <p><strong>Much carrier-neutral capacity is speculative</strong> &mdash; tenants not yet secured. 3.4 GW of the 5.8 GW pipeline is early-stage projects. Power infrastructure may not keep pace: operators are having to solve their own energy problems (DayOne's 500 MW solar PPA with TNB). Sources close to the Johor state government indicate discussions about <strong>potential limits on new DC approvals</strong>, echoing the <a href="article-14.html">community opposition patterns</a> already playing out from Virginia to Johor. The region risks becoming overbuilt for hyperscalers that may not come at the expected pace.</p>
            </div>

            <p>Here's the math that matters: AWS's $6B investment in Malaysia spans <strong>15 years</strong>. That's ~$400M per year. Microsoft's $2.2B is over 4 years. These are not lump-sum capacity injections &mdash; they're gradual deployments that the 5.8 GW pipeline dramatically outpaces.</p>

            <!-- 4. Hyperscaler Dependency -->
            <h2 id="section-4">4. Building on Borrowed Promises: The Hyperscaler Dependency Trap</h2>

            <p>An estimated 60-70% of new large-scale builds (50 MW+) in SEA are build-to-suit or pre-leased to hyperscalers. The remaining 30-40% are speculative, carrier-neutral builds hoping to attract tenants post-construction. This creates a dangerous concentration of risk.</p>

            <h3>4.1 The Self-Build Trend Nobody Discusses</h3>

            <p>While colo providers build for hyperscalers, the hyperscalers themselves are quietly building their own facilities:</p>
            <ul>
                <li><strong>Microsoft:</strong> Self-build data centers under development in Cyberjaya, Malaysia</li>
                <li><strong>Google:</strong> Self-build facility in northern Kuala Lumpur</li>
                <li><strong>AWS:</strong> Self-build operations across Singapore ($17B commitment)</li>
            </ul>

            <p>The hyperscaler playbook is clear: <em>use colocation for speed-to-market, then progressively shift workloads to owned infrastructure where economics favor it.</em> Every MW of self-build capacity is a MW that won't be leased from a colo provider.</p>

            <h3>4.2 The $602 Billion Question</h3>

            <p>Hyperscaler capex is projected at <strong>$602 billion in 2026</strong> (36% increase over 2025), with 75% directed to AI infrastructure. The Big Five now spend 45-57% of revenue on capex &mdash; ratios historically associated with overinvestment. They've raised <strong>$108 billion in debt in 2025 alone</strong> to fund this expansion.</p>

            <blockquote>
                "The projected $3 trillion in AI infrastructure investment by 2028 would rival the railroad build-out of the 1800s in scale. AI CapEx is approximately 0.9% of US GDP, compared to 4% for railways and 1.2% for telecom during their respective build-outs." &mdash; Goldman Sachs, 2026
            </blockquote>

            <div class="danger-box">
                <p><strong>What happens if hyperscaler capex slows?</strong> DeepSeek's R1 model &mdash; trained for allegedly $5.6M using 2,000 H800 GPUs vs. $80-100M and 16,000 H100s for comparable Western models &mdash; demonstrated that the relationship between AI capability and infrastructure demand is not linear. If efficiency improvements outpace demand growth, the SEA colo pipeline faces a brutal correction.</p>
            </div>

            <!-- 5. Legacy DCs -->
            <h2 id="section-5">5. The Stranded Assets Nobody Talks About</h2>

            <p>While billions pour into new AI-ready facilities, a quieter crisis unfolds in the region's older data centers. Pre-2015 facilities designed for 5-10 kW per rack are fundamentally incompatible with modern AI workloads demanding 50-100 kW per rack.</p>

            <div class="data-table-container">
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Metric</th>
                            <th>Legacy DC (pre-2015)</th>
                            <th>Modern AI-Ready DC</th>
                            <th>Gap</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Rack Density</td>
                            <td>5-10 kW/rack</td>
                            <td>50-100 kW/rack</td>
                            <td style="color: #dc2626; font-weight: 700;">10x</td>
                        </tr>
                        <tr>
                            <td>Cooling</td>
                            <td>Raised-floor CRAC/CRAH</td>
                            <td>DLC, Immersion</td>
                            <td style="color: #dc2626; font-weight: 700;">Complete redesign</td>
                        </tr>
                        <tr>
                            <td>Floor Loading</td>
                            <td>Standard (~2,000 lbs)</td>
                            <td>5,000-8,000 lbs/rack</td>
                            <td style="color: #dc2626; font-weight: 700;">4x</td>
                        </tr>
                        <tr>
                            <td>PUE</td>
                            <td>1.8-2.5</td>
                            <td>1.2-1.3</td>
                            <td style="color: #dc2626; font-weight: 700;">40% less efficient</td>
                        </tr>
                        <tr>
                            <td>Power Architecture</td>
                            <td>Single-feed, basic</td>
                            <td>Dual-grid, on-site gen</td>
                            <td style="color: #dc2626; font-weight: 700;">Full rebuild</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <p class="table-source" style="font-size:0.72rem;color:#64748b;font-style:italic;margin:0.4rem 0 1.2rem;">Source: Publicly available industry data and published standards. For educational and research purposes only.</p>

            <p>Legacy facilities face a <strong>dual compression</strong>: their existing enterprise tenants migrate to cloud (AWS, Azure, GCP), while hyperscaler/AI tenants exclusively target purpose-built, AI-ready facilities. Retrofitting from 5 kW to 15-20 kW/rack is feasible at ~$5-6M per MW, but reaching true AI-ready density (50+ kW/rack) is impractical in most pre-2015 buildings due to structural, electrical, and cooling limitations.</p>

            <p>For smaller operators stuck with aging facilities, selling VPS or managed hosting services is a survival strategy, not a growth strategy. Margins have compressed 15-30% over four years, and the hyperscalers' own cloud services progressively eliminate every competitive advantage local providers once held.</p>

            <div class="caution-box">
                <p><strong>The Philippines warning:</strong> SM Investments Corporation, one of the country's largest conglomerates, announced in late 2025 it was <strong>exiting the data center business entirely</strong>, citing soaring electricity costs and heightened disaster risks. When a diversified conglomerate can't make DC economics work, what chance do subscale operators have?</p>
            </div>

            <!-- 6. Is This a Bubble? -->
            <h2 id="section-6">6. Is This a Bubble? The Historical Parallels</h2>

            <p>To answer this question honestly, we need to examine what happened before in similar infrastructure build-outs.</p>

            <div class="bubble-timeline">
                <div class="timeline-item">
                    <div class="timeline-dot" style="background: #059669;"></div>
                    <div class="timeline-year" style="color: #059669;">1996-2000: The Telecom Fiber Boom</div>
                    <div class="timeline-content" style="border-color: #059669;">
                        Companies laid enough fiber to circle the earth 1,500 times. By 2001, less than 3% was lit. Bankruptcies: WorldCom, Global Crossing, 360networks. Total losses: <strong>$2 trillion</strong>. The infrastructure eventually proved valuable &mdash; but most original investors lost everything.
                    </div>
                </div>
                <div class="timeline-item">
                    <div class="timeline-dot" style="background: #eab308;"></div>
                    <div class="timeline-year" style="color: #eab308;">2007-2009: US Data Center Overbuild</div>
                    <div class="timeline-content" style="border-color: #eab308;">
                        Speculative DC construction in Northern Virginia, Chicago, and Dallas outpaced demand. Vacancy rates spiked to 20-30% in some markets. Multiple operators went bankrupt or were acquired at distressed valuations. Recovery took 3-4 years.
                    </div>
                </div>
                <div class="timeline-item">
                    <div class="timeline-dot" style="background: #d97706;"></div>
                    <div class="timeline-year" style="color: #d97706;">2015-2020: China's DC Ghost Towns</div>
                    <div class="timeline-content" style="border-color: #d97706;">
                        Inner Mongolia, Guizhou, and other provinces built massive DC parks with government subsidies. Many sat empty or severely underutilized. Provincial governments offered free land and electricity subsidies, but demand never materialized as projected.
                    </div>
                </div>
                <div class="timeline-item">
                    <div class="timeline-dot" style="background: #dc2626;"></div>
                    <div class="timeline-year" style="color: #dc2626;">2024-2026: The SEA Build-Out</div>
                    <div class="timeline-content" style="border-color: #dc2626;">
                        $37B+ invested. 6,068 MW pipeline. Johor: 5.8 GW for a state of 3.8M people. Build-to-suit concentration on hyperscalers spending 45-57% of revenue on capex. Bullwhip effect warning: analysts flag 2027-2029 as the likely correction window.
                    </div>
                </div>
            </div>

            <h3>6.1 The Bullwhip Effect</h3>

            <p>The <strong>bullwhip effect</strong> &mdash; where supply decisions lag demand signals, causing amplified boom-bust cycles &mdash; is the most dangerous dynamic in the current market. Here's how it works in data centers:</p>

            <ol>
                <li><strong>Demand signal:</strong> Hyperscalers announce massive AI investments (2023-2024)</li>
                <li><strong>Supply response:</strong> Colo operators begin 18-36 month construction cycles (2024-2025)</li>
                <li><strong>Lag period:</strong> New supply comes online 2-3 years after demand signal (2026-2028)</li>
                <li><strong>Potential mismatch:</strong> If AI capex decelerates or efficiency improves, supply arrives into weakening demand (2027-2029)</li>
            </ol>

            <p>Analysts at Gadallon Research explicitly warn of <em>"periods of overcapacity and unstable pricing for multiple years"</em> as the bullwhip unwinds, with mid-decade (2025-2026) identified as a potential inflection point. Occupancy rates are projected to peak at >95% in late 2026, <strong>followed by moderation starting 2027</strong>.</p>

            <h3>6.2 Bubble Indicators Scorecard</h3>

            <div class="data-table-container">
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Indicator</th>
                            <th>Classic Bubble Signal</th>
                            <th>SEA DC Market 2026</th>
                            <th>Signal?</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Supply outpacing demand</td>
                            <td>Construction > absorption rate</td>
                            <td>Johor: 5.8 GW pipeline, ~200 MW/yr absorption</td>
                            <td style="color: #dc2626; font-weight: 700;">STRONG</td>
                        </tr>
                        <tr>
                            <td>Speculative building</td>
                            <td>Building without anchor tenants</td>
                            <td>30-40% of large builds are spec</td>
                            <td style="color: #d97706; font-weight: 700;">MODERATE</td>
                        </tr>
                        <tr>
                            <td>Easy money / cheap debt</td>
                            <td>Low-cost financing fueling expansion</td>
                            <td>$2.8B (Bridge), $1B+ REIT (AirTrunk)</td>
                            <td style="color: #d97706; font-weight: 700;">MODERATE</td>
                        </tr>
                        <tr>
                            <td>"This time is different"</td>
                            <td>Belief that old rules don't apply</td>
                            <td>"AI demand is insatiable"</td>
                            <td style="color: #dc2626; font-weight: 700;">STRONG</td>
                        </tr>
                        <tr>
                            <td>New entrants flooding in</td>
                            <td>Non-traditional players entering</td>
                            <td>Real estate, PE, sovereign funds</td>
                            <td style="color: #dc2626; font-weight: 700;">STRONG</td>
                        </tr>
                        <tr>
                            <td>Customer concentration</td>
                            <td>Revenue depends on few buyers</td>
                            <td>60-70% hyperscaler dependency</td>
                            <td style="color: #dc2626; font-weight: 700;">STRONG</td>
                        </tr>
                        <tr>
                            <td>Demand actually materializing</td>
                            <td>Revenue growth validating investment</td>
                            <td>DC-IDX-1: +119% Q1'25 revenue</td>
                            <td style="color: #059669; font-weight: 700;">HEALTHY</td>
                        </tr>
                        <tr>
                            <td>Structural demand driver</td>
                            <td>Fundamental shift supporting growth</td>
                            <td>AI, cloud, digital transformation</td>
                            <td style="color: #059669; font-weight: 700;">HEALTHY</td>
                        </tr>
                    </tbody>
                </table>
                <p class="table-source">Assessment: 4 strong bubble signals, 2 moderate, 2 healthy counter-signals. Verdict: <strong>selective bubble</strong> &mdash; not uniform across all markets. For educational and research purposes only.</p>
            </div>

            <!-- 7. Investment Analysis -->
            <h2 id="section-7">7. Investment Analysis: The Numbers Behind the Bets</h2>

            <h3>7.1 Build Economics</h3>

            <div class="comparison-grid">
                <div class="comparison-card">
                    <div class="card-title">Cost per MW (Greenfield)</div>
                    <div class="card-value" style="color: #d97706;">$8-10M</div>
                    <div class="card-desc">AI-ready, liquid cooling, Tier III+</div>
                </div>
                <div class="comparison-card">
                    <div class="card-title">Cost per MW (Retrofit)</div>
                    <div class="card-value" style="color: #eab308;">$5-6M</div>
                    <div class="card-desc">Limited to 15-20 kW/rack max</div>
                </div>
                <div class="comparison-card">
                    <div class="card-title">Revenue per MW/Year</div>
                    <div class="card-value" style="color: #059669;">$1.5-2.5M</div>
                    <div class="card-desc">Varies by market and tenant</div>
                </div>
                <div class="comparison-card">
                    <div class="card-title">Target Payback</div>
                    <div class="card-value" style="color: #2563eb;">5-7 years</div>
                    <div class="card-desc">At 85%+ occupancy rate</div>
                </div>
            </div>

            <h3>7.2 The Break-Even Trap</h3>

            <p>A typical 20 MW data center in Southeast Asia requires approximately <strong>60-70% occupancy</strong> to break even on operating costs, and <strong>80-85% occupancy</strong> to achieve the IRR targets that justify the initial investment. Here's what happens at different occupancy levels:</p>

            <div class="data-table-container">
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Occupancy</th>
                            <th>Revenue (20 MW DC)</th>
                            <th>OPEX Coverage</th>
                            <th>Capex Payback</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>90%+</td>
                            <td>$36-45M/yr</td>
                            <td>Full</td>
                            <td>5-6 years</td>
                            <td style="color: #059669; font-weight: 700;">Healthy</td>
                        </tr>
                        <tr>
                            <td>70-85%</td>
                            <td>$28-38M/yr</td>
                            <td>Full</td>
                            <td>7-10 years</td>
                            <td style="color: #eab308; font-weight: 700;">Marginal</td>
                        </tr>
                        <tr>
                            <td>50-70%</td>
                            <td>$20-28M/yr</td>
                            <td>Partial</td>
                            <td>10+ years</td>
                            <td style="color: #d97706; font-weight: 700;">Distressed</td>
                        </tr>
                        <tr>
                            <td>&lt;50%</td>
                            <td>&lt;$20M/yr</td>
                            <td>Negative cash flow</td>
                            <td>Never</td>
                            <td style="color: #dc2626; font-weight: 700;">Failure</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <p class="table-source" style="font-size:0.72rem;color:#64748b;font-style:italic;margin:0.4rem 0 1.2rem;">Source: Publicly available industry data and published standards. For educational and research purposes only.</p>

            <p>If vacancy rates across SEA rise by just 10-15 percentage points (from ~14% regional average to 25-30%), the revenue impact cascades: operators cut pricing to fill space, which compresses margins for everyone, which delays capex payback, which triggers covenant breaches on debt, which forces distressed sales. This is how infrastructure bubbles unwind.</p>

            <!-- 8. What Happens Next -->
            <h2 id="section-8">8. What Happens When the Music Stops</h2>

            <h3>8.1 The Correction Scenario (2027-2029)</h3>

            <p>Based on the evidence, here is the most likely correction scenario:</p>

            <ol>
                <li><strong>Late 2026:</strong> Occupancy peaks at 95%+ as current pipeline absorbs pent-up demand</li>
                <li><strong>2027:</strong> Massive new supply comes online (Johor, Thailand, Indonesia). Vacancy begins rising</li>
                <li><strong>2027-2028:</strong> Pricing pressure as operators compete for tenants. Spec builds particularly affected</li>
                <li><strong>2028-2029:</strong> Consolidation wave. Smaller/subscale operators acquired or exit. Legacy DCs face accelerated obsolescence</li>
                <li><strong>2029-2030:</strong> Market stabilizes at new equilibrium. Survivors emerge stronger with consolidated positions</li>
            </ol>

            <h3>8.2 Who Survives</h3>

            <div class="comparison-grid">
                <div class="comparison-card risk-low">
                    <div class="card-icon">&#9989;</div>
                    <div class="card-title">Operators with Secured Power</div>
                    <div class="card-desc">PPAs and dedicated substations give structural advantage. Power availability &mdash; not demand &mdash; is the binding constraint.</div>
                </div>
                <div class="comparison-card risk-low">
                    <div class="card-icon">&#9989;</div>
                    <div class="card-title">Pre-Committed Anchor Tenants</div>
                    <div class="card-desc">Operators with long-term hyperscaler contracts weather downturns. Build-to-suit &gt; speculative builds.</div>
                </div>
                <div class="comparison-card risk-high">
                    <div class="card-icon">&#10060;</div>
                    <div class="card-title">Spec Builders Without Tenants</div>
                    <div class="card-desc">Carrier-neutral facilities without signed LOIs are the first casualties of a correction.</div>
                </div>
                <div class="comparison-card risk-high">
                    <div class="card-icon">&#10060;</div>
                    <div class="card-title">Legacy DCs on VPS Revenue</div>
                    <div class="card-desc">Sub-10 kW/rack facilities with declining hosting revenue face stranded asset risk.</div>
                </div>
            </div>

            <h3>8.3 The Verdict</h3>

            <div class="warning-box">
                <h4>
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/><line x1="12" y1="9" x2="12" y2="13"/><line x1="12" y1="17" x2="12.01" y2="17"/></svg>
                    Is this a bubble? Yes &mdash; but a selective one.
                </h4>
                <p>This is not a uniform bubble across all SEA markets. <strong>Singapore</strong> (2% vacancy, strict government controls) is undersupplied and will remain so through 2028. <strong>Indonesia</strong> has strong domestic demand but power infrastructure constraints will self-regulate growth. <strong>Vietnam</strong> is early-stage with genuine structural demand.</p>
                <p>The bubble is concentrated in <strong>Johor</strong> (5.8 GW for 3.8M people), parts of <strong>Thailand</strong> (20x investment jump in 6 months), and among <strong>speculative, carrier-neutral operators</strong> building without anchor tenants. The 2027-2029 correction will be real, but it will be geographic and operator-specific &mdash; not a market-wide collapse.</p>
                <p>The infrastructure being built will eventually prove valuable. But as the fiber-optic crash of 2001 taught us: <em>the infrastructure can be right while the investment timing is catastrophically wrong.</em></p>
            </div>

            <!-- Calculator -->
            <h2 id="section-9">9. Interactive: SEA DC Bubble Risk Calculator</h2>

            <p>Model the supply-demand dynamics for any SEA market. Adjust the variables below to see how different scenarios affect bubble risk, vacancy projections, and investment outcomes.</p>

            <div class="bubble-calculator">
                <div class="calc-title">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/><line x1="12" y1="9" x2="12" y2="13"/><line x1="12" y1="17" x2="12.01" y2="17"/></svg>
                    SEA Data Center Bubble Risk Analyzer
                </div>
                <p class="calc-subtitle">Model supply-demand dynamics and risk exposure for any SEA market. Hover <span class="calc-tooltip" style="display:inline-flex;">?<span class="tip-text">Hover over any ? icon for detailed explanations of each input parameter and how it affects the risk calculation.</span></span> icons for parameter explanations.</p>

                <!-- Pro Mode Toolbar -->
                <div class="bub-toolbar">
                    <div class="bub-mode-bar">
                        <button class="bub-toolbar-btn bub-btn-free active" onclick="bubSetMode('free')"><i class="fas fa-chart-bar"></i> Free Assessment</button>
                        <button class="bub-toolbar-btn bub-btn-pro" onclick="bubSetMode('pro')"><i class="fas fa-crown"></i> Pro Risk Intelligence</button>
                    </div>
                    <div class="bub-toolbar-actions">
                        <button class="bub-btn-reset" onclick="bubResetDefaults()"><i class="fas fa-undo"></i> Reset</button>
                        <button class="bub-btn-pdf" onclick="bubExportPDF()"><i class="fas fa-file-pdf"></i> Export PDF</button>
                    </div>
                </div>

                <!-- Supply & Market -->
                <div style="font-size: 0.75rem; color: #fbbf24; font-weight: 600; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 0.75rem;">Supply &amp; Market Parameters</div>
                <div class="calc-grid">
                    <div class="calc-input-group">
                        <div class="calc-label-row"><label>Market</label><span class="calc-tooltip">?<span class="tip-text">Pre-loaded with real market data from Cushman &amp; Wakefield, Arizton, and CBRE H1 2025 reports. Select "Custom" to model a hypothetical market.</span></span></div>
                        <select id="calcMarket" onchange="prefillMarket()">
                            <option value="johor">Malaysia (Johor)</option>
                            <option value="indonesia">Indonesia (Greater Jakarta)</option>
                            <option value="singapore">Singapore</option>
                            <option value="thailand">Thailand (EEC)</option>
                            <option value="vietnam">Vietnam (HCMC/Hanoi)</option>
                            <option value="philippines">Philippines (Manila)</option>
                            <option value="custom">Custom Market</option>
                        </select>
                    </div>
                    <div class="calc-input-group">
                        <div class="calc-label-row"><label>Current Operational (MW)</label><span class="calc-tooltip">?<span class="tip-text">Currently live and energized IT load capacity in the market. This is the baseline that represents proven, absorbed demand. Source: Cushman &amp; Wakefield H1 2025.</span></span></div>
                        <input type="number" id="calcOperational" value="487" min="0" max="10000">
                    </div>
                    <div class="calc-input-group">
                        <div class="calc-label-row"><label>Total Pipeline (MW)</label><span class="calc-tooltip">?<span class="tip-text">Total announced + under construction + planned capacity through 2030. Includes committed builds (with LOIs/PPAs) and speculative builds (no anchor tenants). Source: Arizton 2025-2030.</span></span></div>
                        <input type="number" id="calcPipeline" value="5800" min="0" max="50000">
                    </div>
                    <div class="calc-input-group">
                        <div class="calc-label-row"><label>Population (millions)</label><span class="calc-tooltip">?<span class="tip-text">Market population for computing pipeline-to-population ratio. Helps contextualize whether the pipeline is proportional to the addressable market or wildly excessive.</span></span></div>
                        <input type="number" id="calcPopulation" value="3.8" min="0.1" max="2000" step="0.1">
                    </div>
                </div>

                <!-- Demand & Absorption -->
                <div style="font-size: 0.75rem; color: #fbbf24; font-weight: 600; text-transform: uppercase; letter-spacing: 1px; margin: 1.5rem 0 0.75rem;">Demand &amp; Absorption Dynamics</div>
                <div class="calc-grid">
                    <div class="calc-input-group">
                        <div class="calc-label-row"><label>Annual Absorption Rate (MW/yr)</label><span class="calc-tooltip">?<span class="tip-text">How much new DC capacity the market actually fills per year. Based on historical take-up rates. SG: ~150 MW/yr, ID: ~300 MW/yr, Johor: ~200 MW/yr (optimistic). This is the most critical input — it determines how fast supply gets absorbed.</span></span></div>
                        <input type="number" id="calcAbsorption" value="200" min="10" max="5000">
                    </div>
                    <div class="calc-input-group">
                        <div class="calc-label-row"><label>Hyperscaler Pre-Committed (%)</label><span class="calc-tooltip">?<span class="tip-text">Percentage of pipeline with signed hyperscaler LOIs, PPAs, or build-to-suit contracts. Pre-committed capacity is "safe" — it has guaranteed demand. Higher % = lower bubble risk. AWS, Google, Microsoft, and Meta are the primary hyperscaler tenants.</span></span></div>
                        <input type="number" id="calcPrecommit" value="40" min="0" max="100">
                    </div>
                    <div class="calc-input-group">
                        <div class="calc-label-row"><label>Speculative Build (%)</label><span class="calc-tooltip">?<span class="tip-text">Percentage of pipeline built WITHOUT anchor tenants or signed LOIs. These are carrier-neutral facilities betting that "demand will come." Speculative builds are the first casualties in a correction — they bear the most risk. Higher % = higher bubble risk.</span></span></div>
                        <input type="number" id="calcSpec" value="35" min="0" max="100">
                    </div>
                    <div class="calc-input-group">
                        <div class="calc-label-row"><label>Demand Growth Rate (%/yr)</label><span class="calc-tooltip">?<span class="tip-text">Annual organic demand growth rate for data center capacity, driven by digital economy expansion, cloud adoption, and enterprise migration. SEA average: 15-20%. Used to model whether absorption will accelerate over time.</span></span></div>
                        <input type="number" id="calcDemandGrowth" value="15" min="0" max="50">
                    </div>
                </div>

                <!-- Financial Parameters -->
                <div style="font-size: 0.75rem; color: #fbbf24; font-weight: 600; text-transform: uppercase; letter-spacing: 1px; margin: 1.5rem 0 0.75rem;">Financial &amp; Investment Parameters</div>
                <div class="calc-grid">
                    <div class="calc-input-group">
                        <div class="calc-label-row"><label>Avg Build Cost ($M/MW)</label><span class="calc-tooltip">?<span class="tip-text">Greenfield construction cost per MW of IT load. Includes land, building, MEP, commissioning. Ranges: $7-8M (VN/PH), $8-10M (ID/MY/TH), $12-15M (SG). AI-ready with liquid cooling adds 15-20%. Used to compute total capital at risk.</span></span></div>
                        <input type="number" id="calcCostMW" value="9" min="1" max="30" step="0.5">
                    </div>
                    <div class="calc-input-group">
                        <div class="calc-label-row"><label>Avg Revenue/MW/Year ($M)</label><span class="calc-tooltip">?<span class="tip-text">Annual colocation revenue per MW. Includes power pass-through, space rental, cross-connects, and managed services. SG: $2.5-3.5M, ID/MY: $1.5-2.2M, VN/TH: $1.4-2.0M. Used for break-even and payback calculations.</span></span></div>
                        <input type="number" id="calcRevMW" value="2.0" min="0.5" max="5" step="0.1">
                    </div>
                    <div class="calc-input-group">
                        <div class="calc-label-row"><label>OPEX Ratio (%)</label><span class="calc-tooltip">?<span class="tip-text">Operating expenses as % of revenue. Includes electricity (40-55%), staff (8-12%), maintenance (5-8%), insurance, land lease, and SGA. Typical range: 55-70% for SEA operators. Used to calculate break-even occupancy and EBITDA margin.</span></span></div>
                        <input type="number" id="calcOpexRatio" value="62" min="40" max="85">
                    </div>
                    <div class="calc-input-group">
                        <div class="calc-label-row"><label>Discount Rate / WACC (%)</label><span class="calc-tooltip">?<span class="tip-text">Weighted average cost of capital for NPV calculations. Reflects risk premium for the market. Infrastructure funds: 8-10%, SEA premium: 2-4% above US/EU. Higher WACC = more conservative assessment of whether the investment returns justify the risk.</span></span></div>
                        <input type="number" id="calcWACC" value="10" min="5" max="20" step="0.5">
                    </div>
                </div>

                <button class="calc-button" onclick="calculateBubbleRisk()">
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/><line x1="12" y1="9" x2="12" y2="13"/><line x1="12" y1="17" x2="12.01" y2="17"/></svg>
                    Analyze Bubble Risk
                </button>

                <div class="calc-results" id="calcResults">
                    <!-- Supply-Demand Metrics -->
                    <div style="font-size: 0.75rem; color: #fbbf24; font-weight: 600; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 0.75rem;">Supply-Demand Analysis</div>
                    <div class="results-grid">
                        <div class="result-item">
                            <div class="label">Supply-to-Demand Ratio <span class="res-tip">?<span class="res-tip-body"><div class="rtt">Supply-to-Demand Ratio</div><div class="rtd">Pipeline capacity divided by projected demand. Ratio &gt;2.0 indicates oversupply risk.</div><span class="rtf">&lt;1.5 Undersupplied &middot; 1.5-2.5 Balanced &middot; &gt;2.5 Oversupplied</span></span></span></div>
                            <div class="value" id="rSupplyDemand">-</div>
                            <div class="subtext" id="rSDNote">-</div>
                        </div>
                        <div class="result-item">
                            <div class="label">Years to Absorb Pipeline <span class="res-tip">?<span class="res-tip-body"><div class="rtt">Pipeline Absorption</div><div class="rtd">Time for the market to fill current pipeline at the given absorption rate.</div><span class="rtf">&gt;5 years = high oversupply risk</span></span></span></div>
                            <div class="value" id="rYearsAbsorb">-</div>
                            <div class="subtext">At current absorption rate</div>
                        </div>
                        <div class="result-item">
                            <div class="label">Projected 2028 Vacancy <span class="res-tip">?<span class="res-tip-body"><div class="rtt">2028 Vacancy Rate</div><div class="rtd">Projected percentage of DC capacity sitting empty by 2028.</div><span class="rtf">&lt;10% healthy &middot; &gt;30% distressed</span></span></span></div>
                            <div class="value" id="rVacancy2028">-</div>
                            <div class="subtext" id="rVacNote">-</div>
                        </div>
                        <div class="result-item">
                            <div class="label">Pipeline / Population <span class="res-tip">?<span class="res-tip-body"><div class="rtt">MW per Million People</div><div class="rtd">DC capacity per million population — measures market maturity.</div></span></span></div>
                            <div class="value" id="rPipePerPop">-</div>
                            <div class="subtext" id="rPipePopNote">-</div>
                        </div>
                        <div class="result-item">
                            <div class="label">Capital at Risk <span class="res-tip">?<span class="res-tip-body"><div class="rtt">Capital at Risk</div><div class="rtd">Total investment capital exposed to oversupply risk (vacant capacity &times; build cost).</div></span></span></div>
                            <div class="value" id="rCapitalRisk">-</div>
                            <div class="subtext">Speculative builds only</div>
                        </div>
                        <div class="result-item">
                            <div class="label">Total Pipeline Capex <span class="res-tip">?<span class="res-tip-body"><div class="rtt">Total Pipeline Capex</div><div class="rtd">Total capital expenditure for all pipeline capacity in the market.</div></span></span></div>
                            <div class="value" id="rTotalCapex">-</div>
                            <div class="subtext">Full pipeline build cost</div>
                        </div>
                    </div>

                    <!-- Financial Risk Metrics -->
                    <div style="font-size: 0.75rem; color: #fbbf24; font-weight: 600; text-transform: uppercase; letter-spacing: 1px; margin: 1.25rem 0 0.75rem;">Financial Risk Metrics</div>
                    <div class="results-grid">
                        <div class="result-item">
                            <div class="label">Break-Even Occupancy <span class="res-tip">?<span class="res-tip-body"><div class="rtt">Break-Even Occupancy</div><div class="rtd">Minimum occupancy rate needed to cover operating costs and debt service.</div></span></span></div>
                            <div class="value" id="rBreakeven">-</div>
                            <div class="subtext">OPEX coverage threshold</div>
                        </div>
                        <div class="result-item">
                            <div class="label">Projected Avg Occupancy <span class="res-tip">?<span class="res-tip-body"><div class="rtt">Projected Avg Occupancy</div><div class="rtd">Expected average occupancy rate across the market by analysis end.</div></span></span></div>
                            <div class="value" id="rProjOcc">-</div>
                            <div class="subtext" id="rOccNote">-</div>
                        </div>
                        <div class="result-item">
                            <div class="label">Annual Revenue (Proj.) <span class="res-tip">?<span class="res-tip-body"><div class="rtt">Projected Annual Revenue</div><div class="rtd">Expected yearly revenue based on occupancy and revenue-per-MW assumptions.</div></span></span></div>
                            <div class="value" id="rRevenue">-</div>
                            <div class="subtext" id="rRevNote">-</div>
                        </div>
                        <div class="result-item">
                            <div class="label">Annual EBITDA <span class="res-tip">?<span class="res-tip-body"><div class="rtt">Annual EBITDA</div><div class="rtd">Earnings before interest, taxes, depreciation, and amortization.</div></span></span></div>
                            <div class="value" id="rEBITDA">-</div>
                            <div class="subtext" id="rEBITDANote">-</div>
                        </div>
                        <div class="result-item">
                            <div class="label">Payback Period <span class="res-tip">?<span class="res-tip-body"><div class="rtt">Payback Period</div><div class="rtd">Years to recover total capital investment from operating cash flows.</div></span></span></div>
                            <div class="value" id="rPayback">-</div>
                            <div class="subtext" id="rPayNote">-</div>
                        </div>
                        <div class="result-item">
                            <div class="label">10-Year NPV <span class="res-tip">?<span class="res-tip-body"><div class="rtt">10-Year Net Present Value</div><div class="rtd">NPV of all cash flows over 10 years at the given discount rate.</div><span class="rtf">Positive NPV = value-creating investment</span></span></span></div>
                            <div class="value" id="rNPV">-</div>
                            <div class="subtext" id="rNPVNote">At given WACC</div>
                        </div>
                    </div>

                    <!-- Risk Gauge -->
                    <div class="risk-gauge">
                        <div style="font-size: 0.8rem; color: #d6d3d1; margin-bottom: 0.5rem;">BUBBLE RISK ASSESSMENT</div>
                        <div class="gauge-bar">
                            <div class="gauge-needle" id="rGaugeNeedle" style="left: 50%;"></div>
                        </div>
                        <div class="gauge-labels">
                            <span>Low Risk</span>
                            <span>Moderate</span>
                            <span>High Risk</span>
                            <span>Critical</span>
                        </div>
                        <div class="risk-verdict" id="rVerdict">-</div>
                    </div>

                    <!-- Supply vs Demand Bars -->
                    <div class="sd-chart">
                        <div style="font-size: 0.8rem; color: #d6d3d1; margin-bottom: 1rem;">SUPPLY vs DEMAND VISUALIZATION</div>
                        <div class="sd-bar-container">
                            <div class="sd-bar-label"><span>Total Pipeline</span><span id="rBarPipeline">-</span></div>
                            <div class="sd-bar supply" id="rBarSupply" style="width: 0%;">-</div>
                        </div>
                        <div class="sd-bar-container">
                            <div class="sd-bar-label"><span>Pre-Committed Demand</span><span id="rBarDemandVal">-</span></div>
                            <div class="sd-bar demand" id="rBarDemand" style="width: 0%;">-</div>
                        </div>
                        <div class="sd-bar-container">
                            <div class="sd-bar-label"><span>3-Year Absorption (Projected)</span><span id="rBarAbsVal">-</span></div>
                            <div class="sd-bar committed" id="rBarAbsorb" style="width: 0%;">-</div>
                        </div>
                    </div>

                    <!-- Sensitivity Analysis -->
                    <div style="font-size: 0.8rem; color: #d6d3d1; margin: 1.25rem 0 0.75rem;">SENSITIVITY ANALYSIS (OPTIMISTIC / BASE / PESSIMISTIC)</div>
                    <div class="sensitivity-grid" id="sensitivityGrid"></div>

                    <!-- ═══ PRO PANELS ═══ -->
                    <div id="bubProPanels" style="display:none;">

                        <!-- Panel 1: Monte Carlo -->
                        <div class="bub-pro-panel gated" id="bubPanel1">
                            <div class="bub-panel-inner">
                                <div class="bub-panel-title"><i class="fas fa-dice"></i> Monte Carlo Risk Simulation (10,000 Runs)</div>
                                <div class="bub-kpi-grid">
                                    <div class="bub-kpi-card"><div class="bub-kpi-value" id="bubMcMean">--</div><div class="bub-kpi-label">Mean Risk Score</div></div>
                                    <div class="bub-kpi-card"><div class="bub-kpi-value" id="bubMcP5">--</div><div class="bub-kpi-label">P5 (Best Case)</div></div>
                                    <div class="bub-kpi-card"><div class="bub-kpi-value" id="bubMcP50">--</div><div class="bub-kpi-label">Median (P50)</div></div>
                                    <div class="bub-kpi-card"><div class="bub-kpi-value" id="bubMcP95">--</div><div class="bub-kpi-label">P95 (Worst Case)</div></div>
                                    <div class="bub-kpi-card"><div class="bub-kpi-value" id="bubMcStd">--</div><div class="bub-kpi-label">Std Deviation</div></div>
                                    <div class="bub-kpi-card"><div class="bub-kpi-value" id="bubMcProb">--</div><div class="bub-kpi-label">P(Risk &gt; 70)</div></div>
                                </div>
                                <canvas id="bubMcChart" width="800" height="260" style="width:100%;display:block;margin:0.5rem 0"></canvas>
                            </div>
                            <div class="bub-gate-overlay" onclick="bubShowLogin()"><i class="fas fa-lock"></i><span>Unlock Pro Risk Intelligence</span></div>
                        </div>

                        <!-- Panel 2: Sensitivity Tornado -->
                        <div class="bub-pro-panel gated" id="bubPanel2">
                            <div class="bub-panel-inner">
                                <div class="bub-panel-title"><i class="fas fa-tornado"></i> Sensitivity Tornado — Risk Score Impact</div>
                                <canvas id="bubTornadoChart" width="800" height="300" style="width:100%;display:block;margin:0.5rem 0"></canvas>
                            </div>
                            <div class="bub-gate-overlay" onclick="bubShowLogin()"><i class="fas fa-lock"></i><span>Unlock Pro Risk Intelligence</span></div>
                        </div>

                        <!-- Panel 3: Market Scenario Comparison -->
                        <div class="bub-pro-panel gated" id="bubPanel3">
                            <div class="bub-panel-inner">
                                <div class="bub-panel-title"><i class="fas fa-layer-group"></i> Scenario Intelligence Engine</div>
                                <div class="bub-scenario-grid" id="bubScenarioGrid"></div>
                            </div>
                            <div class="bub-gate-overlay" onclick="bubShowLogin()"><i class="fas fa-lock"></i><span>Unlock Pro Risk Intelligence</span></div>
                        </div>

                        <!-- Panel 4: Risk Radar + Grade -->
                        <div class="bub-pro-panel gated" id="bubPanel4">
                            <div class="bub-panel-inner">
                                <div class="bub-panel-title"><i class="fas fa-radar"></i> Multi-Dimensional Risk Radar</div>
                                <div style="display:grid;grid-template-columns:1fr 1fr;gap:1rem;align-items:center">
                                    <canvas id="bubRadarChart" width="400" height="400" style="width:100%;display:block"></canvas>
                                    <div>
                                        <div class="bub-kpi-grid" style="grid-template-columns:1fr 1fr">
                                            <div class="bub-kpi-card"><div class="bub-kpi-value" id="bubRiskGrade" style="font-size:2rem">--</div><div class="bub-kpi-label">Risk Grade</div></div>
                                            <div class="bub-kpi-card"><div class="bub-kpi-value" id="bubRiskPctile">--</div><div class="bub-kpi-label">Risk Percentile</div></div>
                                            <div class="bub-kpi-card"><div class="bub-kpi-value" id="bubDimSD">--</div><div class="bub-kpi-label">S/D Balance</div></div>
                                            <div class="bub-kpi-card"><div class="bub-kpi-value" id="bubDimSpec">--</div><div class="bub-kpi-label">Spec Exposure</div></div>
                                            <div class="bub-kpi-card"><div class="bub-kpi-value" id="bubDimAbsorb">--</div><div class="bub-kpi-label">Absorption Speed</div></div>
                                            <div class="bub-kpi-card"><div class="bub-kpi-value" id="bubDimNPV">--</div><div class="bub-kpi-label">Financial Return</div></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="bub-gate-overlay" onclick="bubShowLogin()"><i class="fas fa-lock"></i><span>Unlock Pro Risk Intelligence</span></div>
                        </div>

                        <!-- Panel 5: Executive Narrative -->
                        <div class="bub-pro-panel gated" id="bubPanel5">
                            <div class="bub-panel-inner">
                                <div class="bub-panel-title"><i class="fas fa-file-lines"></i> Executive Risk Assessment</div>
                                <div class="bub-narrative" id="bubNarrative"></div>
                            </div>
                            <div class="bub-gate-overlay" onclick="bubShowLogin()"><i class="fas fa-lock"></i><span>Unlock Pro Risk Intelligence</span></div>
                        </div>

                    </div>

                    <!-- Privacy Badge + Benchmark -->
                    <div class="bub-privacy-badge">
                        <i class="fas fa-shield-halved"></i> All calculations run in your browser — no data is sent to any server
                    </div>
                    <div class="bub-benchmark-meta">
                        <span class="bub-benchmark-tag"><i class="fas fa-code-branch"></i> Model v1.0</span>
                        <span class="bub-benchmark-tag"><i class="fas fa-calendar"></i> Updated Feb 2026</span>
                        <span class="bub-benchmark-tag"><i class="fas fa-book"></i> Sources: C&amp;W, Arizton, CBRE 2025</span>
                        <span class="bub-benchmark-tag"><i class="fas fa-info-circle"></i> 5-Factor Risk Model + MC 10K + Tornado</span>
                    </div>

                    <!-- Methodology -->
                    <div class="calc-methodology">
                        <details>
                            <summary>Calculation Methodology &amp; Assumptions</summary>
                            <p><strong>Supply-Demand Analysis:</strong></p>
                            <ul>
                                <li><strong><span class="term-tip">S/D Ratio<span class="term-def">Supply-to-Demand Ratio. Compares total pipeline capacity against projected 5-year demand. A ratio above 1.5x typically signals oversupply risk; above 2.0x is a red flag.</span></span></strong>: <code>pipeline / (absorption &times; 5)</code> &mdash; total pipeline divided by 5-year cumulative demand projection</li>
                                <li><strong>Vacancy 2028</strong>: Based on 3-year <span class="term-tip">absorption<span class="term-def">Absorption Rate is the amount of new data center capacity (MW) that gets leased/filled by tenants each year. Higher absorption = healthier market.</span></span> vs 60% of new capacity expected to come online by 2028</li>
                                <li><strong>Pipeline/Population</strong>: <code>pipeline / population</code> &mdash; MW per million people. Helps identify disproportionate builds (e.g., Johor's 1,526 MW/M vs Indonesia's 15 MW/M)</li>
                            </ul>
                            <p><strong>Financial Risk Metrics:</strong></p>
                            <ul>
                                <li><strong><span class="term-tip">Break-even Occupancy<span class="term-def">The minimum occupancy rate at which a data center covers its operating expenses (OPEX). Below this threshold, the facility operates at a cash-flow loss even if it has some tenants.</span></span></strong>: <code>OPEX% + speculative% &times; 15</code> &mdash; higher speculative builds need higher fill rates to survive</li>
                                <li><strong>Projected Occupancy</strong>: <code>max(40%, 95% - S/D ratio &times; 15%)</code> &mdash; oversupplied markets push average occupancy down</li>
                                <li><strong>Revenue</strong>: <code>rev/MW &times; pipeline &times; occupancy</code> &mdash; annual colocation revenue at projected fill rate</li>
                                <li><strong><span class="term-tip">EBITDA<span class="term-def">Earnings Before Interest, Taxes, Depreciation &amp; Amortization. The primary profitability metric for data centers. Calculated as Revenue minus Operating Expenses. Typical DC EBITDA margins: 35-45%.</span></span></strong>: <code>revenue &times; (1 - OPEX%)</code> &mdash; operating profit before financing costs</li>
                                <li><strong><span class="term-tip">NPV<span class="term-def">Net Present Value. The total value of future cash flows discounted back to today using the WACC. Positive NPV = the investment creates value; negative NPV = it destroys value. Accounts for the time value of money.</span></span></strong>: 10-year <span class="term-tip">DCF<span class="term-def">Discounted Cash Flow. A valuation method that projects future cash flows and discounts them to present value using a discount rate (WACC). Standard methodology for infrastructure investment analysis.</span></span> with 3-year ramp-up from 30% to stabilized occupancy, discounted at <span class="term-tip">WACC<span class="term-def">Weighted Average Cost of Capital. The blended cost of debt and equity financing. Represents the minimum return an investment must generate to create value. SEA infrastructure typically: 8-12%.</span></span></li>
                                <li><strong>Payback Period</strong>: <code>totalCapex / annualEBITDA</code> &mdash; years to recover initial investment. Under 7 years = attractive; over 10 years = high risk</li>
                            </ul>
                            <p><strong>Bubble Risk Score (0-100):</strong></p>
                            <ul>
                                <li>S/D ratio weight: <strong>30 pts</strong> &mdash; the dominant risk factor</li>
                                <li>Speculative build %: <strong>25 pts</strong> &mdash; builds without tenants</li>
                                <li>Low pre-commitment: <strong>20 pts</strong> &mdash; lack of hyperscaler contracts</li>
                                <li>Absorption timeline: <strong>15 pts</strong> &mdash; penalty if >3 years to fill</li>
                                <li>Extended payback: <strong>10 pts</strong> &mdash; penalty if >6 years ROI</li>
                            </ul>
                            <p style="color: #a8a29e; font-size: 0.72rem; margin-top: 0.75rem; font-weight: 400;">Disclaimer: This calculator provides directional estimates for educational purposes. Actual investment decisions require detailed feasibility studies, site-specific analysis, and professional advisory.</p>
                        </details>
                    </div>
                </div>
            </div>

            
                <!-- Independence Disclaimer -->
                <div style="margin:2rem 0 0;padding:1rem 0;border-top:1px solid rgba(255,255,255,0.06);text-align:center;">
                    <p style="font-size:0.72rem;color:#64748b;font-style:italic;line-height:1.6;margin:0;">All content on ResistanceZero is independent personal research derived from publicly available sources. This site does not represent any current or former employer. <a href="terms.html" style="color:#8b5cf6;">Terms &amp; Disclaimer</a></p>
                </div>

<!-- References -->
            <div class="references">
                <h3>References &amp; Sources</h3>
                <ol>
                    <li>ResearchAndMarkets, "South East Asia Colocation Data Center Portfolio Report 2025-2029," January 2026. <a href="https://www.globenewswire.com/news-release/2026/01/06/3213402/28124/en/" target="_blank" rel="noopener">globenewswire.com</a></li>
                    <li>Arizton, "Southeast Asia Data Center Colocation Market Supply &amp; Demand Analysis 2025-2030." <a href="https://finance.yahoo.com/news/southeast-asia-data-center-colocation-102000090.html" target="_blank" rel="noopener">yahoo.com</a></li>
                    <li>Cushman &amp; Wakefield, "APAC Data Centre H1 2025 Update." <a href="https://www.cushmanwakefield.com/en/singapore/insights/apac-data-centre-update" target="_blank" rel="noopener">cushmanwakefield.com</a></li>
                    <li>Data Center Dynamics, "The Past, Present, and Future of Johor." <a href="https://www.datacenterdynamics.com/en/analysis/the-past-present-and-future-of-johor/" target="_blank" rel="noopener">datacenterdynamics.com</a></li>
                    <li>Nikkei Asia, "Malaysia's data center capacity set to double by end-2026." <a href="https://asia.nikkei.com/business/technology/malaysia-s-data-center-capacity-set-to-double-by-end-2026" target="_blank" rel="noopener">nikkei.com</a></li>
                    <li>CBRE, "Asia Pacific Data Centre Trends &amp; Opportunities 2026." <a href="https://www.cbre.com/insights/reports/asia-pacific-data-centre-trends-opportunities" target="_blank" rel="noopener">cbre.com</a></li>
                    <li>IndoPremier, "DCII Targetkan Data Center JK6 Cibitung Beroperasi Semester I 2025." <a href="https://www.indopremier.com/ipotnews/newsDetail.php?jdl=DCII_Targetkan_Data_Center_JK6__Cibitung_Beroperasi_Semester_I_2025&news_id=462859" target="_blank" rel="noopener">indopremier.com</a></li>
                    <li>IDNFinancials, "DCII prepares IDR 1 trillion to boost data centre capacity." <a href="https://www.idnfinancials.com/news/53945/dcii-prepares-idr-1-trillion-to-boost-data-centre-capacity" target="_blank" rel="noopener">idnfinancials.com</a></li>
                    <li>Goldman Sachs, "Why AI Companies May Invest More than $500 Billion in 2026." <a href="https://www.goldmansachs.com/insights/articles/why-ai-companies-may-invest-more-than-500-billion-in-2026" target="_blank" rel="noopener">goldmansachs.com</a></li>
                    <li>IEEE ComSoc, "Hyperscaler CapEx &gt;$600B in 2026." <a href="https://techblog.comsoc.org/2025/12/22/hyperscaler-capex-600-bn-in-2026-a-36-increase-over-2025/" target="_blank" rel="noopener">comsoc.org</a></li>
                    <li>Gadallon Research, "AI's Great Infrastructure Boom: Bullwhip or Building the Future?" <a href="https://gadallon.substack.com/p/ais-great-infrastructure-boom-bullwhip" target="_blank" rel="noopener">substack.com</a></li>
                    <li>GlobeNewsWire, "Indonesia Data Center Industry Report 2026." <a href="https://www.globenewswire.com/news-release/2026/02/09/3234513/28124/en/" target="_blank" rel="noopener">globenewswire.com</a></li>
                    <li>Mordor Intelligence, "Indonesia Data Center Market Size &amp; Share 2031 Outlook." <a href="https://www.mordorintelligence.com/industry-reports/indonesia-data-center-market" target="_blank" rel="noopener">mordorintelligence.com</a></li>
                    <li>Data Center Knowledge, "Retrofitting Legacy Data Centers for AI Hardware." <a href="https://www.datacenterknowledge.com/data-center-infrastructure-management/retrofitting-refurbishment-and-roi-for-legacy-data-centers" target="_blank" rel="noopener">datacenterknowledge.com</a></li>
                    <li>Eco-Business, "High costs, higher risks: Can the Philippines power its data centre hub ambitions?" <a href="https://www.eco-business.com/news/high-costs-higher-risks-can-the-philippines-power-its-data-centre-hub-ambitions/" target="_blank" rel="noopener">eco-business.com</a></li>
                    <li>Introl, "Hyperscaler CapEx Hits $600B: The AI Infrastructure Debt Wave." <a href="https://introl.com/blog/hyperscaler-capex-600b-2026-ai-infrastructure-debt-january-2026" target="_blank" rel="noopener">introl.com</a></li>
                    <li>KR-Asia, "Malaysia's data center boom: An inside look at Asia's battle for AI supremacy." <a href="https://kr-asia.com/malaysias-data-center-boom-an-inside-look-at-asias-battle-for-ai-supremacy" target="_blank" rel="noopener">kr-asia.com</a></li>
                </ol>
            </div>

                <div class="newsletter-signup">
                    <h3>Stay Updated</h3>
                    <p>Get notified when new articles on data center operations and engineering excellence are published.</p>
                    <form class="newsletter-form" onsubmit="return subscribeNewsletter(event)">
                        <input type="email" placeholder="Enter your email" required>
                        <button type="submit">Subscribe</button>
                    </form>
                    <p class="newsletter-privacy">No spam. Unsubscribe anytime.</p>
                </div>

                <div class="author-bio">
                    <div class="author-bio-image">
                        <img loading="lazy" src="assets/profile-photo.jpg" alt="Bagus Dwi Permana">
                    </div>
                    <div class="author-bio-content">
                        <h4>Bagus Dwi Permana</h4>
                        <p class="author-bio-title">Engineering Operations Manager | Ahli K3 Listrik</p>
                        <p>12+ years professional experience in critical infrastructure and operations. CDFOM certified. Transforming operations through systematic excellence and safety-first engineering.</p>
                        <div class="author-bio-links">
                            <a href="https://www.linkedin.com/in/bagus-dwi-permana-ba90b092" target="_blank">
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/></svg>
                                LinkedIn
                            </a>
                            <a href="https://github.com/baguspermana7-cpu" target="_blank">
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/></svg>
                                GitHub
                            </a>
                            <a href="mailto:baguspermana7@gmail.com">
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg>
                                Email
                            </a>
                        </div>
                    </div>
                </div>

                <div class="related-articles">
                    <h3>Continue Reading</h3>
                    <div class="related-grid">
                        <a href="article-15.html" class="related-card">
                            <div class="related-card-number">15</div>
                            <div class="related-card-content">
                                <h4>Data Center Service Catalog</h4>
                                <p>120+ services ranked by revenue impact</p>
                            </div>
                        </a>
                        <a href="article-17.html" class="related-card">
                            <div class="related-card-number">17</div>
                            <div class="related-card-content">
                                <h4>The Counter-Narrative: Why This Time Is Different</h4>
                                <p>The bull case for SEA data center expansion</p>
                            </div>
                        </a>
                        <a href="article-14.html" class="related-card">
                            <div class="related-card-number">14</div>
                            <div class="related-card-content">
                                <h4>The $64 Billion Rebellion: Communities vs Data Centers</h4>
                                <p>Community backlash driving regulatory change</p>
                            </div>
                        </a>
                    </div>
                </div>

        </div>
    </div>
</article>
</main>

    <aside class="share-buttons" id="shareButtons" aria-label="Share this article">
        <span class="share-label">Share</span>
        <button class="share-btn linkedin" data-tooltip="Share on LinkedIn" onclick="shareLinkedIn()" aria-label="Share on LinkedIn">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/></svg>
        </button>
        <button class="share-btn twitter" data-tooltip="Share on X" onclick="shareTwitter()" aria-label="Share on X"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/></svg></button>
        <button class="share-btn whatsapp" data-tooltip="Share on WhatsApp" onclick="shareWhatsApp()" aria-label="Share on WhatsApp"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"/></svg></button>
        <button class="share-btn copy" data-tooltip="Copy link" onclick="copyLink()" aria-label="Copy article link">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="copy-icon"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="check-icon" style="display:none"><polyline points="20 6 9 17 4 12"></polyline></svg>
        </button>
    </aside>

<!-- Footer -->
    <footer class="footer footer-enhanced">
        <div class="container">
            <div class="footer-grid">
                <div class="footer-brand">
                    <p class="footer-tagline-main">BUILT FOR MISSION CRITICAL INFRASTRUCTURE<br>MANAGEMENT // 2026</p>
                    <p class="footer-tagline-sub">ALL OPERATIONAL DATASETS PRESERVED.</p>
                    <p class="footer-copyright">&copy; 2026 Bagus Dwi Permana. All rights reserved.</p>
                </div>
                <div class="footer-nav">
                    <h4 class="footer-heading">NAVIGATION</h4>
                    <ul class="footer-links">
                        <li><a href="index.html">Home Dashboard</a></li>
                        <li><a href="articles.html">Technical Journal</a></li>
                        <li><a href="index.html#case-studies">Case Studies</a></li>
                        <li><a href="datacenter-solutions.html">DC Solutions</a></li>
                    </ul>
                </div>
                <div class="footer-connect">
                    <h4 class="footer-heading">CONNECT</h4>
                    <ul class="footer-links">
                        <li><a href="https://www.linkedin.com/in/bagus-dwi-permana-ba90b092" target="_blank" rel="noopener">LinkedIn Profile</a></li>
                        <li><a href="articles.html">Technical Journal</a></li>
                        <li><a href="mailto:baguspermana7@gmail.com">Direct Contact</a></li>
                        <li><a href="https://github.com/baguspermana7-cpu" target="_blank" rel="noopener">GitHub</a></li>
                    </ul>
                </div>
            </div>
        </div>
    </footer>

<script src="script.js"></script>
<script>
// Market presets — enhanced with all new fields
const marketData = {
    johor:      { op: 487,  pipe: 5800, pop: 3.8,  absorb: 200, precommit: 40, spec: 35, growth: 19, cost: 9, rev: 2.0, opex: 58, wacc: 10 },
    indonesia:  { op: 1717, pipe: 4145, pop: 280,   absorb: 300, precommit: 55, spec: 25, growth: 15, cost: 8, rev: 1.8, opex: 60, wacc: 10 },
    singapore:  { op: 780,  pipe: 900,  pop: 5.9,   absorb: 150, precommit: 70, spec: 15, growth: 12, cost: 14, rev: 3.0, opex: 55, wacc: 8 },
    thailand:   { op: 200,  pipe: 1092, pop: 72,    absorb: 120, precommit: 50, spec: 30, growth: 14, cost: 8.5, rev: 1.9, opex: 62, wacc: 11 },
    vietnam:    { op: 150,  pipe: 560,  pop: 100,   absorb: 80,  precommit: 45, spec: 30, growth: 18, cost: 7, rev: 1.6, opex: 65, wacc: 12 },
    philippines:{ op: 100,  pipe: 500,  pop: 115,   absorb: 50,  precommit: 35, spec: 40, growth: 12, cost: 9, rev: 2.1, opex: 63, wacc: 12 },
    custom:     { op: 500,  pipe: 2000, pop: 50,    absorb: 150, precommit: 50, spec: 30, growth: 15, cost: 9, rev: 2.0, opex: 60, wacc: 10 }
};

function prefillMarket() {
    const m = document.getElementById('calcMarket').value;
    const d = marketData[m];
    document.getElementById('calcOperational').value = d.op;
    document.getElementById('calcPipeline').value = d.pipe;
    document.getElementById('calcPopulation').value = d.pop;
    document.getElementById('calcAbsorption').value = d.absorb;
    document.getElementById('calcPrecommit').value = d.precommit;
    document.getElementById('calcSpec').value = d.spec;
    document.getElementById('calcDemandGrowth').value = d.growth;
    document.getElementById('calcCostMW').value = d.cost;
    document.getElementById('calcRevMW').value = d.rev;
    document.getElementById('calcOpexRatio').value = d.opex;
    document.getElementById('calcWACC').value = d.wacc;
}

function fmt(n) { return n >= 1000 ? (n/1000).toFixed(1) + 'B' : n.toFixed(0) + 'M'; }

function runBubbleModel(op, pipe, pop, absorb, precommit, spec, demandGrowth, costMW, revMW, opexRatio, wacc) {
    const newCapacity = pipe - op;
    const sdRatio = (newCapacity > 0) ? pipe / (absorb * 5) : 1;
    const yearsAbsorb = newCapacity / Math.max(1, absorb);
    const threeYrAbsorb = absorb * 3;
    const actualVacancy = Math.max(5, Math.min(60, (1 - (threeYrAbsorb / Math.max(1, newCapacity * 0.6))) * 50));
    const specMW = newCapacity * spec;
    const capitalRisk = specMW * costMW;
    const totalCapex = newCapacity * costMW;
    const breakeven = opexRatio * 100 + (spec * 15);
    const avgOccupancy = Math.max(40, 95 - (sdRatio * 15)) / 100;
    const annualRev = revMW * pipe * avgOccupancy;
    const annualEBITDA = annualRev * (1 - opexRatio);
    const paybackYears = annualEBITDA > 0 ? totalCapex / annualEBITDA : 99;
    const pipePerPop = pop > 0 ? pipe / pop : 0;

    // NPV with 3-year ramp
    let npv = -totalCapex;
    for (let yr = 1; yr <= 10; yr++) {
        let occYear = yr <= 3 ? (0.30 + (avgOccupancy - 0.30) * (yr / 3)) : avgOccupancy;
        let ebitdaYear = revMW * pipe * occYear * (1 - opexRatio);
        npv += ebitdaYear / Math.pow(1 + wacc, yr);
    }

    // Risk score 0-100
    let riskScore = 0;
    riskScore += Math.min(30, sdRatio * 15);
    riskScore += Math.min(25, spec * 50);
    riskScore += Math.min(20, (1 - precommit) * 40);
    riskScore += Math.min(15, Math.max(0, yearsAbsorb - 3) * 3);
    riskScore += Math.min(10, Math.max(0, paybackYears - 6) * 2);
    riskScore = Math.min(100, Math.max(0, riskScore));

    return {
        sdRatio, yearsAbsorb, actualVacancy, specMW, capitalRisk, totalCapex,
        breakeven, avgOccupancy, annualRev, annualEBITDA, paybackYears,
        pipePerPop, npv, riskScore, newCapacity, threeYrAbsorb
    };
}

function calculateBubbleRisk() {
    const op = parseFloat(document.getElementById('calcOperational').value) || 0;
    const pipe = parseFloat(document.getElementById('calcPipeline').value) || 0;
    const pop = parseFloat(document.getElementById('calcPopulation').value) || 1;
    const absorb = parseFloat(document.getElementById('calcAbsorption').value) || 1;
    const precommit = parseFloat(document.getElementById('calcPrecommit').value) / 100;
    const spec = parseFloat(document.getElementById('calcSpec').value) / 100;
    const demandGrowth = parseFloat(document.getElementById('calcDemandGrowth').value) / 100;
    const costMW = parseFloat(document.getElementById('calcCostMW').value) || 9;
    const revMW = parseFloat(document.getElementById('calcRevMW').value) || 2;
    const opexRatio = parseFloat(document.getElementById('calcOpexRatio').value) / 100;
    const wacc = parseFloat(document.getElementById('calcWACC').value) / 100;

    const r = runBubbleModel(op, pipe, pop, absorb, precommit, spec, demandGrowth, costMW, revMW, opexRatio, wacc);

    // Show results
    document.getElementById('calcResults').classList.add('show');

    // --- SUPPLY-DEMAND ---
    const sdEl = document.getElementById('rSupplyDemand');
    sdEl.textContent = r.sdRatio.toFixed(1) + 'x';
    sdEl.className = 'value ' + (r.sdRatio > 2 ? 'red' : r.sdRatio > 1.3 ? 'amber' : 'green');
    document.getElementById('rSDNote').textContent = r.sdRatio > 2 ? 'Significant oversupply risk' : r.sdRatio > 1.3 ? 'Moderate oversupply risk' : 'Supply-demand balanced';

    const yaEl = document.getElementById('rYearsAbsorb');
    yaEl.textContent = r.yearsAbsorb.toFixed(1) + ' yrs';
    yaEl.className = 'value ' + (r.yearsAbsorb > 10 ? 'red' : r.yearsAbsorb > 5 ? 'amber' : 'green');

    const vacEl = document.getElementById('rVacancy2028');
    vacEl.textContent = r.actualVacancy.toFixed(0) + '%';
    vacEl.className = 'value ' + (r.actualVacancy > 25 ? 'red' : r.actualVacancy > 15 ? 'amber' : 'green');
    document.getElementById('rVacNote').textContent = r.actualVacancy > 25 ? 'Pricing pressure likely' : r.actualVacancy > 15 ? 'Manageable but watch closely' : 'Healthy vacancy range';

    const ppEl = document.getElementById('rPipePerPop');
    ppEl.textContent = r.pipePerPop.toFixed(0) + ' MW/M';
    ppEl.className = 'value ' + (r.pipePerPop > 500 ? 'red' : r.pipePerPop > 50 ? 'amber' : 'green');
    document.getElementById('rPipePopNote').textContent = r.pipePerPop > 500 ? 'Extreme — vastly exceeds population needs' : r.pipePerPop > 50 ? 'High — watch absorption carefully' : 'Proportional to market size';

    const crEl = document.getElementById('rCapitalRisk');
    crEl.textContent = '$' + fmt(r.capitalRisk);
    crEl.className = 'value ' + (r.capitalRisk > 10000 ? 'red' : r.capitalRisk > 3000 ? 'amber' : 'green');

    document.getElementById('rTotalCapex').textContent = '$' + fmt(r.totalCapex);
    document.getElementById('rTotalCapex').className = 'value';

    // --- FINANCIAL ---
    const beEl = document.getElementById('rBreakeven');
    beEl.textContent = r.breakeven.toFixed(0) + '%';
    beEl.className = 'value ' + (r.breakeven > 75 ? 'red' : r.breakeven > 65 ? 'amber' : 'green');

    const occEl = document.getElementById('rProjOcc');
    occEl.textContent = (r.avgOccupancy * 100).toFixed(0) + '%';
    occEl.className = 'value ' + (r.avgOccupancy * 100 > r.breakeven ? 'green' : 'red');
    document.getElementById('rOccNote').textContent = (r.avgOccupancy * 100) > r.breakeven ? 'Above break-even' : 'BELOW break-even — losses likely';

    const revEl = document.getElementById('rRevenue');
    revEl.textContent = '$' + fmt(r.annualRev) + '/yr';
    revEl.className = 'value';
    document.getElementById('rRevNote').textContent = 'At ' + (r.avgOccupancy * 100).toFixed(0) + '% avg occupancy';

    const ebitdaEl = document.getElementById('rEBITDA');
    ebitdaEl.textContent = '$' + fmt(r.annualEBITDA) + '/yr';
    ebitdaEl.className = 'value ' + (r.annualEBITDA > 0 ? 'green' : 'red');
    document.getElementById('rEBITDANote').textContent = ((1 - opexRatio) * 100).toFixed(0) + '% EBITDA margin';

    const pbEl = document.getElementById('rPayback');
    pbEl.textContent = r.paybackYears < 50 ? r.paybackYears.toFixed(1) + ' yrs' : 'N/A';
    pbEl.className = 'value ' + (r.paybackYears > 10 ? 'red' : r.paybackYears > 7 ? 'amber' : 'green');
    document.getElementById('rPayNote').textContent = r.paybackYears <= 7 ? 'Attractive payback' : r.paybackYears <= 10 ? 'Acceptable for infra' : 'Extended — elevated risk';

    const npvEl = document.getElementById('rNPV');
    npvEl.textContent = (r.npv >= 0 ? '+' : '') + '$' + fmt(Math.abs(r.npv));
    npvEl.className = 'value ' + (r.npv > 0 ? 'green' : 'red');
    document.getElementById('rNPVNote').textContent = r.npv > 0 ? 'Positive NPV — value-creating' : 'Negative NPV — destroys value';

    // --- GAUGE ---
    document.getElementById('rGaugeNeedle').style.left = r.riskScore + '%';
    const vEl = document.getElementById('rVerdict');
    if (r.riskScore >= 70) { vEl.textContent = 'CRITICAL RISK — Strong bubble indicators present'; vEl.className = 'risk-verdict critical'; }
    else if (r.riskScore >= 50) { vEl.textContent = 'HIGH RISK — Multiple warning signs detected'; vEl.className = 'risk-verdict high'; }
    else if (r.riskScore >= 30) { vEl.textContent = 'MODERATE RISK — Monitor closely for deterioration'; vEl.className = 'risk-verdict medium'; }
    else { vEl.textContent = 'LOW RISK — Market fundamentals appear sound'; vEl.className = 'risk-verdict low'; }

    // --- BARS ---
    const maxVal = pipe;
    const committedMW = r.newCapacity * precommit;
    const absorbMW3 = r.threeYrAbsorb;

    document.getElementById('rBarPipeline').textContent = pipe.toLocaleString() + ' MW';
    document.getElementById('rBarSupply').style.width = '100%';
    document.getElementById('rBarSupply').textContent = pipe.toLocaleString() + ' MW';

    document.getElementById('rBarDemandVal').textContent = Math.round(committedMW).toLocaleString() + ' MW';
    document.getElementById('rBarDemand').style.width = Math.min(100, (committedMW / maxVal) * 100) + '%';
    document.getElementById('rBarDemand').textContent = Math.round(committedMW).toLocaleString() + ' MW';

    document.getElementById('rBarAbsVal').textContent = absorbMW3.toLocaleString() + ' MW';
    document.getElementById('rBarAbsorb').style.width = Math.min(100, (absorbMW3 / maxVal) * 100) + '%';
    document.getElementById('rBarAbsorb').textContent = absorbMW3.toLocaleString() + ' MW';

    // --- SENSITIVITY ---
    const grid = document.getElementById('sensitivityGrid');
    const scenarios = [
        { label: 'Optimistic', absorbMult: 1.3, specMult: 0.7, cls: 'green' },
        { label: 'Base Case', absorbMult: 1.0, specMult: 1.0, cls: 'amber' },
        { label: 'Pessimistic', absorbMult: 0.7, specMult: 1.3, cls: 'red' }
    ];
    let html = '';
    scenarios.forEach(s => {
        const sr = runBubbleModel(op, pipe, pop, absorb * s.absorbMult, precommit, spec * s.specMult, demandGrowth, costMW, revMW, opexRatio, wacc);
        html += '<div class="sensitivity-card">';
        html += '<div style="font-weight:700;color:' + (s.cls === 'green' ? '#34d399' : s.cls === 'amber' ? '#fbbf24' : '#f87171') + ';margin-bottom:0.5rem;">' + s.label + '</div>';
        html += '<div style="font-size:0.75rem;color:#a8a29e;line-height:1.6;">';
        html += 'Risk Score: <strong style="color:' + (sr.riskScore >= 70 ? '#f87171' : sr.riskScore >= 50 ? '#fb923c' : sr.riskScore >= 30 ? '#fbbf24' : '#34d399') + ';">' + sr.riskScore.toFixed(0) + '/100</strong><br>';
        html += 'Vacancy: <strong style="color:#e7e5e4;">' + sr.actualVacancy.toFixed(0) + '%</strong><br>';
        html += 'NPV: <strong style="color:' + (sr.npv > 0 ? '#34d399' : '#f87171') + ';">' + (sr.npv >= 0 ? '+$' : '-$') + fmt(Math.abs(sr.npv)) + '</strong><br>';
        html += 'Payback: <strong style="color:#e7e5e4;">' + (sr.paybackYears < 50 ? sr.paybackYears.toFixed(1) + ' yrs' : 'N/A') + '</strong>';
        html += '</div></div>';
    });
    grid.innerHTML = html;
}

// Auto-prefill on load
window.addEventListener('DOMContentLoaded', function() {
    prefillMarket();
});
</script>

    <script>
    (function(){const s=document.getElementById('shareButtons'),h=document.querySelector('.article-hero');if(s&&h){document.body.classList.add('has-share-buttons');new IntersectionObserver(e=>e.forEach(x=>s.classList.toggle('visible',!x.isIntersecting)),{threshold:.1}).observe(h)}})();
    function getShareData(){return{title:document.querySelector('meta[property="og:title"]')?.content||document.title,url:window.location.href}}
    function shareLinkedIn(){window.open('https://www.linkedin.com/sharing/share-offsite/?url='+encodeURIComponent(getShareData().url),'_blank','width=600,height=600')}
    function shareTwitter(){var d=getShareData();window.open('https://twitter.com/intent/tweet?text='+encodeURIComponent(d.title+' by @BagusDPermana')+'&url='+encodeURIComponent(d.url),'_blank','width=600,height=400')}
    function shareWhatsApp(){var d=getShareData();window.open('https://wa.me/?text='+encodeURIComponent(d.title+'\n\n'+d.url),'_blank')}
    function copyLink(){var b=document.querySelector('.share-btn.copy'),c=b.querySelector('.copy-icon'),k=b.querySelector('.check-icon');navigator.clipboard.writeText(window.location.href).then(function(){b.classList.add('copied');c.style.display='none';k.style.display='block';b.setAttribute('data-tooltip','Copied!');setTimeout(function(){b.classList.remove('copied');c.style.display='block';k.style.display='none';b.setAttribute('data-tooltip','Copy link')},2000)})}
    </script>
    <script>
    function subscribeNewsletter(e){
      e.preventDefault();
      var email=e.target.querySelector('input[type="email"]').value.trim();
      if(!email)return false;
      var subs=JSON.parse(localStorage.getItem('rz_newsletter_subscribers')||'[]');
      if(subs.find(function(s){return s.email===email})){alert('Already subscribed!');return false}
      subs.push({email:email,date:new Date().toISOString(),source:location.pathname.split('/').pop(),status:'active'});
      localStorage.setItem('rz_newsletter_subscribers',JSON.stringify(subs));
      e.target.innerHTML='<p style="color:#10b981;font-weight:600;">✓ Subscribed successfully!</p>';
      return false;
    }
    </script>
<!-- Login Modal -->
<div class="bub-login-overlay" id="bubLoginOverlay">
    <div class="bub-login-box">
        <button class="bub-login-close" onclick="bubHideLogin()">&times;</button>
        <h3><i class="fas fa-lock" style="color:#d97706;margin-right:6px"></i> Pro Risk Intelligence</h3>
        <p>Unlock Monte Carlo simulation (10K runs), sensitivity tornado, multi-dimensional risk radar, scenario engine, and executive narrative assessment.</p>
        <input type="email" id="bubLoginEmail" placeholder="Email address">
        <input type="password" id="bubLoginPass" placeholder="Password">
        <button class="bub-login-submit" onclick="bubHandleLogin()">Unlock Pro Analysis</button>
        <div class="bub-login-error" id="bubLoginError">Invalid credentials.</div>
        <div class="bub-login-demo">Demo: <code>demo@resistancezero.com</code> / <code>demo2026</code></div>
        <p style="font-size:0.68rem;color:#78716c;margin-top:8px;line-height:1.5;">By clicking Login, you agree to our <a href="terms.html" target="_blank" style="color:#d97706;text-decoration:underline;">Terms of Service</a> and <a href="privacy.html" target="_blank" style="color:#d97706;text-decoration:underline;">Privacy Policy</a>.</p>
    </div>
</div>

<script>
// ═══════════════════════════════════════════════════════════════
// PRO MODE — BUBBLE RISK INTELLIGENCE ENGINE
// ═══════════════════════════════════════════════════════════════
var bubMode='free';
var bubSession=JSON.parse(localStorage.getItem('rz_premium_session')||'null');
var bubPremium=bubSession&&bubSession.tier==='pro'&&new Date(bubSession.expires)>new Date();

function bubShowLogin(){document.getElementById('bubLoginOverlay').classList.add('show')}
function bubHideLogin(){document.getElementById('bubLoginOverlay').classList.remove('show')}
function bubHandleLogin(){
    var email=document.getElementById('bubLoginEmail').value.trim();
    var pass=document.getElementById('bubLoginPass').value;
    if(email==='demo@resistancezero.com'&&pass==='demo2026'){
        localStorage.setItem('rz_premium_session',JSON.stringify({email:email,tier:'pro',expires:new Date(Date.now()+30*86400000).toISOString()}));
        window.dispatchEvent(new CustomEvent('rz-auth-change',{detail:{email:email,tier:'pro',action:'login'}}));
        bubPremium=true;
        bubHideLogin();
        bubUnlockPanels();
        bubSetMode('pro');
    } else {
        var err=document.getElementById('bubLoginError');
        err.style.display='block';
        setTimeout(function(){err.style.display='none'},3000);
    }
}
window.addEventListener('rz-auth-change',function(e){
    bubPremium=true;
    bubUnlockPanels();
    if(bubMode==='pro')bubUpdateProPanels();
});
function bubUnlockPanels(){
    document.querySelectorAll('.bub-pro-panel.gated').forEach(function(p){
        p.classList.remove('gated');
        var ov=p.querySelector('.bub-gate-overlay');
        if(ov)ov.style.display='none';
    });
}
function bubSetMode(mode){
    var sess=JSON.parse(localStorage.getItem('rz_premium_session')||'null');
    bubPremium=sess&&sess.tier==='pro'&&new Date(sess.expires)>new Date();
    if(mode==='pro'&&!bubPremium){bubShowLogin();return}
    bubMode=mode;
    document.querySelector('.bub-btn-free').classList.toggle('active',mode==='free');
    document.querySelector('.bub-btn-pro').classList.toggle('active',mode==='pro');
    var pp=document.getElementById('bubProPanels');
    if(mode==='pro'){pp.style.display='block';bubUpdateProPanels()}
    else{pp.style.display='none'}
}
function bubResetDefaults(){
    document.getElementById('calcMarket').value='johor';
    prefillMarket();
    calculateBubbleRisk();
    if(bubMode==='pro'&&bubPremium)bubUpdateProPanels();
}

// ═══ GET INPUTS ═══
function bubGetInputs(){
    return {
        op:parseFloat(document.getElementById('calcOperational').value)||0,
        pipe:parseFloat(document.getElementById('calcPipeline').value)||0,
        pop:parseFloat(document.getElementById('calcPopulation').value)||1,
        absorb:parseFloat(document.getElementById('calcAbsorption').value)||1,
        precommit:parseFloat(document.getElementById('calcPrecommit').value)/100,
        spec:parseFloat(document.getElementById('calcSpec').value)/100,
        demandGrowth:parseFloat(document.getElementById('calcDemandGrowth').value)/100,
        costMW:parseFloat(document.getElementById('calcCostMW').value)||9,
        revMW:parseFloat(document.getElementById('calcRevMW').value)||2,
        opexRatio:parseFloat(document.getElementById('calcOpexRatio').value)/100,
        wacc:parseFloat(document.getElementById('calcWACC').value)/100
    };
}

// ═══ MONTE CARLO ═══
function bubRunMonteCarlo(inputs){
    var N=10000,results=[];
    for(var i=0;i<N;i++){
        var v={};
        for(var k in inputs)v[k]=inputs[k]*(0.85+Math.random()*0.30);
        v.pop=inputs.pop;
        v.precommit=Math.min(1,Math.max(0,v.precommit));
        v.spec=Math.min(1,Math.max(0,v.spec));
        v.opexRatio=Math.min(0.85,Math.max(0.4,v.opexRatio));
        var r=runBubbleModel(v.op,v.pipe,v.pop,v.absorb,v.precommit,v.spec,v.demandGrowth,v.costMW,v.revMW,v.opexRatio,v.wacc);
        results.push(r.riskScore);
    }
    results.sort(function(a,b){return a-b});
    var sum=0;for(var j=0;j<N;j++)sum+=results[j];
    var mean=sum/N;
    var variance=0;for(var j=0;j<N;j++)variance+=Math.pow(results[j]-mean,2);
    var stdDev=Math.sqrt(variance/N);
    var aboveCritical=results.filter(function(v){return v>70}).length;
    return {
        scores:results,mean:mean,
        p5:results[Math.floor(N*0.05)],p25:results[Math.floor(N*0.25)],
        p50:results[Math.floor(N*0.50)],p75:results[Math.floor(N*0.75)],
        p95:results[Math.floor(N*0.95)],stdDev:stdDev,
        min:results[0],max:results[N-1],
        probCritical:((aboveCritical/N)*100)
    };
}

// ═══ SENSITIVITY ═══
function bubRunSensitivity(inputs){
    var baseR=runBubbleModel(inputs.op,inputs.pipe,inputs.pop,inputs.absorb,inputs.precommit,inputs.spec,inputs.demandGrowth,inputs.costMW,inputs.revMW,inputs.opexRatio,inputs.wacc);
    var baseScore=baseR.riskScore;
    var params=[
        {key:'absorb',label:'Absorption Rate'},
        {key:'spec',label:'Speculative Build %'},
        {key:'precommit',label:'Pre-Commitment %'},
        {key:'pipe',label:'Pipeline Capacity'},
        {key:'costMW',label:'Build Cost ($/MW)'},
        {key:'revMW',label:'Revenue per MW'},
        {key:'opexRatio',label:'OPEX Ratio'},
        {key:'wacc',label:'Discount Rate (WACC)'},
        {key:'demandGrowth',label:'Demand Growth Rate'},
        {key:'op',label:'Current Operational'},
        {key:'pop',label:'Market Population'}
    ];
    var results=[];
    params.forEach(function(p){
        var lo=Object.assign({},inputs);
        var hi=Object.assign({},inputs);
        lo[p.key]=inputs[p.key]*0.8;
        hi[p.key]=inputs[p.key]*1.2;
        var rLo=runBubbleModel(lo.op,lo.pipe,lo.pop,lo.absorb,lo.precommit,lo.spec,lo.demandGrowth,lo.costMW,lo.revMW,lo.opexRatio,lo.wacc);
        var rHi=runBubbleModel(hi.op,hi.pipe,hi.pop,hi.absorb,hi.precommit,hi.spec,hi.demandGrowth,hi.costMW,hi.revMW,hi.opexRatio,hi.wacc);
        results.push({name:p.label,low:rLo.riskScore,high:rHi.riskScore,range:Math.abs(rHi.riskScore-rLo.riskScore),base:baseScore});
    });
    results.sort(function(a,b){return b.range-a.range});
    return {results:results,baseScore:baseScore};
}

// ═══ SCENARIOS ═══
function bubRunScenarios(inputs){
    var scenarios=[
        {name:'Bull Case — Hyperscaler Surge',desc:'Aggressive hyperscaler pre-commits, faster absorption, lower speculation',
         mods:{absorb:1.4,precommit:1.3,spec:0.6,demandGrowth:1.3},color:'#34d399'},
        {name:'Base Case — Current Trajectory',desc:'Current market parameters maintained through 2028',
         mods:{},color:'#fbbf24'},
        {name:'Bear Case — Demand Stall',desc:'Hyperscaler pullback, slower adoption, rising speculation',
         mods:{absorb:0.6,precommit:0.7,spec:1.4,demandGrowth:0.7},color:'#f87171'}
    ];
    return scenarios.map(function(s){
        var v=Object.assign({},inputs);
        for(var k in s.mods)v[k]=inputs[k]*s.mods[k];
        v.precommit=Math.min(1,v.precommit);v.spec=Math.min(1,v.spec);
        var r=runBubbleModel(v.op,v.pipe,v.pop,v.absorb,v.precommit,v.spec,v.demandGrowth,v.costMW,v.revMW,v.opexRatio,v.wacc);
        return {name:s.name,desc:s.desc,color:s.color,risk:r.riskScore,npv:r.npv,vacancy:r.actualVacancy,payback:r.paybackYears,sdRatio:r.sdRatio,occupancy:r.avgOccupancy};
    });
}

// ═══ NARRATIVE ═══
function bubGenerateNarrative(inputs,r,mc,scenarios){
    var market=document.getElementById('calcMarket').options[document.getElementById('calcMarket').selectedIndex].text;
    var grade=r.riskScore>=70?'Critical':r.riskScore>=50?'High':r.riskScore>=30?'Moderate':'Low';
    var gradeColor=r.riskScore>=70?'#f87171':r.riskScore>=50?'#fb923c':r.riskScore>=30?'#fbbf24':'#34d399';
    var html='';
    html+='<p><strong style="color:'+gradeColor+'">Current Assessment:</strong> The '+market+' market scores <strong style="color:'+gradeColor+'">'+r.riskScore.toFixed(0)+'/100</strong> on the bubble risk index ('+grade+' Risk). ';
    html+='With a supply-to-demand ratio of <strong>'+r.sdRatio.toFixed(1)+'x</strong> and <strong>'+(inputs.spec*100).toFixed(0)+'%</strong> speculative builds, ';
    if(r.riskScore>=70)html+='the market exhibits <strong style="color:#f87171">classic bubble characteristics</strong> — supply dramatically outpaces absorption capacity.';
    else if(r.riskScore>=50)html+='multiple warning signs are present requiring <strong style="color:#fb923c">active monitoring and risk mitigation</strong>.';
    else if(r.riskScore>=30)html+='fundamentals are <strong style="color:#fbbf24">stretched but manageable</strong> if absorption trends hold.';
    else html+='fundamentals appear <strong style="color:#34d399">sound with balanced supply-demand dynamics</strong>.';
    html+='</p>';
    html+='<p><strong>Monte Carlo Insight:</strong> Across 10,000 stochastic simulations, the median risk score is <strong>'+mc.p50.toFixed(0)+'</strong> with a 90% confidence interval of <strong>'+mc.p5.toFixed(0)+'–'+mc.p95.toFixed(0)+'</strong>. ';
    html+='There is a <strong style="color:'+(mc.probCritical>50?'#f87171':'#fbbf24')+'">'+mc.probCritical.toFixed(0)+'%</strong> probability of the market entering critical risk territory (score &gt;70). ';
    if(mc.stdDev>15)html+='The high standard deviation ('+mc.stdDev.toFixed(1)+') indicates <strong>significant uncertainty</strong> — outcomes are highly sensitive to assumptions.';
    else html+='Moderate volatility (σ='+mc.stdDev.toFixed(1)+') suggests <strong>relatively predictable</strong> risk dynamics.';
    html+='</p>';
    html+='<p><strong>Financial Outlook:</strong> ';
    if(r.npv>0)html+='The 10-year NPV of <strong style="color:#34d399">+$'+fmt(r.npv)+'</strong> suggests value creation potential, ';
    else html+='The negative 10-year NPV of <strong style="color:#f87171">-$'+fmt(Math.abs(r.npv))+'</strong> signals value destruction risk, ';
    html+='with projected occupancy of <strong>'+(r.avgOccupancy*100).toFixed(0)+'%</strong> against a break-even threshold of <strong>'+r.breakeven.toFixed(0)+'%</strong>. ';
    if(r.avgOccupancy*100<r.breakeven)html+='<strong style="color:#f87171">Occupancy falls below break-even — cash-flow losses are likely for speculative operators.</strong>';
    else html+='Occupancy exceeds break-even, providing a <strong>'+(r.avgOccupancy*100-r.breakeven).toFixed(0)+'pp margin of safety</strong>.';
    html+='</p>';
    html+='<p><strong>Strategic Recommendation:</strong> ';
    if(r.riskScore>=70)html+='<strong style="color:#f87171">Avoid speculative exposure.</strong> Focus exclusively on pre-committed, build-to-suit opportunities with hyperscaler LOIs. Monitor for market correction triggers including hyperscaler capex revisions and power infrastructure delays.';
    else if(r.riskScore>=50)html+='<strong style="color:#fb923c">Selective deployment with hedging.</strong> Pursue pre-committed builds only. Require minimum 60% pre-lease before breaking ground. Secure power-purchase agreements with fixed rates to reduce downside.';
    else if(r.riskScore>=30)html+='<strong style="color:#fbbf24">Measured expansion.</strong> Market fundamentals support controlled growth. Maintain 50%+ pre-commitment targets and diversify across sub-markets to reduce concentration risk.';
    else html+='<strong style="color:#34d399">Favorable entry conditions.</strong> Supply-demand balance supports investment. Consider accelerating deployment while competitive dynamics remain favorable.';
    html+='</p>';
    return html;
}

// ═══ DRAW HISTOGRAM ═══
function bubDrawHistogram(scores){
    var canvas=document.getElementById('bubMcChart');if(!canvas)return;
    var ctx=canvas.getContext('2d');
    var dpr=window.devicePixelRatio||1;
    canvas.width=canvas.offsetWidth*dpr;canvas.height=260*dpr;
    ctx.scale(dpr,dpr);
    var w=canvas.offsetWidth,h=260;
    ctx.clearRect(0,0,w,h);
    var bins=40,min=scores[0],max=scores[scores.length-1];
    var range=max-min||1;var counts=new Array(bins).fill(0);
    scores.forEach(function(s){var idx=Math.min(bins-1,Math.floor((s-min)/range*bins));counts[idx]++});
    var maxC=Math.max.apply(null,counts);
    var barW=(w-60)/bins;
    ctx.fillStyle='rgba(217,119,6,0.08)';ctx.fillRect(0,0,w,h);
    for(var i=0;i<bins;i++){
        var bh=(counts[i]/maxC)*(h-50);
        var x=30+i*barW;var y=h-30-bh;
        var pct=(min+i*range/bins);
        ctx.fillStyle=pct>=70?'rgba(239,68,68,0.6)':pct>=50?'rgba(251,146,60,0.6)':pct>=30?'rgba(251,191,36,0.6)':'rgba(52,211,153,0.6)';
        ctx.fillRect(x,y,barW-1,bh);
    }
    ctx.fillStyle='#a8a29e';ctx.font='10px Inter,sans-serif';ctx.textAlign='center';
    for(var i=0;i<=4;i++){
        var v=min+(range/4)*i;
        ctx.fillText(v.toFixed(0),30+((w-60)/4)*i,h-10);
    }
    ctx.textAlign='left';ctx.fillStyle='#fbbf24';ctx.font='bold 11px Inter,sans-serif';
    ctx.fillText('Risk Score Distribution (10K simulations)',5,14);
    // Draw critical threshold line at 70
    var x70=30+((70-min)/range)*(w-60);
    if(x70>30&&x70<w-30){
        ctx.setLineDash([4,4]);ctx.strokeStyle='#f87171';ctx.lineWidth=1.5;
        ctx.beginPath();ctx.moveTo(x70,20);ctx.lineTo(x70,h-30);ctx.stroke();
        ctx.setLineDash([]);ctx.fillStyle='#f87171';ctx.font='9px Inter,sans-serif';
        ctx.fillText('Critical →',x70+4,30);
    }
}

// ═══ DRAW TORNADO ═══
function bubDrawTornado(results,baseScore){
    var canvas=document.getElementById('bubTornadoChart');if(!canvas)return;
    var ctx=canvas.getContext('2d');
    var dpr=window.devicePixelRatio||1;
    canvas.width=canvas.offsetWidth*dpr;canvas.height=300*dpr;
    ctx.scale(dpr,dpr);
    var w=canvas.offsetWidth,h=300;
    ctx.clearRect(0,0,w,h);
    ctx.fillStyle='rgba(217,119,6,0.05)';ctx.fillRect(0,0,w,h);
    var top8=results.slice(0,8);
    var maxRange=Math.max.apply(null,top8.map(function(r){return r.range}))||1;
    var barH=26,gap=6,labelW=160,chartL=labelW+10,chartR=w-20;
    var chartW=chartR-chartL;
    var centerX=chartL+chartW/2;
    var startY=35;
    // Title
    ctx.fillStyle='#fbbf24';ctx.font='bold 11px Inter,sans-serif';ctx.textAlign='left';
    ctx.fillText('Sensitivity — Which inputs drive risk most?',5,16);
    ctx.fillStyle='#78716c';ctx.font='9px Inter,sans-serif';
    ctx.fillText('Base risk score: '+baseScore.toFixed(0)+'/100 | ±20% input variation',5,28);
    // Baseline
    ctx.setLineDash([4,4]);ctx.strokeStyle='rgba(251,191,36,0.4)';ctx.lineWidth=1;
    ctx.beginPath();ctx.moveTo(centerX,startY);ctx.lineTo(centerX,startY+top8.length*(barH+gap));ctx.stroke();
    ctx.setLineDash([]);
    top8.forEach(function(r,i){
        var y=startY+i*(barH+gap);
        // Label
        ctx.fillStyle='#d6d3d1';ctx.font='11px Inter,sans-serif';ctx.textAlign='right';
        ctx.fillText(r.name,labelW,y+barH/2+4);
        // Low bar (left of center)
        var lowDelta=r.low-baseScore;
        var highDelta=r.high-baseScore;
        var leftDelta=Math.min(lowDelta,highDelta);
        var rightDelta=Math.max(lowDelta,highDelta);
        var leftW=Math.abs(leftDelta)/maxRange*(chartW/2);
        var rightW=Math.abs(rightDelta)/maxRange*(chartW/2);
        // Left bar
        ctx.fillStyle=leftDelta<0?'rgba(52,211,153,0.6)':'rgba(239,68,68,0.6)';
        ctx.beginPath();
        ctx.roundRect(centerX-leftW,y,leftW,barH,[4,0,0,4]);
        ctx.fill();
        // Right bar
        ctx.fillStyle=rightDelta>0?'rgba(239,68,68,0.6)':'rgba(52,211,153,0.6)';
        ctx.beginPath();
        ctx.roundRect(centerX,y,rightW,barH,[0,4,4,0]);
        ctx.fill();
        // Values
        ctx.fillStyle='#e7e5e4';ctx.font='bold 9px JetBrains Mono,monospace';ctx.textAlign='center';
        if(leftW>20)ctx.fillText(r.low.toFixed(0),centerX-leftW/2,y+barH/2+3);
        if(rightW>20)ctx.fillText(r.high.toFixed(0),centerX+rightW/2,y+barH/2+3);
    });
    // Legend
    ctx.font='9px Inter,sans-serif';ctx.textAlign='center';
    ctx.fillStyle='rgba(52,211,153,0.6)';ctx.fillRect(chartL,h-18,10,10);
    ctx.fillStyle='#a8a29e';ctx.textAlign='left';ctx.fillText('Lower Risk',chartL+14,h-9);
    ctx.fillStyle='rgba(239,68,68,0.6)';ctx.fillRect(chartL+90,h-18,10,10);
    ctx.fillStyle='#a8a29e';ctx.fillText('Higher Risk',chartL+104,h-9);
}

// ═══ DRAW RADAR ═══
function bubDrawRadar(r,inputs){
    var canvas=document.getElementById('bubRadarChart');if(!canvas)return;
    var ctx=canvas.getContext('2d');
    var dpr=window.devicePixelRatio||1;
    var size=Math.min(canvas.offsetWidth,400);
    canvas.width=size*dpr;canvas.height=size*dpr;
    ctx.scale(dpr,dpr);
    ctx.clearRect(0,0,size,size);
    var cx=size/2,cy=size/2,rad=size/2-50;
    var dims=['S/D\nBalance','Pre-\nCommit','Absorption\nSpeed','Financial\nReturn','Spec\nExposure','Market\nDepth'];
    // Invert risk scores so higher = better (lower risk)
    var sdBal=Math.max(0,Math.min(1,1-Math.min(r.sdRatio/3,1)));
    var precom=Math.min(1,inputs.precommit);
    var absSpd=Math.max(0,Math.min(1,1-Math.min(r.yearsAbsorb/15,1)));
    var finRet=r.npv>0?Math.min(1,r.npv/(inputs.pipe*inputs.costMW*0.3)):0;
    var specExp=Math.max(0,1-inputs.spec);
    var mktDep=Math.min(1,inputs.pop/100);
    var vals=[sdBal,precom,absSpd,finRet,specExp,mktDep];
    var n=dims.length;
    // Grid circles
    ctx.strokeStyle='rgba(217,119,6,0.12)';ctx.lineWidth=1;
    [0.25,0.5,0.75,1].forEach(function(s){
        ctx.beginPath();
        for(var i=0;i<=n;i++){var a=-Math.PI/2+(2*Math.PI/n)*(i%n);ctx.lineTo(cx+Math.cos(a)*rad*s,cy+Math.sin(a)*rad*s)}
        ctx.closePath();ctx.stroke();
    });
    // Axes
    ctx.strokeStyle='rgba(217,119,6,0.08)';
    for(var i=0;i<n;i++){
        var a=-Math.PI/2+(2*Math.PI/n)*i;
        ctx.beginPath();ctx.moveTo(cx,cy);ctx.lineTo(cx+Math.cos(a)*rad,cy+Math.sin(a)*rad);ctx.stroke();
    }
    // Data polygon
    ctx.beginPath();ctx.fillStyle='rgba(217,119,6,0.2)';ctx.strokeStyle='#d97706';ctx.lineWidth=2;
    for(var i=0;i<=n;i++){
        var a=-Math.PI/2+(2*Math.PI/n)*(i%n);
        var v=vals[i%n]*rad;
        if(i===0)ctx.moveTo(cx+Math.cos(a)*v,cy+Math.sin(a)*v);
        else ctx.lineTo(cx+Math.cos(a)*v,cy+Math.sin(a)*v);
    }
    ctx.closePath();ctx.fill();ctx.stroke();
    // Dots
    ctx.fillStyle='#fbbf24';
    for(var i=0;i<n;i++){
        var a=-Math.PI/2+(2*Math.PI/n)*i;
        var v=vals[i]*rad;
        ctx.beginPath();ctx.arc(cx+Math.cos(a)*v,cy+Math.sin(a)*v,4,0,2*Math.PI);ctx.fill();
    }
    // Labels
    ctx.fillStyle='#d6d3d1';ctx.font='10px Inter,sans-serif';ctx.textAlign='center';
    for(var i=0;i<n;i++){
        var a=-Math.PI/2+(2*Math.PI/n)*i;
        var lx=cx+Math.cos(a)*(rad+30);
        var ly=cy+Math.sin(a)*(rad+30);
        var lines=dims[i].split('\n');
        lines.forEach(function(l,li){ctx.fillText(l,lx,ly+li*12)});
    }
}

// ═══ RENDER SCENARIOS ═══
function bubRenderScenarios(scenarios){
    var grid=document.getElementById('bubScenarioGrid');
    var html='';
    scenarios.forEach(function(s){
        html+='<div class="bub-scenario-card" style="border-top:3px solid '+s.color+'">';
        html+='<h5 style="color:'+s.color+'">'+s.name+'</h5>';
        html+='<p style="margin-bottom:0.75rem">'+s.desc+'</p>';
        html+='<div style="font-size:0.78rem;color:#e7e5e4;line-height:1.8">';
        html+='Risk Score: <strong style="color:'+s.color+'">'+s.risk.toFixed(0)+'/100</strong><br>';
        html+='S/D Ratio: <strong>'+s.sdRatio.toFixed(1)+'x</strong><br>';
        html+='Vacancy: <strong>'+s.vacancy.toFixed(0)+'%</strong><br>';
        html+='NPV: <strong style="color:'+(s.npv>0?'#34d399':'#f87171')+'">'+(s.npv>=0?'+$':'-$')+fmt(Math.abs(s.npv))+'</strong><br>';
        html+='Payback: <strong>'+(s.payback<50?s.payback.toFixed(1)+' yrs':'N/A')+'</strong><br>';
        html+='Occupancy: <strong>'+(s.occupancy*100).toFixed(0)+'%</strong>';
        html+='</div></div>';
    });
    grid.innerHTML=html;
}

// ═══ MASTER UPDATE ═══
function bubUpdateProPanels(){
    var inputs=bubGetInputs();
    var r=runBubbleModel(inputs.op,inputs.pipe,inputs.pop,inputs.absorb,inputs.precommit,inputs.spec,inputs.demandGrowth,inputs.costMW,inputs.revMW,inputs.opexRatio,inputs.wacc);
    // Monte Carlo
    var mc=bubRunMonteCarlo(inputs);
    document.getElementById('bubMcMean').textContent=mc.mean.toFixed(0);
    document.getElementById('bubMcP5').textContent=mc.p5.toFixed(0);
    document.getElementById('bubMcP50').textContent=mc.p50.toFixed(0);
    document.getElementById('bubMcP95').textContent=mc.p95.toFixed(0);
    document.getElementById('bubMcStd').textContent=mc.stdDev.toFixed(1);
    document.getElementById('bubMcProb').textContent=mc.probCritical.toFixed(0)+'%';
    // Color code MC KPIs
    ['bubMcMean','bubMcP50','bubMcP95'].forEach(function(id){
        var el=document.getElementById(id);var v=parseFloat(el.textContent);
        el.className='bub-kpi-value'+(v>=70?' bad':v>=50?' warn':' good');
    });
    document.getElementById('bubMcP5').className='bub-kpi-value'+(mc.p5>=50?' warn':' good');
    document.getElementById('bubMcProb').className='bub-kpi-value'+(mc.probCritical>50?' bad':mc.probCritical>25?' warn':' good');
    bubDrawHistogram(mc.scores);
    // Sensitivity
    var sens=bubRunSensitivity(inputs);
    bubDrawTornado(sens.results,sens.baseScore);
    // Scenarios
    var scenarios=bubRunScenarios(inputs);
    bubRenderScenarios(scenarios);
    // Risk Radar + Grade
    bubDrawRadar(r,inputs);
    var grade=r.riskScore>=80?'F':r.riskScore>=70?'D':r.riskScore>=50?'C':r.riskScore>=30?'B':'A';
    var gc=r.riskScore>=70?'bad':r.riskScore>=30?'warn':'good';
    document.getElementById('bubRiskGrade').textContent=grade;
    document.getElementById('bubRiskGrade').className='bub-kpi-value '+gc;
    document.getElementById('bubRiskPctile').textContent=(100-r.riskScore).toFixed(0)+'th';
    document.getElementById('bubRiskPctile').className='bub-kpi-value '+gc;
    // Dimension scores (0-100 inverted so higher = better)
    var sdScore=Math.max(0,100-Math.min(r.sdRatio/3*100,100)).toFixed(0);
    var specScore=Math.max(0,(1-inputs.spec)*100).toFixed(0);
    var absScore=Math.max(0,100-Math.min(r.yearsAbsorb/15*100,100)).toFixed(0);
    var npvScore=r.npv>0?Math.min(100,r.npv/(inputs.pipe*inputs.costMW*0.3)*100).toFixed(0):'0';
    document.getElementById('bubDimSD').textContent=sdScore+'/100';
    document.getElementById('bubDimSD').className='bub-kpi-value '+(parseInt(sdScore)>=60?'good':parseInt(sdScore)>=30?'warn':'bad');
    document.getElementById('bubDimSpec').textContent=specScore+'/100';
    document.getElementById('bubDimSpec').className='bub-kpi-value '+(parseInt(specScore)>=60?'good':parseInt(specScore)>=30?'warn':'bad');
    document.getElementById('bubDimAbsorb').textContent=absScore+'/100';
    document.getElementById('bubDimAbsorb').className='bub-kpi-value '+(parseInt(absScore)>=60?'good':parseInt(absScore)>=30?'warn':'bad');
    document.getElementById('bubDimNPV').textContent=npvScore+'/100';
    document.getElementById('bubDimNPV').className='bub-kpi-value '+(parseInt(npvScore)>=60?'good':parseInt(npvScore)>=30?'warn':'bad');
    // Narrative
    document.getElementById('bubNarrative').innerHTML=bubGenerateNarrative(inputs,r,mc,scenarios);
}

// ═══ PDF EXPORT ═══
function bubExportPDF(){
    var w=window.open('','_blank');
    if(!w){alert('Please allow popups for PDF export.');return}

    var inputs=bubGetInputs();
    var r=runBubbleModel(inputs.op,inputs.pipe,inputs.pop,inputs.absorb,inputs.precommit,inputs.spec,inputs.demandGrowth,inputs.costMW,inputs.revMW,inputs.opexRatio,inputs.wacc);
    var market=document.getElementById('calcMarket').options[document.getElementById('calcMarket').selectedIndex].text;
    var isPro=bubPremium&&bubMode==='pro';
    var mc=null,sens=null;
    if(isPro){mc=bubRunMonteCarlo(inputs);sens=bubRunSensitivity(inputs)}
    var date=new Date().toLocaleDateString('en-GB');
    var html='<!DOCTYPE html><html><head><meta charset="UTF-8"><title>Bubble Risk Report — '+market+'</title>';
    html+='<style>*{margin:0;padding:0;box-sizing:border-box}body{font-family:Inter,-apple-system,sans-serif;color:#1f2937;padding:30px;max-width:900px;margin:0 auto;font-size:11px;line-height:1.6}';
    html+='h1{font-size:22px;color:#1e3a5f;margin-bottom:4px}h2{font-size:14px;color:#1e3a5f;border-bottom:2px solid #d97706;padding-bottom:4px;margin:20px 0 10px}';
    html+='table{width:100%;border-collapse:collapse;margin:8px 0}th{background:#f8fafc;font-size:10px;text-transform:uppercase;color:#64748b;padding:8px;text-align:left;border:1px solid #e5e7eb}';
    html+='td{padding:8px;border:1px solid #e5e7eb;font-size:11px}.badge{display:inline-block;padding:2px 10px;border-radius:50px;font-weight:700;font-size:10px}';
    html+='.green{background:#ecfdf5;color:#059669}.amber{background:#fffbeb;color:#d97706}.red{background:#fef2f2;color:#dc2626}';
    html+='.score-big{font-size:48px;font-weight:800;text-align:center;margin:15px 0}';
    html+='.kpi-row{display:flex;gap:12px;margin:10px 0}.kpi-box{flex:1;background:#f8fafc;border:1px solid #e5e7eb;border-radius:8px;padding:12px;text-align:center}';
    html+='.kpi-val{font-size:20px;font-weight:800}.kpi-lbl{font-size:9px;color:#64748b;margin-top:4px}';
    html+='.narrative p{margin-bottom:8px}.narrative strong{color:#92400e}';
    html+='.chart-row{display:flex;gap:16px;margin:12px 0}.chart-row>div{flex:1;min-width:0}';
    html+='.footer{border-top:1px solid #e5e7eb;margin-top:20px;padding-top:10px;font-size:9px;color:#94a3b8;text-align:center}';
    html+='@media print{@page{margin:15mm}body{-webkit-print-color-adjust:exact;print-color-adjust:exact}}</style></head><body>';
    // Header
    html+='<div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:15px;border-bottom:2px solid #d97706;padding-bottom:10px"><div><h1>SEA Data Center Bubble Risk Report</h1>';
    html+='<div style="color:#64748b;font-size:11px">'+market+' | Generated '+date+'</div></div>';
    html+='<div style="text-align:right"><div style="font-weight:800;color:#d97706;font-size:14px">ResistanceZero</div><div style="font-size:9px;color:#94a3b8">'+(isPro?'Pro Risk Intelligence':'Free Assessment')+'</div></div></div>';
    // Risk Score block
    var gc=r.riskScore>=70?'red':r.riskScore>=30?'amber':'green';
    var grade=r.riskScore>=70?'Critical':r.riskScore>=50?'High':r.riskScore>=30?'Moderate':'Low';
    html+='<div style="text-align:center;padding:15px;background:#f8fafc;border-radius:10px;margin:10px 0">';
    html+='<div style="font-size:11px;color:#64748b;text-transform:uppercase">Bubble Risk Score</div>';
    html+='<div class="score-big '+gc+'">'+r.riskScore.toFixed(0)+'/100</div>';
    html+='<span class="badge '+gc+'">'+grade+' Risk</span></div>';
    // KPI row
    html+='<div class="kpi-row">';
    html+='<div class="kpi-box"><div class="kpi-val" style="color:'+(r.sdRatio>2?'#dc2626':r.sdRatio>1.3?'#d97706':'#059669')+'">'+r.sdRatio.toFixed(1)+'x</div><div class="kpi-lbl">S/D Ratio</div></div>';
    html+='<div class="kpi-box"><div class="kpi-val">'+(r.avgOccupancy*100).toFixed(0)+'%</div><div class="kpi-lbl">Proj. Occupancy</div></div>';
    html+='<div class="kpi-box"><div class="kpi-val" style="color:'+(r.npv>0?'#059669':'#dc2626')+'">'+(r.npv>=0?'+$':'-$')+fmt(Math.abs(r.npv))+'</div><div class="kpi-lbl">10-Year NPV</div></div>';
    html+='<div class="kpi-box"><div class="kpi-val">'+(r.paybackYears<50?r.paybackYears.toFixed(1)+' yrs':'N/A')+'</div><div class="kpi-lbl">Payback</div></div>';
    html+='</div>';
    // Inputs table (2-col layout)
    html+='<h2>Input Parameters</h2><table><tr><th style="width:30%">Parameter</th><th style="width:20%">Value</th><th style="width:30%">Parameter</th><th style="width:20%">Value</th></tr>';
    html+='<tr><td style="font-weight:600">Market</td><td>'+market+'</td><td style="font-weight:600">Current Operational</td><td>'+inputs.op.toLocaleString()+' MW</td></tr>';
    html+='<tr><td style="font-weight:600">Total Pipeline</td><td>'+inputs.pipe.toLocaleString()+' MW</td><td style="font-weight:600">Population</td><td>'+inputs.pop+'M</td></tr>';
    html+='<tr><td style="font-weight:600">Absorption Rate</td><td>'+inputs.absorb+' MW/yr</td><td style="font-weight:600">Pre-Committed</td><td>'+(inputs.precommit*100).toFixed(0)+'%</td></tr>';
    html+='<tr><td style="font-weight:600">Speculative Build</td><td>'+(inputs.spec*100).toFixed(0)+'%</td><td style="font-weight:600">Demand Growth</td><td>'+(inputs.demandGrowth*100).toFixed(0)+'%/yr</td></tr>';
    html+='<tr><td style="font-weight:600">Build Cost</td><td>$'+inputs.costMW+'M/MW</td><td style="font-weight:600">Revenue/MW/Yr</td><td>$'+inputs.revMW+'M</td></tr>';
    html+='<tr><td style="font-weight:600">OPEX Ratio</td><td>'+(inputs.opexRatio*100).toFixed(0)+'%</td><td style="font-weight:600">WACC</td><td>'+(inputs.wacc*100).toFixed(1)+'%</td></tr></table>';
    // Results table
    html+='<h2>Risk Analysis Results</h2><table><tr><th>Metric</th><th>Value</th><th>Assessment</th></tr>';
    html+='<tr><td>Supply-to-Demand Ratio</td><td style="font-weight:700;color:'+(r.sdRatio>2?'#dc2626':r.sdRatio>1.3?'#d97706':'#059669')+'">'+r.sdRatio.toFixed(1)+'x</td><td>'+(r.sdRatio>2?'Significant oversupply':r.sdRatio>1.3?'Moderate oversupply':'Balanced')+'</td></tr>';
    html+='<tr><td>Years to Absorb</td><td>'+r.yearsAbsorb.toFixed(1)+' yrs</td><td>'+(r.yearsAbsorb>10?'Extended timeline':r.yearsAbsorb>5?'Manageable':'Healthy')+'</td></tr>';
    html+='<tr><td>Projected Vacancy</td><td>'+r.actualVacancy.toFixed(0)+'%</td><td>'+(r.actualVacancy>25?'Pricing pressure likely':'Within norms')+'</td></tr>';
    html+='<tr><td>Break-Even Occupancy</td><td>'+r.breakeven.toFixed(0)+'%</td><td>'+(r.breakeven>75?'High threshold':'Achievable')+'</td></tr>';
    html+='<tr><td>Capital at Risk</td><td>$'+fmt(r.capitalRisk)+'</td><td>Speculative builds exposure</td></tr>';
    html+='<tr><td>Annual EBITDA</td><td>$'+fmt(r.annualEBITDA)+'/yr</td><td>'+(100-inputs.opexRatio*100).toFixed(0)+'% margin</td></tr>';
    html+='<tr><td>Payback Period</td><td>'+(r.paybackYears<50?r.paybackYears.toFixed(1)+' yrs':'N/A')+'</td><td>'+(r.paybackYears<=7?'Attractive':r.paybackYears<=10?'Acceptable':'Extended risk')+'</td></tr>';
    html+='<tr><td>10-Year NPV</td><td style="font-weight:700;color:'+(r.npv>0?'#059669':'#dc2626')+'">'+(r.npv>=0?'+$':'-$')+fmt(Math.abs(r.npv))+'</td><td>'+(r.npv>0?'Value-creating':'Value-destroying')+'</td></tr></table>';
    // Pro sections
    if(isPro&&mc){
        // SVG Risk Distribution
        html+='<h2>Monte Carlo Risk Distribution (10,000 Runs)</h2>';
        html+='<div class="chart-row"><div>';
        // SVG Histogram
        var svgW=400,svgH=200,bins=30;
        var svgMin=mc.min,svgMax=mc.max,svgRange=svgMax-svgMin||1;
        var svgCounts=new Array(bins).fill(0);
        mc.scores.forEach(function(s){var idx=Math.min(bins-1,Math.floor((s-svgMin)/svgRange*bins));svgCounts[idx]++});
        var svgMaxC=Math.max.apply(null,svgCounts);
        var svgBarW=(svgW-40)/bins;
        html+='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 '+svgW+' '+svgH+'" style="width:100%">';
        for(var si=0;si<bins;si++){
            var sh=(svgCounts[si]/svgMaxC)*(svgH-40);
            var sx=20+si*svgBarW;var sy=svgH-20-sh;
            var sv=svgMin+si*svgRange/bins;
            var sc=sv>=70?'#dc2626':sv>=50?'#d97706':sv>=30?'#f59e0b':'#059669';
            html+='<rect x="'+sx+'" y="'+sy+'" width="'+(svgBarW-1)+'" height="'+sh+'" fill="'+sc+'" rx="2"/>';
        }
        for(var si=0;si<=4;si++){
            var sv=(svgMin+(svgRange/4)*si).toFixed(0);
            html+='<text x="'+(20+(svgW-40)/4*si)+'" y="'+(svgH-4)+'" text-anchor="middle" font-size="9" fill="#64748b">'+sv+'</text>';
        }
        html+='</svg></div><div>';
        // Stats table beside
        html+='<table><tr><th>Statistic</th><th>Value</th></tr>';
        html+='<tr><td>Mean Risk</td><td><strong>'+mc.mean.toFixed(1)+'</strong></td></tr>';
        html+='<tr><td>P5 (Best)</td><td>'+mc.p5.toFixed(1)+'</td></tr>';
        html+='<tr><td>Median (P50)</td><td>'+mc.p50.toFixed(1)+'</td></tr>';
        html+='<tr><td>P95 (Worst)</td><td>'+mc.p95.toFixed(1)+'</td></tr>';
        html+='<tr><td>Std Deviation</td><td>'+mc.stdDev.toFixed(1)+'</td></tr>';
        html+='<tr><td>P(Critical &gt;70)</td><td style="font-weight:700;color:'+(mc.probCritical>50?'#dc2626':'#d97706')+'">'+mc.probCritical.toFixed(0)+'%</td></tr></table>';
        html+='</div></div>';
    }
    if(isPro&&sens){
        // SVG Tornado
        html+='<h2>Sensitivity Analysis — Top Risk Drivers</h2>';
        html+='<div class="chart-row"><div>';
        var top6=sens.results.slice(0,6);
        var tW=420,tH=180;
        var tMaxR=Math.max.apply(null,top6.map(function(r){return r.range}))||1;
        html+='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 '+tW+' '+tH+'" style="width:100%">';
        var tBarH=22,tGap=4,tLabelW=130,tChartL=tLabelW+5,tChartW=tW-tLabelW-15;
        var tCx=tLabelW+tChartW/2;
        html+='<line x1="'+tCx+'" y1="0" x2="'+tCx+'" y2="'+tH+'" stroke="#e5e7eb" stroke-dasharray="4,4"/>';
        top6.forEach(function(sr,si){
            var ty=5+si*(tBarH+tGap);
            html+='<text x="'+(tLabelW-2)+'" y="'+(ty+tBarH/2+4)+'" text-anchor="end" font-size="10" fill="#374151">'+sr.name+'</text>';
            var lDelta=Math.min(sr.low-sr.base,sr.high-sr.base);
            var rDelta=Math.max(sr.low-sr.base,sr.high-sr.base);
            var lW=Math.abs(lDelta)/tMaxR*(tChartW/2);
            var rW=Math.abs(rDelta)/tMaxR*(tChartW/2);
            html+='<rect x="'+(tCx-lW)+'" y="'+ty+'" width="'+lW+'" height="'+tBarH+'" fill="'+(lDelta<0?'#059669':'#dc2626')+'" rx="3"/>';
            html+='<rect x="'+tCx+'" y="'+ty+'" width="'+rW+'" height="'+tBarH+'" fill="'+(rDelta>0?'#dc2626':'#059669')+'" rx="3"/>';
            html+='<text x="'+(tCx-lW/2)+'" y="'+(ty+tBarH/2+3)+'" text-anchor="middle" font-size="8" fill="#fff" font-weight="600">'+sr.low.toFixed(0)+'</text>';
            html+='<text x="'+(tCx+rW/2)+'" y="'+(ty+tBarH/2+3)+'" text-anchor="middle" font-size="8" fill="#fff" font-weight="600">'+sr.high.toFixed(0)+'</text>';
        });
        html+='</svg></div><div>';
        // Sensitivity table beside
        html+='<table><tr><th>Parameter</th><th>-20%</th><th>Base</th><th>+20%</th><th>Range</th></tr>';
        top6.forEach(function(sr){
            html+='<tr><td>'+sr.name+'</td><td>'+sr.low.toFixed(1)+'</td><td>'+sr.base.toFixed(1)+'</td><td>'+sr.high.toFixed(1)+'</td><td><strong>'+sr.range.toFixed(1)+'</strong></td></tr>';
        });
        html+='</table></div></div>';
    }
    if(isPro){
        // Narrative
        html+='<h2>Executive Risk Assessment</h2><div class="narrative">'+bubGenerateNarrative(inputs,r,mc,bubRunScenarios(inputs))+'</div>';
        // Scenarios table
        var scens=bubRunScenarios(inputs);
        html+='<h2>Scenario Comparison</h2><table><tr><th>Scenario</th><th>Risk Score</th><th>S/D Ratio</th><th>NPV</th><th>Payback</th><th>Vacancy</th></tr>';
        scens.forEach(function(s){
            html+='<tr><td style="font-weight:600">'+s.name+'</td>';
            html+='<td style="color:'+(s.risk>=70?'#dc2626':s.risk>=30?'#d97706':'#059669')+';font-weight:700">'+s.risk.toFixed(0)+'/100</td>';
            html+='<td>'+s.sdRatio.toFixed(1)+'x</td>';
            html+='<td style="color:'+(s.npv>0?'#059669':'#dc2626')+'">'+(s.npv>=0?'+$':'-$')+fmt(Math.abs(s.npv))+'</td>';
            html+='<td>'+(s.payback<50?s.payback.toFixed(1)+' yrs':'N/A')+'</td>';
            html+='<td>'+s.vacancy.toFixed(0)+'%</td></tr>';
        });
        html+='</table>';
    }
    // Methodology
    html+='<h2>Methodology</h2><p style="font-size:10px;color:#64748b">5-factor weighted risk model: S/D ratio (30pts), speculative exposure (25pts), pre-commitment gap (20pts), absorption timeline (15pts), extended payback (10pts). Monte Carlo: 10,000 iterations with ±15% uniform random variation across all inputs. NPV: 10-year DCF with 3-year ramp-up. Sources: Cushman &amp; Wakefield H1 2025, Arizton 2025-2030, CBRE SEA Data Center Report 2025.</p>';
    html+='<div class="footer">resistancezero.com &middot; Generated '+date+' &middot; All calculations performed client-side — no data sent to any server</div>';
        html+='
<!-- ═══ Feature 22: Reading Progress Bar ═══ -->
<script>
(function() {
    var bar = document.getElementById('scrollProgress');
    if (!bar) return;
    var ticking = false;
    function updateProgress() {
        var scrollTop = window.scrollY || document.documentElement.scrollTop;
        var docHeight = document.documentElement.scrollHeight - window.innerHeight;
        var pct = docHeight > 0 ? (scrollTop / docHeight) * 100 : 0;
        bar.style.width = Math.min(pct, 100) + '%';
        ticking = false;
    }
    window.addEventListener('scroll', function() {
        if (!ticking) { requestAnimationFrame(updateProgress); ticking = true; }
    }, { passive: true });
    updateProgress();
})();
</script>

<!-- ═══ Feature 23: TOC Sidebar ═══ -->
<script>
(function() {
    // Find H2s with IDs first, then fallback to auto-generating IDs
    var sections = document.querySelectorAll('.article-body h2[id], .article-content h2[id]');
    if (!sections.length) {
        var allH2s = document.querySelectorAll('.article-body h2, .article-content h2');
        allH2s.forEach(function(h2, i) {
            if (!h2.id) h2.id = 'toc-section-' + (i + 1);
        });
        sections = document.querySelectorAll('.article-body h2[id], .article-content h2[id]');
    }
    if (!sections.length) return;

    var sidebarList = document.getElementById('tocSidebarList');
    var mobileList = document.getElementById('tocMobileList');
    var sidebar = document.getElementById('tocSidebar');
    var tocToggle = document.getElementById('tocMobileToggle');
    var tocDrawer = document.getElementById('tocMobileDrawer');
    var tocBackdrop = document.getElementById('tocMobileBackdrop');
    var tocClose = document.getElementById('tocDrawerClose');

    var tocData = [];
    sections.forEach(function(h2, i) {
        var id = h2.getAttribute('id');
        var numMatch = id.match(/\d+/);
        var num = numMatch ? numMatch[0] : String(i + 1);
        var text = h2.textContent.replace(/^\s*\d+[\.\s]*/, '').trim();
        tocData.push({ id: id, num: num, text: text });
    });

    function buildList(container, isMobile) {
        tocData.forEach(function(item) {
            var li = document.createElement('li');
            if (!isMobile) li.className = 'toc-sidebar-item';
            var a = document.createElement('a');
            a.href = '#' + item.id;
            a.setAttribute('data-section', item.id);
            if (isMobile) {
                a.textContent = item.num + '. ' + item.text;
            } else {
                a.className = 'toc-sidebar-link';
                a.innerHTML = '<span class="toc-sidebar-num">' + item.num + '</span>' + item.text;
            }
            a.addEventListener('click', function(e) {
                e.preventDefault();
                var target = document.getElementById(item.id);
                if (target) window.scrollTo({ top: target.offsetTop - 80, behavior: 'smooth' });
                if (isMobile) closeMobileDrawer();
            });
            li.appendChild(a);
            container.appendChild(li);
        });
    }

    buildList(sidebarList, false);
    buildList(mobileList, true);

    var currentSection = null;
    var observer = new IntersectionObserver(function(entries) {
        entries.forEach(function(entry) {
            if (entry.isIntersecting) {
                currentSection = entry.target.getAttribute('id');
                highlightActive(currentSection);
            }
        });
    }, { rootMargin: '-80px 0px -70% 0px', threshold: 0 });

    sections.forEach(function(s) { observer.observe(s); });

    function highlightActive(sectionId) {
        sidebarList.querySelectorAll('.toc-sidebar-link').forEach(function(a) {
            a.classList.toggle('active', a.getAttribute('data-section') === sectionId);
        });
        mobileList.querySelectorAll('a').forEach(function(a) {
            a.classList.toggle('active', a.getAttribute('data-section') === sectionId);
        });
    }

    var articleContent = document.querySelector('.article-content');
    if (articleContent && sidebar) {
        var sidebarObserver = new IntersectionObserver(function(entries) {
            entries.forEach(function(entry) {
                sidebar.classList.toggle('visible', entry.isIntersecting);
            });
        }, { rootMargin: '0px', threshold: 0.01 });
        sidebarObserver.observe(articleContent);
    }

    function openMobileDrawer() {
        tocDrawer.classList.add('active');
        tocBackdrop.classList.add('active');
        document.body.style.overflow = 'hidden';
    }
    function closeMobileDrawer() {
        tocDrawer.classList.remove('active');
        tocBackdrop.classList.remove('active');
        document.body.style.overflow = '';
    }

    if (tocToggle) tocToggle.addEventListener('click', openMobileDrawer);
    if (tocClose) tocClose.addEventListener('click', closeMobileDrawer);
    if (tocBackdrop) tocBackdrop.addEventListener('click', closeMobileDrawer);
})();
</script>

<!-- ═══ Feature 21: Global Search ═══ -->
<script>
(function() {
    var searchBtn = document.getElementById('navSearchBtn');
    var overlay = document.getElementById('searchOverlay');
    var modal = document.getElementById('searchModal');
    var input = document.getElementById('searchInput');
    var resultsEl = document.getElementById('searchResults');
    var fuse = null;
    var searchData = null;
    var focusedIdx = -1;

    function openSearch() {
        overlay.classList.add('active');
        modal.classList.add('active');
        input.value = '';
        input.focus();
        focusedIdx = -1;
        resultsEl.innerHTML = '<div class="search-empty">Type to search across all content</div>';
        if (!searchData) {
            fetch('search-index.json')
                .then(function(r) { return r.json(); })
                .then(function(data) {
                    searchData = data;
                    fuse = new Fuse(data, {
                        keys: [
                            { name: 'title', weight: 0.4 },
                            { name: 'description', weight: 0.25 },
                            { name: 'keywords', weight: 0.25 },
                            { name: 'category', weight: 0.1 }
                        ],
                        threshold: 0.35,
                        includeScore: true,
                        minMatchCharLength: 2
                    });
                })
                .catch(function() {});
        }
    }

    function closeSearch() {
        overlay.classList.remove('active');
        modal.classList.remove('active');
        input.blur();
    }

    function getIconClass(cat) {
        cat = (cat || '').toLowerCase();
        if (cat === 'calculator') return 'calc';
        if (cat === 'tool') return 'tool';
        return '';
    }

    function getIconLabel(item) {
        if (item.url && item.url.indexOf('article-') === 0) {
            return item.url.replace('article-', '').replace('.html', '').padStart(2, '0');
        }
        var cat = (item.category || '').toLowerCase();
        if (cat === 'calculator') return '&#9889;';
        if (cat === 'tool') return '&#9881;';
        return '&#9733;';
    }

    function renderResults(results) {
        if (!results.length) {
            resultsEl.innerHTML = '<div class="search-empty">No results found</div>';
            focusedIdx = -1;
            return;
        }
        var html = '';
        results.slice(0, 8).forEach(function(r, i) {
            var item = r.item;
            var iconCls = getIconClass(item.category);
            html += '<a href="' + item.url + '" class="search-result-item" data-idx="' + i + '">'
                + '<div class="search-result-icon ' + iconCls + '">' + getIconLabel(item) + '</div>'
                + '<div class="search-result-info">'
                + '<div class="search-result-category">' + (item.category || '') + '</div>'
                + '<div class="search-result-title">' + item.title + '</div>'
                + '<div class="search-result-desc">' + item.description + '</div>'
                + '</div></a>';
        });
        resultsEl.innerHTML = html;
        focusedIdx = -1;
    }

    function updateFocus() {
        var items = resultsEl.querySelectorAll('.search-result-item');
        items.forEach(function(el, i) {
            el.classList.toggle('focused', i === focusedIdx);
            if (i === focusedIdx) el.scrollIntoView({ block: 'nearest' });
        });
    }

    if (searchBtn) searchBtn.addEventListener('click', openSearch);
    if (overlay) overlay.addEventListener('click', closeSearch);

    document.addEventListener('keydown', function(e) {
        if ((e.ctrlKey || e.metaKey) && e.key === 'k') {
            e.preventDefault();
            if (modal.classList.contains('active')) closeSearch();
            else openSearch();
            return;
        }
        if (!modal.classList.contains('active')) return;
        if (e.key === 'Escape') { closeSearch(); return; }
        var items = resultsEl.querySelectorAll('.search-result-item');
        if (e.key === 'ArrowDown') {
            e.preventDefault();
            focusedIdx = Math.min(focusedIdx + 1, items.length - 1);
            updateFocus();
        } else if (e.key === 'ArrowUp') {
            e.preventDefault();
            focusedIdx = Math.max(focusedIdx - 1, 0);
            updateFocus();
        } else if (e.key === 'Enter' && focusedIdx >= 0 && items[focusedIdx]) {
            e.preventDefault();
            items[focusedIdx].click();
        }
    });

    if (input) {
        input.addEventListener('input', function() {
            var query = input.value.trim();
            if (query.length < 2 || !fuse) {
                resultsEl.innerHTML = '<div class="search-empty">Type to search across all content</div>';
                focusedIdx = -1;
                return;
            }
            var results = fuse.search(query);
            renderResults(results);
        });
    }
})();
</script>

</body></html>';
    w.document.open();w.document.write(html);w.document.close();
    setTimeout(function(){w.print()},600);
}

// ═══ INPUT HOOKS ═══
document.querySelectorAll('.bubble-calculator input, .bubble-calculator select').forEach(function(el){
    el.addEventListener('input',function(){if(bubPremium&&bubMode==='pro')bubUpdateProPanels()});
    el.addEventListener('change',function(){if(bubPremium&&bubMode==='pro')bubUpdateProPanels()});
});
// Unlock panels if already logged in
if(bubPremium){bubUnlockPanels()}
</script>

<script src="auth.js"></script>
<script src="rz-tracker.js"></script>

<!-- Cookie Consent Banner -->
<div class="cookie-banner hidden" id="cookieBanner">
    <p>We use cookies for analytics to improve your experience. <a href="privacy.html">Learn more</a></p>
    <div class="cookie-actions">
        <button class="cookie-accept" id="cookieAccept">Accept</button>
        <button class="cookie-decline" id="cookieDecline">Decline</button>
    </div>
</div>

<!-- Scroll to Top -->
<button class="scroll-top-btn" id="scrollTopBtn" aria-label="Scroll to top">
    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><polyline points="18 15 12 9 6 15"/></svg>
</button>

<script>
(function(){
    // Cookie Banner
    var cb = document.getElementById('cookieBanner');
    var consent = localStorage.getItem('rz_cookie_consent');
    if (!consent && cb) {
        cb.classList.remove('hidden');
    }
    var acceptBtn = document.getElementById('cookieAccept');
    var declineBtn = document.getElementById('cookieDecline');
    if (acceptBtn) acceptBtn.addEventListener('click', function(){
        localStorage.setItem('rz_cookie_consent', 'accepted');
        cb.classList.add('hidden');
    });
    if (declineBtn) declineBtn.addEventListener('click', function(){
        localStorage.setItem('rz_cookie_consent', 'declined');
        cb.classList.add('hidden');
        // Disable GA
        window['ga-disable-G-GED7FX8RTV'] = true;
    });

    // Scroll to Top
    var sBtn = document.getElementById('scrollTopBtn');
    if (sBtn) {
        var ticking = false;
        window.addEventListener('scroll', function(){
            if (!ticking) {
                window.requestAnimationFrame(function(){
                    if (window.scrollY > 500) {
                        sBtn.classList.add('visible');
                    } else {
                        sBtn.classList.remove('visible');
                    }
                    ticking = false;
                });
                ticking = true;
            }
        });
        sBtn.addEventListener('click', function(){
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });
    }
})();
</script>

</body>
</html>
