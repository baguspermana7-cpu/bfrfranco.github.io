<!DOCTYPE html>
<html lang="en">
<head>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-GED7FX8RTV"></script>
    <script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}gtag('js',new Date());gtag('config','G-GED7FX8RTV');</script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TIA-942 Compliance Checklist | Data Center Infrastructure Standard</title>
    <meta name="description" content="TIA-942 compliance checklist for 5 DC types. 80+ items across 6 domains with facility-type filtering for enterprise, colo, hyperscale, edge, modular.">
    <meta name="keywords" content="TIA-942, Data Center Compliance, Tier Classification, Infrastructure Standard, ANSI/TIA-942-B, Compliance Checklist, Enterprise, Colocation, Hyperscale, Edge, Modular">
    <meta name="author" content="Bagus Dwi Permana">
    <meta name="robots" content="index, follow">
    <meta name="theme-color" content="#10b981">
    <link rel="canonical" href="https://resistancezero.com/tia-942-checklist.html">
    <link rel="alternate" hreflang="en" href="https://resistancezero.com/tia-942-checklist.html">

    <!-- Resource Hints -->
    <link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin>
    <link rel="preconnect" href="https://www.googletagmanager.com" crossorigin>
    <link rel="dns-prefetch" href="https://cdn.jsdelivr.net">
    <link rel="dns-prefetch" href="https://www.googletagmanager.com">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://resistancezero.com/tia-942-checklist.html">
    <meta property="og:title" content="TIA-942 Compliance Checklist — Data Center Standard">
    <meta property="og:description" content="TIA-942-B compliance for 5 DC types — 80+ items across 6 categories with facility-type and tier filtering.">
    <meta property="og:locale" content="en_US">
    <meta property="og:site_name" content="Bagus Dwi Permana Portfolio">
    <meta property="og:image" content="https://resistancezero.com/assets/tia-942-hero.jpg">
    <meta property="og:image:alt" content="Tia 942 Checklist">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="TIA-942 Compliance Checklist">
    <meta name="twitter:description" content="TIA-942-B compliance for 5 DC types with real-time scoring, tier and facility-type filtering.">
    <meta name="twitter:image" content="https://resistancezero.com/assets/tia-942-hero.jpg">
    <script type="application/ld+json">{"@context":"https://schema.org","@type":"WebApplication","name":"TIA-942 Compliance Checklist","applicationCategory":"UtilityApplication","description":"TIA-942-B compliance assessment for 5 data center types with 80+ items across 6 categories and 4 tier levels.","url":"https://resistancezero.com/tia-942-checklist.html","operatingSystem":"Web Browser","offers":{"@type":"Offer","price":"0","priceCurrency":"USD"},"creator":{"@type":"Person","name":"Bagus Dwi Permana"}}</script>
    <link rel="icon" type="image/png" href="assets/Favicon.png">
    <link rel="apple-touch-icon" href="assets/Favicon.png">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --primary-gradient: linear-gradient(135deg, #065f46 0%, #059669 50%, #10b981 100%);
            --secondary-gradient: linear-gradient(135deg, #059669 0%, #065f46 100%);
            --dark-green: #065f46;
            --medium-green: #059669;
            --light-green: #10b981;
            --accent-emerald: #10b981;
            --accent-gold: #f59e0b;
            --accent-cyan: #06b6d4;
            --accent-purple: #8b5cf6;
            --accent-red: #ef4444;
            --bg-primary: #ffffff;
            --bg-secondary: #f8f9fa;
            --bg-tertiary: #e9ecef;
            --text-primary: #212529;
            --text-secondary: #495057;
            --text-muted: #6c757d;
            --glass-bg: rgba(255,255,255,0.85);
            --glass-bg-dark: rgba(6,95,70,0.95);
            --glass-border: rgba(16,185,129,0.1);
            --glass-blur: blur(20px);
            --shadow-sm: 0 2px 4px rgba(0,0,0,0.05);
            --shadow-md: 0 4px 12px rgba(0,0,0,0.1);
            --shadow-lg: 0 8px 30px rgba(0,0,0,0.12);
        }
        *{margin:0;padding:0;box-sizing:border-box}html{scroll-behavior:smooth}
        body{font-family:'Inter',-apple-system,BlinkMacSystemFont,sans-serif;background:var(--bg-primary);color:var(--text-primary);min-height:100vh;line-height:1.6}
        .page-background{position:fixed;top:0;left:0;width:100%;height:100%;pointer-events:none;z-index:0;background:radial-gradient(ellipse at top right,rgba(16,185,129,0.08) 0%,transparent 50%),radial-gradient(ellipse at bottom left,rgba(5,150,105,0.05) 0%,transparent 50%),linear-gradient(rgba(16,185,129,0.02) 1px,transparent 1px),linear-gradient(90deg,rgba(16,185,129,0.02) 1px,transparent 1px);background-size:100% 100%,100% 100%,50px 50px,50px 50px}

        /* Navbar */
        .navbar{position:fixed;top:0;left:0;right:0;z-index:1000;background:var(--glass-bg);backdrop-filter:var(--glass-blur);border-bottom:1px solid var(--glass-border);box-shadow:var(--shadow-md)}
        .nav-container{display:flex;justify-content:space-between;align-items:center;padding:1rem 2rem;max-width:1400px;margin:0 auto}
        .nav-brand{display:flex;align-items:center;gap:12px;text-decoration:none;color:var(--dark-green)}
        .nav-logo{width:44px;height:44px;background:linear-gradient(135deg,#10b981,#059669);border-radius:12px;display:flex;align-items:center;justify-content:center;font-weight:700;font-size:10px;color:white;box-shadow:0 4px 12px rgba(16,185,129,0.3);letter-spacing:-0.5px}
        .nav-title{font-weight:700;font-size:1.1rem;color:var(--dark-green)}
        .nav-subtitle{font-size:0.75rem;color:var(--text-muted)}
        .nav-links{display:flex;gap:1.5rem;align-items:center}
        .nav-link{color:var(--text-secondary);text-decoration:none;font-size:0.9rem;font-weight:500;padding:8px 0;transition:color 0.3s}
        .nav-link:hover{color:var(--dark-green)}
        .nav-back{display:flex;align-items:center;gap:8px;padding:10px 20px;background:var(--primary-gradient);border:none;border-radius:8px;color:white;text-decoration:none;font-size:0.85rem;font-weight:600;transition:all 0.3s;box-shadow:0 4px 12px rgba(16,185,129,0.25)}
        .nav-back:hover{transform:translateY(-2px)}

        .nav-auth-wrap{position:relative;margin-left:0.5rem}
        .nav-login-btn{display:flex;align-items:center;gap:6px;padding:8px 18px;background:linear-gradient(135deg,#7c3aed,#a855f7);border:none;border-radius:8px;color:white;font-size:0.82rem;font-weight:600;font-family:inherit;cursor:pointer;transition:all 0.3s;box-shadow:0 3px 10px rgba(139,92,246,0.3);white-space:nowrap}
        .nav-login-btn:hover{transform:translateY(-1px);box-shadow:0 5px 16px rgba(139,92,246,0.4)}
        .nav-user-btn{display:flex;align-items:center;gap:8px;padding:6px 12px 6px 6px;background:rgba(139,92,246,0.08);border:1px solid rgba(139,92,246,0.25);border-radius:50px;cursor:pointer;transition:all 0.3s;font-family:inherit;color:var(--text-primary)}
        .nav-user-btn:hover{background:rgba(139,92,246,0.14)}
        .nav-user-avatar{width:30px;height:30px;border-radius:50%;background:linear-gradient(135deg,#7c3aed,#a855f7);display:flex;align-items:center;justify-content:center;color:white;font-size:0.7rem;font-weight:700}
        .nav-user-email{font-size:0.8rem;font-weight:500;color:var(--text-secondary);max-width:130px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}
        .nav-user-chevron{font-size:0.6rem;color:var(--text-muted);transition:transform 0.3s}
        .nav-user-btn.open .nav-user-chevron{transform:rotate(180deg)}
        .nav-user-dropdown{display:none;position:absolute;top:calc(100% + 8px);right:0;background:white;border-radius:12px;border:1px solid #e2e8f0;box-shadow:0 12px 40px rgba(0,0,0,0.12);min-width:220px;z-index:1001;overflow:hidden}
        .nav-user-dropdown.show{display:block}
        .nav-dd-header{padding:14px 16px;border-bottom:1px solid #f1f5f9}
        .nav-dd-tier-badge{display:inline-flex;padding:3px 10px;border-radius:50px;font-size:0.65rem;font-weight:700;letter-spacing:0.5px;margin-bottom:6px}
        .nav-dd-tier-badge.pro{background:linear-gradient(135deg,#8b5cf6,#a855f7);color:white}
        .nav-dd-email{font-size:0.78rem;color:#64748b;word-break:break-all}
        .nav-dd-logout{display:flex;align-items:center;gap:8px;width:100%;padding:12px 16px;border:none;background:none;font-size:0.82rem;font-weight:500;color:#ef4444;cursor:pointer;font-family:inherit;transition:background 0.2s}
        .nav-dd-logout:hover{background:#fef2f2}

        .main-content{position:relative;z-index:10;padding-top:80px}

        /* Hero */
        .hero{padding:3rem 2rem 2rem;text-align:center;max-width:900px;margin:0 auto}
        .hero-badge{display:inline-flex;align-items:center;gap:8px;padding:8px 16px;background:linear-gradient(135deg,rgba(16,185,129,0.1),rgba(16,185,129,0.05));border:1px solid rgba(16,185,129,0.3);border-radius:50px;font-size:0.8rem;color:var(--accent-emerald);font-weight:600;margin-bottom:1.5rem}
        .hero h1{font-size:clamp(2rem,4vw,2.8rem);font-weight:800;background:linear-gradient(135deg,#10b981,#059669);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;margin-bottom:1rem}
        .hero p{font-size:1.1rem;color:var(--text-secondary);max-width:700px;margin:0 auto}
        .quick-stats{display:flex;justify-content:center;gap:2rem;margin-top:1.5rem;flex-wrap:wrap}
        .quick-stat{display:flex;align-items:center;gap:6px;font-size:0.82rem;color:var(--text-muted)}
        .quick-stat i{color:var(--accent-emerald)}

        /* Toolbar */
        .tia-toolbar{display:flex;align-items:center;justify-content:space-between;gap:0.75rem;margin:0 auto;max-width:1400px;padding:0 2rem 1.25rem;flex-wrap:wrap}
        .tia-mode-bar{display:flex;gap:0;background:#f1f5f9;border-radius:10px;padding:3px;border:1px solid #e2e8f0}
        .tia-toolbar-btn{padding:0.55rem 1.2rem;border-radius:8px;border:none;cursor:pointer;font-weight:700;font-size:0.82rem;font-family:inherit;transition:all 0.25s;display:flex;align-items:center;gap:6px;white-space:nowrap}
        .tia-btn-free{background:transparent;color:#64748b}
        .tia-btn-free.active{background:linear-gradient(135deg,#10b981,#059669);color:white;box-shadow:0 2px 8px rgba(16,185,129,0.3)}
        .tia-btn-free:not(.active):hover{background:rgba(16,185,129,0.08);color:#059669}
        .tia-btn-pro{background:transparent;color:#64748b}
        .tia-btn-pro.active{background:linear-gradient(135deg,#7c3aed,#a855f7);color:white;box-shadow:0 2px 8px rgba(139,92,246,0.3)}
        .tia-btn-pro:not(.active):hover{background:rgba(139,92,246,0.08);color:#8b5cf6}
        .tia-btn-pro.locked-hint{position:relative}
        .tia-btn-pro.locked-hint::after{content:'';position:absolute;top:-2px;right:-2px;width:8px;height:8px;background:#f59e0b;border-radius:50%;border:2px solid #f1f5f9}
        .tia-toolbar-actions{display:flex;gap:0.5rem;align-items:center}
        .tia-btn-reset{padding:0.55rem 1rem;border-radius:10px;border:1px solid #e2e8f0;background:white;color:#64748b;cursor:pointer;font-weight:600;font-size:0.82rem;font-family:inherit;transition:all 0.3s;display:flex;align-items:center;gap:6px}
        .tia-btn-reset:hover{border-color:#10b981;color:#10b981;background:rgba(16,185,129,0.04)}
        .tia-btn-pdf{padding:0.55rem 1rem;border-radius:10px;border:1px solid rgba(239,68,68,0.3);background:rgba(239,68,68,0.04);color:#ef4444;cursor:pointer;font-weight:600;font-size:0.82rem;font-family:inherit;transition:all 0.3s;display:flex;align-items:center;gap:6px}
        .tia-btn-pdf:hover{border-color:#ef4444;background:rgba(239,68,68,0.1);box-shadow:0 2px 8px rgba(239,68,68,0.15)}
        .tia-btn-pdf.disabled{opacity:0.45;pointer-events:none}
        .tia-mode-indicator{font-size:0.72rem;font-weight:700;letter-spacing:0.5px;padding:3px 10px;border-radius:50px;display:none}
        .tia-mode-indicator.free-active{display:inline-flex;background:rgba(16,185,129,0.1);color:#059669}
        .tia-mode-indicator.pro-active{display:inline-flex;background:rgba(139,92,246,0.1);color:#8b5cf6}

        /* Tier Selector */
        .tier-selector{max-width:1400px;margin:0 auto;padding:0 2rem 1.5rem}
        .tier-bar{display:flex;gap:0;background:#f1f5f9;border-radius:12px;padding:4px;border:1px solid #e2e8f0}
        .tier-btn{flex:1;padding:0.6rem 1rem;border-radius:9px;border:none;cursor:pointer;font-weight:600;font-size:0.82rem;font-family:inherit;transition:all 0.25s;text-align:center;color:#64748b;background:transparent}
        .tier-btn.active{background:white;color:var(--dark-green);box-shadow:var(--shadow-sm);border:1px solid rgba(16,185,129,0.2)}
        .tier-btn:not(.active):hover{background:rgba(16,185,129,0.06);color:#059669}
        .tier-num{font-weight:800;margin-right:4px}

        /* DC Type Selector */
        .dctype-selector{max-width:1400px;margin:0 auto;padding:0 2rem 1.5rem}
        .dctype-label{font-size:0.75rem;font-weight:700;color:var(--text-muted);text-transform:uppercase;letter-spacing:0.5px;margin-bottom:0.5rem;display:flex;align-items:center;gap:6px}
        .dctype-label i{color:var(--accent-emerald);font-size:0.8rem}
        .dctype-bar{display:flex;gap:0;background:#f1f5f9;border-radius:12px;padding:4px;border:1px solid #e2e8f0;flex-wrap:wrap}
        .dctype-btn{flex:1;padding:0.5rem 0.75rem;border-radius:9px;border:none;cursor:pointer;font-weight:600;font-size:0.78rem;font-family:inherit;transition:all 0.25s;text-align:center;color:#64748b;background:transparent;display:flex;align-items:center;justify-content:center;gap:5px;white-space:nowrap;min-width:0}
        .dctype-btn.active{background:white;color:#1e293b;box-shadow:var(--shadow-sm);border:1px solid rgba(16,185,129,0.2)}
        .dctype-btn:not(.active):hover{background:rgba(16,185,129,0.06);color:#059669}
        .dctype-btn i{font-size:0.72rem}

        /* Calculator Grid */
        .calculator-section{max-width:1400px;margin:2rem auto;padding:0 2rem}
        .calculator-grid{display:grid;grid-template-columns:1.3fr 1fr;gap:2rem}

        /* Checklist Panel */
        .checklist-panel{display:flex;flex-direction:column;gap:1rem}
        .checklist-category{background:var(--glass-bg);backdrop-filter:var(--glass-blur);border:1px solid var(--glass-border);border-radius:16px;overflow:hidden;transition:box-shadow 0.3s}
        .checklist-category:hover{box-shadow:var(--shadow-md)}
        .cat-header{display:flex;align-items:center;gap:12px;padding:1rem 1.25rem;cursor:pointer;user-select:none;transition:background 0.2s}
        .cat-header:hover{background:rgba(16,185,129,0.03)}
        .cat-icon{width:36px;height:36px;border-radius:10px;display:flex;align-items:center;justify-content:center;font-size:0.9rem;flex-shrink:0}
        .cat-info{flex:1}
        .cat-title{font-size:0.95rem;font-weight:700;color:var(--text-primary)}
        .cat-progress-wrap{display:flex;align-items:center;gap:8px;margin-top:4px}
        .cat-progress-bar{flex:1;height:4px;background:#e2e8f0;border-radius:2px;overflow:hidden}
        .cat-progress-fill{height:100%;border-radius:2px;transition:width 0.4s ease;width:0%}
        .cat-count{font-size:0.72rem;font-weight:600;color:var(--text-muted);white-space:nowrap;font-family:'JetBrains Mono',monospace}
        .cat-chevron{font-size:0.75rem;color:var(--text-muted);transition:transform 0.3s}
        .cat-header.open .cat-chevron{transform:rotate(180deg)}
        .cat-body{max-height:0;overflow:hidden;transition:max-height 0.4s ease}
        .cat-body.open{max-height:3000px}
        .cat-items{padding:0 1.25rem 1rem}
        .check-item{display:flex;align-items:center;gap:10px;padding:0.6rem 0;border-bottom:1px solid rgba(0,0,0,0.04)}
        .check-item:last-child{border-bottom:none}
        .check-item input[type="checkbox"]{width:18px;height:18px;accent-color:#10b981;cursor:pointer;flex-shrink:0}
        .check-label{flex:1;font-size:0.85rem;color:var(--text-primary);cursor:pointer}
        .check-weight{padding:2px 8px;border-radius:50px;font-size:0.65rem;font-weight:700;font-family:'JetBrains Mono',monospace;white-space:nowrap}
        .check-weight.w3{background:rgba(239,68,68,0.1);color:#ef4444}
        .check-weight.w2{background:rgba(245,158,11,0.1);color:#f59e0b}
        .check-weight.w1{background:rgba(107,114,128,0.1);color:#6b7280}
        .check-ref{font-size:0.68rem;color:var(--text-muted);font-family:'JetBrains Mono',monospace;white-space:nowrap}

        /* Tooltips */
        .tooltip-trigger{display:inline-flex;align-items:center;justify-content:center;width:16px;height:16px;background:rgba(16,185,129,0.1);border:1px solid rgba(16,185,129,0.3);border-radius:50%;font-size:10px;color:var(--accent-emerald);cursor:help;margin-left:auto;transition:all 0.3s;flex-shrink:0}
        .tooltip-trigger:hover{background:rgba(16,185,129,0.2);transform:scale(1.1)}
        #tooltip-container{position:fixed;width:340px;max-width:calc(100vw - 40px);padding:16px;background:linear-gradient(135deg,#064e3b,#065f46);border:1px solid rgba(255,255,255,0.15);border-radius:12px;box-shadow:0 15px 50px rgba(0,0,0,0.5);z-index:999999;pointer-events:none;opacity:0;visibility:hidden;transition:opacity 0.15s ease;color:white;font-size:12px;line-height:1.6}
        #tooltip-container.visible{opacity:1;visibility:visible}
        #tooltip-container .tip-title{font-size:13px;font-weight:700;color:#34d399;margin-bottom:6px;display:flex;align-items:center;gap:8px}
        #tooltip-container .tip-desc{color:rgba(255,255,255,0.9)}
        #tooltip-container .tip-meta{display:flex;gap:10px;margin-top:8px;padding-top:8px;border-top:1px solid rgba(255,255,255,0.12);font-size:10px;color:rgba(255,255,255,0.6)}
        #tooltip-container .tip-meta span{display:flex;align-items:center;gap:4px}
        .tooltip-trigger .tooltip-data{display:none}

        /* Results Panel */
        .results-panel{position:sticky;top:100px}
        .results-card{background:var(--glass-bg);backdrop-filter:var(--glass-blur);border:1px solid var(--glass-border);border-radius:16px;padding:1.5rem}
        .score-display{text-align:center;padding:1.5rem 0}
        .score-value{font-size:4rem;font-weight:800;font-family:'JetBrains Mono',monospace;line-height:1}
        .score-label{font-size:0.8rem;color:var(--text-muted);font-weight:600;text-transform:uppercase;letter-spacing:1px;margin-top:0.5rem}
        .score-grade{display:inline-flex;align-items:center;gap:6px;padding:4px 14px;border-radius:50px;font-size:0.75rem;font-weight:700;margin-top:0.75rem}
        .metric-grid{display:grid;grid-template-columns:1fr 1fr;gap:0.75rem;margin-top:1.25rem}
        .metric-box{background:rgba(16,185,129,0.04);border:1px solid rgba(16,185,129,0.1);border-radius:10px;padding:0.75rem;text-align:center}
        .metric-label{font-size:0.68rem;color:var(--text-muted);font-weight:600;text-transform:uppercase;letter-spacing:0.3px}
        .metric-value{font-size:1.1rem;font-weight:700;font-family:'JetBrains Mono',monospace;color:var(--text-primary);margin-top:2px}

        /* Category Bars */
        .cat-bars{margin-top:1.25rem}
        .cat-bars-title{font-size:0.78rem;font-weight:700;color:var(--text-primary);margin-bottom:0.75rem}
        .cat-bar-row{display:flex;align-items:center;gap:8px;margin-bottom:0.5rem}
        .cat-bar-label{font-size:0.72rem;color:var(--text-muted);width:80px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
        .cat-bar-track{flex:1;height:8px;background:#e2e8f0;border-radius:4px;overflow:hidden}
        .cat-bar-fill{height:100%;border-radius:4px;transition:width 0.5s ease}
        .cat-bar-pct{font-size:0.72rem;font-weight:600;font-family:'JetBrains Mono',monospace;width:38px;text-align:right}

        /* Recommendations */
        .rec-section{margin-top:1.25rem}
        .rec-title{font-size:0.78rem;font-weight:700;color:var(--text-primary);margin-bottom:0.75rem;display:flex;align-items:center;gap:6px}
        .rec-card{display:flex;gap:10px;padding:0.75rem;background:rgba(16,185,129,0.04);border:1px solid rgba(16,185,129,0.1);border-radius:10px;margin-bottom:0.5rem}
        .rec-icon{width:32px;height:32px;border-radius:8px;background:rgba(16,185,129,0.1);display:flex;align-items:center;justify-content:center;color:var(--accent-emerald);font-size:0.8rem;flex-shrink:0}
        .rec-text h4{font-size:0.78rem;font-weight:600;color:var(--text-primary)}
        .rec-text p{font-size:0.72rem;color:var(--text-muted);margin-top:2px}

        /* Charts */
        .charts-section{max-width:1400px;margin:2rem auto;padding:0 2rem}
        .charts-grid{display:grid;grid-template-columns:1fr 1fr;gap:1.5rem}
        .chart-card{background:var(--glass-bg);backdrop-filter:var(--glass-blur);border:1px solid var(--glass-border);border-radius:16px;padding:1.5rem}
        .chart-title{font-size:0.85rem;font-weight:700;color:var(--text-primary);margin-bottom:1rem;display:flex;align-items:center;gap:8px}
        .chart-container{position:relative;height:280px}

        /* PRO Sections */
        .pro-section{position:relative}
        .pro-section.locked>*:not(.pro-overlay){filter:blur(6px);user-select:none;pointer-events:none}
        .pro-overlay{display:none;position:absolute;top:0;left:0;right:0;bottom:0;z-index:10;background:rgba(255,255,255,0.7);backdrop-filter:blur(2px);border-radius:16px;flex-direction:column;align-items:center;justify-content:center;gap:0.75rem;pointer-events:all;cursor:pointer}
        .pro-section.locked .pro-overlay{display:flex}
        .pro-overlay i{font-size:2rem;color:var(--accent-purple)}
        .pro-overlay-title{font-size:1rem;font-weight:700;color:var(--text-primary)}
        .pro-overlay-desc{font-size:0.8rem;color:var(--text-muted);text-align:center;max-width:260px}
        .pro-overlay-btn{padding:8px 20px;background:linear-gradient(135deg,#7c3aed,#a855f7);border:none;border-radius:8px;color:white;font-size:0.82rem;font-weight:600;cursor:pointer;transition:all 0.3s}
        .pro-overlay-btn:hover{transform:translateY(-1px)}
        .pro-badge{display:inline-flex;align-items:center;gap:4px;padding:2px 8px;background:linear-gradient(135deg,#8b5cf6,#a855f7);color:white;font-size:0.6rem;font-weight:700;border-radius:50px;letter-spacing:0.5px;vertical-align:middle}

        /* Pro Panel Cards */
        .pro-panel{background:var(--glass-bg);backdrop-filter:var(--glass-blur);border:1px solid var(--glass-border);border-radius:16px;padding:1.5rem;margin-bottom:1.5rem}
        .pro-panel h3{font-size:0.95rem;font-weight:700;margin-bottom:1rem;display:flex;align-items:center;gap:8px}
        .gap-table{width:100%;border-collapse:collapse;font-size:0.8rem}
        .gap-table th{text-align:left;padding:8px 10px;background:rgba(16,185,129,0.05);border-bottom:2px solid rgba(16,185,129,0.15);font-size:0.72rem;text-transform:uppercase;color:var(--text-muted);letter-spacing:0.3px}
        .gap-table td{padding:6px 10px;border-bottom:1px solid rgba(0,0,0,0.04);font-size:0.8rem}
        .priority-badge{padding:2px 8px;border-radius:50px;font-size:0.65rem;font-weight:700}
        .priority-badge.p1{background:rgba(239,68,68,0.1);color:#ef4444}
        .priority-badge.p2{background:rgba(245,158,11,0.1);color:#f59e0b}
        .priority-badge.p3{background:rgba(107,114,128,0.1);color:#6b7280}

        /* Login Modal */
        @keyframes modalSlideIn{from{opacity:0;transform:translateY(-20px)}to{opacity:1;transform:translateY(0)}}

        /* Print */
        @media print{
            body{background:white !important;color:#1e293b !important;-webkit-print-color-adjust:exact;print-color-adjust:exact}
            .navbar,.hero,.tia-toolbar,.tier-selector,.dctype-selector,#loginModal,.nav-back,footer,.pro-overlay,.pro-badge{display:none !important}
            .main-content{padding-top:0 !important}
            .calculator-section{padding:0 !important}
            .calculator-grid{display:block !important}
            .pro-section.locked>*:not(.pro-overlay){filter:none !important;user-select:auto !important;pointer-events:auto !important}
            .results-panel{position:static !important}
            @page{margin:1cm;size:A4}
        }

        /* Responsive */
        @media(max-width:768px){
            .nav-links{display:none}
            .calculator-grid{grid-template-columns:1fr}
            .results-panel{position:static}
            .charts-grid{grid-template-columns:1fr}
            .hero h1{font-size:1.8rem}
            .score-value{font-size:3rem}
            .metric-grid{grid-template-columns:1fr}
            .tier-bar{flex-wrap:wrap}
            .tier-btn{flex:none;width:calc(50% - 2px)}
            .dctype-bar{flex-wrap:wrap}
            .dctype-btn{flex:none;width:calc(50% - 2px)}
        }
        /* Calculator Disclaimer */
        .calc-disclaimer { background: #f1f5f9 !important; border: 1px solid #cbd5e1 !important; border-radius: 12px; padding: 1.25rem 1.5rem; margin-top: 1.5rem; }
        .calc-disclaimer .disc-title { color: #1e293b !important; }
        .calc-disclaimer .disc-text { color: #475569 !important; }
        .calc-disclaimer .disc-text strong { color: #1e293b !important; }
        .calc-disclaimer .disc-text a { color: #2563eb !important; }
        .calc-disclaimer .disc-fine { color: #64748b !important; }
            /* Cookie Banner */
        .cookie-banner { position: fixed; bottom: 0; left: 0; right: 0; z-index: 10002; display: flex; align-items: center; justify-content: center; gap: 1.5rem; padding: 1rem 2rem; background: rgba(255,255,255,0.92); backdrop-filter: blur(12px); -webkit-backdrop-filter: blur(12px); border-top: 1px solid rgba(0,0,0,0.08); box-shadow: 0 -2px 16px rgba(0,0,0,0.06); font-size: 0.85rem; color: #374151; transform: translateY(0); transition: transform 0.4s cubic-bezier(0.4,0,0.2,1); }
        .cookie-banner.hidden { transform: translateY(100%); pointer-events: none; }
        .cookie-banner p { margin: 0; line-height: 1.5; }
        .cookie-banner a { color: #2563eb; text-decoration: underline; }
        .cookie-actions { display: flex; gap: 0.75rem; align-items: center; flex-shrink: 0; }
        .cookie-accept { padding: 0.45rem 1.2rem; background: #2563eb; color: #fff; border: none; border-radius: 6px; font-size: 0.8rem; font-weight: 600; cursor: pointer; transition: background 0.2s; }
        .cookie-accept:hover { background: #1d4ed8; }
        .cookie-decline { padding: 0.45rem 1.2rem; background: transparent; color: #6b7280; border: 1px solid #d1d5db; border-radius: 6px; font-size: 0.8rem; cursor: pointer; transition: all 0.2s; }
        .cookie-decline:hover { background: #f3f4f6; color: #374151; }
        @media (max-width: 768px) { .cookie-banner { flex-direction: column; gap: 0.75rem; text-align: center; padding: 1rem; } }
        @media print { .cookie-banner { display: none; } }
</style>
</head>
<body>
    <div class="page-background"></div>

    <nav class="navbar">
        <div class="nav-container">
            <a href="index.html" class="nav-brand">
                <div class="nav-logo">TIA</div>
                <div>
                    <div class="nav-title">TIA-942 Checklist</div>
                    <div class="nav-subtitle">Compliance Assessment</div>
                </div>
            </a>
            <div class="nav-links">
                <a href="datacenter-solutions.html" class="nav-link">DC Solutions</a>
                <a href="capex-calculator.html" class="nav-link" style="color:#f59e0b;">CAPEX Calc</a>
                <a href="opex-calculator.html" class="nav-link" style="color:#10b981;">OPEX Calc</a>
                <a href="pue-calculator.html" class="nav-link" style="color:#06b6d4;">PUE Calc</a>
                <a href="dcmoc/" class="nav-link" style="color:#ef4444;">DC MOC</a>
                <div class="nav-auth-wrap" id="navAuthWrap">
                    <button class="nav-login-btn" id="navLoginBtn" onclick="handlePremiumTab()">
                        <i class="fas fa-user-circle"></i>
                        <span class="nav-login-text">Login</span>
                    </button>
                    <button class="nav-user-btn" id="navUserBtn" style="display:none;" onclick="toggleUserDropdown()">
                        <div class="nav-user-avatar" id="navUserAvatar">U</div>
                        <span class="nav-user-email" id="navUserEmail"></span>
                        <i class="fas fa-chevron-down nav-user-chevron"></i>
                    </button>
                    <div class="nav-user-dropdown" id="navUserDropdown">
                        <div class="nav-dd-header">
                            <div class="nav-dd-tier-badge pro" id="navDdTierBadge">PRO</div>
                            <div class="nav-dd-email" id="navDdEmail"></div>
                        </div>
                        <button class="nav-dd-logout" onclick="logoutPremium()">
                            <i class="fas fa-sign-out-alt"></i> Logout
                        </button>
                    </div>
                </div>
                <a href="index.html" class="nav-back">
                    <i class="fas fa-arrow-left"></i>
                    Portfolio
                </a>
            </div>
        </div>
    </nav>

    <main class="main-content">
        <section class="hero">
            <div class="hero-badge"><i class="fas fa-certificate"></i> TIA-942-B Compliance</div>
            <h1>TIA-942 Compliance Checklist</h1>
            <p>Assess your data center infrastructure against TIA-942-B standard requirements. Evaluate 80+ items across 6 categories with tier-specific and facility-type filtering for enterprise, colocation, hyperscale, edge, and modular data centers.</p>
            <div style="max-width:800px;margin:1.5rem auto;border-radius:16px;overflow:hidden;box-shadow:0 8px 30px rgba(0,0,0,0.12);border:1px solid rgba(16,185,129,0.15);">
                <img src="assets/tia-942-hero.jpg" alt="TIA-942 Data Center Infrastructure Standard" style="width:100%;height:auto;display:block;" loading="lazy">
            </div>
            <div style="max-width:800px;margin:0 auto 1.5rem;text-align:left;padding:1.25rem 1.5rem;background:rgba(16,185,129,0.04);border:1px solid rgba(16,185,129,0.12);border-radius:12px;">
                <h3 style="font-size:0.95rem;font-weight:700;color:#065f46;margin-bottom:0.5rem;display:flex;align-items:center;gap:8px;"><i class="fas fa-info-circle" style="color:#10b981;"></i> About TIA-942</h3>
                <p style="font-size:0.85rem;color:var(--text-secondary);line-height:1.7;margin:0;">
                    <strong>ANSI/TIA-942-B</strong> is the telecommunications infrastructure standard for data centers published by the Telecommunications Industry Association (TIA). It defines requirements across <strong>six critical domains</strong> — site/architecture, electrical, mechanical/cooling, telecommunications, fire protection, and physical security — organized into <strong>four tier levels</strong> of increasing redundancy and fault tolerance. <strong>Tier 1</strong> (Basic) provides a single path for power and cooling with no redundancy. <strong>Tier 2</strong> (Redundant Components) adds N+1 redundancy. <strong>Tier 3</strong> (Concurrently Maintainable) ensures any component can be serviced without IT interruption. <strong>Tier 4</strong> (Fault Tolerant) provides 2N fully independent infrastructure paths, tolerating any single fault with zero impact. This tool assesses compliance using <strong>weighted scoring</strong> with category importance factors reflecting real-world criticality.
                </p>
            </div>
            <div class="quick-stats">
                <span class="quick-stat"><i class="fas fa-clipboard-check"></i> <span id="statItemCount">56</span> checklist items</span>
                <span class="quick-stat"><i class="fas fa-layer-group"></i> 4 tier levels</span>
                <span class="quick-stat"><i class="fas fa-th-large"></i> 6 categories</span>
                <span class="quick-stat"><i class="fas fa-server"></i> <span id="statDcType">Enterprise</span></span>
            </div>
        </section>

        <!-- Toolbar -->
        <div class="tia-toolbar">
            <div class="tia-mode-bar">
                <button class="tia-toolbar-btn tia-btn-free active" id="btnFreeMode" onclick="setMode('free')">
                    <i class="fas fa-chart-bar"></i> Free Assessment
                </button>
                <button class="tia-toolbar-btn tia-btn-pro locked-hint" id="btnProMode" onclick="setMode('pro')">
                    <i class="fas fa-crown"></i> Pro Analysis
                </button>
            </div>
            <span class="tia-mode-indicator free-active" id="modeIndicator">FREE MODE</span>
            <div class="tia-toolbar-actions">
                <button class="tia-btn-reset" onclick="resetChecklist()">
                    <i class="fas fa-undo"></i> Reset
                </button>
                <button class="tia-btn-pdf disabled" id="btnExportPDF" onclick="exportPDF()">
                    <i class="fas fa-file-pdf"></i> Export PDF
                </button>
            </div>
        </div>

        <!-- Tier Selector -->
        <div class="tier-selector">
            <div class="dctype-label"><i class="fas fa-layer-group"></i> Tier Level</div>
            <div class="tier-bar">
                <button class="tier-btn" onclick="setTier(1)"><span class="tier-num">1</span> Basic</button>
                <button class="tier-btn" onclick="setTier(2)"><span class="tier-num">2</span> Redundant</button>
                <button class="tier-btn active" onclick="setTier(3)"><span class="tier-num">3</span> Concurrently Maintainable</button>
                <button class="tier-btn" onclick="setTier(4)"><span class="tier-num">4</span> Fault Tolerant</button>
            </div>
        </div>

        <!-- DC Type Selector -->
        <div class="dctype-selector">
            <div class="dctype-label"><i class="fas fa-server"></i> Facility Type</div>
            <div class="dctype-bar">
                <button class="dctype-btn active" onclick="setDcType('ent')" data-dc="ent"><i class="fas fa-building"></i> Enterprise</button>
                <button class="dctype-btn" onclick="setDcType('colo')" data-dc="colo"><i class="fas fa-city"></i> Colocation</button>
                <button class="dctype-btn" onclick="setDcType('hyper')" data-dc="hyper"><i class="fas fa-cloud"></i> Hyperscale</button>
                <button class="dctype-btn" onclick="setDcType('edge')" data-dc="edge"><i class="fas fa-microchip"></i> Edge</button>
                <button class="dctype-btn" onclick="setDcType('mod')" data-dc="mod"><i class="fas fa-cube"></i> Modular</button>
            </div>
        </div>

        <!-- Calculator Grid -->
        <section class="calculator-section">
            <div class="calculator-grid">
                <div class="checklist-panel" id="checklistPanel"></div>
                <div class="results-panel">
                    <div class="results-card">
                        <div class="score-display">
                            <div class="score-value" id="scoreValue" style="color:#10b981;">0%</div>
                            <div class="score-label">Overall Compliance</div>
                            <div class="score-grade" id="scoreGrade" style="background:rgba(107,114,128,0.1);color:#6b7280;">F — Incomplete</div>
                        </div>
                        <div class="metric-grid">
                            <div class="metric-box"><div class="metric-label">Checked</div><div class="metric-value" id="metricChecked">0</div></div>
                            <div class="metric-box"><div class="metric-label">Applicable</div><div class="metric-value" id="metricApplicable">0</div></div>
                            <div class="metric-box"><div class="metric-label">Risk Index</div><div class="metric-value" id="metricCRI">0</div></div>
                            <div class="metric-box"><div class="metric-label">Tier Level</div><div class="metric-value" id="metricTier">3</div></div>
                            <div class="metric-box"><div class="metric-label">Weakest Cat.</div><div class="metric-value" id="metricWeakest">0%</div></div>
                            <div class="metric-box"><div class="metric-label">Maturity</div><div class="metric-value" id="metricMaturity" style="font-size:0.85rem;">L1</div></div>
                            <div class="metric-box" style="grid-column:span 2;"><div class="metric-label">Facility Type</div><div class="metric-value" id="metricDcType" style="font-size:0.85rem;">Enterprise</div></div>
                        </div>
                        <div class="cat-bars" id="catBars">
                            <div class="cat-bars-title"><i class="fas fa-chart-bar" style="color:var(--accent-emerald);"></i> Category Scores</div>
                        </div>
                        <div class="rec-section" id="recSection">
                            <div class="rec-title"><i class="fas fa-lightbulb" style="color:var(--accent-emerald);"></i> Top Gaps</div>
                            <div id="recCards"></div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Charts -->
        <section class="charts-section">
            <div class="charts-grid">
                <div class="chart-card">
                    <div class="chart-title"><i class="fas fa-chart-pie" style="color:var(--accent-emerald);"></i> Compliance Overview</div>
                    <div class="chart-container"><canvas id="doughnutChart"></canvas></div>
                </div>
                <div class="chart-card">
                    <div class="chart-title"><i class="fas fa-chart-bar" style="color:var(--accent-emerald);"></i> Category Comparison</div>
                    <div class="chart-container"><canvas id="barChart"></canvas></div>
                </div>
            </div>
            <!-- Pro Charts -->
            <div class="charts-grid pro-section locked" id="proChartsSection" style="margin-top:1.5rem;">
                <div class="pro-overlay" onclick="handlePremiumTab()">
                    <i class="fas fa-crown"></i>
                    <div class="pro-overlay-title">PRO Charts</div>
                    <div class="pro-overlay-desc">Multi-tier radar comparison and Monte Carlo risk distribution</div>
                    <button class="pro-overlay-btn"><i class="fas fa-lock-open" style="margin-right:6px;"></i>Unlock PRO</button>
                </div>
                <div class="chart-card">
                    <div class="chart-title"><i class="fas fa-spider" style="color:var(--accent-purple);"></i> Tier Radar <span class="pro-badge"><i class="fas fa-crown"></i> PRO</span></div>
                    <div class="chart-container"><canvas id="radarChart"></canvas></div>
                </div>
                <div class="chart-card">
                    <div class="chart-title"><i class="fas fa-chart-area" style="color:var(--accent-purple);"></i> Monte Carlo Distribution <span class="pro-badge"><i class="fas fa-crown"></i> PRO</span></div>
                    <div class="chart-container"><canvas id="mcChart"></canvas></div>
                </div>
            </div>
        </section>

        <!-- Pro Panels -->
        <section class="charts-section">
            <!-- Gap Analysis -->
            <div class="pro-section locked" id="proGapSection">
                <div class="pro-overlay" onclick="handlePremiumTab()">
                    <i class="fas fa-crown"></i>
                    <div class="pro-overlay-title">PRO Gap Analysis</div>
                    <div class="pro-overlay-desc">Prioritized list of unchecked items with remediation guidance</div>
                    <button class="pro-overlay-btn"><i class="fas fa-lock-open" style="margin-right:6px;"></i>Unlock PRO</button>
                </div>
                <div class="pro-panel">
                    <h3><i class="fas fa-search" style="color:var(--accent-emerald);"></i> Gap Analysis <span class="pro-badge"><i class="fas fa-crown"></i> PRO</span></h3>
                    <table class="gap-table" id="gapTable">
                        <thead><tr><th>Priority</th><th>Item</th><th>Category</th><th>Weight</th><th>Reference</th></tr></thead>
                        <tbody id="gapTableBody"></tbody>
                    </table>
                </div>
            </div>
            <!-- Monte Carlo -->
            <div class="pro-section locked" id="proMCSection">
                <div class="pro-overlay" onclick="handlePremiumTab()">
                    <i class="fas fa-crown"></i>
                    <div class="pro-overlay-title">PRO Monte Carlo Risk</div>
                    <button class="pro-overlay-btn"><i class="fas fa-lock-open" style="margin-right:6px;"></i>Unlock PRO</button>
                </div>
                <div class="pro-panel">
                    <h3><i class="fas fa-dice" style="color:var(--accent-purple);"></i> Monte Carlo Simulation <span class="pro-badge"><i class="fas fa-crown"></i> PRO</span></h3>
                    <p style="font-size:0.82rem;color:var(--text-muted);margin-bottom:1rem;">10,000 iterations with ±15% weight variance. Shows probability distribution of compliance scores.</p>
                    <div id="mcResults" style="display:grid;grid-template-columns:repeat(4,1fr);gap:0.75rem;"></div>
                </div>
            </div>
            <!-- Tier Comparison -->
            <div class="pro-section locked" id="proTierSection">
                <div class="pro-overlay" onclick="handlePremiumTab()"><i class="fas fa-crown"></i><div class="pro-overlay-title">PRO Tier Comparison</div><button class="pro-overlay-btn"><i class="fas fa-lock-open" style="margin-right:6px;"></i>Unlock PRO</button></div>
                <div class="pro-panel">
                    <h3><i class="fas fa-columns" style="color:var(--accent-cyan);"></i> Tier Comparison <span class="pro-badge"><i class="fas fa-crown"></i> PRO</span></h3>
                    <div id="tierCompare"></div>
                </div>
            </div>
            <!-- Roadmap -->
            <div class="pro-section locked" id="proRoadmapSection">
                <div class="pro-overlay" onclick="handlePremiumTab()"><i class="fas fa-crown"></i><div class="pro-overlay-title">PRO Remediation Roadmap</div><button class="pro-overlay-btn"><i class="fas fa-lock-open" style="margin-right:6px;"></i>Unlock PRO</button></div>
                <div class="pro-panel">
                    <h3><i class="fas fa-road" style="color:var(--accent-gold);"></i> Remediation Roadmap <span class="pro-badge"><i class="fas fa-crown"></i> PRO</span></h3>
                    <table class="gap-table" id="roadmapTable">
                        <thead><tr><th>Item</th><th>Effort</th><th>Est. Cost</th><th>Timeline</th><th>Impact</th></tr></thead>
                        <tbody id="roadmapBody"></tbody>
                    </table>
                </div>
            </div>
            <!-- Sensitivity -->
            <div class="pro-section locked" id="proSensSection">
                <div class="pro-overlay" onclick="handlePremiumTab()"><i class="fas fa-crown"></i><div class="pro-overlay-title">PRO Sensitivity Analysis</div><button class="pro-overlay-btn"><i class="fas fa-lock-open" style="margin-right:6px;"></i>Unlock PRO</button></div>
                <div class="pro-panel">
                    <h3><i class="fas fa-chart-line" style="color:var(--accent-red);"></i> Sensitivity — Top 10 Impact Items <span class="pro-badge"><i class="fas fa-crown"></i> PRO</span></h3>
                    <div id="sensitivityBars"></div>
                </div>
            </div>
        </section>
    
    <!-- Calculator Disclaimer -->
    <div style="max-width:1400px;margin:2rem auto 0;padding:0 2rem;">
        <div class="calc-disclaimer" style="background:rgba(30,41,59,0.6);border:1px solid rgba(148,163,184,0.15);border-radius:12px;padding:1.25rem 1.5rem;">
            <div style="display:flex;align-items:flex-start;gap:0.75rem;">
                <div style="color:#f59e0b;font-size:1rem;margin-top:2px;flex-shrink:0;"><i class="fas fa-triangle-exclamation"></i></div>
                <div>
                    <div class="disc-title" style="font-weight:700;font-size:0.8rem;color:#e2e8f0;margin-bottom:0.5rem;">Disclaimer &amp; Data Sources</div>
                    <p class="disc-text" style="font-size:0.72rem;color:#94a3b8;line-height:1.65;margin:0 0 0.5rem 0;">This calculator is provided for <strong style="color:#cbd5e1;">educational and estimation purposes only</strong>. Results are approximations based on industry benchmarks and publicly available data. They should not be used as the sole basis for investment, procurement, or engineering decisions. Always consult qualified professionals for site-specific analysis.</p>
                    <p class="disc-text" style="font-size:0.72rem;color:#94a3b8;line-height:1.65;margin:0 0 0.5rem 0;"><strong style="color:#cbd5e1;">Algorithm &amp; methodology sources:</strong> TIA-942-B Telecommunications Infrastructure Standard for Data Centers (2017), Uptime Institute Tier Classification System, BICSI 002-2019 Data Center Design and Implementation Best Practices.</p>
                    <p class="disc-text" style="font-size:0.72rem;color:#94a3b8;line-height:1.65;margin:0 0 0.5rem 0;">All calculations are performed entirely in your browser. No data is transmitted to any server. See our <a href="privacy.html" style="color:#60a5fa;text-decoration:underline;">Privacy Policy</a> for details.</p>
                    <p class="disc-fine" style="font-size:0.68rem;color:#64748b;line-height:1.5;margin:0;">By using this tool you agree to our <a href="terms.html" style="color:#60a5fa;text-decoration:underline;">Terms of Service</a>. All content on ResistanceZero is independent personal research. This site does not represent any current or former employer.</p>
                </div>
            </div>
        </div>
    </div>

    </main>

    <!-- Login Modal -->
    <div id="loginModal" style="display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.6);backdrop-filter:blur(8px);z-index:99999;align-items:center;justify-content:center;">
        <div style="background:white;border-radius:20px;padding:2.5rem;max-width:420px;width:90%;box-shadow:0 25px 60px rgba(0,0,0,0.3);position:relative;animation:modalSlideIn 0.3s ease;">
            <button onclick="closeLoginModal()" style="position:absolute;top:16px;right:16px;background:none;border:none;font-size:1.2rem;color:#94a3b8;cursor:pointer;padding:4px;">&times;</button>
            <div style="text-align:center;margin-bottom:1.5rem;">
                <div style="width:56px;height:56px;background:linear-gradient(135deg,#7c3aed,#a855f7);border-radius:16px;display:flex;align-items:center;justify-content:center;margin:0 auto 1rem;"><i class="fas fa-crown" style="color:white;font-size:1.3rem;"></i></div>
                <h3 style="font-size:1.2rem;font-weight:700;color:#1e293b;">Sign In</h3>
                <p style="font-size:0.82rem;color:#64748b;margin-top:0.5rem;">Gap analysis, Monte Carlo, tier comparison, roadmap, sensitivity, and PDF export.</p>
            </div>
            <div style="margin-bottom:1rem;">
                <label style="display:block;font-size:0.78rem;font-weight:600;color:#475569;margin-bottom:4px;">Email</label>
                <input type="email" id="loginEmail" placeholder="demo@resistancezero.com" style="width:100%;padding:10px 14px;border:1px solid #e2e8f0;border-radius:10px;font-size:0.9rem;font-family:inherit;outline:none;">
            </div>
            <div style="margin-bottom:1rem;">
                <label style="display:block;font-size:0.78rem;font-weight:600;color:#475569;margin-bottom:4px;">Password</label>
                <input type="password" id="loginPassword" placeholder="Enter password" style="width:100%;padding:10px 14px;border:1px solid #e2e8f0;border-radius:10px;font-size:0.9rem;font-family:inherit;outline:none;" onkeydown="if(event.key==='Enter')attemptLogin()">
            </div>
            <div id="loginError" style="display:none;padding:8px 12px;background:#fef2f2;border:1px solid #fecaca;border-radius:8px;color:#ef4444;font-size:0.78rem;margin-bottom:1rem;"></div>
            <button onclick="attemptLogin()" style="width:100%;padding:12px;background:linear-gradient(135deg,#7c3aed,#a855f7);border:none;border-radius:10px;color:white;font-size:0.9rem;font-weight:700;cursor:pointer;font-family:inherit;">Sign In</button>
            <div style="text-align:center;margin-top:1rem;padding:8px;background:#f8fafc;border-radius:8px;">
                <p class="disc-text" style="font-size:0.72rem;color:#94a3b8;"><i class="fas fa-shield-alt" style="margin-right:4px;"></i> Demo Account: demo@resistancezero.com / demo2026</p>
            </div>
            <div style="text-align:center;margin-top:0.75rem;"><p style="font-size:0.68rem;color:#cbd5e1;"><i class="fas fa-lock" style="margin-right:3px;"></i> All calculations run locally. No data transmitted.</p></div>
            <p class="disc-fine" style="font-size:0.68rem;color:#64748b;margin-top:12px;line-height:1.5;text-align:center;">By signing in, you agree to our <a href="terms.html" target="_blank" style="color:#8b5cf6;text-decoration:underline;">Terms</a> &amp; <a href="privacy.html" target="_blank" style="color:#8b5cf6;text-decoration:underline;">Privacy Policy</a>.</p>
        </div>
    </div>

    <script>
    // ═══ DATA MODEL ═══
    const CATEGORIES = [
        { id:'site', label:'Site & Architecture', icon:'fa-building', color:'#10b981', weight:1.0 },
        { id:'elec', label:'Electrical', icon:'fa-bolt', color:'#f59e0b', weight:1.5 },
        { id:'mech', label:'Mechanical / Cooling', icon:'fa-snowflake', color:'#06b6d4', weight:1.3 },
        { id:'tel', label:'Telecommunications', icon:'fa-network-wired', color:'#3b82f6', weight:1.0 },
        { id:'fire', label:'Fire Protection', icon:'fa-fire-extinguisher', color:'#ef4444', weight:1.1 },
        { id:'sec', label:'Physical Security', icon:'fa-shield-alt', color:'#8b5cf6', weight:0.9 }
    ];
    const DC_TYPES = [
        {id:'ent', label:'Enterprise', icon:'fa-building', color:'#3b82f6'},
        {id:'colo', label:'Colocation', icon:'fa-city', color:'#8b5cf6'},
        {id:'hyper', label:'Hyperscale/Cloud', icon:'fa-cloud', color:'#06b6d4'},
        {id:'edge', label:'Edge/Micro', icon:'fa-microchip', color:'#f59e0b'},
        {id:'mod', label:'Modular/Prefab', icon:'fa-cube', color:'#10b981'}
    ];
    const DC_ALL = ['ent','colo','hyper','edge','mod'];
    const ITEMS = [
        // ── Site & Architecture ──
        {id:'site_location',cat:'site',label:'Site risk assessment completed',tiers:[1,2,3,4],w:3,ref:'§5.1',dcTypes:DC_ALL,
         tip:'Comprehensive site risk assessment evaluating natural disasters (seismic, flood, wind), environmental hazards, proximity to airports/highways, EMI sources, and utility reliability. Must document all identified risks with mitigation strategies.'},
        {id:'site_floor_load',cat:'site',label:'Floor load ≥12 kPa (250 psf)',tiers:[1,2,3,4],w:3,ref:'§5.2.2',dcTypes:DC_ALL,
         tip:'Structural floor load capacity must support ≥12 kPa (250 psf) for heavy IT equipment, UPS batteries, and cooling units. Standard office floors (~2.5 kPa) are insufficient. Requires structural engineer certification.'},
        {id:'site_ceiling',cat:'site',label:'Ceiling ≥3.0m clear',tiers:[1,2,3,4],w:2,ref:'§5.2.3',dcTypes:['ent','colo','hyper'],
         tip:'Minimum 3.0m (10ft) clear height above finished floor for adequate airflow, overhead cable routing, and cooling distribution. Higher ceilings improve hot-air stratification and reduce recirculation.'},
        {id:'site_raised_floor',cat:'site',label:'Raised floor ≥450mm',tiers:[2,3,4],w:2,ref:'§5.2.4',dcTypes:['ent','colo'],
         tip:'Raised access floor ≥450mm (18in) enables underfloor air distribution, cable routing, and leak detection. Required for Tier 2+ to separate power/data cabling from cooling airflow paths.'},
        {id:'site_cable_pathway',cat:'site',label:'Dedicated cable pathways',tiers:[1,2,3,4],w:2,ref:'§5.3.1',dcTypes:DC_ALL,
         tip:'Dedicated cable pathways separate power and telecommunications cables to prevent electromagnetic interference. Requires physical separation between high-voltage and low-voltage systems per NEC/TIA standards.'},
        {id:'site_entrance_room',cat:'site',label:'Dedicated entrance room(s)',tiers:[2,3,4],w:2,ref:'§5.3.2',dcTypes:['ent','colo','hyper'],
         tip:'Dedicated entrance room(s) house carrier demarcation points, main distribution frames, and incoming service connections. Must be physically separate from computer room with fire-rated walls.'},
        {id:'site_loading_dock',cat:'site',label:'Loading dock/staging area',tiers:[2,3,4],w:1,ref:'§5.2.5',dcTypes:['ent','colo','hyper'],
         tip:'Loading dock or staging area for equipment delivery, unpacking, and acclimation. Prevents contamination from cardboard/debris entering white space. Recommended minimum 30 m² staging area.'},
        {id:'site_separate_entry',cat:'site',label:'Separate delivery & personnel entry',tiers:[3,4],w:1,ref:'§5.2.6',dcTypes:['ent','colo','hyper'],
         tip:'Separate delivery entrance and personnel entry prevents security conflicts and contamination. Delivery path should not cross secure computer room areas. Critical for Tier 3/4 security requirements.'},
        {id:'site_dual_entrance',cat:'site',label:'Dual entrance rooms (diverse carriers)',tiers:[3,4],w:3,ref:'§5.3.3',dcTypes:['ent','colo','hyper'],
         tip:'Dual entrance rooms with diverse carrier entry paths eliminate single points of failure for telecommunications. Each room should serve independent carrier feeds entering from different building sides.'},
        {id:'site_vapor_barrier',cat:'site',label:'Vapor barrier below floor',tiers:[2,3,4],w:1,ref:'§5.2.7',dcTypes:['ent','colo'],
         tip:'Vapor barrier (6-mil polyethylene minimum) below raised floor prevents moisture migration from concrete slab. Critical in humid climates. Requires continuous barrier with sealed seams and penetration boots.'},
        // ── Electrical ──
        {id:'elec_utility_feed',cat:'elec',label:'Dedicated utility power feed',tiers:[1,2,3,4],w:3,ref:'§6.1.1',dcTypes:DC_ALL,
         tip:'Dedicated utility power feed from local distribution company sized for full facility load plus growth. Must have dedicated transformer(s) not shared with other buildings. Voltage typically 12-35kV medium voltage.'},
        {id:'elec_dual_feed',cat:'elec',label:'Dual feeds from independent substations',tiers:[3,4],w:3,ref:'§6.1.2',dcTypes:['ent','colo','hyper'],
         tip:'Two independent utility feeds from separate substations via diverse physical paths. Eliminates single utility source as point of failure. Required for Tier 3/4 concurrent maintainability. Each feed must handle full load.'},
        {id:'elec_ups',cat:'elec',label:'UPS system for critical loads',tiers:[1,2,3,4],w:3,ref:'§6.2.1',dcTypes:DC_ALL,
         tip:'Uninterruptible Power Supply protects IT loads from power disturbances (sags, surges, outages). Online double-conversion is standard for data centers. Must bridge load until generator starts (~10-15 seconds typically).'},
        {id:'elec_ups_n1',cat:'elec',label:'UPS N+1 redundancy',tiers:[2,3,4],w:3,ref:'§6.2.2',dcTypes:['ent','colo','hyper','mod'],
         tip:'N+1 UPS redundancy provides one additional module beyond minimum required capacity. Example: if 4 modules needed for full load, deploy 5. Allows one module failure or maintenance without capacity loss.'},
        {id:'elec_ups_2n',cat:'elec',label:'UPS 2N configuration',tiers:[4],w:3,ref:'§6.2.3',dcTypes:['ent','colo','hyper'],
         tip:'2N UPS provides fully independent, mirrored power paths (A+B). Each path carries 100% of load independently. Tier 4 fault-tolerant requirement — any single failure has zero impact on IT operations.'},
        {id:'elec_generator',cat:'elec',label:'Backup generator(s)',tiers:[2,3,4],w:3,ref:'§6.3.1',dcTypes:['ent','colo','hyper','mod'],
         tip:'Backup diesel generators provide extended power during utility outages. Must auto-start and accept load within 10-15 seconds. Sized for full critical load plus cooling and support systems.'},
        {id:'elec_ats',cat:'elec',label:'Automatic transfer switch',tiers:[2,3,4],w:3,ref:'§6.3.2',dcTypes:['ent','colo','hyper','mod'],
         tip:'Automatic Transfer Switch (ATS) detects utility failure and transfers load to generator within seconds. Must be rated for full facility load. Types: open transition (brief interruption) or closed transition (make-before-break).'},
        {id:'elec_fuel_24h',cat:'elec',label:'≥24-hour on-site fuel storage',tiers:[3,4],w:2,ref:'§6.3.3',dcTypes:['ent','colo','hyper'],
         tip:'Minimum 24-hour on-site fuel storage at full generator load. Ensures operation during extended utility outages. Requires fuel maintenance plan, automatic fuel polishing system, and contractual refueling agreements.'},
        {id:'elec_pdu',cat:'elec',label:'PDUs in computer room',tiers:[1,2,3,4],w:2,ref:'§6.4.1',dcTypes:DC_ALL,
         tip:'Power Distribution Units in computer room provide final power distribution to racks. Transform voltage (e.g., 480V→208V) and provide branch circuit protection with monitoring. Located near rack rows for short whip lengths.'},
        {id:'elec_dual_pdu',cat:'elec',label:'Dual A+B PDU feeds per rack',tiers:[3,4],w:3,ref:'§6.4.2',dcTypes:['ent','colo','hyper'],
         tip:'Dual A+B PDU feeds per rack with independent power paths from separate UPS systems. Each feed powers one PSU in dual-corded equipment. Eliminates PDU, UPS, or utility feed as single point of failure.'},
        {id:'elec_grounding',cat:'elec',label:'TGB/TMGB grounding system',tiers:[1,2,3,4],w:2,ref:'§6.5',dcTypes:DC_ALL,
         tip:'Telecommunications Grounding Busbar (TGB) and Telecommunications Main Grounding Busbar (TMGB) provide equipotential ground per TIA-607. Prevents ground loops, reduces EMI, and protects from ESD damage.'},
        {id:'elec_epo',cat:'elec',label:'Emergency Power Off system',tiers:[1,2,3,4],w:2,ref:'§6.6',dcTypes:DC_ALL,
         tip:'Emergency Power Off (EPO) provides immediate de-energization of computer room electrical systems in emergencies (fire, flood). Required by NEC 645.10/11. Must be clearly marked, accessible, and properly interlocked.'},
        {id:'elec_metering',cat:'elec',label:'Branch circuit monitoring',tiers:[2,3,4],w:1,ref:'§6.7',dcTypes:DC_ALL,
         tip:'Branch circuit monitoring provides real-time visibility into power consumption at circuit level (per-breaker). Enables capacity planning, identifies stranded power, supports PUE optimization and billing accuracy.'},
        {id:'elec_concurrent',cat:'elec',label:'All electrical concurrently maintainable',tiers:[3,4],w:3,ref:'§6.8',dcTypes:['ent','colo','hyper'],
         tip:'All electrical systems concurrently maintainable — any component can be serviced without IT load interruption. Requires maintenance bypass paths, redundant distribution, wrap-around capability, and trained procedures.'},
        // ── Mechanical / Cooling ──
        {id:'mech_cooling',cat:'mech',label:'Dedicated computer room cooling',tiers:[1,2,3,4],w:3,ref:'§7.1.1',dcTypes:DC_ALL,
         tip:'Dedicated precision cooling (CRAC/CRAH units) designed for data centers. Standard office HVAC lacks the precision temperature/humidity control, air filtration (MERV 8+), and 24/7 operation required for IT environments.'},
        {id:'mech_n1',cat:'mech',label:'N+1 cooling redundancy',tiers:[2,3,4],w:3,ref:'§7.1.2',dcTypes:['ent','colo','hyper','mod'],
         tip:'N+1 cooling redundancy provides one spare unit beyond minimum required. If 3 CRAC units needed for design load, deploy 4. One unit can fail or undergo maintenance while maintaining ASHRAE A1 conditions.'},
        {id:'mech_2n',cat:'mech',label:'2N cooling capacity',tiers:[4],w:3,ref:'§7.1.3',dcTypes:['ent','colo','hyper'],
         tip:'2N cooling with fully independent, redundant cooling paths (separate chilled water loops, CRAHs, chillers). Each system handles full heat load independently. Tier 4 fault-tolerance requirement.'},
        {id:'mech_temp',cat:'mech',label:'Temperature monitoring (ASHRAE 18-27°C)',tiers:[1,2,3,4],w:2,ref:'§7.2',dcTypes:DC_ALL,
         tip:'Continuous temperature monitoring per ASHRAE TC 9.9 A1 recommended envelope (18-27°C / 64.4-80.6°F). Sensors at rack inlet, return air, and supply air. BMS alerts for threshold violations with escalation.'},
        {id:'mech_humidity',cat:'mech',label:'Humidity control 40-60% RH',tiers:[2,3,4],w:2,ref:'§7.3',dcTypes:['ent','colo'],
         tip:'Relative humidity maintained 40-60% RH to prevent electrostatic discharge (below 40%) and condensation/corrosion (above 60%). Precision humidifiers/dehumidifiers integrated with CRAC/CRAH units.'},
        {id:'mech_leak_detect',cat:'mech',label:'Water/leak detection',tiers:[2,3,4],w:2,ref:'§7.4',dcTypes:['ent','colo','hyper'],
         tip:'Water/liquid leak detection sensors deployed under raised floor, near CRAC drip pans, chilled water pipes, and humidifiers. Cable-style sensors provide continuous coverage. Must alarm to BMS/NOC within 30 seconds.'},
        {id:'mech_pipe_routing',cat:'mech',label:'Pipes routed away from IT equipment',tiers:[1,2,3,4],w:2,ref:'§7.5',dcTypes:['ent','colo','hyper'],
         tip:'All water, steam, and drain pipes must be routed away from IT equipment areas. Where unavoidable (e.g., rear-door heat exchangers), pipes must have drip pans, leak detection, and automatic isolation valves.'},
        {id:'mech_concurrent',cat:'mech',label:'Cooling concurrently maintainable',tiers:[3,4],w:3,ref:'§7.6',dcTypes:['ent','colo','hyper'],
         tip:'Cooling systems concurrently maintainable — any cooling component can be serviced without affecting IT environment conditions. Requires isolation valves, redundant piping loops, bypass capability, and N+1 or 2N capacity.'},
        {id:'mech_separate_zone',cat:'mech',label:'Separate IT vs office HVAC zones',tiers:[2,3,4],w:1,ref:'§7.7',dcTypes:['ent','colo','hyper'],
         tip:'Separate HVAC zones for IT spaces vs. office/support areas. IT areas need 24/7/365 precision cooling at 18-27°C; office areas use standard HVAC with occupancy-based schedules and wider setpoint ranges.'},
        // ── Telecommunications ──
        {id:'tel_entrance',cat:'tel',label:'Entrance room with demarcation',tiers:[1,2,3,4],w:2,ref:'§8.1',dcTypes:['ent','colo','hyper'],
         tip:'Dedicated entrance room housing carrier demarcation points where external provider cabling terminates. Requires fire-rated room (1-hr minimum), cable entry protection sleeves, grounding busbar, and physical access control.'},
        {id:'tel_mda',cat:'tel',label:'Main Distribution Area defined',tiers:[1,2,3,4],w:2,ref:'§8.2.1',dcTypes:['ent','colo','hyper'],
         tip:'Main Distribution Area (MDA) is the central cabling hub housing core switches, routers, and main cross-connects. Must be in a dedicated, secure space with adequate power, cooling, and grounding per TIA-942.'},
        {id:'tel_hda',cat:'tel',label:'Horizontal Distribution Area',tiers:[2,3,4],w:2,ref:'§8.2.2',dcTypes:['ent','colo','hyper'],
         tip:'Horizontal Distribution Area (HDA) provides intermediate cabling distribution between MDA and equipment racks. Reduces cable run lengths, improves manageability, and enables zone-based network architecture in large facilities.'},
        {id:'tel_tia568',cat:'tel',label:'Cabling meets TIA-568',tiers:[1,2,3,4],w:2,ref:'§8.3.1',dcTypes:DC_ALL,
         tip:'All structured cabling must meet ANSI/TIA-568 performance standards for cable types, connectors, installation practices, and testing procedures. Ensures interoperability and provides documented performance baselines for all links and channels.'},
        {id:'tel_fiber',cat:'tel',label:'Fiber optic backbone',tiers:[1,2,3,4],w:2,ref:'§8.3.2',dcTypes:['ent','colo','hyper'],
         tip:'Fiber optic backbone cabling between entrance room, MDA, and HDAs. Provides high bandwidth (100G+), EMI immunity, and supports long distances. OS2 single-mode for backbone runs; OM4/OM5 multimode for short horizontal links.'},
        {id:'tel_cat6a',cat:'tel',label:'Cat 6A+ copper horizontal',tiers:[2,3,4],w:1,ref:'§8.3.3',dcTypes:DC_ALL,
         tip:'Category 6A or higher copper horizontal cabling supports 10GBASE-T (10 Gbps) over 100m channels. Provides future bandwidth headroom beyond Cat 6. Must meet TIA-568 channel performance with proper alien crosstalk mitigation.'},
        {id:'tel_redundant_path',cat:'tel',label:'Redundant cabling pathways',tiers:[3,4],w:3,ref:'§8.4',dcTypes:['ent','colo','hyper'],
         tip:'Redundant cabling pathways via physically diverse routes between distribution areas. Separate conduits, trays, or riser paths. Eliminates pathway as single point of failure. Critical for Tier 3/4 concurrent maintainability.'},
        {id:'tel_diverse_entry',cat:'tel',label:'Diverse carrier entrance paths',tiers:[3,4],w:3,ref:'§8.5',dcTypes:['ent','colo','hyper'],
         tip:'Diverse carrier entrance paths from different service providers entering building from geographically different directions. Prevents a single utility corridor cut, road construction, or disaster from affecting all carrier services.'},
        {id:'tel_labeling',cat:'tel',label:'TIA-606 labeling standard',tiers:[1,2,3,4],w:1,ref:'§8.6',dcTypes:DC_ALL,
         tip:'TIA-606 administration standard requires consistent labeling of all infrastructure: cables, pathways, spaces, equipment ports, and patch panels. Machine-readable labels enable efficient troubleshooting, moves/adds/changes, and auditing.'},
        // ── Fire Protection ──
        {id:'fire_detection',cat:'fire',label:'VESDA/smoke detection system',tiers:[1,2,3,4],w:3,ref:'§9.1',dcTypes:DC_ALL,
         tip:'Very Early Smoke Detection Apparatus (VESDA) or equivalent aspirating system. Detects smoke at pre-combustion stage — 10-100× more sensitive than spot detectors. Provides Alert/Action/Fire alarm stages for graduated response.'},
        {id:'fire_suppression',cat:'fire',label:'Automatic fire suppression',tiers:[1,2,3,4],w:3,ref:'§9.2',dcTypes:DC_ALL,
         tip:'Automatic fire suppression activated by detection system. Must suppress fire without water damage to IT equipment. System design considers room volume, seal integrity, hold time, and personnel safety with abort switches.'},
        {id:'fire_clean_agent',cat:'fire',label:'Clean agent (FM-200/Novec 1230)',tiers:[2,3,4],w:2,ref:'§9.2.1',dcTypes:['ent','colo','hyper'],
         tip:'Clean agent gaseous suppression (FM-200/HFC-227ea or Novec 1230/FK-5-1-12) suppresses fire without residue or water damage. Safe for occupied spaces at design concentrations. Novec 1230 preferred for low GWP (global warming potential = 1).'},
        {id:'fire_preaction',cat:'fire',label:'Pre-action sprinkler system',tiers:[2,3,4],w:2,ref:'§9.3',dcTypes:['ent','colo','hyper'],
         tip:'Pre-action sprinkler requires dual activation: (1) detection system alarm AND (2) sprinkler head fusing from heat. Dry pipe until both triggers activate. Dramatically reduces accidental water discharge risk vs. wet-pipe systems.'},
        {id:'fire_egress',cat:'fire',label:'Emergency egress marked',tiers:[1,2,3,4],w:2,ref:'§9.4',dcTypes:DC_ALL,
         tip:'Emergency egress paths clearly marked with illuminated EXIT signs (battery backup), photoluminescent floor markers, emergency lighting (90-min minimum), and unobstructed pathways. Maximum travel distance per NFPA 101 Life Safety Code.'},
        {id:'fire_signage',cat:'fire',label:'Fire safety signage posted',tiers:[1,2,3,4],w:1,ref:'§9.5',dcTypes:DC_ALL,
         tip:'Fire safety signage including extinguisher locations, manual pull station locations, evacuation route maps, assembly point identification, and emergency contact numbers. Posted at all entries and throughout facility per local fire code.'},
        {id:'fire_extinguisher',cat:'fire',label:'Portable extinguishers (Class C)',tiers:[1,2,3,4],w:1,ref:'§9.6',dcTypes:DC_ALL,
         tip:'Portable Class C (energized electrical equipment) fire extinguishers at maximum 15m (50ft) travel distance. Clean agent portable units (CO2 or halotron) preferred in IT spaces to avoid powder residue on electronics.'},
        // ── Physical Security ──
        {id:'sec_access',cat:'sec',label:'Electronic access control',tiers:[1,2,3,4],w:3,ref:'§10.1',dcTypes:DC_ALL,
         tip:'Electronic access control (card readers, PIN pads, or biometric) on all entry points to data center spaces. System logs all access events with timestamp, credential ID, and door location. Integrates with CCTV and intrusion alarms.'},
        {id:'sec_cctv',cat:'sec',label:'CCTV surveillance + recording',tiers:[1,2,3,4],w:2,ref:'§10.2',dcTypes:DC_ALL,
         tip:'CCTV surveillance covering all entrances, corridors, computer room aisles, loading dock, and perimeter. Recordings retained minimum 90 days. IP cameras with motion detection, analytics, and remote viewing capability recommended.'},
        {id:'sec_mantrap',cat:'sec',label:'Man-trap/airlock entry',tiers:[3,4],w:2,ref:'§10.3',dcTypes:['ent','colo','hyper'],
         tip:'Man-trap (airlock/sally port) entry requiring authentication at two sequential interlocked doors — only one can be open at any time. Prevents tailgating and piggybacking. Weight sensors or anti-passback logic recommended.'},
        {id:'sec_visitor',cat:'sec',label:'Visitor management/escort policy',tiers:[1,2,3,4],w:1,ref:'§10.4',dcTypes:['ent','colo','hyper'],
         tip:'Formal visitor management: pre-registration, government-issued photo ID verification, visitor badge with photo, mandatory escort by authorized personnel at all times, sign-in/sign-out log, and restricted area access control.'},
        {id:'sec_perimeter',cat:'sec',label:'Perimeter fencing/barrier',tiers:[2,3,4],w:2,ref:'§10.5',dcTypes:['ent','colo','hyper','mod'],
         tip:'Perimeter security: fencing minimum 2.4m (8ft) with anti-climb topping (razor wire or similar), vehicle barriers/bollards at entry points, controlled vehicle gates with authentication, and perimeter intrusion detection sensors.'},
        {id:'sec_biometric',cat:'sec',label:'Biometric authentication',tiers:[3,4],w:2,ref:'§10.6',dcTypes:['ent','colo','hyper'],
         tip:'Biometric authentication (fingerprint, iris scan, or facial recognition) for computer room and critical infrastructure access. Provides non-transferable identity verification. Two-factor authentication (card + biometric) preferred.'},
        {id:'sec_noc_24x7',cat:'sec',label:'24/7 NOC/security monitoring',tiers:[3,4],w:2,ref:'§10.7',dcTypes:['ent','colo','hyper'],
         tip:'24/7 Network Operations Center (NOC) and/or security control room with trained operators. Monitors BMS, CCTV, access control, fire/smoke detection, power systems, and environmental sensors. Documented escalation and incident response procedures.'},
        // ── Alternative Items (replace existing for specific DC types) ──
        {id:'site_solid_floor',cat:'site',label:'Structural floor ≥12 kPa with overhead cable management',tiers:[2,3,4],w:2,ref:'§5.2.4',dcTypes:['hyper','mod'],
         tip:'Structural solid floor rated ≥12 kPa with overhead cable tray/basket management system. Hyperscale and modular facilities use solid floors with top-of-rack cabling instead of raised floor. Overhead pathways must support cable weight and allow hot-aisle containment.'},
        {id:'mech_humidity_wide',cat:'mech',label:'Humidity monitoring (ASHRAE A2-A4 expanded envelope)',tiers:[2,3,4],w:2,ref:'§7.3',dcTypes:['hyper','edge','mod'],
         tip:'Humidity monitoring per ASHRAE A2-A4 expanded environmental envelope (8-80% RH non-condensing). Hyperscale, edge, and modular facilities leverage wider allowable ranges to reduce energy spent on active humidity control while monitoring for condensation risk.'},
        {id:'fire_modular_suppression',cat:'fire',label:'Integrated suppression (factory-installed clean agent/aerosol)',tiers:[2,3,4],w:2,ref:'§9.2.1',dcTypes:['mod'],
         tip:'Factory-integrated fire suppression system pre-installed in modular unit. Typically uses clean agent (Novec 1230) or condensed aerosol systems designed for enclosed containerized environments. Must be tested and certified before deployment.'},
        {id:'fire_edge_suppression',cat:'fire',label:'Compact fire suppression (clean agent or aerosol)',tiers:[2,3,4],w:2,ref:'§9.2.1',dcTypes:['edge'],
         tip:'Compact fire suppression sized for small edge enclosures. Condensed aerosol or small-cylinder clean agent systems designed for enclosed cabinets and micro data centers. Automatic activation with detection system integration.'},
        {id:'sec_remote_monitoring',cat:'sec',label:'24/7 remote monitoring and automated alerting',tiers:[3,4],w:2,ref:'§10.7',dcTypes:['edge','mod'],
         tip:'24/7 remote monitoring via centralized NOC or cloud-based platform with automated alerting for environmental, power, security, and connectivity anomalies. Includes automated escalation workflows and remote remediation capabilities for unmanned sites.'},
        // ── New DC-Type-Specific Items ──
        // Mechanical/Cooling
        {id:'mech_containment',cat:'mech',label:'Hot/cold aisle containment',tiers:[2,3,4],w:2,ref:'§7.8',dcTypes:['ent','colo','hyper'],
         tip:'Physical containment of hot or cold aisles prevents mixing of supply and return air. Improves cooling efficiency by 20-40%, raises allowable supply temperatures, and reduces fan energy. Curtains, panels, or chimney cabinets acceptable.'},
        {id:'mech_liquid_cooling',cat:'mech',label:'Direct-to-chip liquid cooling infrastructure',tiers:[2,3,4],w:3,ref:'§7.9',dcTypes:['hyper'],
         tip:'Direct-to-chip liquid cooling using cold plates on CPUs/GPUs with facility water loop (CDU). Required for high-density AI/HPC racks exceeding 30 kW. Includes coolant distribution units, leak detection, and manifold systems per rack row.'},
        {id:'mech_rdhx',cat:'mech',label:'Rear-door heat exchangers available',tiers:[2,3,4],w:1,ref:'§7.10',dcTypes:['ent','colo','hyper'],
         tip:'Rear-door heat exchangers (RDHx) provide supplemental or primary cooling at the rack level. Passive or active units remove heat at the source before it enters the room. Useful for high-density racks in mixed environments.'},
        {id:'mech_env_granularity',cat:'mech',label:'Environmental sensor grid (≥6 sensors per row)',tiers:[2,3,4],w:1,ref:'§7.11',dcTypes:DC_ALL,
         tip:'Granular environmental monitoring with minimum 6 temperature/humidity sensors per row — top, middle, bottom of inlet and exhaust. Enables thermal mapping, identifies hotspots, and validates cooling effectiveness.'},
        {id:'mech_hotswap',cat:'mech',label:'Hot-swappable cooling/power components',tiers:[2,3,4],w:2,ref:'§7.12',dcTypes:['mod'],
         tip:'Modular units designed with hot-swappable cooling fans, power modules, and control boards. Enables field replacement without shutting down the unit. Reduces MTTR and supports concurrent maintainability in prefabricated environments.'},
        {id:'mech_edge_cooling',cat:'mech',label:'Compact self-contained precision cooling',tiers:[1,2,3,4],w:2,ref:'§7.13',dcTypes:['edge'],
         tip:'Self-contained precision cooling integrated into edge enclosure. Includes DX split system or thermoelectric cooling sized for enclosure heat load. Must maintain ASHRAE A1/A2 conditions independently with redundant fans.'},
        {id:'mech_immersion',cat:'mech',label:'Immersion cooling infrastructure',tiers:[3,4],w:2,ref:'§7.14',dcTypes:['hyper'],
         tip:'Single-phase or two-phase immersion cooling for ultra-high-density compute (50-100+ kW per tank). Requires dielectric fluid management, CDU integration, specialized containment tanks, and modified server hardware support.'},
        // Electrical
        {id:'elec_density_monitor',cat:'elec',label:'Per-rack power density monitoring',tiers:[2,3,4],w:2,ref:'§6.9',dcTypes:['colo','hyper'],
         tip:'Real-time per-rack power monitoring with kW, kWh, voltage, current, and power factor. Enables capacity planning, tenant billing accuracy, and density management. Minimum per-circuit granularity with DCIM integration.'},
        {id:'elec_bess',cat:'elec',label:'Battery Energy Storage System (BESS)',tiers:[2,3,4],w:2,ref:'§6.10',dcTypes:['hyper','edge','mod'],
         tip:'Lithium-ion or similar BESS providing extended runtime beyond traditional UPS batteries. Edge/modular sites may use BESS as primary backup (replacing generators). Includes battery management system, thermal management, and fire suppression.'},
        {id:'elec_renewable',cat:'elec',label:'On-site renewable energy integration',tiers:[2,3,4],w:1,ref:'§6.11',dcTypes:['hyper','mod'],
         tip:'On-site renewable energy generation (solar PV, wind) with grid-tie inverters and energy storage integration. Supports sustainability targets and provides supplemental power. Requires proper islanding protection and utility interconnection agreement.'},
        {id:'elec_tenant_metering',cat:'elec',label:'Per-tenant revenue-grade metering',tiers:[2,3,4],w:2,ref:'§6.12',dcTypes:['colo'],
         tip:'Revenue-grade (ANSI C12.20 Class 0.2) power metering per tenant cage/suite for accurate billing. Includes kW demand, kWh consumption, power factor, and harmonics data. Tamper-evident with independent verification capability.'},
        {id:'elec_mv_distribution',cat:'elec',label:'Medium-voltage distribution to rows',tiers:[3,4],w:2,ref:'§6.13',dcTypes:['hyper'],
         tip:'Medium-voltage (e.g., 33kV/11kV) distribution brought closer to IT loads, reducing transformation losses and copper costs. Enables higher density deployments with smaller electrical rooms. Requires qualified MV switchgear and protection.'},
        {id:'elec_busway',cat:'elec',label:'Overhead busway power distribution',tiers:[2,3,4],w:1,ref:'§6.14',dcTypes:['hyper'],
         tip:'Overhead busway (busduct) distributing power along rack rows, eliminating underfloor power cabling. Provides flexible tap-off points for rack connections, supports solid-floor designs, and simplifies capacity additions.'},
        // Telecommunications
        {id:'tel_remote_mgmt',cat:'tel',label:'Out-of-band remote management (IPMI/iLO)',tiers:[2,3,4],w:3,ref:'§8.7',dcTypes:['edge','mod'],
         tip:'Out-of-band management via IPMI, iLO, iDRAC, or similar for remote server access independent of primary network. Critical for unmanned edge/modular sites. Includes dedicated management network, VPN access, and KVM-over-IP capability.'},
        {id:'tel_sla_monitoring',cat:'tel',label:'SLA monitoring and reporting platform',tiers:[2,3,4],w:2,ref:'§8.8',dcTypes:['colo'],
         tip:'Automated SLA monitoring tracking uptime, power availability, temperature compliance, and response times against contractual commitments. Generates tenant-facing reports with real-time dashboards and historical trend analysis.'},
        {id:'tel_cross_connect',cat:'tel',label:'Cross-connect management and meet-me room',tiers:[2,3,4],w:2,ref:'§8.9',dcTypes:['colo'],
         tip:'Dedicated meet-me room for carrier-neutral cross-connections between tenants and service providers. Structured cross-connect management with documented patching, diverse pathway options, and carrier demarcation per tenant.'},
        {id:'tel_dcim',cat:'tel',label:'DCIM platform with capacity planning',tiers:[2,3,4],w:2,ref:'§8.10',dcTypes:['ent','colo','hyper'],
         tip:'Data Center Infrastructure Management platform providing unified visibility into power, cooling, space, and network capacity. Includes asset tracking, change management, capacity forecasting, and what-if scenario modeling.'},
        {id:'tel_mod_connectivity',cat:'tel',label:'Pre-terminated trunk cables and quick-connect',tiers:[1,2,3,4],w:1,ref:'§8.11',dcTypes:['mod'],
         tip:'Factory-terminated trunk cables with MPO/MTP connectors for rapid deployment of modular units. Quick-connect interfaces for power, cooling, and network between modules and site infrastructure. Reduces deployment time from weeks to days.'},
        {id:'tel_cellular_backup',cat:'tel',label:'Cellular/satellite backup connectivity',tiers:[2,3,4],w:2,ref:'§8.12',dcTypes:['edge'],
         tip:'Cellular (4G/5G) or satellite (LEO) backup connectivity for edge sites where diverse fiber paths are unavailable. Provides management plane and critical data path redundancy. Includes automatic failover and bandwidth management.'},
        // Site
        {id:'site_mod_anchoring',cat:'site',label:'Modular unit anchoring and weather protection',tiers:[1,2,3,4],w:2,ref:'§5.4',dcTypes:['mod'],
         tip:'Structural anchoring of modular/container units to foundation (concrete pad, steel piers) rated for local wind/seismic loads. Includes weather protection for external connections, cable entry seals, and drainage provisions.'},
        {id:'site_edge_enclosure',cat:'site',label:'Ruggedized enclosure (IP55+ rated)',tiers:[1,2,3,4],w:2,ref:'§5.5',dcTypes:['edge'],
         tip:'IP55 or higher rated enclosure providing protection against dust ingress and water jets. Suitable for deployment in non-datacenter environments (retail, factory floor, outdoor). Includes environmental sealing, tamper-resistant locks, and shock/vibration resistance.'},
        // Security
        {id:'sec_tenant_isolation',cat:'sec',label:'Multi-tenant cage/suite isolation',tiers:[2,3,4],w:3,ref:'§10.8',dcTypes:['colo'],
         tip:'Physical isolation between tenant spaces using floor-to-ceiling mesh cages or solid-wall suites with independent access control. Prevents unauthorized inter-tenant access. Includes individual lock systems, CCTV per cage, and access logging.'},
        {id:'sec_decommission',cat:'sec',label:'Secure equipment decommissioning process',tiers:[2,3,4],w:1,ref:'§10.9',dcTypes:['ent','colo','hyper'],
         tip:'Documented secure decommissioning process for retired equipment including data sanitization (NIST 800-88), asset tracking, chain of custody, and certificate of destruction. Prevents data leakage from decommissioned drives and hardware.'},
        {id:'sec_intrusion_detect',cat:'sec',label:'Physical intrusion detection sensors',tiers:[2,3,4],w:2,ref:'§10.10',dcTypes:['edge','mod'],
         tip:'Door/panel tamper sensors, vibration detectors, and contact switches on all access points of unmanned edge/modular units. Integrated with remote monitoring platform for immediate alerting on unauthorized physical access attempts.'}
    ];

    // ═══ STATE ═══
    var currentTier = 3;
    var currentDcType = 'ent';
    var checkedItems = {};
    var isPremiumUser = false;
    var userTier = 'free';
    var currentMode = 'free';
    var doughnutChart, barChart, radarChart, mcChart;

    function getFilteredItems(catId) {
        return ITEMS.filter(function(it) {
            return it.cat === catId
                && it.tiers.indexOf(currentTier) !== -1
                && it.dcTypes.indexOf(currentDcType) !== -1;
        });
    }
    function getAllFilteredItems() {
        return ITEMS.filter(function(it) {
            return it.tiers.indexOf(currentTier) !== -1
                && it.dcTypes.indexOf(currentDcType) !== -1;
        });
    }

    // ═══ RENDER CHECKLIST ═══
    function renderChecklist() {
        var panel = document.getElementById('checklistPanel');
        panel.innerHTML = '';
        CATEGORIES.forEach(function(cat, ci) {
            var items = getFilteredItems(cat.id);
            var checked = items.filter(function(it) { return checkedItems[it.id]; }).length;
            var div = document.createElement('div');
            div.className = 'checklist-category';
            var headerOpen = ci < 2 ? ' open' : '';
            var bodyOpen = ci < 2 ? ' open' : '';
            div.innerHTML = '<div class="cat-header' + headerOpen + '" onclick="toggleCat(this)">' +
                '<div class="cat-icon" style="background:' + cat.color + '18;color:' + cat.color + ';"><i class="fas ' + cat.icon + '"></i></div>' +
                '<div class="cat-info"><div class="cat-title">' + cat.label + '</div>' +
                '<div class="cat-progress-wrap"><div class="cat-progress-bar"><div class="cat-progress-fill" style="width:' + (items.length ? (checked/items.length*100) : 0) + '%;background:' + cat.color + ';"></div></div>' +
                '<span class="cat-count" data-cat="' + cat.id + '">' + checked + '/' + items.length + '</span></div></div>' +
                '<i class="fas fa-chevron-down cat-chevron"></i></div>' +
                '<div class="cat-body' + bodyOpen + '"><div class="cat-items" id="cat-items-' + cat.id + '"></div></div>';
            panel.appendChild(div);
            var itemsDiv = div.querySelector('#cat-items-' + cat.id);
            items.forEach(function(it) {
                var isChecked = checkedItems[it.id] ? ' checked' : '';
                var wClass = 'w' + it.w;
                var wLabel = it.w === 3 ? 'Critical' : (it.w === 2 ? 'Important' : 'Standard');
                var catObj = CATEGORIES.find(function(c){return c.id===it.cat;});
                var tipHtml = it.tip ? '<span class="tooltip-trigger">?<div class="tooltip-data" data-title="' + it.label.replace(/"/g,'&quot;') + '" data-desc="' + it.tip.replace(/"/g,'&quot;') + '" data-ref="' + it.ref + '" data-weight="W' + it.w + ' — ' + wLabel + '" data-icon="' + catObj.icon + '"></div></span>' : '';
                itemsDiv.innerHTML += '<div class="check-item">' +
                    '<input type="checkbox" id="chk-' + it.id + '"' + isChecked + ' onchange="onCheck(\'' + it.id + '\',this.checked)">' +
                    '<label class="check-label" for="chk-' + it.id + '">' + it.label + '</label>' +
                    tipHtml +
                    '<span class="check-weight ' + wClass + '">W' + it.w + '</span>' +
                    '<span class="check-ref">' + it.ref + '</span></div>';
            });
        });
    }

    function toggleCat(header) {
        header.classList.toggle('open');
        var body = header.nextElementSibling;
        body.classList.toggle('open');
    }

    function onCheck(id, val) {
        checkedItems[id] = val;
        calculate();
    }

    // ═══ SCORING ═══
    function calculate() {
        var catScores = {};
        var totalWeightedScore = 0, totalMaxWeight = 0;
        CATEGORIES.forEach(function(cat) {
            var items = getFilteredItems(cat.id);
            var checkedW = 0, totalW = 0;
            items.forEach(function(it) {
                totalW += it.w;
                if (checkedItems[it.id]) checkedW += it.w;
            });
            var pct = totalW > 0 ? (checkedW / totalW * 100) : 0;
            catScores[cat.id] = { pct: pct, checked: checkedW, total: totalW, count: items.filter(function(it){return checkedItems[it.id];}).length, applicable: items.length };
            totalWeightedScore += pct * cat.weight;
            totalMaxWeight += 100 * cat.weight;
        });
        var overall = totalMaxWeight > 0 ? (totalWeightedScore / totalMaxWeight * 100) : 0;

        // ── Advanced Metrics ──
        var catPcts = CATEGORIES.map(function(c){return catScores[c.id].pct;});
        var weakestLink = Math.min.apply(null, catPcts.length ? catPcts : [0]);
        var avgPct = catPcts.reduce(function(a,b){return a+b;},0) / (catPcts.length||1);
        var variance = catPcts.reduce(function(a,b){return a+(b-avgPct)*(b-avgPct);},0) / (catPcts.length||1);
        var imbalancePenalty = Math.min(0.15, Math.sqrt(variance) / 200);
        var cri = Math.max(0, overall * (1 - imbalancePenalty));
        var maturity = cri >= 95 ? 5 : (cri >= 80 ? 4 : (cri >= 60 ? 3 : (cri >= 40 ? 2 : 1)));
        var maturityLabels = {1:'Initial',2:'Developing',3:'Defined',4:'Managed',5:'Optimized'};

        var grade, gradeColor;
        if (overall >= 95) { grade = 'A+'; gradeColor = '#10b981'; }
        else if (overall >= 85) { grade = 'A'; gradeColor = '#10b981'; }
        else if (overall >= 75) { grade = 'B'; gradeColor = '#06b6d4'; }
        else if (overall >= 65) { grade = 'C'; gradeColor = '#f59e0b'; }
        else if (overall >= 50) { grade = 'D'; gradeColor = '#f97316'; }
        else { grade = 'F'; gradeColor = '#ef4444'; }
        var gradeLabels = {'A+':'Excellent','A':'Very Good','B':'Good','C':'Fair','D':'Below Standard','F':'Incomplete'};

        // Update UI
        var sv = document.getElementById('scoreValue');
        sv.textContent = Math.round(overall) + '%';
        sv.style.color = gradeColor;
        var sg = document.getElementById('scoreGrade');
        sg.textContent = grade + ' — ' + gradeLabels[grade];
        sg.style.background = gradeColor + '18';
        sg.style.color = gradeColor;

        var totalChecked = 0, totalApplicable = 0, totalCheckedWeight = 0;
        CATEGORIES.forEach(function(cat) {
            totalChecked += catScores[cat.id].count;
            totalApplicable += catScores[cat.id].applicable;
            totalCheckedWeight += catScores[cat.id].checked;
        });
        document.getElementById('metricChecked').textContent = totalChecked;
        document.getElementById('metricApplicable').textContent = totalApplicable;
        var statCount = document.getElementById('statItemCount');
        if (statCount) statCount.textContent = totalApplicable;
        document.getElementById('metricCRI').textContent = Math.round(cri);
        document.getElementById('metricTier').textContent = currentTier;
        document.getElementById('metricWeakest').textContent = Math.round(weakestLink) + '%';
        document.getElementById('metricWeakest').style.color = weakestLink >= 75 ? '#10b981' : (weakestLink >= 50 ? '#f59e0b' : '#ef4444');
        document.getElementById('metricMaturity').textContent = 'L' + maturity;
        document.getElementById('metricMaturity').title = maturityLabels[maturity];
        var dcObj = DC_TYPES.find(function(d){return d.id===currentDcType;});
        var metricDcEl = document.getElementById('metricDcType');
        if (metricDcEl && dcObj) metricDcEl.textContent = dcObj.label;

        // Category bars
        var barsHtml = '<div class="cat-bars-title"><i class="fas fa-chart-bar" style="color:var(--accent-emerald);"></i> Category Scores</div>';
        CATEGORIES.forEach(function(cat) {
            var s = catScores[cat.id];
            barsHtml += '<div class="cat-bar-row"><span class="cat-bar-label">' + cat.label.split('/')[0].split('&')[0].trim() + '</span>' +
                '<div class="cat-bar-track"><div class="cat-bar-fill" style="width:' + s.pct + '%;background:' + cat.color + ';"></div></div>' +
                '<span class="cat-bar-pct" style="color:' + cat.color + ';">' + Math.round(s.pct) + '%</span></div>';
        });
        document.getElementById('catBars').innerHTML = barsHtml;

        // Update progress bars in accordion
        CATEGORIES.forEach(function(cat) {
            var s = catScores[cat.id];
            var countEl = document.querySelector('[data-cat="' + cat.id + '"]');
            if (countEl) countEl.textContent = s.count + '/' + s.applicable;
            var fills = document.querySelectorAll('.cat-progress-fill');
        });

        // Recommendations (top 3 unchecked high-weight items)
        var gaps = getAllFilteredItems().filter(function(it) { return !checkedItems[it.id]; });
        gaps.sort(function(a, b) { return b.w - a.w; });
        var recHtml = '';
        gaps.slice(0, 3).forEach(function(it) {
            var cat = CATEGORIES.find(function(c) { return c.id === it.cat; });
            recHtml += '<div class="rec-card"><div class="rec-icon" style="background:' + cat.color + '15;color:' + cat.color + ';"><i class="fas ' + cat.icon + '"></i></div>' +
                '<div class="rec-text"><h4>' + it.label + '</h4><p>' + cat.label + ' · Weight ' + it.w + ' · ' + it.ref + '</p></div></div>';
        });
        document.getElementById('recCards').innerHTML = recHtml || '<p style="font-size:0.82rem;color:var(--text-muted);">All items checked!</p>';

        updateCharts(catScores, overall);
        if (isPremiumUser) updateProPanels(catScores, gaps, overall);
    }

    // ═══ CHARTS ═══
    var centerTextPlugin = {
        id: 'centerText',
        afterDraw: function(chart) {
            if (chart.config.type !== 'doughnut' || !chart.options.plugins.centerText) return;
            var ctx = chart.ctx, w = chart.chartArea.right - chart.chartArea.left, h = chart.chartArea.bottom - chart.chartArea.top;
            var cx = chart.chartArea.left + w/2, cy = chart.chartArea.top + h/2;
            ctx.save();
            ctx.font = '800 ' + Math.round(h*0.22) + 'px "JetBrains Mono",monospace';
            ctx.textAlign = 'center'; ctx.textBaseline = 'middle';
            ctx.fillStyle = chart.options.plugins.centerText.color || '#1f2937';
            ctx.fillText(chart.options.plugins.centerText.text || '', cx, cy - 6);
            ctx.font = '600 ' + Math.round(h*0.08) + 'px "Inter",sans-serif';
            ctx.fillStyle = '#6b7280';
            ctx.fillText(chart.options.plugins.centerText.sub || '', cx, cy + Math.round(h*0.14));
            ctx.restore();
        }
    };
    var thresholdPlugin = {
        id: 'thresholdLine',
        afterDraw: function(chart) {
            if (chart.config.type !== 'bar' || !chart.options.plugins.thresholdLine) return;
            var yScale = chart.scales.y, ctx = chart.ctx;
            var yVal = chart.options.plugins.thresholdLine.value || 75;
            var y = yScale.getPixelForValue(yVal);
            ctx.save();
            ctx.strokeStyle = chart.options.plugins.thresholdLine.color || 'rgba(239,68,68,0.5)';
            ctx.lineWidth = 2; ctx.setLineDash([6,4]);
            ctx.beginPath(); ctx.moveTo(chart.chartArea.left, y); ctx.lineTo(chart.chartArea.right, y); ctx.stroke();
            ctx.font = '600 10px "JetBrains Mono",monospace';
            ctx.fillStyle = chart.options.plugins.thresholdLine.color || 'rgba(239,68,68,0.7)';
            ctx.textAlign = 'right';
            ctx.fillText(chart.options.plugins.thresholdLine.label || 'Target', chart.chartArea.right - 4, y - 5);
            ctx.restore();
        }
    };
    Chart.register(centerTextPlugin, thresholdPlugin);

    function updateCharts(catScores, overall) {
        var labels = CATEGORIES.map(function(c) { return c.label.split('/')[0].split('&')[0].trim(); });
        var pcts = CATEGORIES.map(function(c) { return Math.round(catScores[c.id].pct); });
        var colors = CATEGORIES.map(function(c) { return c.color; });

        var gradeColor = overall >= 85 ? '#10b981' : (overall >= 65 ? '#f59e0b' : '#ef4444');

        // Doughnut with center text
        var dCtx = document.getElementById('doughnutChart').getContext('2d');
        if (doughnutChart) doughnutChart.destroy();
        doughnutChart = new Chart(dCtx, {
            type: 'doughnut',
            data: { labels: ['Compliant', 'Non-Compliant'], datasets: [{
                data: [Math.round(overall), Math.round(100 - overall)],
                backgroundColor: [gradeColor, '#e5e7eb'],
                hoverBackgroundColor: [gradeColor + 'dd', '#d1d5db'],
                borderWidth: 0, borderRadius: 4
            }] },
            options: { responsive: true, maintainAspectRatio: false, cutout: '72%',
                plugins: {
                    legend: { position: 'bottom', labels: { font: { family: 'Inter', size: 12 }, padding: 16 } },
                    centerText: { text: Math.round(overall) + '%', color: gradeColor, sub: 'Compliance' }
                },
                animation: { animateRotate: true, duration: 800 }
            }
        });

        // Bar with threshold line + data labels
        var bCtx = document.getElementById('barChart').getContext('2d');
        if (barChart) barChart.destroy();
        var bgColors = pcts.map(function(p, i) {
            var c = colors[i];
            return p >= 75 ? c + '50' : (p >= 50 ? c + '35' : c + '20');
        });
        barChart = new Chart(bCtx, {
            type: 'bar',
            data: { labels: labels, datasets: [{
                label: 'Score %', data: pcts,
                backgroundColor: bgColors, borderColor: colors, borderWidth: 2, borderRadius: 8
            }] },
            options: { responsive: true, maintainAspectRatio: false,
                scales: {
                    y: { beginAtZero: true, max: 100, ticks: { font: { family: 'JetBrains Mono', size: 10 }, callback: function(v){return v+'%';} },
                        grid: { color: 'rgba(0,0,0,0.05)' } },
                    x: { ticks: { font: { family: 'Inter', size: 10 } }, grid: { display: false } }
                },
                plugins: {
                    legend: { display: false },
                    thresholdLine: { value: 75, color: 'rgba(239,68,68,0.45)', label: '75% Target' },
                    tooltip: { callbacks: { label: function(ctx) { return ctx.parsed.y + '% compliance'; } } }
                },
                animation: { duration: 600 }
            }
        });
    }

    // ═══ PRO PANELS ═══
    function updateProPanels(catScores, gaps, overall) {
        // Gap Analysis
        var gapHtml = '';
        gaps.forEach(function(it) {
            var cat = CATEGORIES.find(function(c) { return c.id === it.cat; });
            var pClass = it.w === 3 ? 'p1' : (it.w === 2 ? 'p2' : 'p3');
            var pLabel = it.w === 3 ? 'P1-Critical' : (it.w === 2 ? 'P2-Important' : 'P3-Standard');
            gapHtml += '<tr><td><span class="priority-badge ' + pClass + '">' + pLabel + '</span></td><td>' + it.label + '</td><td>' + cat.label + '</td><td>W' + it.w + '</td><td>' + it.ref + '</td></tr>';
        });
        document.getElementById('gapTableBody').innerHTML = gapHtml || '<tr><td colspan="5" style="text-align:center;color:var(--text-muted);">No gaps — 100% compliant!</td></tr>';

        // Monte Carlo
        var mcResults = runMonteCarlo(10000);
        var mcColor = function(v){return v>=85?'#10b981':(v>=65?'#f59e0b':'#ef4444');};
        document.getElementById('mcResults').innerHTML =
            '<div class="metric-box"><div class="metric-label">Mean</div><div class="metric-value" style="color:'+mcColor(mcResults.mean)+'">' + mcResults.mean.toFixed(1) + '%</div></div>' +
            '<div class="metric-box"><div class="metric-label">Std Dev</div><div class="metric-value">±' + mcResults.stddev.toFixed(1) + '%</div></div>' +
            '<div class="metric-box"><div class="metric-label">P5 (Worst)</div><div class="metric-value" style="color:'+mcColor(mcResults.p5)+'">' + mcResults.p5.toFixed(1) + '%</div></div>' +
            '<div class="metric-box"><div class="metric-label">P95 (Best)</div><div class="metric-value" style="color:'+mcColor(mcResults.p95)+'">' + mcResults.p95.toFixed(1) + '%</div></div>' +
            '<div class="metric-box"><div class="metric-label">P25</div><div class="metric-value">' + mcResults.p25.toFixed(1) + '%</div></div>' +
            '<div class="metric-box"><div class="metric-label">Median (P50)</div><div class="metric-value" style="font-weight:800;">' + mcResults.p50.toFixed(1) + '%</div></div>' +
            '<div class="metric-box"><div class="metric-label">P75</div><div class="metric-value">' + mcResults.p75.toFixed(1) + '%</div></div>' +
            '<div class="metric-box"><div class="metric-label">90% CI Range</div><div class="metric-value" style="font-size:0.85rem;">' + mcResults.p5.toFixed(0) + '-' + mcResults.p95.toFixed(0) + '%</div></div>';

        // MC Chart — color-coded bins
        var mcCtx = document.getElementById('mcChart').getContext('2d');
        if (mcChart) mcChart.destroy();
        var binColors = mcResults.bins.map(function(b) {
            var mid = parseInt(b.label); return mid >= 85 ? 'rgba(16,185,129,0.5)' : (mid >= 65 ? 'rgba(245,158,11,0.5)' : (mid >= 50 ? 'rgba(249,115,22,0.5)' : 'rgba(239,68,68,0.4)'));
        });
        var binBorders = mcResults.bins.map(function(b) {
            var mid = parseInt(b.label); return mid >= 85 ? '#10b981' : (mid >= 65 ? '#f59e0b' : (mid >= 50 ? '#f97316' : '#ef4444'));
        });
        mcChart = new Chart(mcCtx, {
            type: 'bar',
            data: { labels: mcResults.bins.map(function(b) { return b.label; }), datasets: [{ label: 'Frequency', data: mcResults.bins.map(function(b) { return b.count; }), backgroundColor: binColors, borderColor: binBorders, borderWidth: 1.5, borderRadius: 3 }] },
            options: { responsive: true, maintainAspectRatio: false,
                plugins: { legend: { display: false }, tooltip: { callbacks: { label: function(ctx){return ctx.parsed.y + ' iterations (' + (ctx.parsed.y/100).toFixed(1) + '%)';} } } },
                scales: { y: { ticks: { font: { size: 9 } }, title: { display: true, text: 'Frequency', font: { size: 10 } } }, x: { ticks: { font: { size: 8 }, maxRotation: 45 }, title: { display: true, text: 'Score Range', font: { size: 10 } } } }
            }
        });

        // Radar (all 4 tiers)
        var radarCtx = document.getElementById('radarChart').getContext('2d');
        if (radarChart) radarChart.destroy();
        var tierDatasets = [1,2,3,4].map(function(t) {
            var ds = CATEGORIES.map(function(cat) {
                var items = ITEMS.filter(function(it) { return it.cat === cat.id && it.tiers.indexOf(t) !== -1 && it.dcTypes.indexOf(currentDcType) !== -1; });
                var cw = 0, tw = 0;
                items.forEach(function(it) { tw += it.w; if (checkedItems[it.id]) cw += it.w; });
                return tw > 0 ? Math.round(cw / tw * 100) : 0;
            });
            var colors = ['rgba(107,114,128,','rgba(59,130,246,','rgba(16,185,129,','rgba(139,92,246,'];
            return { label: 'Tier ' + t, data: ds, borderColor: colors[t-1] + '0.8)', backgroundColor: colors[t-1] + '0.1)', borderWidth: t === currentTier ? 3 : 1.5, pointRadius: t === currentTier ? 4 : 2 };
        });
        radarChart = new Chart(radarCtx, {
            type: 'radar',
            data: { labels: CATEGORIES.map(function(c) { return c.label.split('/')[0].trim(); }), datasets: tierDatasets },
            options: { responsive: true, maintainAspectRatio: false, scales: { r: { beginAtZero: true, max: 100, ticks: { stepSize: 25, font: { size: 9 } } } }, plugins: { legend: { position: 'bottom', labels: { font: { size: 10 } } } } }
        });

        // Tier Comparison table
        var tcHtml = '<table class="gap-table"><thead><tr><th>Category</th><th>Tier 1</th><th>Tier 2</th><th>Tier 3</th><th>Tier 4</th></tr></thead><tbody>';
        CATEGORIES.forEach(function(cat) {
            tcHtml += '<tr><td style="font-weight:600;">' + cat.label + '</td>';
            [1,2,3,4].forEach(function(t) {
                var items = ITEMS.filter(function(it) { return it.cat === cat.id && it.tiers.indexOf(t) !== -1 && it.dcTypes.indexOf(currentDcType) !== -1; });
                var cw = 0, tw = 0;
                items.forEach(function(it) { tw += it.w; if (checkedItems[it.id]) cw += it.w; });
                var pct = tw > 0 ? Math.round(cw / tw * 100) : 0;
                var col = pct >= 80 ? '#10b981' : (pct >= 50 ? '#f59e0b' : '#ef4444');
                tcHtml += '<td style="font-family:\'JetBrains Mono\',monospace;color:' + col + ';font-weight:600;">' + pct + '%</td>';
            });
            tcHtml += '</tr>';
        });
        tcHtml += '</tbody></table>';
        document.getElementById('tierCompare').innerHTML = tcHtml;

        // Roadmap
        var rmHtml = '';
        var efforts = { 3: { effort: 'High', cost: '$50K-200K', timeline: '3-6 mo' }, 2: { effort: 'Medium', cost: '$10K-50K', timeline: '1-3 mo' }, 1: { effort: 'Low', cost: '<$10K', timeline: '<1 mo' } };
        gaps.slice(0, 15).forEach(function(it) {
            var e = efforts[it.w];
            var pClass = it.w === 3 ? 'p1' : (it.w === 2 ? 'p2' : 'p3');
            rmHtml += '<tr><td>' + it.label + '</td><td>' + e.effort + '</td><td>' + e.cost + '</td><td>' + e.timeline + '</td><td><span class="priority-badge ' + pClass + '">W' + it.w + '</span></td></tr>';
        });
        document.getElementById('roadmapBody').innerHTML = rmHtml || '<tr><td colspan="5" style="text-align:center;">No remediation needed.</td></tr>';

        // Sensitivity — actual impact calculation (what happens to overall if you check this item)
        var sensHtml = '';
        var currentOverall = overall;
        var sensItems = gaps.map(function(it) {
            var cat = CATEGORIES.find(function(c) { return c.id === it.cat; });
            // Simulate checking this item
            var simScore = 0, simMax = 0;
            CATEGORIES.forEach(function(c2) {
                var items2 = ITEMS.filter(function(i2){return i2.cat===c2.id && i2.tiers.indexOf(currentTier)!==-1 && i2.dcTypes.indexOf(currentDcType)!==-1;});
                var cw2 = 0, tw2 = 0;
                items2.forEach(function(i2){ tw2 += i2.w; if(checkedItems[i2.id] || i2.id === it.id) cw2 += i2.w; });
                simScore += (tw2 > 0 ? cw2/tw2*100 : 0) * c2.weight;
                simMax += 100 * c2.weight;
            });
            var simOverall = simMax > 0 ? simScore/simMax*100 : 0;
            return { item: it, cat: cat, impact: simOverall - currentOverall };
        });
        sensItems.sort(function(a,b){return b.impact - a.impact;});
        var maxImpact = sensItems.length ? sensItems[0].impact : 1;
        sensItems.slice(0, 10).forEach(function(s, idx) {
            var barW = maxImpact > 0 ? Math.min(100, s.impact / maxImpact * 100) : 0;
            var pBadge = s.item.w === 3 ? '<span style="padding:1px 6px;border-radius:50px;font-size:0.6rem;font-weight:700;background:rgba(239,68,68,0.1);color:#ef4444;margin-left:6px;">P1</span>'
                       : (s.item.w === 2 ? '<span style="padding:1px 6px;border-radius:50px;font-size:0.6rem;font-weight:700;background:rgba(245,158,11,0.1);color:#f59e0b;margin-left:6px;">P2</span>' : '');
            sensHtml += '<div style="display:flex;align-items:center;gap:8px;margin-bottom:8px;">' +
                '<span style="font-size:0.72rem;color:#6b7280;width:16px;text-align:right;flex-shrink:0;">' + (idx+1) + '</span>' +
                '<span style="font-size:0.75rem;width:200px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;">' + s.item.label + pBadge + '</span>' +
                '<div style="flex:1;height:18px;background:#f1f5f9;border-radius:4px;overflow:hidden;position:relative;"><div style="height:100%;width:' + barW + '%;background:linear-gradient(90deg,' + s.cat.color + '40,' + s.cat.color + ');border-radius:4px;transition:width 0.4s;"></div></div>' +
                '<span style="font-size:0.72rem;font-weight:700;font-family:\'JetBrains Mono\',monospace;width:55px;text-align:right;color:' + s.cat.color + ';">+' + s.impact.toFixed(2) + '%</span></div>';
        });
        document.getElementById('sensitivityBars').innerHTML = sensHtml || '<p style="color:var(--text-muted);font-size:0.82rem;">No gaps to analyze.</p>';
    }

    // ═══ MONTE CARLO ═══
    function runMonteCarlo(n) {
        var scores = [];
        for (var i = 0; i < n; i++) {
            var wScore = 0, wMax = 0;
            CATEGORIES.forEach(function(cat) {
                var items = ITEMS.filter(function(it) { return it.cat === cat.id && it.tiers.indexOf(currentTier) !== -1 && it.dcTypes.indexOf(currentDcType) !== -1; });
                var cw = 0, tw = 0;
                items.forEach(function(it) {
                    var variance = 1 + (Math.random() - 0.5) * 0.3;
                    var adjW = it.w * variance;
                    tw += adjW;
                    if (checkedItems[it.id]) cw += adjW;
                });
                wScore += (tw > 0 ? cw / tw * 100 : 0) * cat.weight;
                wMax += 100 * cat.weight;
            });
            scores.push(wMax > 0 ? wScore / wMax * 100 : 0);
        }
        scores.sort(function(a, b) { return a - b; });
        var mean = scores.reduce(function(a, b) { return a + b; }, 0) / n;
        var variance = scores.reduce(function(a, b) { return a + (b - mean) * (b - mean); }, 0) / n;
        var bins = [];
        for (var b = 0; b <= 90; b += 10) {
            var count = scores.filter(function(s) { return s >= b && s < b + 10; }).length;
            bins.push({ label: b + '-' + (b + 10), count: count });
        }
        bins.push({ label: '90-100', count: scores.filter(function(s) { return s >= 90; }).length });
        return { mean: mean, stddev: Math.sqrt(variance), p5: scores[Math.floor(n*0.05)], p10: scores[Math.floor(n*0.10)], p25: scores[Math.floor(n*0.25)], p50: scores[Math.floor(n*0.50)], p75: scores[Math.floor(n*0.75)], p90: scores[Math.floor(n*0.90)], p95: scores[Math.floor(n*0.95)], bins: bins };
    }

    // ═══ TIER SELECTOR ═══
    function setTier(t) {
        currentTier = t;
        document.querySelectorAll('.tier-btn').forEach(function(b, i) { b.classList.toggle('active', i + 1 === t); });
        renderChecklist();
        calculate();
    }

    // ═══ DC TYPE SELECTOR ═══
    function setDcType(type) {
        currentDcType = type;
        document.querySelectorAll('.dctype-btn').forEach(function(b) {
            b.classList.toggle('active', b.getAttribute('data-dc') === type);
        });
        var dcObj = DC_TYPES.find(function(d){return d.id===type;});
        var statEl = document.getElementById('statDcType');
        if (statEl && dcObj) statEl.textContent = dcObj.label;
        renderChecklist();
        calculate();
    }

    // ═══ MODE ═══
    function setMode(mode) {
        if (mode === 'pro' && !isPremiumUser) { handlePremiumTab(); return; }
        currentMode = mode;
        var btnFree = document.getElementById('btnFreeMode');
        var btnPro = document.getElementById('btnProMode');
        var indicator = document.getElementById('modeIndicator');
        var btnPdf = document.getElementById('btnExportPDF');
        if (mode === 'pro') {
            btnFree.classList.remove('active'); btnPro.classList.add('active');
            indicator.className = 'tia-mode-indicator pro-active'; indicator.textContent = 'PRO MODE';
            btnPdf.classList.remove('disabled');
        } else {
            btnFree.classList.add('active'); btnPro.classList.remove('active');
            indicator.className = 'tia-mode-indicator free-active'; indicator.textContent = 'FREE MODE';
            if (!isPremiumUser) btnPdf.classList.add('disabled');
        }
    }

    function resetChecklist() {
        checkedItems = {};
        renderChecklist();
        calculate();
    }

    // ═══ AUTH ═══
    (function checkSession() {
        var session = localStorage.getItem('rz_premium_session');
        if (session) {
            try {
                var data = JSON.parse(session);
                var exp = typeof data.expires === 'string' ? new Date(data.expires).getTime() : data.expires;
                if (exp > Date.now()) { isPremiumUser = true; userTier = data.tier || 'pro'; activatePremiumUI(); return; }
                else { localStorage.removeItem('rz_premium_session'); }
            } catch(e) { localStorage.removeItem('rz_premium_session'); }
        }
        var dcmocAuth = localStorage.getItem('dcmoc-auth');
        if (dcmocAuth) {
            try {
                var d = JSON.parse(dcmocAuth); if (d.state && d.state.user) { isPremiumUser = true; userTier = 'pro'; activatePremiumUI(); }
            } catch(e) {}
        }
    })();

    function handlePremiumTab() {
        if (isPremiumUser) return;
        document.getElementById('loginModal').style.display = 'flex';
        document.getElementById('loginError').style.display = 'none';
        document.getElementById('loginEmail').value = '';
        document.getElementById('loginPassword').value = '';
        setTimeout(function() { document.getElementById('loginEmail').focus(); }, 100);
    }

    function closeLoginModal() { document.getElementById('loginModal').style.display = 'none'; }
    document.getElementById('loginModal').addEventListener('click', function(e) { if (e.target === this) closeLoginModal(); });
    document.addEventListener('keydown', function(e) { if (e.key === 'Escape') closeLoginModal(); });

    function attemptLogin() {
        var email = document.getElementById('loginEmail').value.trim();
        var password = document.getElementById('loginPassword').value;
        var errorEl = document.getElementById('loginError');
        if (!email || !password) { errorEl.textContent = 'Please enter email and password'; errorEl.style.display = 'block'; return; }
        var validUsers = [{ email: 'demo@resistancezero.com', password: 'demo2026', tier: 'pro' },{ email: 'bagus@resistancezero.com', password: 'RZ@Premium2026!', tier: 'pro' },{ email: 'admin@resistancezero.com', password: 'RZ@Premium2026!', tier: 'pro' }];
        var match = validUsers.find(function(u) { return u.email === email && u.password === password; });
        if (match) {
            var expDate = new Date(); expDate.setDate(expDate.getDate() + 30);
            localStorage.setItem('rz_premium_session', JSON.stringify({ email: match.email, tier: match.tier, role: (match.email === 'admin@resistancezero.com' || match.email === 'bagus@resistancezero.com') ? 'root' : 'pro', expires: expDate.toISOString() }));
            isPremiumUser = true; userTier = match.tier;
            closeLoginModal(); activatePremiumUI();
            window.dispatchEvent(new CustomEvent('rz-auth-change', { detail: { email: match.email, tier: match.tier, role: (match.email === 'admin@resistancezero.com' || match.email === 'bagus@resistancezero.com') ? 'root' : 'pro', action: 'login' } }));
        } else { errorEl.textContent = 'Invalid credentials'; errorEl.style.display = 'block'; }
    }

    function activatePremiumUI() {
        document.querySelectorAll('.pro-section').forEach(function(s) { s.classList.remove('locked'); });
        var btnPro = document.getElementById('btnProMode');
        if (btnPro) btnPro.classList.remove('locked-hint');
        setMode('pro');
        updateNavbarAuthUI();
        calculate();
    }

    function logoutPremium() {
        if (!confirm('Logout from your account?')) return;
        isPremiumUser = false; userTier = 'free';
        localStorage.removeItem('rz_premium_session');
        document.querySelectorAll('.pro-section').forEach(function(s) { s.classList.add('locked'); });
        var btnPro = document.getElementById('btnProMode');
        if (btnPro) btnPro.classList.add('locked-hint');
        setMode('free');
        updateNavbarAuthUI();
        window.dispatchEvent(new CustomEvent('rz-auth-change', { detail: { action: 'logout' } }));
    }

    function toggleUserDropdown() {
        document.getElementById('navUserBtn').classList.toggle('open');
        document.getElementById('navUserDropdown').classList.toggle('show');
    }
    document.addEventListener('click', function(e) {
        var wrap = document.getElementById('navAuthWrap');
        if (wrap && !wrap.contains(e.target)) {
            var dd = document.getElementById('navUserDropdown');
            var btn = document.getElementById('navUserBtn');
            if (dd) dd.classList.remove('show');
            if (btn) btn.classList.remove('open');
        }
    });
    function updateNavbarAuthUI() {
        var loginBtn = document.getElementById('navLoginBtn');
        var userBtn = document.getElementById('navUserBtn');
        if (isPremiumUser) {
            var session = JSON.parse(localStorage.getItem('rz_premium_session') || '{}');
            var email = session.email || 'PRO User';
            loginBtn.style.display = 'none'; userBtn.style.display = 'flex';
            document.getElementById('navUserAvatar').textContent = email.charAt(0).toUpperCase();
            document.getElementById('navUserEmail').textContent = email;
            document.getElementById('navDdEmail').textContent = email;
            document.getElementById('navDdTierBadge').textContent = 'PRO';
            document.getElementById('navDdTierBadge').className = 'nav-dd-tier-badge pro';
        } else { loginBtn.style.display = 'flex'; userBtn.style.display = 'none'; }
    }

    // ═══ PDF EXPORT ═══
    function exportPDF() {
        if (!isPremiumUser) { handlePremiumTab(); return; }
        var w = window.open('', '_blank');
        if (!w) { alert('Please allow popups for PDF export.'); return; }
        var now = new Date();
        var dateStr = now.toLocaleDateString('en-US', { year:'numeric', month:'long', day:'numeric' });
        var overall = parseFloat(document.getElementById('scoreValue').textContent);
        var gradeText = document.getElementById('scoreGrade').textContent;
        var checked = document.getElementById('metricChecked').textContent;
        var applicable = document.getElementById('metricApplicable').textContent;
        var weighted = document.getElementById('metricCRI').textContent;
        var gColor = overall >= 85 ? '#10b981' : (overall >= 65 ? '#f59e0b' : '#ef4444');

        var dcTypeLabel = (DC_TYPES.find(function(d){return d.id===currentDcType;}) || {}).label || 'Enterprise';

        // SVG Category Bar
        var svgBar = '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 400 240" style="width:100%;height:auto;">';
        svgBar += '<text x="200" y="16" text-anchor="middle" font-size="11" font-weight="700" fill="#1e3a5f">Category Compliance Scores</text>';
        CATEGORIES.forEach(function(cat, i) {
            var items = getFilteredItems(cat.id);
            var cw = 0, tw = 0;
            items.forEach(function(it) { tw += it.w; if (checkedItems[it.id]) cw += it.w; });
            var pct = tw > 0 ? Math.round(cw / tw * 100) : 0;
            var barW = 48, gap = 10, startX = 22;
            var x = startX + i * (barW + gap);
            var maxH = 150, h = Math.max(4, pct / 100 * maxH), y = 190 - h;
            svgBar += '<rect x="'+x+'" y="'+y+'" width="'+barW+'" height="'+h+'" fill="'+cat.color+'" rx="3"/>';
            svgBar += '<text x="'+(x+barW/2)+'" y="'+(y-5)+'" text-anchor="middle" font-size="10" font-weight="600" fill="#1f2937">'+pct+'%</text>';
            svgBar += '<text x="'+(x+barW/2)+'" y="208" text-anchor="middle" font-size="7" fill="#64748b">'+cat.label.split('/')[0].split('&')[0].trim()+'</text>';
        });
        svgBar += '</svg>';

        // Gap table
        var gaps = getAllFilteredItems().filter(function(it) { return !checkedItems[it.id]; });
        gaps.sort(function(a, b) { return b.w - a.w; });
        var gapRows = '';
        gaps.forEach(function(it) {
            var cat = CATEGORIES.find(function(c) { return c.id === it.cat; });
            var pLabel = it.w === 3 ? 'P1' : (it.w === 2 ? 'P2' : 'P3');
            var pColor = it.w === 3 ? '#ef4444' : (it.w === 2 ? '#f59e0b' : '#6b7280');
            gapRows += '<tr><td style="color:'+pColor+';font-weight:700;">'+pLabel+'</td><td>'+it.label+'</td><td>'+cat.label+'</td><td>W'+it.w+'</td><td>'+it.ref+'</td></tr>';
        });

        var html = '<!DOCTYPE html><html><head><meta charset="UTF-8"><title>TIA-942 Compliance Report — '+dateStr+'</title>';
        html += '<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&family=JetBrains+Mono:wght@400;600&display=swap" rel="stylesheet">';
        html += '<style>@media print{body{-webkit-print-color-adjust:exact;print-color-adjust:exact}@page{margin:15mm}}';
        html += '*{margin:0;padding:0;box-sizing:border-box}body{font-family:"Inter",Arial,sans-serif;max-width:820px;margin:0 auto;padding:20px 30px;color:#1f2937;font-size:12px;line-height:1.5}';
        html += 'h1{color:#065f46;font-size:20px;margin-bottom:2px}h2{color:#065f46;font-size:14px;margin:16px 0 8px;padding-bottom:4px;border-bottom:2px solid #10b981}';
        html += 'table{width:100%;border-collapse:collapse;margin:8px 0}th{background:#f8fafc;padding:6px 10px;text-align:left;font-size:9px;text-transform:uppercase;color:#64748b;border-bottom:2px solid #e5e7eb;letter-spacing:0.5px}';
        html += 'td{padding:6px 10px;border-bottom:1px solid #e5e7eb;font-size:11px}';
        html += '.pdf-header{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:12px;padding-bottom:10px;border-bottom:2px solid #10b981}';
        html += '.pdf-brand{font-size:9px;color:#64748b;text-transform:uppercase;letter-spacing:1px;font-weight:700}.pdf-brand span{color:#10b981}';
        html += '.pdf-date{font-size:9px;color:#94a3b8;text-align:right}';
        html += '.pdf-score-row{display:flex;gap:16px;margin:12px 0}.pdf-score-card{flex:1;text-align:center;padding:16px;background:linear-gradient(135deg,#ecfdf5,#f0fdf4);border:2px solid '+gColor+';border-radius:12px}';
        html += '.pdf-score-value{font-size:42px;font-weight:800;color:'+gColor+';font-family:"JetBrains Mono",monospace;line-height:1}';
        html += '.pdf-score-label{font-size:10px;color:#64748b;text-transform:uppercase;letter-spacing:1px;margin-top:4px}';
        html += '.pdf-kpi-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:10px;margin:12px 0}';
        html += '.pdf-kpi-card{background:#f8fafc;border:1px solid #e5e7eb;border-radius:6px;padding:10px;text-align:center}';
        html += '.pdf-kpi-value{font-size:16px;font-weight:700;color:#065f46;font-family:"JetBrains Mono",monospace}';
        html += '.pdf-kpi-label{font-size:8px;color:#6b7280;margin-top:3px;text-transform:uppercase;letter-spacing:0.3px}';
        html += '.pdf-footer{margin-top:20px;padding-top:10px;border-top:2px solid #10b981;text-align:center;font-size:8px;color:#94a3b8}';
        html += '</style></head><body>';
        html += '<div class="pdf-header"><div><h1>TIA-942 Compliance Report</h1><div class="pdf-brand"><span>RESISTANCE</span>ZERO — Pro Analysis</div></div><div class="pdf-date">Generated '+dateStr+'<br>Tier '+currentTier+' · '+dcTypeLabel+' Facility<br>resistancezero.com</div></div>';
        html += '<div class="pdf-score-row"><div class="pdf-score-card"><div class="pdf-score-value">'+Math.round(overall)+'%</div><div class="pdf-score-label">Overall Compliance</div><div style="margin-top:6px;font-size:12px;font-weight:700;color:'+gColor+';">'+gradeText+'</div></div>';
        html += '<div style="flex:1.2;"><div class="pdf-kpi-grid" style="grid-template-columns:repeat(3,1fr);height:100%;">';
        html += '<div class="pdf-kpi-card"><div class="pdf-kpi-value">'+checked+'</div><div class="pdf-kpi-label">Items Checked</div></div>';
        html += '<div class="pdf-kpi-card"><div class="pdf-kpi-value">'+applicable+'</div><div class="pdf-kpi-label">Applicable</div></div>';
        html += '<div class="pdf-kpi-card"><div class="pdf-kpi-value">'+weighted+'</div><div class="pdf-kpi-label">Risk Index (CRI)</div></div>';
        html += '<div class="pdf-kpi-card"><div class="pdf-kpi-value">Tier '+currentTier+'</div><div class="pdf-kpi-label">Target Level</div></div>';
        html += '<div class="pdf-kpi-card" style="grid-column:span 2;"><div class="pdf-kpi-value" style="font-size:13px;">'+dcTypeLabel+'</div><div class="pdf-kpi-label">Facility Type</div></div>';
        html += '</div></div></div>';
        html += '<h2>Category Scores</h2><div style="background:#fafbfc;border:1px solid #e5e7eb;border-radius:8px;padding:8px;">'+svgBar+'</div>';
        if (gapRows) { html += '<h2>Gap Analysis</h2><table><tr><th>Priority</th><th>Item</th><th>Category</th><th>Weight</th><th>Ref</th></tr>'+gapRows+'</table>'; }
        html += '<h2>Methodology</h2><p style="font-size:10px;color:#6b7280;">Compliance scored using weighted item assessment per ANSI/TIA-942-B standard. Items filtered by facility type ('+dcTypeLabel+') and tier level ('+currentTier+'). Category weights: Electrical (1.5×), Mechanical (1.3×), Fire (1.1×), Site/Telecom (1.0×), Security (0.9×). Grade scale: A+ ≥95%, A ≥85%, B ≥75%, C ≥65%, D ≥50%, F &lt;50%. Monte Carlo simulation uses 10,000 iterations with ±15% weight variance.</p>';
        html += '<div class="pdf-footer">resistancezero.com · Generated '+dateStr+' · All calculations performed client-side · No data transmitted<br>TIA-942 Compliance Checklist v1.0 — Bagus Dwi Permana Portfolio</div>';
        html += '</body></html>';
        w.document.write(html); w.document.close();
        setTimeout(function() { w.print(); }, 500);
    }

    // ═══ TOOLTIP SYSTEM ═══
    function initTooltipSystem() {
        var el = document.createElement('div');
        el.id = 'tooltip-container';
        document.body.appendChild(el);
        document.addEventListener('mouseover', function(e) {
            var trigger = e.target.closest('.tooltip-trigger');
            if (!trigger) return;
            var data = trigger.querySelector('.tooltip-data');
            if (!data) return;
            var title = data.getAttribute('data-title') || '';
            var desc = data.getAttribute('data-desc') || '';
            var ref = data.getAttribute('data-ref') || '';
            var weight = data.getAttribute('data-weight') || '';
            var icon = data.getAttribute('data-icon') || 'fa-info-circle';
            el.innerHTML = '<div class="tip-title"><i class="fas ' + icon + '"></i> ' + title + '</div>' +
                '<div class="tip-desc">' + desc + '</div>' +
                '<div class="tip-meta"><span><i class="fas fa-book"></i> ' + ref + '</span><span><i class="fas fa-weight-hanging"></i> ' + weight + '</span></div>';
            var rect = trigger.getBoundingClientRect();
            var left = rect.right + 12;
            var top = rect.top;
            var tw = 340, th = el.offsetHeight || 180;
            if (left + tw > window.innerWidth - 20) left = rect.left - tw - 12;
            if (left < 10) left = 10;
            top = top - th / 2 + rect.height / 2;
            if (top + th > window.innerHeight - 20) top = window.innerHeight - th - 20;
            if (top < 10) top = 10;
            el.style.left = left + 'px';
            el.style.top = top + 'px';
            el.classList.add('visible');
        });
        document.addEventListener('mouseout', function(e) {
            var trigger = e.target.closest('.tooltip-trigger');
            if (trigger) el.classList.remove('visible');
        });
    }

    // ═══ INIT ═══
    document.addEventListener('DOMContentLoaded', function() {
        renderChecklist();
        calculate();
        updateNavbarAuthUI();
        initTooltipSystem();
    });
    </script>
    <script src="rz-tracker.js"></script>

    <!-- Cookie Consent Banner -->
    <div class="cookie-banner hidden" id="cookieBanner">
        <p>We use cookies for analytics to improve your experience. <a href="privacy.html">Learn more</a></p>
        <div class="cookie-actions">
            <button class="cookie-accept" id="cookieAccept">Accept</button>
            <button class="cookie-decline" id="cookieDecline">Decline</button>
        </div>
    </div>
    <script>
    (function(){
        var cb = document.getElementById('cookieBanner');
        var consent = localStorage.getItem('rz_cookie_consent');
        if (!consent && cb) cb.classList.remove('hidden');
        var acceptBtn = document.getElementById('cookieAccept');
        var declineBtn = document.getElementById('cookieDecline');
        if (acceptBtn) acceptBtn.addEventListener('click', function(){ localStorage.setItem('rz_cookie_consent','accepted'); cb.classList.add('hidden'); });
        if (declineBtn) declineBtn.addEventListener('click', function(){ localStorage.setItem('rz_cookie_consent','declined'); cb.classList.add('hidden'); window['ga-disable-G-GED7FX8RTV'] = true; });
    })();
    </script>
</body>
</html>
