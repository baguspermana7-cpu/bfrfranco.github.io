(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,32737,e=>{"use strict";var t=e.i(33107);let o=[6,182,212],l=[16,185,129],a=[99,102,241],n=[244,63,94],r=[245,158,11],i=[34,197,94],s=[59,130,246],c=[15,23,42],d=[30,41,59],u=[51,65,85],C=[71,85,105],F=[100,116,139],h=[148,163,184],m=[203,213,225],g=[226,232,240],x=[51,65,85],y=[100,116,139],S=182,v=e=>{let t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)]:o},p=(e,t,o,l)=>t+o>e.internal.pageSize.height-20?(b(e,l.current),e.addPage(),l.current++,35):t,f=(e,t,l,a,r)=>{let i=e.internal.pageSize.width,s=e.internal.pageSize.height,d=r?.primaryColor?v(r.primaryColor):o;if(e.setFillColor(...c),e.rect(0,0,i,s,"F"),e.setFillColor(...d),e.rect(0,0,6,s,"F"),r?.logoBase64)try{e.addImage(r.logoBase64,"PNG",i-40-14,14,40,40,void 0,"FAST")}catch(e){console.warn("Failed to render logo",e)}else e.setFillColor(d[0],d[1],d[2]),e.circle(i-30,40,60,"F"),e.setFillColor(...c),e.circle(i-30,40,55,"F");e.setFont("helvetica","bold"),e.setFontSize(32),e.setTextColor(255,255,255);let u=t.toUpperCase().split("\n"),F=.35*s;e.text(u,24,F);let m=F+(u.length-1)*14;e.setFontSize(14),e.setTextColor(...d),e.text(l,24,m+18),e.setDrawColor(...d),e.setLineWidth(.5),e.line(24,m+24,134,m+24);let g=m+39;e.setFontSize(10),e.setFont("helvetica","normal"),e.setTextColor(...h),r?.companyName&&(e.text(`Prepared by: ${r.companyName}`,24,g),g+=7),a.client&&(e.text(`Prepared for: ${a.client}`,24,g),g+=7),e.text(`Date: ${a.date}`,24,g),g+=7,e.text(`Version: ${a.version||"1.0"}`,24,g),!1!==a.confidential&&(e.setFillColor(...n),e.roundedRect(24,s-50,50,10,2,2,"F"),e.setFontSize(7),e.setTextColor(255,255,255),e.setFont("helvetica","bold"),e.text("CONFIDENTIAL",29,s-43)),e.setFontSize(8),e.setTextColor(...C),e.setFont("helvetica","normal");let x=r?.companyName?`Generated by ${r.companyName} Operations Calculator`:"Generated by DCMOC v2.0 — Data Center M&O Calculator";e.text(x,24,s-15)},T=(e,t,l="",a)=>{let n=e.internal.pageSize.width,r=a?.primaryColor?v(a.primaryColor):o;e.setFillColor(...c),e.rect(0,0,n,25,"F"),e.setFillColor(...r),e.rect(0,23,n,1,"F"),e.setFont("helvetica","bold"),e.setFontSize(14),e.setTextColor(255,255,255),e.text(t,14,16),a?.logoBase64?e.addImage(a.logoBase64,"PNG",n-14-12,6,12,12,void 0,"FAST"):l&&(e.setFontSize(8),e.setTextColor(...h),e.text(l,n-14,16,{align:"right"}))},b=(e,t,o)=>{let l=e.internal.pageSize.width,a=e.internal.pageSize.height;e.setDrawColor(...g),e.line(14,a-15,l-14,a-15),e.setFontSize(7),e.setTextColor(...h);let n=new Date().toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),r=o?.companyName?o.companyName:"DCMOC v2.0";e.text(`Generated ${n} | ${r} | CONFIDENTIAL`,14,a-8),e.text(`Page ${t}`,l-14,a-8,{align:"right"})},P=(e,t,l,a,n)=>{let r=n?.primaryColor?v(n.primaryColor):o;e.setFillColor(...r),e.rect(14,t,3,8,"F"),e.setFont("helvetica","bold"),e.setFontSize(13),e.setTextColor(...c);let i=a?`${a}. `:"";return e.text(`${i}${l}`,20,t+6),e.setDrawColor(...g),e.setLineWidth(.3),e.line(14,t+10,196,t+10),t+16},$=(e,t,o,a,n,r,i,s,d=l)=>{e.setFillColor(248,250,252),e.setDrawColor(...g),e.roundedRect(t,o,a,n,2,2,"FD"),e.setFillColor(...d),e.rect(t,o+6,2,n-12,"F"),e.setFontSize(7),e.setTextColor(...y),e.setFont("helvetica","normal"),e.text(r.toUpperCase(),t+5,o+9),e.setFontSize(14),e.setFont("helvetica","bold"),e.setTextColor(...c),e.text(i,t+5,o+19),e.setFontSize(7),e.setFont("helvetica","normal"),e.setTextColor(...y),e.text(s,t+5,o+n-5)},w=(e,t,o,a,n="info")=>{let i={info:s,warning:r,success:l},c=e.splitTextToSize(a,S-16),d=14+4.5*c.length;return e.setFillColor(...{info:[239,246,255],warning:[254,252,232],success:[236,253,245]}[n]),e.roundedRect(14,t,S,d,2,2,"F"),e.setFillColor(...i[n]),e.rect(14,t,3,d,"F"),e.setFont("helvetica","bold"),e.setFontSize(9),e.setTextColor(...i[n]),e.text(o,21,t+8),e.setFont("helvetica","normal"),e.setFontSize(8),e.setTextColor(...x),e.text(c,21,t+14),t+d+4},R=(e,t,o,l=S)=>{e.setFont("helvetica","normal"),e.setFontSize(9),e.setTextColor(...x);let a=e.splitTextToSize(o,l);return e.text(a,14,t),t+4.5*a.length+2},D=(e,t,o,l,a,n)=>{e.setFontSize(10),e.setFont("helvetica","bold"),e.setTextColor(...c),e.text(n,t,o);let r=Math.max(...a.map(e=>e.value),1),i=o+8;return a.forEach(o=>{e.setFontSize(7.5),e.setFont("helvetica","normal"),e.setTextColor(...x),e.text(o.label,t,i+5),e.setFillColor(241,245,249),e.roundedRect(t+45,i,l-90,8,1,1,"F");let a=Math.max(2,o.value/r*(l-90));e.setFillColor(...o.color),e.roundedRect(t+45,i,a,8,1,1,"F"),e.setFontSize(7),e.setFont("helvetica","bold"),e.setTextColor(...c);let n=o.value>=1e3?`$${(o.value/1e3).toFixed(1)}k`:`$${o.value.toFixed(0)}`;e.text(n,t+l-40,i+5.5,{align:"right"}),i+=12}),i+4};var E=e.i(42821);let z=async t=>{let o=await e.A(73880),l=null;l=o.default&&"function"==typeof o.default?o.default:o.jsPDF?o.jsPDF:o.default||o;let a=await e.A(34642),n=a.default||a;if(!l)throw Error("Failed to load jsPDF constructor");return{doc:new l({orientation:"portrait",unit:"mm",format:"a4"}),autoTable:(e,t)=>"function"==typeof n?n(e,t):"function"==typeof e.autoTable?e.autoTable(t):void console.error("autoTable plugin not found")}},M=(e,t)=>{try{let o=e.output("blob");if(console.log(`PDF Generated: ${t}, Size: ${o.size} bytes, Type: ${o.type}`),o.size<100)throw Error(`Generated PDF is empty (${o.size} bytes)`);let l=URL.createObjectURL(o),a=document.createElement("a");a.href=l,a.download=t,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(l)}catch(e){console.error("PDF save error:",e),window.alert(`PDF Generation Failed: ${e.message||"Unknown error"}`)}},A=e=>e>=1e6?`$${(e/1e6).toFixed(2)}M`:e>=1e3?`$${(e/1e3).toFixed(1)}k`:`$${e.toFixed(0)}`,I=e=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",maximumFractionDigits:0}).format(e),O=()=>new Date().toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"}),k=async(e,t,a,n,r,i,d)=>{let{doc:u,autoTable:C}=await z(d),F=1;f(u,"Staffing Strategy &\nOperational Roster",`Analysis for ${e.name} Region`,{client:"Internal Assessment",date:O(),version:"2.4",confidential:!0},d),u.addPage(),F++,T(u,"Executive Summary","Staffing & Cost Analysis",d);let m=35,y=a.reduce((e,t)=>e+t.headcount,0),v=a.reduce((e,t)=>e+t.monthlyCost,0);$(u,14,m,42,24,"Total Headcount",`${y}`,"FTEs across all shifts"),$(u,60,m,42,24,"Monthly OPEX",A(v),"Gross Salary + Burden"),$(u,106,m,42,24,"Avg Cost / Head",A(v/y),"Monthly Blended Rate"),$(u,152,m,42,24,"Shift Model","8h"===t?"8-Hour":"12-Hour","Rotation Pattern"),m+=35;let R=r.find(e=>"high"===e.severity)||r[0];if(R&&(m=w(u,m,`Strategic Recommendation: ${R.title}`,R.recommendation,"high"===R.severity?"warning":"info")),m=D(u,14,m,180,a.map(e=>({label:e.role,value:e.monthlyCost,color:e.role.includes("Engineer")?l:o})),"Monthly Cost Distribution by Role"),m=p(u,m,60,{current:F}),i&&i.length>0){var E,I;let t,o;E=m=P(u,m,"Shift Model Comparison","1.0",d),I=`8-Hour vs 12-Hour Model (${e.name})`,u.setFontSize(10),u.setFont("helvetica","bold"),u.setTextColor(...c),u.text(I,14,E),t=E+4,u.setFillColor(...c),u.rect(14,t,S,8,"F"),u.setFontSize(7),u.setFont("helvetica","bold"),u.setTextColor(255,255,255),u.text("Metric",17,t+5.5),u.text("8h Continental",87,t+5.5),u.text("12h (4on/4off)",132,t+5.5),u.text("Better",177,t+5.5),o=t+8,i.forEach((e,t)=>{t%2==0&&(u.setFillColor(248,250,252),u.rect(14,o,S,8,"F")),u.setFontSize(7),u.setFont("helvetica","normal"),u.setTextColor(...x),u.text(e.metric,17,o+5.5),u.text(e.value8h,87,o+5.5),u.text(e.value12h,132,o+5.5),"12h"===e.winner?(u.setTextColor(...l),u.setFont("helvetica","bold"),u.text("12h ✓",177,o+5.5)):"8h"===e.winner?(u.setTextColor(...s),u.setFont("helvetica","bold"),u.text("8h ✓",177,o+5.5)):(u.setTextColor(...h),u.text("—",177,o+5.5)),o+=8}),u.setDrawColor(...g),u.rect(14,t,S,o-t),m=o+6}b(u,F,d),u.addPage(),F++,T(u,"Operational Roster","Shift Pattern Visualization",d),m=P(u,m=35,"Shift Rotation Schedule","2.0",d),C(u,{startY:m,head:[["Team","Next 14 Days Rotation"]],body:Array.from(new Set(n.map(e=>e.team))).map(e=>{let t=n.filter(t=>t.team===e).slice(0,14);return[e,t.map(e=>"Day"===e.shiftType?"☀":"Night"===e.shiftType?"☾":"—").join(" ")]}),theme:"striped",headStyles:{fillColor:(d?.primaryColor,c)},styles:{fontSize:8,cellPadding:3},margin:{left:14,right:14}}),b(u,F,d),M(u,`DCMOC_Staffing_Report_${e.name}_${new Date().toISOString().slice(0,10)}.pdf`)},N=async(e,t,a,s,y)=>{var v;let $,{doc:w,autoTable:R}=await z(s),{inputs:D,results:E,insights:k}=a,N=1;f(w,"Feasibility Simulation\n& Market Analysis",`Assessment for ${e.name} Data Center`,{client:"Strategic Planning Committee",date:O(),version:"1.2"},s),w.addPage(),N++,T(w,"Executive Summary","Operational Viability Assessment",s);let L=35,Y=E.monthlyInternalCost||0,G=E.monthlyVendorCost||0,B=E.totalMonthlyConsumables||0,U=E.turnoverCost||0,V=(e,t,o,l,a,n,r,i,s,c)=>{w.setFillColor(255,255,255),w.setDrawColor(226,232,240),w.roundedRect(e,t,o,l,2,2,"FD"),w.setFont("helvetica","bold"),w.setFontSize(7),w.setTextColor(...F),w.text(a.toUpperCase(),e+4,t+6),w.setFontSize(14),w.setTextColor(...i),w.text(n,e+4,t+14),w.setFillColor(...s),w.roundedRect(e+4,t+18,o-8,5,1,1,"F"),w.setFont("helvetica","normal"),w.setFontSize(6),w.setTextColor(...c),w.text(r,e+6,t+21.5)};V(14,L,42,26,"Internal Staff Cost",A(Y),`${E.headcount||0} Internal FTEs`,c,[241,245,249],C),V(60,L,42,26,"Vendor Labor Cost",A(G),"Includes Premium",r,[254,243,199],[217,119,6]),V(106,L,42,26,"Parts & Consumables",A(B),`AQI Impact: ${E.aqiImpact>1?"High":"None"}`,o,[241,245,249],C),V(152,L,42,26,"Hidden Turnover Loss",A(U),"Recruitment + Training",n,[255,228,230],[225,29,72]),L+=35,L=p(w,L,60,{current:N}),$=v=L=P(w,L,"Key Strategic Insights","1.0",s),k.slice(0,6).forEach(e=>{let t="high"===e.severity?n:"medium"===e.severity?r:l,o=w.splitTextToSize(e.description,S-12),a=12+4*o.length;w.setFillColor(248,250,252),w.rect(14,$,S,a,"F"),w.setFillColor(...t),w.rect(14,$,2.5,a,"F"),w.setFontSize(8.5),w.setFont("helvetica","bold"),w.setTextColor(...c),w.text(e.title,20,$+6),w.setFont("helvetica","normal"),w.setFontSize(7.5),w.setTextColor(...x),w.text(o,20,$+12),$+=a+3}),L=p(w,L=$,80,{current:N}),L=P(w,L,"Operational Physics & Regulatory Analysis","2.0",s),w.setFillColor(248,250,252),w.setDrawColor(...g),w.roundedRect(14,L,182,30,2,2,"FD"),w.setFont("helvetica","bold"),w.setFontSize(9),w.setTextColor(...d),w.text("Overtime & Regulatory Analysis (PP 35/2021)",18,L+6),w.setFontSize(8),w.setFont("helvetica","normal"),w.setTextColor(...C),w.text("Weekly OT Hours/Person",18,L+14),w.setFont("helvetica","bold"),w.setTextColor(...c),w.text(`${E.overtimeHours?.toFixed(1)||0} hrs`,90,L+14,{align:"right"});let _=Math.min(1,(E.overtimeHours||0)/18);w.setFillColor(...g),w.roundedRect(18,L+17,72,2,1,1,"F"),w.setFillColor(...(E.overtimeHours||0)>12?n:i),w.roundedRect(18,L+17,72*_,2,1,1,"F"),w.setFont("helvetica","normal"),w.setFontSize(7),w.setTextColor(...F),w.text("Legal limit for 12h shifts without permit is strict. >18h/week incurs 4.0x multiplier.",18,L+24),w.setFontSize(8),w.setTextColor(...C),w.text("Base Salary",105,L+14),w.setTextColor(...c),w.text("$20000.00",185,L+14,{align:"right"}),w.setFont("helvetica","bold"),w.setTextColor(...r),w.text("Overtime Penalty",105,L+20),w.text("$1126.30",185,L+20,{align:"right"}),L+=35,w.setFillColor(248,250,252),w.roundedRect(14,L,88,30,2,2,"FD"),w.setFont("helvetica","bold"),w.setFontSize(9),w.setTextColor(...d),w.text("Environmental Physics (Power Law)",18,L+6),w.setFillColor(241,245,249),w.setDrawColor(...m),w.roundedRect(18,L+9,60,18,1,1,"FD"),w.setFontSize(6),w.setTextColor(...F),w.text("Mathematical Formula",20,L+13),w.setFont("courier","normal"),w.setTextColor(...i),w.text("Life_Actual =",20,L+18),w.text("Life_Base * (AQI_Base/AQI)^1.5",20,L+22),w.setFont("helvetica","bold"),w.setFontSize(7),w.setTextColor(...F),w.text("Impact",98,L+13,{align:"right"}),w.setTextColor(...u),w.text((D.aqiOverride||50)>100?"Accelerated Wear":"Standard",98,L+17,{align:"right"}),w.setFillColor(248,250,252),w.roundedRect(108,L,88,30,2,2,"FD"),w.setFontSize(9),w.setTextColor(...d),w.text(`Risk & Downtime Exposure (Tier ${D.tierLevel||3})`,112,L+6),w.setFontSize(6),w.setTextColor(...F),w.text("EXPECTED AVAILABILITY",112,L+12),w.setFontSize(14),w.setTextColor(...c),w.text(`${E.availability?.toFixed(3)||0}%`,112,L+18),w.setFontSize(6),w.setTextColor(...F),w.text(`~${Math.round(E.downtimeMinutes||0)} mins downtime / yr`,112,L+22),w.setFontSize(6),w.setTextColor(...F),w.text("FINANCIAL EXPOSURE",156,L+12),w.setFontSize(14),w.setTextColor(...n),w.text(I(E.financialRisk||0),156,L+18),w.setFontSize(6),w.setTextColor(...F),w.text("@ $5k/min impact",156,L+22),L+=35,L=p(w,L,70,{current:N}),L=P(w,L,"Power & Cooling Analytics","3.0",s),w.setFillColor(248,250,252),w.roundedRect(14,L,182,35,2,2,"FD"),w.setFillColor(241,245,249),w.roundedRect(18,L+4,38,14,1,1,"FD"),w.setFontSize(6),w.setTextColor(...F),w.text("PUE",20,L+8),w.setFontSize(10),w.setTextColor(217,119,6),w.text("1.45",20,L+14),w.roundedRect(58,L+4,38,14,1,1,"FD"),w.setFontSize(6),w.setTextColor(...F),w.text("COOLING LOAD",60,L+8),w.setFontSize(10),w.setTextColor(...o),w.text("450 kW",60,L+14),w.roundedRect(98,L+4,38,14,1,1,"FD"),w.setFontSize(6),w.setTextColor(...F),w.text("TOTAL FACILITY",100,L+8),w.setFontSize(10),w.setTextColor(...c),w.text("1450 kW",100,L+14);let W=e.environment?.gridCarbonIntensity??.5,j=D.tierLevel||3;if(w.roundedRect(138,L+4,54,14,1,1,"FD"),w.setFontSize(6),w.setTextColor(...F),w.text("ANNUAL CO2",140,L+8),w.setFontSize(10),w.setTextColor(109,40,217),w.text(`${((4===j?1250:1450)*8760/1e3*W/1e3).toFixed(1)}k tonnes/yr`,140,L+14),w.setFontSize(6),w.setTextColor(...F),w.text("POWER CHAIN EFFICIENCY",18,L+24),w.setFont("courier","normal"),w.setFillColor(209,250,229),w.roundedRect(18,L+26,25,5,1,1,"F"),w.setTextColor(4,120,87),w.text("Grid 98%",21,L+29.5),w.setTextColor(...h),w.text("->",45,L+29.5),w.setFillColor(219,234,254),w.roundedRect(50,L+26,25,5,1,1,"F"),w.setTextColor(29,78,216),w.text("UPS 94%",53,L+29.5),w.setTextColor(...h),w.text("->",77,L+29.5),w.setFillColor(233,213,255),w.roundedRect(82,L+26,25,5,1,1,"F"),w.setTextColor(109,40,217),w.text("PDU 97%",85,L+29.5),w.setTextColor(...h),w.text("->",109,L+29.5),w.setFillColor(207,250,254),w.roundedRect(114,L+26,30,5,1,1,"F"),w.setTextColor(14,116,144),w.text("IT Load ✓",117,L+29.5),L+=45,y?.tornado||y?.sankey){if(b(w,N,s),w.addPage(),N++,T(w,"Visual Analysis","Generated Charts",s),L=35,y.sankey){L=P(w,L,"Cost Flow Analysis (Sankey)","3.0",s);try{let e=w.getImageProperties(y.sankey),t=180*e.height/e.width;w.addImage(y.sankey,"PNG",15,L,180,t),L+=t+10}catch(e){console.warn("Error adding Sankey image to PDF",e)}}if(y.tornado){L=p(w,L,100,{current:N}),L=P(w,L,"Sensitivity Analysis (Tornado)","4.0",s);try{let e=w.getImageProperties(y.tornado),t=180*e.height/e.width;w.addImage(y.tornado,"PNG",15,L,180,t)}catch(e){console.warn("Error adding Tornado image to PDF",e)}}}b(w,N,s),M(w,`DCMOC_Feasibility_${e.name}_${new Date().toISOString().slice(0,10)}.pdf`)},L=async(e,t,o,l,a)=>{let{doc:n,autoTable:r}=await z(a),i=1;f(n,"Capital Expenditure\nReport",`Budget Estimation for ${e.name}`,{client:"Finance Dept",date:O(),version:"3.1"},a),n.addPage(),i++,T(n,"Project Configuration","Facility Design & Inputs",a);let s=(e,t,o,l)=>{n.setFillColor(248,250,252),n.setDrawColor(226,232,240),n.roundedRect(e,t,85,10+8*l.length,2,2,"FD"),n.setFont("helvetica","bold"),n.setFontSize(9),n.setTextColor(...u),n.text(o,e+4,t+6);let a=t+12;return l.forEach(t=>{n.setFont("helvetica","normal"),n.setFontSize(8),n.setTextColor(...F),n.text(t.label,e+4,a),n.setFont("helvetica","bold"),n.setTextColor(...c),n.text(t.value,e+81,a,{align:"right"}),a+=8}),t+10+8*l.length+4},m=35;m=s(14,35,"Facility Layout",[{label:"IT Capacity",value:`${l.itLoad||1e3} kW`},{label:"Redundancy Tier",value:l.redundancy?.toUpperCase()||"N+1"},{label:"Cooling Strategy",value:"air"===l.coolingType?"Air Cooled":"inrow"===l.coolingType?"In-Row":"Other"},{label:"Building Type",value:"purpose"===l.buildingType?"Purpose Built":"Retrofit/Modular"},{label:"Rack Density",value:l.rackType?.toUpperCase()||"STANDARD"}]),m=s(14,m,"Power & Cooling Build",[{label:"UPS System",value:l.upsType||"Modular"},{label:"Generator",value:l.genType||"Diesel"},{label:"Fuel Storage",value:`${l.fuelHours||48} Hours`},{label:"Fire Suppression",value:l.fireType||"Novec"},{label:"Fire Alarm",value:l.alarmType||"Addressable"}]);let g=35;g=s(105,35,"Sustainability & Site",[{label:"Green Certification",value:l.greenCert||"None"},{label:"Renewable Energy",value:l.renewableOption||"None"},{label:"Substation & Grid",value:l.includeFOM?"Include FOM":"Exclude FOM"},{label:"Project Year",value:l.projYear||"2025"},{label:"City Market",value:"none"!==l.cityMarket?l.cityMarket:"Generic"}]),g=s(105,g,"Soft Costs",[{label:"Design Fee",value:`${l.designFee||8}%`},{label:"PM Fee",value:`${l.pmFee||5}%`},{label:"Contingency",value:`${l.contingency||10}%`}]),b(n,i,a),n.addPage(),i++,T(n,"Project Parameters & Executive Summary",`Total CAPEX: ${I(t.total)}`,a);let x=35,{metrics:y,timeline:S,costs:v,softCosts:p,contingency:$}=t,w=(e,t,o,l,a,r,i,s,c=F)=>{n.setFillColor(255,255,255),n.setDrawColor(226,232,240),n.roundedRect(e,t,o,l,2,2,"FD"),n.setFont("helvetica","medium"),n.setFontSize(8),n.setTextColor(...c),n.text(a,e+4,t+8),n.setFont("helvetica","bold"),n.setFontSize(16),n.setTextColor(...s),n.text(r,e+4,t+16),n.setFont("helvetica","normal"),n.setFontSize(7),n.setTextColor(...h),n.text(i,e+4,t+22)};w(14,35,42,26,"Total CAPEX",I(t.total),"Estimated Total",c,[79,70,229]),w(58,x,42,26,"Cost per kW",`$${Math.round(y.perKw).toLocaleString()}`,y.perKw<8e3?"Low Cost":y.perKw<15e3?"Standard":"Premium",[79,70,229]),w(102,x,42,26,"PUE Target",t.pue.toFixed(2),t.pue<1.3?"Best-in-Class":t.pue<1.5?"Good":"Standard",[5,150,105]),w(146,x,42,26,"Timeline",`${S.totalMonths} Mo`,"Design to Commissioning",[217,119,6]),w(14,x+=30,42,26,"Total Racks",`${y.racks}`,"IT Equipment",u),w(58,x,42,26,"Floor Space",`${Math.round(y.floorSpace).toLocaleString()} m\xb2`,"White space",u),w(102,x,42,26,"Annual Energy",I(y.annualEnergy),"@ $0.10/kWh",u),w(146,x,42,26,"Soft Costs",I((p.design||0)+(p.pm||0)),"Design & PM Fees",u),x+=36,n.setFillColor(238,242,255),n.setDrawColor(224,231,255),n.roundedRect(14,x,174,30,2,2,"FD"),n.setFont("helvetica","bold"),n.setFontSize(10),n.setTextColor(49,46,129),n.text("CAPEX Analysis",18,x+8);let R=n.splitTextToSize(o.replace(/\*\*/g,""),166);n.setFont("helvetica","normal"),n.setFontSize(8),n.setTextColor(55,48,163),n.text(R,18,x+14),x+=38;let D=x=P(n,x,"Details","1.0",a);n.setFont("helvetica","bold"),n.setFontSize(9),n.setTextColor(...u),n.text("Cost Breakdown",14,D),n.setDrawColor(241,245,249);let E=D+6,A=Object.entries(v).sort(([,e],[,t])=>t-e),k=(e,o)=>{t.total,n.line(14,E-3,94,E-3),n.setFillColor(129,140,248),n.circle(16,E-.5,1.5,"F"),n.setFont("helvetica","normal"),n.setFontSize(7.5),n.setTextColor(...C),n.text(e.replace(/([A-Z])/g," $1").trim().replace(/^./,e=>e.toUpperCase()),19,E),n.setFont("helvetica","bold"),n.setFontSize(8),n.setTextColor(...c),n.text(`$${(o/1e3).toFixed(0)}k`,94,E,{align:"right"}),E+=7};for(let[e,t]of A)k(e,t);p.design&&k("Design Fee",p.design),p.pm&&k("PM Fee",p.pm),$&&k("Contingency",$),t.fomTotal>0&&k("Front-of-Meter",t.fomTotal),n.setFont("helvetica","bold"),n.setFontSize(9),n.setTextColor(...u),n.text("Project Timeline",105,D);let N=D+6;for(let e of S.phases){n.setDrawColor(226,232,240),n.line(109,N,109,N+12);let t=(e=>{let t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)]:[0,0,0]})(e.color);n.setFillColor(...t),n.circle(109,N+2,2,"F"),n.setFont("helvetica","bold"),n.setFontSize(8),n.setTextColor(...d),n.text(e.name,113,N+3),n.setFont("helvetica","normal"),n.setFontSize(7),n.setTextColor(...F),n.text(`M${e.start} - M${e.end}`,180,N+3,{align:"right"}),N+=14}n.setFillColor(248,250,252),n.roundedRect(109,N,71,20,2,2,"F"),n.setFont("helvetica","bold"),n.setFontSize(7),n.setTextColor(...F),n.text("TOTAL DURATION",113,N+6),n.setFontSize(14),n.setTextColor(...d),n.text(`${S.totalMonths} months`,113,N+12),n.setFontSize(7),n.setFont("helvetica","normal"),n.setTextColor(...h),n.text(`~${(S.totalMonths/12).toFixed(1)} years from design start to go-live`,113,N+17),b(n,i,a),M(n,`DCMOC_CAPEX_${e.name}_${new Date().toISOString().slice(0,10)}.pdf`)},Y=async(e,t,o,l,a,n,r)=>{let{doc:i,autoTable:s}=await z(r),d=1;f(i,"Maintenance Strategy\n& Reliability Analysis",`Operational Plan for ${e.name}`,{client:"Ops Director",date:O()},r),i.addPage(),d++,T(i,"Strategy & OPEX Optimization","Maintenance Regime Analysis",r);let u=35;u=w(i,35,`Recommended Strategy: ${t.recommended.toUpperCase()}`,t.recommendationReason,"success"),u=p(i,u,60,{current:d}),u=P(i,u,"Strategy Cost Comparison","1.0",r),s(i,{startY:u,head:[["Strategy","Annual Cost","5-Year NPV","Status"]],body:t.strategies.map(e=>[e.label,I(e.totalAnnualCost),I(e.fiveYearNPV),e.id===t.recommended?"Recommended":""]),theme:"grid",headStyles:{fillColor:(r?.primaryColor,c)},margin:{left:14,right:14}}),u=i.lastAutoTable.finalY+15;let C=u=P(i,u,"Inventory & SLA Optimization","2.0",r);$(i,14,C,55,24,"Inventory Value",I(l.totalInventoryValue),"Capital Locked in Spares"),$(i,75,C,55,24,"Annual Budget",I(l.totalAnnualSparesBudget),"Consumption + Holding"),$(i,136,C,55,24,"Critical Items",`${l.criticalSpares}`,"Must-Stock SKUs"),u+=35,n&&(u=R(i,u,`Analyst Notes: ${n}`)),b(i,d,r),M(i,`DCMOC_Maintenance_${e.name}_${new Date().toISOString().slice(0,10)}.pdf`)},G=async(e,t,o,a,r,i,s,d,C,m)=>{let{doc:g,autoTable:x}=await z(m),y=1;f(g,"Financial Feasibility\n& Revenue Analysis",`Investment Case for ${e.name}`,{client:"CFO / Investment Comm.",date:O()},m),g.addPage(),y++,T(g,"Financial & Revenue Parameters","Assumption Guidelines",m);let S=(e,t,o,l)=>{g.setFillColor(248,250,252),g.setDrawColor(226,232,240),g.roundedRect(e,t,85,10+8*l.length,2,2,"FD"),g.setFont("helvetica","bold"),g.setFontSize(9),g.setTextColor(...u),g.text(o,e+4,t+6);let a=t+12;return l.forEach(t=>{g.setFont("helvetica","normal"),g.setFontSize(8),g.setTextColor(...F),g.text(t.label,e+4,a),g.setFont("helvetica","bold"),g.setTextColor(...c),g.text(t.value,e+81,a,{align:"right"}),a+=8}),t+10+8*l.length+4},v=35;v=S(14,35,"Financial Analysis",[{label:"Revenue per kW/month",value:`$${a.revenuePerKwMonth}`},{label:"Discount Rate",value:`${(100*a.discountRate).toFixed(0)}%`},{label:"Project Life",value:`${a.projectLifeYears} yrs`},{label:"Rev. Escalation",value:`${(100*a.escalationRate).toFixed(0)}%`},{label:"OPEX Escalation",value:`${(100*a.opexEscalation).toFixed(1)}%`},{label:"Tax Rate",value:`${(100*a.taxRate).toFixed(0)}%`},{label:"Depreciation",value:`${a.depreciationYears} yrs`}]),v=S(14,v,"NRC (Non-Recurring Charges)",[{label:"Setup Fee",value:`$${r.nrcPerKw}/kW`},{label:"X-Connect Setup",value:I(r.nrcCrossConnect)},{label:"Custom Fit-out",value:I(r.nrcCustomFitout)}]);let $=35;$=S(105,35,"MRC (Monthly Recurring)",[{label:"MRC $/kW/mo",value:`$${r.mrcPerKwMonth}`},{label:"Escalation",value:`${(100*r.mrcEscalation).toFixed(0)}%/yr`},{label:"X-Connect MRC",value:`$${r.mrcCrossConnectMonthly}/mo`}]),$=S(105,$,"Contract Terms",[{label:"Lease Term",value:`${r.contractYears} yrs`},{label:"Take-or-Pay Floor",value:`${r.takeOrPayPct}%`}]),$=S(105,$,"Quick Summary",[{label:"CAPEX Investment",value:I(i)},{label:"Annual OPEX (est.)",value:I(s)},{label:"Annual Revenue (100%)",value:I(12*a.revenuePerKwMonth*d)},{label:"Break-even Occupancy",value:`${t.breakEvenOccupancy}%`},{label:"Total NRC",value:I(o.totalNRC)},{label:"TCV",value:I(o.contractValue)}]),b(g,y,m),g.addPage(),y++,T(g,"Financial Executive Summary","Key Investment & Revenue Metrics",m);let R=35,E=(e,t,o,l,a,n,r,i,s=F)=>{g.setFillColor(255,255,255),g.setDrawColor(226,232,240),g.roundedRect(e,t,o,l,2,2,"FD"),g.setFont("helvetica","medium"),g.setFontSize(8),g.setTextColor(...s),g.text(a,e+4,t+8),g.setFont("helvetica","bold"),g.setFontSize(16),g.setTextColor(...i),g.text(n,e+4,t+16),g.setFont("helvetica","normal"),g.setFontSize(7),g.setTextColor(...h),g.text(r,e+4,t+22)};if(E(14,35,42,26,"NPV (10yr)",I(t.npv),"Net Present Value",t.npv>0?[5,150,105]:[220,38,38],[15,23,42]),E(58,R,42,26,"IRR",`${t.irr.toFixed(1)}%`,t.irr>100*a.discountRate?"Exceeds hurdle":"Below hurdle",t.irr>10?[5,150,105]:[217,119,6],[15,23,42]),E(102,R,42,26,"Payback",`${t.paybackPeriodYears.toFixed(1)} yrs`,`Discounted: ${t.discountedPaybackYears} yrs`,c,[15,23,42]),E(146,R,42,26,"ROI",`${t.roiPercent.toFixed(0)}%`,`PI: ${t.profitabilityIndex.toFixed(2)}x`,t.roiPercent>0?[5,150,105]:[220,38,38],[15,23,42]),E(14,R+=30,42,26,"Total NRC",I(o.totalNRC),"One-time setup fees",[8,145,178],[8,145,178]),E(58,R,42,26,"Lifetime MRC",I(o.totalMRC_lifetime),`Over ${r.contractYears} years`,[5,150,105],[5,150,105]),E(102,R,42,26,"TCV",I(o.contractValue),"Total Contract Value",[79,70,229],[79,70,229]),E(146,R,42,26,"Effective $/kW/mo",`$${o.effectiveRate.toFixed(0)}`,"Blended rate",[217,119,6],[217,119,6]),R+=36,R=w(g,R,"Financial Verdict",t.npv>0?`Strong investment case. Positive NPV of ${I(t.npv)} indicates value creation above the discount rate. TCV is ${I(o.contractValue)}.`:`Caution advised. Negative NPV of ${I(t.npv)} suggests returns may not meet capital cost requirements. TCV is ${I(o.contractValue)}.`,t.npv>0?"success":"warning"),C?.cashflow||C?.waterfall||C?.mrc){if(R=p(g,R,90,{current:y}),T(g,"Visual Analysis","Generated Cashflow & Revenue Charts",m),R=35,C.cashflow){R=P(g,R,"Cumulative Cashflow Projection","1.0",m);try{let e=g.getImageProperties(C.cashflow),t=180*e.height/e.width;g.addImage(C.cashflow,"PNG",15,R,180,t),R+=t+10}catch(e){console.warn("Error adding cashflow image to PDF",e)}}if(C.waterfall){R=p(g,R,90,{current:y}),R=P(g,R,"Revenue Waterfall — NRC + MRC Breakdown","2.0",m);try{let e=g.getImageProperties(C.waterfall),t=180*e.height/e.width;g.addImage(C.waterfall,"PNG",15,R,180,t),R+=t+10}catch(e){console.warn("Error adding waterfall image to PDF",e)}}if(C.mrc){R=p(g,R,90,{current:y}),R=P(g,R,"MRC Growth Trajectory with Take-or-Pay Floor","3.0",m);try{let e=g.getImageProperties(C.mrc),t=180*e.height/e.width;g.addImage(C.mrc,"PNG",15,R,180,t)}catch(e){console.warn("Error adding MRC image to PDF",e)}}b(g,y,m),g.addPage(),y++,R=35}else R=p(g,R,90,{current:y}),R=P(g,R,"Cumulative Cashflow Projection","1.0",m),R=D(g,14,R,180,t.cashflows.map(e=>({label:`Y${e.year}`,value:e.cumulativeCashflow,color:e.cumulativeCashflow>=0?l:n})).slice(0,10),"Cumulative Cashflow Growth (First 10 Years)"),b(g,y,m),g.addPage(),y++,R=35;T(g,"Detailed Cashflow & Revenue","Year-by-Year Projection",m),x(g,{startY:R=35,head:[["Period","Revenue","OPEX","EBITDA","Net Income","Occ%","Billed kW","NRC","MRC/mo","MRC Yr","Total Rev","Cum. CF"]],body:t.cashflows.map((e,t)=>{let l=o.yearDetails[t];return[`Y${e.year}`,I(e.revenue),I(-e.opex),I(e.ebitda),I(e.netIncome),l?`${(100*l.occupancy).toFixed(0)}%`:"—",l?A(l.billedKw):"—",l&&l.nrc>0?I(l.nrc):"—",l?I(l.mrcMonthly):"—",l?I(l.mrcAnnual):"—",l?I(l.totalRevenue):I(e.revenue),I(e.cumulativeCashflow)]}),theme:"striped",headStyles:{fillColor:(m?.primaryColor,c)},margin:{left:14,right:14},styles:{fontSize:7,cellPadding:1},columnStyles:{0:{fontStyle:"bold"},1:{halign:"right",textColor:[5,150,105]},2:{halign:"right",textColor:[220,38,38]},3:{halign:"right",fontStyle:"bold"},4:{halign:"right"},5:{halign:"right"},6:{halign:"right"},7:{halign:"right",textColor:[8,145,178]},8:{halign:"right",textColor:[5,150,105]},9:{halign:"right",textColor:[5,150,105]},10:{halign:"right",fontStyle:"bold"},11:{halign:"right",fontStyle:"bold"}}}),b(g,y,m),M(g,`DCMOC_Financials_${e.name}_${new Date().toISOString().slice(0,10)}.pdf`)},B=async(e,t,o,l)=>{let{doc:a}=await z(l),i=1;f(a,"Risk & Compliance\nAssessment",`Facility Analysis for ${e.name}`,{client:"Risk Management",date:O()},l),a.addPage(),i++,T(a,"Risk Matrix Executive Summary",`Normalized Score: ${t.normalizedScore}/100`,l);let c=35;$(a,14,35,55,24,"Total Risk Score",`${t.totalScore}`,"Raw unweighted score"),$(a,75,c,55,24,"SLA Breach Prob.",`${(100*t.slaBreachProbability).toFixed(1)}%`,"Annually"),$(a,136,c,55,24,"Identified Risks",`${t.topRisks.length}`,"Active threats"),c+=35,c=R(a,c,o),c=p(a,c,80,{current:i}),c=P(a,c,"Primary Risk Vectors","1.0",l),c=D(a,14,c,180,t.topRisks.slice(0,5).map(e=>({label:e.title,value:e.score,color:e.score>10?n:e.score>5?r:s})),"Top Matrix Scores"),b(a,i,l),M(a,`DCMOC_RiskProfile_${e.name}_${new Date().toISOString().slice(0,10)}.pdf`)},U=async(e,t,o,l)=>{var i;let s,d,u,C,F,{doc:h,autoTable:m}=await z(l),g=1;f(h,"Carbon & ESG\nFootprint Report",`Sustainability Profile for ${e.name}`,{client:"Sustainability Office",date:O()},l),h.addPage(),g++,T(h,"ESG Executive Summary",`Rating: ${t.efficiencyRating}`,l);let y=35;$(h,14,35,42,24,"Emissions",`${A(t.annualEmissionsTonCO2)} tCO₂`,"Scope 1+2+3"),$(h,60,y,42,24,"Effective PUE",`${t.pueEfficiency.toFixed(2)}`,"Design target"),$(h,106,y,42,24,"Tax Exposure",A(t.carbonTaxExposureUSD),"Potential liability"),$(h,152,y,42,24,"Renewable",`${t.renewableReductionPct}%`,"Offset percentage"),y+=35,y=R(h,y,o),y=p(h,y,80,{current:g}),y=P(h,y,"Emissions Breakdown","1.0",l);let S=[{label:"Scope 1 (Direct)",value:t.scope1,color:n},{label:"Scope 2 (Grid)",value:t.scope2,color:r},{label:"Scope 3 (Supply)",value:t.scope3,color:a}];i=y,h.setFontSize(10),h.setFont("helvetica","bold"),h.setTextColor(...c),h.text("GHG Protocol Scopes",14,i+8),s=S.reduce((e,t)=>e+t.value,0),d=14,u=i+15,S.forEach(e=>{let t=e.value/s*180;t>0&&(h.setFillColor(...e.color),h.rect(d,u,t,10,"F"),d+=t)}),C=u+18,F=0,S.forEach(e=>{F>2&&(F=0,C+=8);let t=14+60*F;h.setFillColor(...e.color),h.circle(t+2,C-1,2,"F"),h.setFontSize(7.5),h.setFont("helvetica","normal"),h.setTextColor(...x);let o=(e.value/s*100).toFixed(1),l=e.value>=1e6?`$${(e.value/1e6).toFixed(2)}M`:e.value>=1e3?`$${(e.value/1e3).toFixed(1)}k`:`$${e.value.toFixed(0)}`;h.text(`${e.label}: ${l} (${o}%)`,t+6,C),F++}),y=p(h,y=C+10,80,{current:g}),y=P(h,y,"Carbon Reduction Investment Scenarios","2.0",l),m(h,{startY:y,head:[["Initiative","Investment","CO₂ Abatement","Est. Payback"]],body:t.reductionScenarios.map(e=>[e.name,I(e.investmentUSD),`${Math.round(e.annualSavingsTonCO2)} tCO₂/yr`,e.paybackYears>0?`${e.paybackYears} yrs`:"Immediate/PPA"]),theme:"striped",headStyles:{fillColor:(l?.primaryColor,c)},margin:{left:14,right:14}}),b(h,g,l),M(h,`DCMOC_CarbonESG_${e.name}_${new Date().toISOString().slice(0,10)}.pdf`)},V=async(e,a,n,r)=>{var i,s,u,C,F,h;let m,g,y,{doc:S,autoTable:v}=await z(n),{inputs:w,capex:I,financial:k,staffing:N,maintenance:L,risk:Y,insights:G}=a,B=1;f(S,"Master Operational Report\n& Exact Feasibility Study",`M&O Assessment for ${e.name}`,{client:"Executive Board",date:O(),version:"1.0"},n),S.addPage(),B++,T(S,"Table of Contents","Master Document Structure",n);let U=35;U=((e,o,l,a="Table of Contents")=>(e.setFontSize(16),e.setFont("helvetica","bold"),e.setTextColor(...c),e.text(a,14,o),(0,t.default)(e,{startY:o+10,head:[["Reason","Source","Validation","Pages"]],body:l.map(e=>[e.reason,e.source,e.validation,e.pages]),theme:"grid",headStyles:{fillColor:c,textColor:255,fontSize:9,fontStyle:"bold",halign:"center"},bodyStyles:{textColor:x,fontSize:8,valign:"middle"},columnStyles:{0:{cellWidth:50},1:{cellWidth:50},2:{cellWidth:60},3:{cellWidth:20,halign:"center"}},margin:{left:14,right:14}}),e.lastAutoTable.finalY+15))(S,35,[{reason:"High-Level Overview",source:"Simulation Engine",validation:"Exec Gen",pages:"3-4"},{reason:"Investment Breakdown",source:"Capex Engine",validation:"Cost Capitulation",pages:"5-6"},{reason:"TCO & Cashflow",source:"Financial Engine",validation:"NPV/IRR Formula",pages:"7-8"},{reason:"Operational Strategy",source:"Shift & Roster Engine",validation:"Cost Modeling",pages:"9-10"},{reason:"Predictive vs SFG20",source:"Maintenance Engine",validation:"Life Cycle Cost",pages:"11-12"},{reason:"Security & Reliability",source:"Risk Engine",validation:"Matrix Model",pages:"13-14"}],"Sections inside this Data Center Report"),b(S,B,n),S.addPage(),B++,T(S,"Executive Summary","C-Suite Narrative",n);let V=U=35;if(V=P(S,V,"CAPEX Assessment","1.0",n),V=R(S,V,(0,E.generateCapexSectionNarrative)(I,w.tierLevel,e.name))+10,V=P(S,V,"Return on Investment & Cashflow","1.1",n),V=R(S,V,(0,E.generateTCONarrative)(k))+10,N){V=P(S,V,"Cost Waterfall Dynamics","1.2",n);let e=k.cashflows.reduce((e,t)=>e+t.opex,0);V=R(S,V,(0,E.generateCostWaterfallNarrative)(I,k,e))+10}if(V=p(S,V,60,{current:B}),V=P(S,V,"Maintenance & Risk Stance","1.3",n),V=R(S,V,(0,E.generateMaintenanceNarrative)(L?.strategy,L?.sla,L?.spares))+5,V=R(S,V,(0,E.generateRiskNarrative)(Y?.aggregation)),b(S,B,n),S.addPage(),B++,T(S,"Capital Expenditure Detail","Cost Capitulation Matrix",n),i=U=35,s=I.costs,u=I.softCosts,C=I.contingency,F=I.fomTotal,h=I.total,S.setFontSize(12),S.setFont("helvetica","bold"),S.setTextColor(...c),S.text("Cost Capitulation",14,i),m=e=>`$${(e/1e6).toFixed(2)}M`,g=[],y=0,Object.entries(s).forEach(([e,t])=>{g.push([{content:e.toUpperCase(),styles:{fontStyle:"normal"}},m(t),`${(t/h*100).toFixed(1)}%`]),y+=t}),g.push([{content:"SUBTOTAL (HARD COSTS)",styles:{fontStyle:"bold",fillColor:[241,245,249]}},{content:m(y),styles:{fontStyle:"bold",fillColor:[241,245,249]}},{content:`${(y/h*100).toFixed(1)}%`,styles:{fontStyle:"bold",fillColor:[241,245,249]}}]),u.design,u.pm,g.push([{content:"Design & Engineering Fee",styles:{fontStyle:"normal"}},m(u.design||0),`${((u.design||0)/h*100).toFixed(1)}%`]),g.push([{content:"Project Management Fee",styles:{fontStyle:"normal"}},m(u.pm||0),`${((u.pm||0)/h*100).toFixed(1)}%`]),g.push([{content:"Construction Contingency",styles:{fontStyle:"normal"}},m(C),`${(C/h*100).toFixed(1)}%`]),F>0&&g.push([{content:"First of a Kind (FOM) Upgrades",styles:{fontStyle:"normal"}},m(F),`${(F/h*100).toFixed(1)}%`]),g.push([{content:"TOTAL ESTIMATED CAPEX",styles:{fontStyle:"bold",fillColor:l,textColor:255}},{content:m(h),styles:{fontStyle:"bold",fillColor:l,textColor:255}},{content:"100.0%",styles:{fontStyle:"bold",fillColor:l,textColor:255}}]),(0,t.default)(S,{startY:i+5,head:[["Cost Code / Category","Estimated Amount (USD)","% of Total"]],body:g,theme:"grid",headStyles:{fillColor:d,textColor:255,fontSize:9,fontStyle:"bold"},bodyStyles:{textColor:x,fontSize:8},columnStyles:{0:{cellWidth:90},1:{cellWidth:50,halign:"right"},2:{cellWidth:30,halign:"right"}},margin:{left:14,right:14}}),U=S.lastAutoTable.finalY+15,b(S,B,n),S.addPage(),B++,T(S,"Operational Expenditure","5-Year Tabular View",n),U=((e,o,l,a)=>{e.setFontSize(12),e.setFont("helvetica","bold"),e.setTextColor(...c),e.text("5-Year Total Cost of Ownership (TCO & Cashflow)",14,o);let n=e=>`$${(e/1e6).toFixed(2)}M`,r=l.slice(0,5);for(;r.length<5;)r.push({revenue:0,opex:0,ebitda:0,freeCashflow:0,cumulativeCashflow:0});let i=["Revenue","-",n(r[0].revenue),n(r[1].revenue),n(r[2].revenue),n(r[3].revenue),n(r[4].revenue)],s=["OPEX (Operating Expenses)","-",n(r[0].opex),n(r[1].opex),n(r[2].opex),n(r[3].opex),n(r[4].opex)],u=["CAPEX (Capital Invest)",`(${n(a)})`,"-","-","-","-","-"],C=[{content:"Free Cash Flow (FCF)",styles:{fontStyle:"bold"}},{content:`(${n(a)})`,styles:{fontStyle:"bold",textColor:[220,38,38]}}];r.forEach(e=>{C.push({content:n(e.freeCashflow),styles:{fontStyle:"bold",textColor:e.freeCashflow<0?[220,38,38]:[22,163,74]}})});let F=[{content:"Cumulative Cash Flow",styles:{fontStyle:"bold",fillColor:[241,245,249]}},{content:`(${n(a)})`,styles:{fontStyle:"bold",fillColor:[241,245,249],textColor:[220,38,38]}}];r.forEach(e=>{F.push({content:n(e.cumulativeCashflow),styles:{fontStyle:"bold",fillColor:[241,245,249],textColor:e.cumulativeCashflow<0?[220,38,38]:[22,163,74]}})});let h=[i,s,u,C,F];return(0,t.default)(e,{startY:o+5,head:[["Metric","Year 0","Year 1","Year 2","Year 3","Year 4","Year 5"]],body:h,theme:"grid",headStyles:{fillColor:d,textColor:255,fontSize:8,fontStyle:"bold",halign:"center"},bodyStyles:{textColor:x,fontSize:8,halign:"right"},columnStyles:{0:{cellWidth:45,halign:"left"}},margin:{left:14,right:14}}),e.lastAutoTable.finalY+15})(S,U=35,k.cashflows,I.total),b(S,B,n),S.addPage(),B++,r?.tornado||r?.sankey){if(T(S,"Visual Analysis","Generated Charts",n),U=35,r.sankey){U=P(S,U,"Cost Flow Analysis (Sankey)","3.0",n);try{let e=S.getImageProperties(r.sankey),t=180*e.height/e.width;S.addImage(r.sankey,"PNG",15,U,180,t),U+=t+10}catch(e){console.warn("Error adding Sankey image to PDF",e)}}if(r.tornado){U=p(S,U,100,{current:B}),U=P(S,U,"Sensitivity Analysis (Tornado)","4.0",n);try{let e=S.getImageProperties(r.tornado),t=180*e.height/e.width;S.addImage(r.tornado,"PNG",15,U,180,t)}catch(e){console.warn("Error adding Tornado image to PDF",e)}}b(S,B,n),S.addPage(),B++}if(T(S,"Shift & Roster Strategy","Detailed Personnel Plan",n),U=35,N.results){let e=N.results.reduce((e,t)=>e+t.headcount,0),t=N.results.reduce((e,t)=>e+t.monthlyCost,0);$(S,14,U,55,24,"Total Headcount",`${e}`,"FTEs across all shifts"),$(S,75,U,55,24,"Monthly OPEX",A(t),"Gross Salary + Burden"),U+=35,U=D(S,14,U,180,N.results.map(e=>({label:e.role,value:e.monthlyCost,color:e.role.includes("Engineer")?l:o})),"Monthly Cost Distribution by Role")}b(S,B,n),M(S,`DCMOC_MasterReport_${e.name}_${new Date().toISOString().slice(0,10)}.pdf`)};e.s(["generateCapexPDF",0,L,"generateCarbonPDF",0,U,"generateDetailedPDF",0,N,"generateFinancialPDF",0,G,"generateMaintenancePDF",0,Y,"generateMasterReportPDF",0,V,"generateRiskPDF",0,B,"generateSimulationPDF",0,N,"generateStaffingPDF",0,k],32737)}]);