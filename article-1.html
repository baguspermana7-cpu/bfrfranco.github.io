<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-GED7FX8RTV"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-GED7FX8RTV');
    </script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <!-- SEO Meta Tags -->
    <title>When Nothing Happens, Engineering Is Working | Operations Journal #1</title>
    <meta name="description" content="Proactive engineering and Safety-II theory applied to data center operations. Interactive maturity calculator. 9,000-word flagship journal entry.">
    <meta name="keywords" content="Data Center Operations, Proactive Engineering, Safety-II, Hollnagel, Operational Maturity, Resilience Engineering, Incident Prevention, MTBF, MTTR, PUE, Critical Infrastructure, Condition Monitoring, Predictive Maintenance, CMMS, DCIM, BMS, Operations Journal">
    <meta name="author" content="Bagus Dwi Permana">
    <meta name="robots" content="index, follow">
    <meta name="theme-color" content="#1e3a5f">
    <link rel="canonical" href="https://resistancezero.com/article-1.html">

    <link rel="alternate" hreflang="en" href="https://resistancezero.com/article-1.html">

    <!-- Resource Hints -->
    <link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin>
    <link rel="preconnect" href="https://www.googletagmanager.com" crossorigin>
    <link rel="dns-prefetch" href="https://cdn.jsdelivr.net">
    <link rel="dns-prefetch" href="https://www.googletagmanager.com">
    <!-- Open Graph Meta Tags -->
    <meta property="og:type" content="article">
    <meta property="og:url" content="https://resistancezero.com/article-1.html">
    <meta property="og:title" content="When Nothing Happens, Engineering Is Working">
    <meta property="og:description" content="In critical infrastructure, success is defined by the absence of events. This journal documents the work required to make that absence possible. Flagship article exploring Safety-II theory, operational maturity, and proactive engineering with interactive calculator.">
    <meta property="og:image" content="https://resistancezero.com/assets/article-1-cover.jpg">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:image:alt" content="When Nothing Happens, Engineering Is Working - Operations Journal">
    <meta property="og:locale" content="en_US">
    <meta property="og:site_name" content="Bagus Dwi Permana Portfolio">
    <meta property="article:author" content="Bagus Dwi Permana">
    <meta property="article:published_time" content="2025-12-06T00:00:00Z">
    <meta property="article:modified_time" content="2026-02-17T00:00:00Z">
    <meta property="article:section" content="Engineering Journal">
    <meta property="article:tag" content="Critical Infrastructure">
    <meta property="article:tag" content="Proactive Engineering">
    <meta property="article:tag" content="Safety-II">
    <meta property="article:tag" content="Operational Maturity">

    <!-- Twitter Card Meta Tags -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@BagusDPermana">
    <meta name="twitter:creator" content="@BagusDPermana">
    <meta name="twitter:title" content="When Nothing Happens, Engineering Is Working">
    <meta name="twitter:description" content="In critical infrastructure, success is defined by the absence of events. Flagship article on proactive engineering and operational maturity.">
    <meta name="twitter:image" content="https://resistancezero.com/assets/article-1-cover.jpg">
    <meta name="twitter:image:alt" content="When Nothing Happens Engineering Is Working - Operations Journal">

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
    <link rel="icon" type="image/png" href="assets/Favicon.png">
    <link rel="apple-touch-icon" href="assets/Favicon.png">
    <link rel="stylesheet" href="styles.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="preload" as="image" href="assets/article-1-cover.jpg">

    <style>
        /* Dimension Card Interface */
        .dim-cards-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:0.85rem;margin-bottom:1.5rem}
        .dim-card{background:rgba(15,23,42,0.6);border:1px solid rgba(255,255,255,0.08);border-radius:12px;padding:1rem 1.1rem;transition:border-color 0.3s,box-shadow 0.3s}
        .dim-card:hover{border-color:rgba(96,165,250,0.25);box-shadow:0 0 12px rgba(96,165,250,0.06)}
        .dim-card-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:0.4rem}
        .dim-card-name{font-weight:600;color:#e2e8f0;font-size:0.88rem}
        .dim-card-weight{background:rgba(59,130,246,0.15);color:#60a5fa;padding:2px 8px;border-radius:20px;font-size:0.68rem;font-weight:600;font-family:'JetBrains Mono',monospace}
        .dim-card-desc{color:#94a3b8;font-size:0.72rem;line-height:1.4;margin-bottom:0.65rem}
        .dim-score-btns{display:flex;gap:5px;margin-bottom:0.5rem}
        .dim-score-btn{flex:1;padding:7px 0;border:1px solid rgba(255,255,255,0.1);border-radius:8px;background:rgba(255,255,255,0.03);color:#94a3b8;font-size:0.82rem;font-weight:600;cursor:pointer;transition:all 0.2s;text-align:center;font-family:'JetBrains Mono',monospace}
        .dim-score-btn:hover{border-color:rgba(96,165,250,0.4);background:rgba(96,165,250,0.08);color:#e2e8f0}
        .dim-score-btn.active{border-color:#3b82f6;background:rgba(59,130,246,0.18);color:#60a5fa;box-shadow:0 0 8px rgba(59,130,246,0.15)}
        .dim-level-def{font-size:0.7rem;color:#94a3b8;line-height:1.4;padding:6px 8px;background:rgba(255,255,255,0.03);border-radius:6px;border-left:2px solid #3b82f6;min-height:1.8em;transition:all 0.25s}
        /* ISO 55001 Roadmap */
        .iso-roadmap-section{margin:2rem 0 0}
        .iso-stages{display:flex;gap:6px;margin-top:0.75rem}
        .iso-stage{flex:1;padding:0.75rem 0.5rem;background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.06);border-radius:10px;text-align:center;transition:all 0.3s}
        .iso-stage.active{border-color:#3b82f6;background:rgba(59,130,246,0.12);box-shadow:0 0 12px rgba(59,130,246,0.12)}
        .iso-stage-num{font-size:1.1rem;font-weight:800;color:#475569;margin-bottom:2px;font-family:'JetBrains Mono',monospace}
        .iso-stage.active .iso-stage-num{color:#60a5fa}
        .iso-stage-label{font-size:0.68rem;color:#64748b;font-weight:600;text-transform:uppercase;letter-spacing:0.5px}
        .iso-stage.active .iso-stage-label{color:#93c5fd}
        .iso-stage-clauses{font-size:0.62rem;color:#475569;margin-top:4px;line-height:1.3}
        .iso-stage.active .iso-stage-clauses{color:#94a3b8}
        .iso-stage-connector{width:24px;display:flex;align-items:center;justify-content:center;color:#334155;font-size:0.8rem;flex-shrink:0}
        .iso-mapping-note{font-size:0.65rem;color:#64748b;margin-top:8px;font-style:italic}
        @media(max-width:768px){.dim-cards-grid{grid-template-columns:1fr}.iso-stages{flex-direction:column}.iso-stage-connector{transform:rotate(90deg);width:auto;height:20px}}
    </style>

    <!-- Structured Data - TechnicalArticle -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "TechnicalArticle",
        "headline": "When Nothing Happens, Engineering Is Working",
        "description": "In critical infrastructure, success is defined by the absence of events. A comprehensive exploration of proactive engineering, Safety-II theory, operational maturity, and the invisible work that prevents data center incidents.",
        "image": "https://resistancezero.com/assets/article-1-cover.jpg",
        "author": {
            "@type": "Person",
            "name": "Bagus Dwi Permana",
            "jobTitle": "Engineering Operations Manager",
            "url": "https://resistancezero.com/"
        },
        "publisher": {
            "@type": "Person",
            "name": "Bagus Dwi Permana"
        },
        "datePublished": "2025-12-06",
        "dateModified": "2025-12-06",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https://resistancezero.com/article-1.html"
        },
        "articleSection": "Engineering Journal",
        "keywords": ["Critical Infrastructure", "Proactive Engineering", "Safety-II", "Operational Maturity", "Data Center", "Resilience Engineering"],
        "wordCount": 9000,
        "inLanguage": "en"
    }
    </script>

    <!-- Structured Data - BreadcrumbList -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "BreadcrumbList",
        "itemListElement": [
            {
                "@type": "ListItem",
                "position": 1,
                "name": "Home",
                "item": "https://resistancezero.com/"
            },
            {
                "@type": "ListItem",
                "position": 2,
                "name": "Engineering Journal",
                "item": "https://resistancezero.com/articles.html"
            },
            {
                "@type": "ListItem",
                "position": 3,
                "name": "When Nothing Happens, Engineering Is Working"
            }
        ]
    }
    </script>

    <!-- Structured Data - FAQPage -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "FAQPage",
        "mainEntity": [
            {
                "@type": "Question",
                "name": "What is proactive engineering in data center operations?",
                "acceptedAnswer": {
                    "@type": "Answer",
                    "text": "Proactive engineering is an operational philosophy where success is measured by the absence of incidents. It encompasses predictive maintenance, condition monitoring, design authority governance, and Safety-II thinking — focusing on understanding why things go right rather than only investigating failures. In mature data centers, proactive engineering prevents 85-95% of potential incidents before they occur."
                }
            },
            {
                "@type": "Question",
                "name": "How do you measure operational maturity in a data center?",
                "acceptedAnswer": {
                    "@type": "Answer",
                    "text": "Operational maturity is measured across multiple dimensions: maintenance compliance rates (target >97%), mean time between failures (MTBF), alarm-to-incident ratios, change management success rates, and the ratio of planned vs unplanned work. A mature facility has >80% planned work, <5% repeat incidents, and documented operating procedures for all critical systems."
                }
            },
            {
                "@type": "Question",
                "name": "What is Safety-II theory and how does it apply to data centers?",
                "acceptedAnswer": {
                    "@type": "Answer",
                    "text": "Safety-II is a paradigm shift from traditional safety management. Instead of only studying failures (Safety-I), Safety-II focuses on understanding how work succeeds despite varying conditions. In data centers, this means studying how operators adapt to unexpected situations, how systems maintain performance under stress, and building resilience through understanding normal operational variability."
                }
            }
        ]
    }
    </script>

    <style>
        :root {
            --primary-blue: #1e3a5f;
            --accent-blue: #3b82f6;
            --accent-blue-light: #60a5fa;
            --accent-cyan: #06b6d4;
            --accent-amber: #f59e0b;
            --accent-emerald: #10b981;
            --accent-red: #ef4444;
            --bg-dark: #0f172a;
            --bg-light: #f8fafc;
            --text-primary: #1e293b;
            --text-secondary: #64748b;
        }

        /* Hero Section */
        .article-hero {
            background: linear-gradient(135deg, #0b1220 0%, #1e3a5f 50%, #1e40af 100%);
            padding: 7rem 2rem 3.5rem;
            color: #fff;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .article-hero::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            background:
                radial-gradient(circle at 20% 80%, rgba(59, 130, 246, 0.15) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(96, 165, 250, 0.1) 0%, transparent 50%);
            z-index: 0;
        }

        .article-hero::after {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            background: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M30 5 L32 15 L42 17 L32 19 L30 29 L28 19 L18 17 L28 15 Z' fill='%233b82f6' fill-opacity='0.03'/%3E%3C/svg%3E");
            z-index: 0;
        }

        .article-hero > * { position: relative; z-index: 1; }
        .article-hero .container { max-width: 1000px; margin: 0 auto; }

        .article-badge {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            background: rgba(59, 130, 246, 0.2);
            color: #60a5fa;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
            margin-bottom: 1.5rem;
            border: 1px solid rgba(59, 130, 246, 0.3);
        }

        .article-title {
            font-size: clamp(1.6rem, 3.2vw, 2.35rem);
            font-weight: 800;
            margin-bottom: 1.25rem;
            line-height: 1.25;
            color: #fff;
            letter-spacing: -0.01em;
        }

        .article-subtitle {
            font-size: clamp(0.95rem, 1.6vw, 1.15rem);
            color: #94a3b8;
            max-width: 800px;
            margin: 0 auto 2rem;
            line-height: 1.7;
        }

        .article-meta {
            display: flex;
            justify-content: center;
            gap: 2rem;
            flex-wrap: wrap;
            color: #94a3b8;
            font-size: 0.9rem;
        }

        .article-meta-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        /* Table of Contents */
        .toc-section {
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            padding: 3rem 2rem;
            border-bottom: 1px solid #e2e8f0;
        }

        .toc-container {
            max-width: 900px;
            margin: 0 auto;
        }

        .toc-title {
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--primary-blue);
            margin-bottom: 1.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .toc-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 0.625rem;
        }

        .toc-item {
            background: #fff;
            padding: 0.75rem 1rem;
            border-radius: 10px;
            border-left: 4px solid var(--accent-blue);
            transition: all 0.2s ease;
            text-decoration: none;
            color: var(--text-primary);
        }

        .toc-item:hover {
            transform: translateX(4px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        .toc-item-number {
            font-size: 0.75rem;
            color: var(--accent-blue);
            font-weight: 700;
            margin-bottom: 0.25rem;
        }

        .toc-item-title {
            font-weight: 600;
            font-size: 0.88rem;
        }

        /* TOC Calculator Highlight */
        .toc-item.toc-calculator {
            background: linear-gradient(135deg, #eff6ff 0%, #dbeafe 100%);
            border-left-color: #3b82f6;
            border-left-width: 5px;
        }
        .toc-item.toc-calculator .toc-item-number { display: flex; align-items: center; gap: 6px; }
        .toc-item.toc-calculator .toc-calc-badge {
            font-size: 0.6rem; background: #3b82f6; color: #fff; padding: 1px 6px; border-radius: 4px; font-weight: 700; letter-spacing: 0.5px;
        }
        [data-theme="dark"] .toc-item.toc-calculator {
            background: linear-gradient(135deg, rgba(59,130,246,0.15) 0%, rgba(59,130,246,0.08) 100%);
        }

        /* Article Content */
        .article-content {
            padding: 4rem 2rem;
            background: #fff;
        }

        .article-content .container {
            max-width: 900px;
            margin: 0 auto;
        }

        .article-body {
            font-size: 0.95rem;
            line-height: 1.7;
            color: var(--text-primary);
        }

        .article-body p {
            margin-bottom: 1rem;
        }

        .article-body h2 {
            font-size: 1.4rem;
            color: var(--primary-blue);
            margin: 2rem 0 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 3px solid var(--accent-blue);
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .article-body h2 .section-number {
            background: var(--accent-blue);
            color: #fff;
            width: 32px;
            height: 32px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.9rem;
            font-weight: 700;
            flex-shrink: 0;
        }

        .article-body h3 {
            font-size: 1.1rem;
            color: #334155;
            margin: 1.5rem 0 0.5rem;
        }

        .article-body h4 {
            font-size: 0.9rem;
            color: #475569;
            margin: 1rem 0 0.5rem;
        }

        .article-body ul, .article-body ol {
            margin: 1rem 0;
            padding-left: 1.5rem;
        }

        .article-body li {
            margin-bottom: 0.35rem;
            font-size: 0.9rem;
        }

        .article-body blockquote {
            background: linear-gradient(135deg, #eff6ff 0%, #dbeafe 100%);
            border-left: 4px solid var(--accent-blue);
            padding: 1.5rem 2rem;
            margin: 1.5rem 0;
            border-radius: 0 12px 12px 0;
            font-style: italic;
            color: #1e40af;
        }

        /* Inline Citations */
        .cite {
            color: var(--accent-blue);
            font-size: 0.75em;
            vertical-align: super;
            font-weight: 600;
            text-decoration: none;
            padding: 0 2px;
        }
        .cite:hover { color: #1d4ed8; text-decoration: underline; }

        /* Tooltips */
        .tooltip {
            position: relative;
            border-bottom: 1px dashed var(--accent-blue);
            cursor: help;
            font-weight: 500;
        }
        .tooltip::after {
            content: attr(data-tip);
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            background: #1e293b;
            color: #e2e8f0;
            padding: 0.5rem 0.75rem;
            border-radius: 8px;
            font-size: 0.75rem;
            font-weight: 400;
            font-style: normal;
            white-space: nowrap;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.2s ease;
            z-index: 100;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
        }
        .tooltip:hover::after { opacity: 1; }

        /* Data Tables */
        .data-table-wrapper {
            overflow-x: auto;
            margin: 1.5rem 0;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.08);
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.85rem;
        }

        .data-table thead {
            background: linear-gradient(135deg, var(--primary-blue) 0%, #1e40af 100%);
            color: #fff;
        }

        .data-table th {
            padding: 0.875rem 1rem;
            text-align: left;
            font-weight: 600;
            white-space: nowrap;
        }

        .data-table td {
            padding: 0.75rem 1rem;
            border-bottom: 1px solid #e2e8f0;
        }

        .data-table tbody tr:hover {
            background: #f8fafc;
        }
        [data-theme="dark"] .data-table tbody tr:hover {
            background: rgba(59,130,246,0.12);
        }

        .data-table tbody tr:last-child td {
            border-bottom: none;
        }

        /* Info Boxes */
        .info-box {
            background: linear-gradient(135deg, #eff6ff 0%, #dbeafe 100%);
            border-left: 4px solid var(--accent-blue);
            padding: 1.5rem;
            border-radius: 0 12px 12px 0;
            margin: 1.5rem 0;
        }

        .info-box.warning {
            background: linear-gradient(135deg, #fffbeb 0%, #fef3c7 100%);
            border-left-color: var(--accent-amber);
        }

        .info-box.critical {
            background: linear-gradient(135deg, #fef2f2 0%, #fecaca 100%);
            border-left-color: var(--accent-red);
        }

        .info-box.success {
            background: linear-gradient(135deg, #ecfdf5 0%, #d1fae5 100%);
            border-left-color: var(--accent-emerald);
        }

        .info-box-title {
            font-weight: 700;
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        /* Framework Cards */
        .framework-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1.25rem;
            margin: 2rem 0;
        }

        .framework-card {
            background: #fff;
            border-radius: 16px;
            padding: 1.5rem;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
            border: 1px solid #e2e8f0;
            position: relative;
            overflow: hidden;
            transition: all 0.3s ease;
        }

        .framework-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 30px rgba(0,0,0,0.12);
        }

        .framework-card::before {
            content: '';
            position: absolute;
            top: 0; left: 0;
            width: 4px; height: 100%;
            background: linear-gradient(180deg, var(--accent-blue) 0%, #2563eb 100%);
        }

        .framework-card-number {
            position: absolute;
            top: 0.75rem; right: 1rem;
            font-size: 2rem;
            font-weight: 800;
            color: rgba(59, 130, 246, 0.12);
            line-height: 1;
        }

        .framework-card-icon {
            width: 40px;
            height: 40px;
            background: rgba(59, 130, 246, 0.1);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 0.75rem;
        }

        .framework-card-title {
            font-weight: 700;
            font-size: 0.95rem;
            color: var(--text-primary);
            margin-bottom: 0.5rem;
        }

        .framework-card-desc {
            font-size: 0.85rem;
            color: var(--text-secondary);
            line-height: 1.6;
        }

        /* Comparison Cards */
        .comparison-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
            margin: 2rem 0;
        }

        .comparison-card {
            background: #fff;
            border-radius: 16px;
            padding: 1.5rem;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
            border: 1px solid #e2e8f0;
        }

        .comparison-card-header {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            margin-bottom: 1rem;
            font-weight: 700;
            font-size: 1rem;
            color: var(--text-primary);
        }

        .comparison-card-icon {
            width: 42px;
            height: 42px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.25rem;
        }

        /* Formula Box */
        .formula-box {
            background: linear-gradient(135deg, #eff6ff 0%, #dbeafe 100%);
            border: 2px solid #93c5fd;
            padding: 1.5rem;
            border-radius: 12px;
            margin: 1.5rem 0;
            font-family: 'JetBrains Mono', monospace;
        }

        .formula-box-title {
            font-weight: 700;
            color: #1d4ed8;
            margin-bottom: 0.75rem;
            font-family: 'Inter', sans-serif;
        }

        /* Maturity Level Badges */
        .maturity-badge {
            display: inline-flex;
            align-items: center;
            gap: 0.35rem;
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .maturity-badge.reactive { background: #fef2f2; color: #dc2626; }
        .maturity-badge.preventive { background: #fff7ed; color: #ea580c; }
        .maturity-badge.predictive { background: #fffbeb; color: #d97706; }
        .maturity-badge.proactive { background: #ecfdf5; color: #059669; }
        .maturity-badge.generative { background: #eff6ff; color: #2563eb; }

        /* Calculator Section */
        .calculator-section {
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
            padding: 3rem 2rem;
            border-radius: 20px;
            margin: 3rem 0;
            color: #fff;
        }

        .calculator-title {
            font-size: 1.5rem;
            font-weight: 800;
            margin-bottom: 0.5rem;
            text-align: center;
        }

        .calculator-subtitle {
            color: #94a3b8;
            text-align: center;
            margin-bottom: 2rem;
            font-size: 0.9rem;
        }

        .calc-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.25rem;
            margin-bottom: 2rem;
        }

        .calc-input-group {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .calc-label {
            font-size: 0.8rem;
            color: #94a3b8;
            font-weight: 500;
        }

        .calc-select {
            background: rgba(255,255,255,0.1);
            border: 1px solid rgba(255,255,255,0.2);
            border-radius: 10px;
            padding: 0.75rem 1rem;
            color: #fff;
            font-size: 0.85rem;
            font-weight: 600;
            transition: all 0.2s ease;
            cursor: pointer;
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 24 24' fill='none' stroke='%2394a3b8' stroke-width='2'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 0.75rem center;
        }

        .calc-select option {
            background: #1e293b;
            color: #fff;
        }

        .calc-select:focus {
            outline: none;
            border-color: var(--accent-blue);
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.2);
        }

        .calc-results {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 1rem;
            background: rgba(255,255,255,0.05);
            border-radius: 16px;
            padding: 1.5rem;
            margin-bottom: 2rem;
        }

        .calc-result-item {
            text-align: center;
            padding: 0.75rem;
        }

        .calc-result-value {
            font-size: 1.75rem;
            font-weight: 800;
            color: var(--accent-blue-light);
        }

        .calc-result-label {
            font-size: 0.75rem;
            color: #94a3b8;
            margin-top: 0.25rem;
        }

        /* Radar Chart Container */
        .radar-chart-container {
            display: flex;
            justify-content: center;
            margin: 1.5rem 0;
        }

        .radar-chart-container canvas {
            max-width: 400px;
            width: 100%;
            aspect-ratio: 1;
        }

        /* Executive Summary Cards */
        .exec-cards {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 0.75rem;
            margin-bottom: 1rem;
        }
        .exec-card {
            border-radius: 12px;
            padding: 14px 12px;
            text-align: center;
        }
        .exec-card-label,
        .exec-card-value,
        .exec-card-sub {
            background: none !important;
            color: inherit;
        }
        .exec-card-label {
            font-size: 0.6rem;
            text-transform: uppercase;
            letter-spacing: 1.5px;
            color: rgba(255,255,255,0.6) !important;
            margin-bottom: 6px;
        }
        .exec-card-value {
            font-size: 1.5rem;
            font-weight: 900;
            line-height: 1.2;
        }
        .exec-card-sub {
            font-size: 0.65rem;
            margin-top: 4px;
            opacity: 0.75;
        }

        /* Radar Panel (Maturity Profile) */
        .radar-panel {
            background: rgba(15,23,42,0.6);
            border: 1px solid rgba(255,255,255,0.08);
            border-radius: 16px;
            padding: 1.25rem;
            margin-bottom: 1.5rem;
        }
        .radar-panel-header {
            text-align: center;
            margin-bottom: 0.75rem;
        }
        .radar-panel-title {
            color: #e2e8f0;
            font-size: 0.95rem;
            font-weight: 700;
            margin: 0 0 8px;
        }
        .radar-legend {
            display: flex;
            justify-content: center;
            gap: 18px;
            font-size: 0.7rem;
            color: #94a3b8;
        }
        .radar-legend-item {
            display: flex;
            align-items: center;
            gap: 5px;
        }
        .radar-legend-swatch {
            width: 12px;
            height: 3px;
            border-radius: 2px;
        }
        .strategic-insight {
            background: rgba(16,185,129,0.08);
            border: 1px solid rgba(16,185,129,0.25);
            border-radius: 10px;
            padding: 12px 14px;
            margin-top: 1rem;
        }
        .strategic-insight-title {
            font-size: 0.75rem;
            font-weight: 700;
            color: #10b981;
            margin-bottom: 6px;
        }
        .strategic-insight-text {
            font-size: 0.78rem;
            color: #cbd5e1;
            line-height: 1.6;
        }

        @media (max-width: 640px) {
            .exec-cards { grid-template-columns: repeat(2, 1fr); }
        }

        /* Dimension Bars */
        .dimension-bars {
            display: grid;
            gap: 0.75rem;
            margin: 1.5rem 0;
        }

        .dimension-bar {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .dimension-bar-label {
            min-width: 130px;
            font-size: 0.8rem;
            color: #94a3b8;
            text-align: right;
        }

        .dimension-bar-track {
            flex: 1;
            height: 24px;
            background: rgba(255,255,255,0.08);
            border-radius: 6px;
            overflow: hidden;
            position: relative;
        }

        .dimension-bar-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--accent-blue) 0%, var(--accent-blue-light) 100%);
            border-radius: 6px;
            transition: width 0.6s ease;
            display: flex;
            align-items: center;
            justify-content: flex-end;
            padding-right: 0.5rem;
            font-size: 0.7rem;
            font-weight: 700;
            color: #fff;
        }

        /* Priority List */
        .priority-list {
            display: grid;
            gap: 0.75rem;
            margin: 1.5rem 0;
        }

        .priority-item {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            background: rgba(255,255,255,0.05);
            padding: 0.875rem 1rem;
            border-radius: 10px;
            border-left: 3px solid var(--accent-amber);
        }

        .priority-rank {
            width: 28px;
            height: 28px;
            background: var(--accent-amber);
            color: #fff;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
            font-weight: 700;
            flex-shrink: 0;
        }

        .priority-text {
            font-size: 0.85rem;
            color: #e2e8f0;
        }

        .priority-gap {
            font-size: 0.75rem;
            color: var(--accent-amber);
            font-weight: 600;
        }

        /* Benchmark Comparison */
        .benchmark-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 0.75rem;
            margin: 1.5rem 0;
        }

        .benchmark-item {
            background: rgba(255,255,255,0.05);
            padding: 1rem;
            border-radius: 10px;
            text-align: center;
        }

        .benchmark-tier {
            font-size: 0.75rem;
            color: #94a3b8;
            margin-bottom: 0.25rem;
        }

        .benchmark-value {
            font-size: 1.25rem;
            font-weight: 800;
            color: var(--accent-blue-light);
        }

        .benchmark-marker {
            border: 2px solid var(--accent-amber);
        }

        /* References Section */
        .references-section {
            background: #f8fafc;
            padding: 2rem;
            border-radius: 16px;
            margin-top: 3rem;
        }

        .references-title {
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--primary-blue);
            margin-bottom: 1.5rem;
        }

        .references-list {
            display: grid;
            gap: 0.75rem;
        }

        .reference-item {
            display: flex;
            gap: 0.75rem;
            font-size: 0.85rem;
        }

        .reference-number {
            color: var(--accent-blue);
            font-weight: 700;
            flex-shrink: 0;
        }

        .reference-source {
            color: var(--text-secondary);
            font-size: 0.8rem;
        }

        .reference-item a {
            color: var(--primary-blue);
            text-decoration: none;
        }

        .reference-item a:hover {
            text-decoration: underline;
        }

        /* ═══ TOOLTIP SYSTEM ═══ */
        .tooltip-trigger {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 16px;
            height: 16px;
            background: rgba(245, 158, 11, 0.15);
            border: 1px solid rgba(245, 158, 11, 0.35);
            border-radius: 50%;
            font-size: 10px;
            color: #fbbf24;
            cursor: help;
            margin-left: 6px;
            transition: all 0.3s;
            flex-shrink: 0;
        }
        .tooltip-trigger:hover { background: rgba(245, 158, 11, 0.3); transform: scale(1.15); }
        .tooltip-trigger .tooltip-content { display: none; }

        #maturity-tooltip-container {
            position: fixed;
            width: 320px;
            max-width: calc(100vw - 40px);
            padding: 16px;
            background: linear-gradient(135deg, #1e3a5f, #2d5a87);
            border: 1px solid rgba(255,255,255,0.2);
            border-radius: 12px;
            box-shadow: 0 15px 50px rgba(0,0,0,0.5);
            z-index: 999999;
            pointer-events: none;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.15s ease;
            color: white;
            font-size: 12px;
            line-height: 1.5;
        }
        #maturity-tooltip-container.visible { opacity: 1; visibility: visible; }
        #maturity-tooltip-container .tooltip-title { font-size: 13px; font-weight: 700; color: #fbbf24; margin-bottom: 8px; }
        #maturity-tooltip-container .tooltip-desc { color: rgba(255,255,255,0.9); margin-bottom: 6px; }
        #maturity-tooltip-container .tooltip-formula { font-family: 'JetBrains Mono', monospace; font-size: 11px; background: rgba(0,0,0,0.3); padding: 6px 10px; border-radius: 6px; margin-top: 6px; color: #22d3ee; }

        /* ═══ MODE TOGGLE ═══ */
        .maturity-mode-bar { display: flex; gap: 8px; margin-bottom: 0; }
        .maturity-toolbar-row { display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 0.75rem; margin-bottom: 1.5rem; }
        .maturity-toolbar-actions { display: flex; gap: 8px; align-items: center; }
        .maturity-mode-btn {
            padding: 8px 20px;
            border-radius: 8px;
            border: 1px solid rgba(255,255,255,0.2);
            background: rgba(255,255,255,0.06);
            color: #94a3b8;
            font-size: 0.82rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 6px;
        }
        .maturity-mode-btn:hover { background: rgba(255,255,255,0.12); color: #e2e8f0; }
        .maturity-mode-btn.active { background: rgba(59,130,246,0.25); border-color: rgba(59,130,246,0.5); color: #60a5fa; }
        .maturity-mode-btn .fa-lock { font-size: 0.7rem; color: #fbbf24; }

        /* ═══ GATING ═══ */
        .pro-panel { position: relative; margin-top: 1.5rem; }
        .gated-overlay {
            position: absolute;
            inset: 0;
            background: rgba(15, 23, 42, 0.7);
            backdrop-filter: blur(6px);
            -webkit-backdrop-filter: blur(6px);
            border-radius: 16px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 10;
            cursor: pointer;
        }
        .gated-overlay .gated-icon { font-size: 2rem; color: #fbbf24; margin-bottom: 8px; }
        .gated-overlay .gated-text { color: #e2e8f0; font-size: 0.85rem; font-weight: 600; }
        .gated-overlay .gated-sub { color: #94a3b8; font-size: 0.75rem; margin-top: 4px; }
        .gated-badge { display: inline-block; background: linear-gradient(135deg,#7c3aed,#a855f7); color: #fff; font-size: 0.65rem; font-weight: 700; padding: 2px 8px; border-radius: 4px; margin-left: 6px; vertical-align: middle; text-transform: uppercase; letter-spacing: 0.5px; }

        /* ═══ PRO PANELS ═══ */
        .pro-panel-inner {
            background: rgba(255,255,255,0.04);
            border: 1px solid rgba(255,255,255,0.08);
            border-radius: 16px;
            padding: 1.25rem;
        }
        .pro-panel-title {
            font-size: 0.95rem;
            font-weight: 700;
            color: #e2e8f0;
            margin-bottom: 0.75rem;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .pro-panel-title i { color: #a855f7; font-size: 0.85rem; }

        /* Facility Context Grid */
        .facility-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(160px, 1fr)); gap: 0.75rem; }
        .facility-grid .calc-input-group .calc-label { font-size: 0.75rem; }

        /* Weight Editor */
        .weight-editor-grid { display: grid; gap: 0.6rem; }
        .weight-row { display: flex; align-items: center; gap: 0.75rem; }
        .weight-row-label { min-width: 120px; font-size: 0.8rem; color: #94a3b8; }
        .weight-row input[type="range"] { flex: 1; accent-color: #a855f7; height: 6px; }
        .weight-row-value { min-width: 40px; text-align: right; font-size: 0.8rem; font-weight: 700; color: #e2e8f0; font-family: 'JetBrains Mono', monospace; }
        .weight-total { text-align: right; font-size: 0.85rem; font-weight: 700; color: #fbbf24; margin-top: 0.5rem; }
        .weight-total.invalid { color: #ef4444; }
        .weight-preset-bar { display: flex; gap: 6px; flex-wrap: wrap; margin-bottom: 1rem; }
        .weight-preset-btn { padding: 5px 12px; border-radius: 6px; border: 1px solid rgba(255,255,255,0.15); background: rgba(255,255,255,0.05); color: #94a3b8; font-size: 0.75rem; cursor: pointer; transition: all 0.2s; }
        .weight-preset-btn:hover, .weight-preset-btn.active { background: rgba(168,85,247,0.2); border-color: rgba(168,85,247,0.5); color: #c084fc; }

        /* Sub-Dimension Accordions */
        .subdim-accordion { margin-bottom: 0.5rem; }
        .subdim-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0.6rem 0.75rem;
            background: rgba(255,255,255,0.05);
            border-radius: 8px;
            cursor: pointer;
            transition: background 0.2s;
        }
        .subdim-header:hover { background: rgba(255,255,255,0.08); }
        .subdim-header-label { font-size: 0.8rem; color: #e2e8f0; font-weight: 600; }
        .subdim-header-avg { font-size: 0.8rem; font-weight: 700; color: #60a5fa; font-family: 'JetBrains Mono', monospace; }
        .subdim-header .fa-chevron-down { font-size: 0.65rem; color: #64748b; transition: transform 0.2s; }
        .subdim-body { max-height: 0; overflow: hidden; transition: max-height 0.3s ease; }
        .subdim-body.open { max-height: 500px; }
        .subdim-body-inner { padding: 0.75rem; display: grid; gap: 0.5rem; }
        .subdim-row { display: flex; align-items: center; gap: 0.5rem; }
        .subdim-row-label { flex: 1; font-size: 0.75rem; color: #94a3b8; }
        .subdim-row select { width: 110px; background: rgba(255,255,255,0.08); border: 1px solid rgba(255,255,255,0.15); border-radius: 6px; padding: 4px 6px; color: #e2e8f0; font-size: 0.75rem; }
        .subdim-row select option { background: #1e293b; color: #fff; }

        /* ═══ TORNADO / SENSITIVITY ═══ */
        .tornado-bar-row { display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.4rem; }
        .tornado-label { min-width: 110px; text-align: right; font-size: 0.75rem; color: #94a3b8; }
        .tornado-track { flex: 1; height: 18px; background: rgba(255,255,255,0.05); border-radius: 4px; position: relative; overflow: hidden; }
        .tornado-neg { position: absolute; top: 0; height: 100%; background: rgba(239,68,68,0.6); border-radius: 4px 0 0 4px; }
        .tornado-pos { position: absolute; top: 0; height: 100%; background: rgba(34,197,94,0.6); border-radius: 0 4px 4px 0; }
        .tornado-range { min-width: 45px; font-size: 0.7rem; font-weight: 600; color: #e2e8f0; text-align: right; font-family: 'JetBrains Mono', monospace; }

        /* ═══ CONFIDENCE ═══ */
        .confidence-display { display: flex; gap: 1rem; flex-wrap: wrap; justify-content: center; }
        .confidence-stat { text-align: center; padding: 0.5rem 1rem; background: rgba(255,255,255,0.04); border-radius: 8px; }
        .confidence-stat-value { font-size: 1.1rem; font-weight: 700; font-family: 'JetBrains Mono', monospace; color: #60a5fa; }
        .confidence-stat-label { font-size: 0.7rem; color: #94a3b8; margin-top: 2px; }

        /* ═══ SCENARIO WHAT-IF ═══ */
        .scenario-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 0.5rem; }
        .scenario-item { display: flex; align-items: center; gap: 0.5rem; }
        .scenario-item-label { min-width: 100px; font-size: 0.75rem; color: #94a3b8; }
        .scenario-item select { flex: 1; background: rgba(255,255,255,0.08); border: 1px solid rgba(255,255,255,0.15); border-radius: 6px; padding: 4px 6px; color: #e2e8f0; font-size: 0.75rem; }
        .scenario-item select option { background: #1e293b; }
        .scenario-result-bar { display: flex; align-items: center; gap: 1rem; margin-top: 1rem; padding: 1rem; background: rgba(168,85,247,0.08); border: 1px solid rgba(168,85,247,0.2); border-radius: 10px; }
        .scenario-result-bar .sr-current, .scenario-result-bar .sr-target { text-align: center; flex: 1; }
        .scenario-result-bar .sr-value { font-size: 1.4rem; font-weight: 800; font-family: 'JetBrains Mono', monospace; }
        .scenario-result-bar .sr-label { font-size: 0.7rem; color: #94a3b8; }
        .scenario-result-bar .sr-delta { font-size: 1.2rem; font-weight: 700; color: #22c55e; }

        /* ═══ WATERFALL ═══ */
        .waterfall-container { display: flex; justify-content: center; margin: 1rem 0; }

        /* ═══ EXPORT BTN ═══ */
        .maturity-export-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            width: 100%;
            padding: 12px;
            margin-top: 1.5rem;
            border-radius: 10px;
            border: 1px solid rgba(168,85,247,0.3);
            background: linear-gradient(135deg, rgba(168,85,247,0.15), rgba(124,58,237,0.15));
            color: #c084fc;
            font-size: 0.85rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }
        .maturity-export-btn:hover { background: linear-gradient(135deg, rgba(168,85,247,0.25), rgba(124,58,237,0.25)); transform: translateY(-1px); }

        /* ═══ ARTICLE NAV ═══ */
        .article-nav {
            display: flex;
            justify-content: space-between;
            padding: 2rem 0;
            border-top: 1px solid #e2e8f0;
            margin-top: 3rem;
        }
        .article-nav a {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: #1e3a5f;
            font-weight: 600;
            transition: color 0.3s ease;
            text-decoration: none;
        }
        [data-theme="dark"] .article-nav a { color: #93c5fd; }
        .article-nav a:hover { color: #60a5fa; }

        /* ═══ EXECUTIVE EVIDENCE BLOCK ═══ */
        .evidence-block {
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
            border-radius: 16px;
            padding: 2rem;
            margin: 2.5rem 0;
            border: 1px solid rgba(59, 130, 246, 0.2);
        }
        .evidence-block-title {
            font-size: 0.75rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 1.5px;
            color: #60a5fa;
            margin-bottom: 1.25rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        .evidence-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
            gap: 1rem;
        }
        .evidence-card {
            background: rgba(255,255,255,0.04);
            border: 1px solid rgba(255,255,255,0.08);
            border-radius: 12px;
            padding: 1.25rem 1rem;
            text-align: center;
            transition: all 0.3s ease;
        }
        .evidence-card:hover {
            background: rgba(59,130,246,0.08);
            border-color: rgba(59,130,246,0.3);
            transform: translateY(-2px);
        }
        .evidence-card-value {
            font-size: 1.5rem;
            font-weight: 800;
            font-family: 'JetBrains Mono', monospace;
            margin-bottom: 4px;
        }
        .evidence-card-label {
            font-size: 0.72rem;
            color: #94a3b8;
            line-height: 1.4;
        }
        .evidence-card-sub {
            font-size: 0.65rem;
            color: #64748b;
            margin-top: 4px;
        }
        .evidence-source {
            margin-top: 1rem;
            font-size: 0.7rem;
            color: #64748b;
            text-align: center;
            font-style: italic;
        }

        /* ═══ RISK & COST TRANSLATION PANEL ═══ */
        .risk-cost-panel {
            background: linear-gradient(135deg, rgba(239,68,68,0.05) 0%, rgba(234,88,12,0.05) 100%);
            border: 1px solid rgba(239,68,68,0.15);
            border-radius: 14px;
            padding: 1.25rem;
            margin-top: 1.5rem;
        }
        .risk-cost-title {
            font-size: 0.9rem;
            font-weight: 700;
            color: #e2e8f0;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        .risk-cost-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 0.75rem;
            margin-bottom: 1rem;
        }
        .risk-cost-card {
            background: rgba(0,0,0,0.2);
            border-radius: 10px;
            padding: 1rem;
            text-align: center;
        }
        .risk-cost-card-value {
            font-size: 1.15rem;
            font-weight: 800;
            font-family: 'JetBrains Mono', monospace;
            margin-bottom: 2px;
        }
        .risk-cost-card-label {
            font-size: 0.7rem;
            color: #94a3b8;
        }
        .risk-drivers-list {
            font-size: 0.78rem;
            color: #cbd5e1;
            line-height: 1.7;
            padding-left: 1.25rem;
        }
        .risk-drivers-list li { margin-bottom: 4px; }

        /* ═══ PRIVACY BADGE ═══ */
        .privacy-badge {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
            font-size: 0.72rem;
            color: #64748b;
            margin-top: 0.5rem;
            padding: 6px 0;
        }
        .privacy-badge i { color: #10b981; font-size: 0.8rem; }

        /* ═══ BENCHMARK VERSION TAG ═══ */
        .benchmark-meta {
            display: flex;
            flex-wrap: wrap;
            gap: 0.75rem;
            margin-top: 0.75rem;
            padding-top: 0.75rem;
            border-top: 1px solid rgba(255,255,255,0.08);
        }
        .benchmark-meta-tag {
            font-size: 0.65rem;
            color: #64748b;
            background: rgba(255,255,255,0.04);
            padding: 3px 8px;
            border-radius: 4px;
            display: flex;
            align-items: center;
            gap: 4px;
        }
        .benchmark-meta-tag i { font-size: 0.6rem; }

        /* ═══ DARK MODE ENHANCEMENT ═══ */
        [data-theme="dark"] .article-content { background: #0f172a; }
        [data-theme="dark"] .article-body { background: #0f172a; color: #e2e8f0; }
        [data-theme="dark"] .article-body h2 { color: #93c5fd; }
        [data-theme="dark"] .article-body h3 { color: #cbd5e1; }
        [data-theme="dark"] .article-body p { color: #cbd5e1; }
        [data-theme="dark"] .article-body blockquote { background: rgba(30,58,95,0.3); border-color: rgba(96,165,250,0.4); color: #cbd5e1; }
        [data-theme="dark"] .article-body .info-box,
        [data-theme="dark"] .article-body .key-insight { background: rgba(15,23,42,0.8); border-color: rgba(255,255,255,0.1); color: #cbd5e1; }
        [data-theme="dark"] .article-body table th { background: #0f172a; color: #e2e8f0; }
        [data-theme="dark"] .article-body table td { color: #cbd5e1; border-color: rgba(255,255,255,0.1); }
        [data-theme="dark"] .article-body ul li,
        [data-theme="dark"] .article-body ol li { color: #cbd5e1; }
        [data-theme="dark"] .article-body a { color: #60a5fa; }
        [data-theme="dark"] .article-body strong { color: #f1f5f9; }

        /* ═══ RESPONSIVE ═══ */
        @media (max-width: 768px) {
            .article-hero { padding: 6rem 1rem 3rem; }
            .article-content { padding: 2rem 1rem; }
            .toc-grid { grid-template-columns: 1fr; }
            .comparison-grid { grid-template-columns: 1fr; }
            .framework-grid { grid-template-columns: 1fr; }
            .calc-grid { grid-template-columns: 1fr; }
            .calc-results { grid-template-columns: repeat(2, 1fr); }
            .benchmark-grid { grid-template-columns: repeat(2, 1fr); }
            .dimension-bar-label { min-width: 90px; font-size: 0.7rem; }
            .tornado-label { min-width: 80px; }
            .weight-row-label { min-width: 90px; }
            .facility-grid { grid-template-columns: 1fr 1fr; }
            .scenario-grid { grid-template-columns: 1fr; }
            .confidence-display { gap: 0.5rem; }
            .maturity-mode-btn { padding: 6px 12px; font-size: 0.75rem; }
            .evidence-grid { grid-template-columns: repeat(2, 1fr); }
            .evidence-card-value { font-size: 1.2rem; }
            .risk-cost-grid { grid-template-columns: repeat(2, 1fr); }
            .benchmark-meta { gap: 0.4rem; }
        }
    </style>
    <link rel="preload" as="image" href="assets/article-1-cover.jpg">
    <script src="https://cdn.jsdelivr.net/npm/fuse.js@7.0.0" defer></script>
</head>
<body>
    <!-- Reading Progress Bar -->
    <div class="scroll-progress" id="scrollProgress"></div>

    <!-- Search Overlay & Modal -->
    <div class="search-overlay" id="searchOverlay"></div>
    <div class="search-modal" id="searchModal">
        <div class="search-input-wrap">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg>
            <input type="text" class="search-input" id="searchInput" placeholder="Search articles, calculators, tools..." autocomplete="off">
            <kbd class="search-kbd">ESC</kbd>
        </div>
        <div class="search-results" id="searchResults">
            <div class="search-empty">Type to search across all content</div>
        </div>
        <div class="search-footer">
            <span><kbd class="search-kbd">&uarr;&darr;</kbd> Navigate</span>
            <span><kbd class="search-kbd">Enter</kbd> Open</span>
        </div>
    </div>

    <!-- TOC Sidebar (desktop, wide screens) -->
    <nav class="toc-sidebar" id="tocSidebar" aria-label="Table of Contents">
        <div class="toc-sidebar-label">On this page</div>
        <ul class="toc-sidebar-list" id="tocSidebarList"></ul>
    </nav>

    <!-- TOC Mobile Toggle -->
    <button class="toc-mobile-toggle" id="tocMobileToggle" aria-label="Table of contents">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="8" y1="6" x2="21" y2="6"/><line x1="8" y1="12" x2="21" y2="12"/><line x1="8" y1="18" x2="21" y2="18"/><line x1="3" y1="6" x2="3.01" y2="6"/><line x1="3" y1="12" x2="3.01" y2="12"/><line x1="3" y1="18" x2="3.01" y2="18"/></svg>
    </button>
    <div class="toc-mobile-backdrop" id="tocMobileBackdrop"></div>
    <div class="toc-mobile-drawer" id="tocMobileDrawer">
        <div class="toc-drawer-header">
            <span class="toc-drawer-title">Table of Contents</span>
            <button class="toc-drawer-close" id="tocDrawerClose" aria-label="Close">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>
            </button>
        </div>
        <ul class="toc-mobile-list" id="tocMobileList"></ul>
    </div>

    <a href="#main-content" class="skip-link">Skip to main content</a>
    <!-- Navigation -->
    <nav class="navbar">
        <div class="nav-container">
            <a href="index.html" class="nav-logo">
                <img loading="lazy" src="assets/profile-photo.jpg" alt="Bagus Dwi Permana" class="nav-avatar">
            </a>
            <ul class="nav-menu">
                <li><a href="index.html" class="nav-link">Home</a></li>
                <li class="nav-dropdown">
                    <a href="datacenter-solutions.html" class="nav-link">
                        DC Solutions
                        <svg class="dropdown-arrow" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polyline points="6 9 12 15 18 9"></polyline>
                        </svg>
                    </a>
                    <ul class="dropdown-menu">
                        <li><a href="datacenter-solutions.html" style="color: #06b6d4; font-weight: 600;">DC Solutions Hub</a></li>
                        <li style="border-bottom: 1px solid rgba(255,255,255,0.1); margin: 4px 0;"></li>
                        <li><a href="datahallAI.html" style="color: #8b5cf6;">DC AI/HPC</a></li>
                        <li><a href="dc-conventional.html">DC Conventional</a></li>
                        <li style="border-bottom: 1px solid rgba(255,255,255,0.1); margin: 4px 0;"></li>
                        <li><a href="capex-calculator.html" style="color: #f59e0b;">CAPEX Calculator</a></li>
                        <li><a href="opex-calculator.html" style="color: #10b981;">OPEX Calculator</a></li>
                        <li style="border-bottom: 1px solid rgba(255,255,255,0.1); margin: 4px 0;"></li>
                        <li><a href="dcmoc/" style="color: #ef4444; font-weight: 600;">DC MOC</a></li>
                    </ul>
                </li>
                <li class="nav-dropdown">
                    <a href="articles.html" class="nav-link">
                        Insights
                        <svg class="dropdown-arrow" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polyline points="6 9 12 15 18 9"></polyline>
                        </svg>
                    </a>
                    <ul class="dropdown-menu">
                        <li><a href="articles.html" style="color: #06b6d4; font-weight: 600;">Engineering Journal</a></li>
                        <li><a href="geopolitics.html" style="color: #ef4444;">Global Analysis</a></li>
                        <li style="border-bottom: 1px solid rgba(255,255,255,0.1); margin: 4px 0;"></li>
                        <li><a href="insights.html" style="color: #64748b; font-size: 0.85rem;">All Insights</a></li>
                    </ul>
                </li>
                <li><a href="index.html#contact" class="nav-link">Contact</a></li>
            </ul>
            <button class="nav-search-btn" id="navSearchBtn" aria-label="Search" title="Search (Ctrl+K)">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg>
            </button>
            <button class="theme-toggle" id="themeToggle" aria-label="Toggle dark mode">
                <svg class="moon-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                </svg>
                <svg class="sun-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="5"></circle>
                    <line x1="12" y1="1" x2="12" y2="3"></line>
                    <line x1="12" y1="21" x2="12" y2="23"></line>
                    <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                    <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                    <line x1="1" y1="12" x2="3" y2="12"></line>
                    <line x1="21" y1="12" x2="23" y2="12"></line>
                    <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                    <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                </svg>
            </button>
            <button class="hamburger" aria-label="Open navigation menu" aria-expanded="false">
                <span class="bar"></span>
                <span class="bar"></span>
                <span class="bar"></span>
            </button>
        </div>
    </nav>

    <main id="main-content">
    <!-- Hero Section -->
    <section class="article-hero">
        <div class="container">
            <a href="articles.html" style="display: inline-flex; align-items: center; gap: 0.5rem; color: #94a3b8; margin-bottom: 1.5rem; font-size: 0.9rem; text-decoration: none;">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <polyline points="15 18 9 12 15 6"></polyline>
                </svg>
                Back to Engineering Journal
            </a>

            <span class="article-badge">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M12 20h9"/>
                    <path d="M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4L16.5 3.5z"/>
                </svg>
                Operations Journal #1 &mdash; Flagship Article
            </span>

            <h1 class="article-title">When Nothing Happens,<br>Engineering Is Working</h1>

            <p class="article-subtitle">
                In critical infrastructure, success is defined by the absence of events. This journal explores the invisible engineering behind zero-incident operations: the theory, the framework, the metrics, and the daily discipline that makes "nothing happening" possible.
            </p>

            <div class="article-meta">
                <span class="article-meta-item">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                        <line x1="16" y1="2" x2="16" y2="6"></line>
                        <line x1="8" y1="2" x2="8" y2="6"></line>
                        <line x1="3" y1="10" x2="21" y2="10"></line>
                    </svg>
                    December 6, 2025
                </span>
                <span class="article-meta-item">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="10"></circle>
                        <polyline points="12 6 12 12 16 14"></polyline>
                    </svg>
                    20 min read
                </span>
                <span class="article-meta-item">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"></path>
                        <path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"></path>
                    </svg>
                    ~9,000 words
                </span>
                <span class="article-meta-item">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                        <circle cx="12" cy="7" r="4"></circle>
                    </svg>
                    Bagus Dwi Permana
                </span>
            </div>
        </div>
    </section>

    <!-- Series Navigation -->
    <div class="series-nav" style="margin-top: 1rem;">
        <div class="series-badge">
            <span class="series-badge-icon">01</span>
            Engineering Journal — Article 1 of 18
        </div>
        <span class="series-title">When Nothing Happens, Engineering Is Working</span>
        <div class="series-links">
            <span class="series-link disabled">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="15 18 9 12 15 6"/></svg>
                Prev
            </span>
            <a href="article-2.html" class="series-link">
                Next
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="9 18 15 12 9 6"/></svg>
            </a>
        </div>
    </div>

    <!-- Featured Image -->
    <figure style="margin: 2rem 0; text-align: center;">
        <img src="Article/Article_1 02.02.26/1.1.jpg" alt="Proactive engineering and operational maturity framework for data center infrastructure management" loading="lazy" style="max-width: 100%; height: auto; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.1);" decoding="async">
    </figure>

    <!-- Table of Contents -->
    <section class="toc-section">
        <div class="toc-container">
            <h2 class="toc-title">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <line x1="8" y1="6" x2="21" y2="6"></line>
                    <line x1="8" y1="12" x2="21" y2="12"></line>
                    <line x1="8" y1="18" x2="21" y2="18"></line>
                    <line x1="3" y1="6" x2="3.01" y2="6"></line>
                    <line x1="3" y1="12" x2="3.01" y2="12"></line>
                    <line x1="3" y1="18" x2="3.01" y2="18"></line>
                </svg>
                Table of Contents
            </h2>
            <div class="toc-grid">
                <a href="#section-1" class="toc-item">
                    <div class="toc-item-number">SECTION 1</div>
                    <div class="toc-item-title">Introduction: The Paradox of Invisible Success</div>
                </a>
                <a href="#section-2" class="toc-item">
                    <div class="toc-item-number">SECTION 2</div>
                    <div class="toc-item-title">Safety-I vs Safety-II: A Theoretical Foundation</div>
                </a>
                <a href="#section-3" class="toc-item">
                    <div class="toc-item-number">SECTION 3</div>
                    <div class="toc-item-title">The Operational Journal Concept</div>
                </a>
                <a href="#section-4" class="toc-item">
                    <div class="toc-item-number">SECTION 4</div>
                    <div class="toc-item-title">The Eight-Stage Proactive Framework</div>
                </a>
                <a href="#section-5" class="toc-item">
                    <div class="toc-item-number">SECTION 5</div>
                    <div class="toc-item-title">Proactive vs Reactive: Cost Quantification</div>
                </a>
                <a href="#section-6" class="toc-item">
                    <div class="toc-item-number">SECTION 6</div>
                    <div class="toc-item-title">Case Context: 10MW Facility Operations</div>
                </a>
                <a href="#section-7" class="toc-item">
                    <div class="toc-item-number">SECTION 7</div>
                    <div class="toc-item-title">The Culture Trap: Heroes vs Boring Competence</div>
                </a>
                <a href="#section-8" class="toc-item">
                    <div class="toc-item-number">SECTION 8</div>
                    <div class="toc-item-title">Maturity Metrics: The Five-Level Model</div>
                </a>
                <a href="#section-9" class="toc-item toc-calculator">
                    <div class="toc-item-number">SECTION 9 <span class="toc-calc-badge"><i class="fas fa-calculator" style="font-size:0.5rem;"></i> Interactive</span></div>
                    <div class="toc-item-title">Calculator: Operational Maturity Assessment</div>
                </a>
                <a href="#section-10" class="toc-item">
                    <div class="toc-item-number">SECTION 10</div>
                    <div class="toc-item-title">Conclusion: Making Invisibility Visible</div>
                </a>
            </div>
        </div>
    </section>

    <!-- Article Content -->
    <article class="article-content">
        <div class="container">
            <div class="article-body">

                <!-- Section 1: Introduction -->
                <h2 id="section-1">
                    <span class="section-number">1</span>
                    Introduction: The Paradox of Invisible Success
                </h2>

                <p>
                    A data center that operates reliably does not announce itself. There are no alarms. No emergency calls at 3:00 AM. No scrambled teams racing against a cascading failure. The cooling systems hum within tolerance. The <span class="tooltip" data-tip="Uninterruptible Power Supply — battery-backed power protection">UPS</span> systems remain on bypass, ready but unused. The <span class="tooltip" data-tip="Building Management System — centralized monitoring of MEP systems">BMS</span> screens show green across every parameter. And nobody outside the operations team notices, because there is nothing to notice.
                </p>

                <p>
                    This is the paradox at the heart of critical infrastructure engineering: <strong>the better the work, the less visible it becomes</strong>. When an operations team does its job perfectly, the outcome is indistinguishable from a facility that requires no management at all. The signals of excellence are, by definition, the absence of signals. No incidents to report. No near-misses to investigate. No emergency maintenance windows to justify. Just continuous, silent, reliable operation — a condition that depends on recognizing <a href="article-8.html">weak signals and safety indicators</a> before they escalate.
                </p>

                <blockquote>
                    "Reliability is not a feature. It is a process. Systems do not remain reliable by design alone, but by daily human and organizational effort." <a href="#ref-1" class="cite">[1]</a>
                </blockquote>

                <p>
                    Yet this invisibility creates an organizational problem. How does an engineering team justify staffing levels, training budgets, and maintenance investments when the evidence of their effectiveness is the absence of failure? When finance sees months of zero incidents, the instinctive conclusion is not "this team is exceptional" but "perhaps we can reduce costs here."
                </p>

                <p>
                    This problem is not theoretical. The Uptime Institute's 2024 Annual Outage Analysis reports that <strong>over 55% of significant data center outages are attributed to operational and human factors</strong>, not equipment failure <a href="#ref-3" class="cite">[3]</a>. The same report notes that facilities with robust operational programs experience 3-5x fewer incidents than those with minimal programs. Yet operational budgets consistently face pressure because their deliverable is nothingness.
                </p>

                <p>
                    This flagship entry establishes the foundation for the Operations Journal series: <strong>proactive engineering is not an absence of activity — it is a different kind of activity</strong>. One that can be documented, measured, quantified, and valued. The goal is to make the invisible visible through structured methodology, evidence-based metrics, and operational science.
                </p>

                <div class="info-box">
                    <div class="info-box-title">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#3b82f6" stroke-width="2">
                            <circle cx="12" cy="12" r="10"></circle>
                            <line x1="12" y1="16" x2="12" y2="12"></line>
                            <line x1="12" y1="8" x2="12.01" y2="8"></line>
                        </svg>
                        Why This Article Matters
                    </div>
                    <p style="margin: 0; font-size: 0.85rem; line-height: 1.6;">
                        Every subsequent article in this journal builds upon the frameworks introduced here. This is not a motivational piece about the importance of maintenance. It is a systematic argument, grounded in safety science and resilience engineering, for why proactive operations must be treated as a measurable engineering discipline rather than an invisible overhead.
                    </p>
                </div>

                <p>
                    We begin with theory — not as academic luxury, but because the language we use to describe operations determines what we measure, value, and fund. The <span class="tooltip" data-tip="Safety-I: Traditional approach focused on what goes wrong">Safety-I</span> vs <span class="tooltip" data-tip="Safety-II: Modern approach focused on understanding why things go right">Safety-II</span> distinction is the difference between an organization that reacts to failure and one that actively engineers success.
                </p>

                <!-- Executive Evidence Block -->
                <div class="evidence-block">
                    <div class="evidence-block-title">
                        <i class="fas fa-shield-halved"></i> Operational Evidence — Single 10MW Facility, 6-Month Period
                    </div>
                    <div class="evidence-grid">
                        <div class="evidence-card">
                            <div class="evidence-card-value" style="color:#10b981;">12</div>
                            <div class="evidence-card-label">Prevented Incidents</div>
                            <div class="evidence-card-sub">Proactive intervention before failure</div>
                        </div>
                        <div class="evidence-card">
                            <div class="evidence-card-value" style="color:#3b82f6;">$1.2M+</div>
                            <div class="evidence-card-label">Avoided Costs</div>
                            <div class="evidence-card-sub">vs ~$180K proactive investment</div>
                        </div>
                        <div class="evidence-card">
                            <div class="evidence-card-value" style="color:#8b5cf6;">99.999%</div>
                            <div class="evidence-card-label">Uptime Achieved</div>
                            <div class="evidence-card-sub">Zero unplanned outages</div>
                        </div>
                        <div class="evidence-card">
                            <div class="evidence-card-value" style="color:#f59e0b;">1.65→1.48</div>
                            <div class="evidence-card-label">PUE Improvement</div>
                            <div class="evidence-card-sub">10.3% energy efficiency gain</div>
                        </div>
                        <div class="evidence-card">
                            <div class="evidence-card-value" style="color:#06b6d4;">5:1–12:1</div>
                            <div class="evidence-card-label">Prevention ROI</div>
                            <div class="evidence-card-sub">Return on proactive investment</div>
                        </div>
                    </div>
                    <div class="evidence-source">Case context from documented operational journal entries — details in Sections 5-7 below</div>
                </div>

                <!-- Quick Assessment CTA -->
                <div style="background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%); border-radius: 16px; padding: 1.5rem 2rem; margin: 2rem 0; display: flex; align-items: center; justify-content: space-between; gap: 1.5rem; flex-wrap: wrap;">
                    <div>
                        <div style="font-size: 1.1rem; font-weight: 700; color: #e2e8f0; margin-bottom: 4px;">Get Your 3 Operational Investment Priorities in 10 Minutes</div>
                        <div style="font-size: 0.82rem; color: #94a3b8;">Rate 8 dimensions (1-5 scale) → composite score + radar chart + improvement roadmap + PDF report. Data stays in your browser.</div>
                    </div>
                    <a href="#maturityCalculator" style="display: inline-flex; align-items: center; gap: 8px; padding: 10px 24px; background: linear-gradient(135deg, #3b82f6, #2563eb); color: #fff; border-radius: 10px; font-size: 0.85rem; font-weight: 600; text-decoration: none; white-space: nowrap; transition: transform 0.2s;" onmouseover="this.style.transform='translateY(-2px)'" onmouseout="this.style.transform='none'">
                        <i class="fas fa-chart-line"></i> Start Assessment
                    </a>
                </div>

                <!-- Section 2: Safety-I vs Safety-II -->
                <h2 id="section-2">
                    <span class="section-number">2</span>
                    Safety-I vs Safety-II: A Theoretical Foundation
                </h2>

                <p>
                    Erik Hollnagel's <em>Safety-I and Safety-II</em> (2014) fundamentally reframed how safety professionals think about organizational performance <a href="#ref-1" class="cite">[1]</a>. His distinction between two paradigms — now influential across aviation, healthcare, and critical infrastructure — provides the theoretical backbone for this journal's approach to data center operations.
                </p>

                <h3>2.1 Safety-I: The Traditional Paradigm</h3>

                <p>
                    <span class="tooltip" data-tip="Safety-I: Traditional approach focused on preventing things from going wrong">Safety-I</span> represents the traditional approach to safety management. Under this paradigm, safety is defined as <strong>the absence of adverse outcomes</strong>. The operating assumption is that systems work correctly by default, and when they do not, something has gone wrong that must be identified, analyzed, and corrected. The primary activities of Safety-I are:
                </p>

                <ul>
                    <li><strong>Reactive investigation:</strong> When an incident occurs, determine the root cause</li>
                    <li><strong>Error elimination:</strong> Identify human errors and procedural failures, then create barriers to prevent recurrence</li>
                    <li><strong>Linear causality:</strong> Assume that outcomes have identifiable, traceable causes that can be isolated</li>
                    <li><strong>Compliance focus:</strong> Ensure that procedures are followed and deviations are flagged</li>
                </ul>

                <p>
                    In data center operations, Safety-I manifests as incident-response-driven management. The team investigates outages, writes root cause analyses (<span class="tooltip" data-tip="Root Cause Analysis — systematic investigation method">RCA</span>), implements corrective actions, and measures success by the declining frequency of incidents. The <span class="tooltip" data-tip="Key Performance Indicator — measurable value demonstrating effectiveness">KPI</span> dashboard tracks failures, near-misses, and <span class="tooltip" data-tip="Service Level Agreement — contracted performance commitment">SLA</span> breaches. When there are no incidents, there is nothing to report.
                </p>

                <p>
                    Safety-I is not wrong — it is incomplete. It explains why a chiller tripped, but not why 10,000 other hours passed without one. It attributes success to the absence of failure rather than to the presence of competent performance.
                </p>

                <h3>2.2 Safety-II: The Proactive Paradigm</h3>

                <p>
                    <span class="tooltip" data-tip="Safety-II: Modern paradigm focused on understanding why things go right most of the time">Safety-II</span> inverts the perspective. Rather than defining safety as the absence of adverse outcomes, Safety-II defines it as <strong>the presence of adaptive capacity</strong> — a concept we explore further in our analysis of <a href="article-7.html">resilience beyond traditional tier ratings</a>. The operating assumption is that systems are inherently variable, and successful outcomes occur not because everything follows plan, but because people continuously adjust their performance to match conditions <a href="#ref-1" class="cite">[1]</a>.
                </p>

                <p>
                    Under Safety-II, the primary activities shift fundamentally:
                </p>

                <ul>
                    <li><strong>Proactive monitoring:</strong> Understand how things go right, not just why they go wrong</li>
                    <li><strong>Performance variability:</strong> Recognize that human adaptation is a source of resilience, not just a source of error</li>
                    <li><strong>Non-linear thinking:</strong> Accept that outcomes emerge from complex interactions, not single causes</li>
                    <li><strong>Functional focus:</strong> Study everyday work to understand the conditions that enable success</li>
                </ul>

                <div class="comparison-grid">
                    <div class="comparison-card">
                        <div class="comparison-card-header">
                            <div class="comparison-card-icon" style="background: rgba(239, 68, 68, 0.1);">
                                <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="#ef4444" stroke-width="2"><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/><line x1="12" y1="9" x2="12" y2="13"/><line x1="12" y1="17" x2="12.01" y2="17"/></svg>
                            </div>
                            Safety-I (Reactive)
                        </div>
                        <ul style="margin:0; padding-left:1.25rem; font-size:0.85rem; color:#64748b; line-height:1.7;">
                            <li>Focus on what goes <strong>wrong</strong></li>
                            <li>Safety = absence of failures</li>
                            <li>Investigate after incidents</li>
                            <li>Humans are liability (error source)</li>
                            <li>Linear cause-effect models</li>
                            <li>KPIs: incident rate, MTTR, SLA breaches</li>
                        </ul>
                    </div>
                    <div class="comparison-card">
                        <div class="comparison-card-header">
                            <div class="comparison-card-icon" style="background: rgba(16, 185, 129, 0.1);">
                                <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="#10b981" stroke-width="2"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></svg>
                            </div>
                            Safety-II (Proactive)
                        </div>
                        <ul style="margin:0; padding-left:1.25rem; font-size:0.85rem; color:#64748b; line-height:1.7;">
                            <li>Focus on what goes <strong>right</strong></li>
                            <li>Safety = presence of adaptive capacity</li>
                            <li>Study everyday operations</li>
                            <li>Humans are asset (adaptation source)</li>
                            <li>Complex system interactions</li>
                            <li>KPIs: prevented incidents, MTBF, maturity scores</li>
                        </ul>
                    </div>
                </div>

                <h3>2.3 Application to Data Center Operations</h3>

                <p>
                    In a data center context, Safety-II thinking means asking fundamentally different questions. Instead of asking "Why did the <span class="tooltip" data-tip="Heating, Ventilation, and Air Conditioning — thermal management systems">HVAC</span> system fail last Tuesday?" a Safety-II approach asks "What are the daily adjustments, monitoring activities, and preventive actions that ensure the HVAC system operates reliably for the other 8,759 hours of the year?" The first question yields an incident report. The second yields an understanding of operational competence.
                </p>

                <p>
                    James Reason's <em>Managing the Risks of Organizational Accidents</em> provides complementary framework through his Swiss Cheese Model <a href="#ref-2" class="cite">[2]</a>. Reason argues that catastrophic failures rarely result from a single error. Instead, they occur when multiple defensive layers simultaneously fail, like holes in Swiss cheese slices aligning. In proactive operations, the goal is not merely to add more cheese slices (more barriers) but to continuously monitor and maintain each layer's integrity.
                </p>

                <p>
                    Weick and Sutcliffe's work on High Reliability Organizations (HROs) extends this further <a href="#ref-7" class="cite">[7]</a>. They identify five hallmarks of organizations that operate reliably in high-risk environments: preoccupation with failure, reluctance to simplify, sensitivity to operations, commitment to resilience, and deference to expertise. These are not abstract principles. They are observable behaviors that can be cultivated, measured, and maintained through deliberate organizational design.
                </p>

                <p>
                    The implication for data center operations is clear: <strong>if we only measure what goes wrong, we will never understand what keeps things going right</strong>. The operational journal exists to capture both sides. It documents incidents, yes. But more importantly, it documents the proactive work that prevented incidents from ever occurring.
                </p>

                <!-- Section 3: Operational Journal Concept -->
                <h2 id="section-3">
                    <span class="section-number">3</span>
                    The Operational Journal Concept
                </h2>

                <p>
                    The Operational Journal is not a maintenance log. It is not a shift handover report. It is a structured documentation methodology that bridges the gap between "as designed" and "as operated," capturing the real-world engineering decisions that determine whether a facility achieves its design intent or drifts toward failure.
                </p>

                <p>
                    In traditional operations, documentation focuses on two extremes: design documents (which describe how things should work) and incident reports (which describe how things failed). The vast operational territory between these extremes goes largely undocumented. This territory includes the daily adjustments, the subtle observations, the predictive interventions, and the preventive actions that constitute the actual work of keeping critical infrastructure running. The Operational Journal captures this territory.
                </p>

                <h3>3.1 The Gap Between Design and Reality</h3>

                <p>
                    Every facility begins with a design basis. Engineers specify equipment ratings, redundancy topologies, environmental parameters, and failure modes. These specifications are validated during commissioning. Then the facility goes live, and reality diverges from design. Load patterns differ from projections. Equipment degrades at rates that vary from manufacturer specifications. Environmental conditions fluctuate beyond design envelopes. Staff rotate, bringing different experience levels and operational philosophies.
                </p>

                <p>
                    The gap between "as designed" and "as operated" is where operational engineering lives. <span class="tooltip" data-tip="European Standard for Data Centre Facilities and Infrastructures">EN 50600</span> <a href="#ref-10" class="cite">[10]</a> provides a standardized framework for data center design and operation, but the standard acknowledges that operational performance depends on more than design compliance. It depends on the quality of ongoing operational management, which includes monitoring, maintenance, change management, and continuous improvement.
                </p>

                <h3>3.2 What the Journal Captures</h3>

                <p>
                    Each journal entry follows a consistent structure, designed to create a body of evidence that demonstrates operational competence over time:
                </p>

                <ul>
                    <li><strong>Context:</strong> The operational environment, load conditions, and relevant parameters at the time of observation</li>
                    <li><strong>Signal:</strong> The observation, data point, or trend that triggered attention. This may be a <span class="tooltip" data-tip="Building Management System — centralized monitoring of MEP systems">BMS</span> alarm, a maintenance finding, a <span class="tooltip" data-tip="Data Center Infrastructure Management — software for monitoring and managing DC assets">DCIM</span> trend, or an operator's intuition based on experience</li>
                    <li><strong>Analysis:</strong> The engineering reasoning applied. What theories were considered? What data was examined? What risks were assessed?</li>
                    <li><strong>Action:</strong> The intervention taken, including any <span class="tooltip" data-tip="Management of Change — formal process for evaluating and implementing changes">MoC</span> processes, procedural changes, or coordination required</li>
                    <li><strong>Outcome:</strong> The verified result. Did the intervention achieve its intended effect? What evidence confirms this?</li>
                    <li><strong>Learning:</strong> What was learned, and how does this feed back into operating procedures, training, or design standards?</li>
                </ul>

                <p>
                    This structure serves multiple purposes. For the operations team, it creates institutional memory that survives staff turnover. For management, it provides evidence of proactive value. For auditors and regulators, it demonstrates compliance with <span class="tooltip" data-tip="ISO 55001 — International standard for asset management systems">ISO 55001</span> <a href="#ref-6" class="cite">[6]</a> asset management principles and <span class="tooltip" data-tip="Information Technology Infrastructure Library — framework for IT service management">ITIL</span> <a href="#ref-8" class="cite">[8]</a> service management frameworks. For the broader engineering community, it contributes to the collective knowledge of how critical infrastructure actually operates.
                </p>

                <h3>3.3 The Journal as Evidence</h3>

                <p>
                    Perhaps most critically, the Operational Journal creates a defensible record of proactive competence. When the question arises, "What does the operations team actually do when nothing goes wrong?" the journal provides the answer. It documents the hours of monitoring that detected a subtle trend. It records the preventive maintenance that replaced a component before failure. It captures the risk assessment that led to a procedural change. It shows the communication that aligned stakeholders around a preventive action.
                </p>

                <p>
                    In aggregate, the journal transforms invisible work into visible evidence. It shifts the organizational narrative from "nothing happened because the facility is well-designed" to "nothing happened because the operations team engineered that outcome through deliberate, documented, measurable action."
                </p>

                <!-- Section 4: Eight-Stage Framework -->
                <h2 id="section-4">
                    <span class="section-number">4</span>
                    The Eight-Stage Proactive Framework
                </h2>

                <p>
                    Proactive operations is not a single activity. It is a systematic cycle of eight interconnected stages, each contributing to the overall reliability of the facility. This framework draws from <span class="tooltip" data-tip="ISO 55001 — International standard for asset management systems">ISO 55001</span> asset management principles <a href="#ref-6" class="cite">[6]</a>, <span class="tooltip" data-tip="ITIL 4 — IT service management framework by Axelos">ITIL 4</span> service management <a href="#ref-8" class="cite">[8]</a>, and resilience engineering theory to create an integrated approach to operational excellence.
                </p>

                <div class="framework-grid">
                    <div class="framework-card">
                        <span class="framework-card-number">01</span>
                        <div class="framework-card-icon">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#3b82f6" stroke-width="2"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg>
                        </div>
                        <div class="framework-card-title">Environmental Scanning</div>
                        <div class="framework-card-desc">Continuous monitoring of external conditions including weather, grid stability, vendor advisories, and industry incident reports that may impact operations.</div>
                    </div>
                    <div class="framework-card">
                        <span class="framework-card-number">02</span>
                        <div class="framework-card-icon">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#3b82f6" stroke-width="2"><polyline points="22 12 18 12 15 21 9 3 6 12 2 12"/></svg>
                        </div>
                        <div class="framework-card-title">Predictive Analysis</div>
                        <div class="framework-card-desc">Trend analysis using BMS, DCIM, and CMMS data to identify degradation patterns before they reach failure thresholds.</div>
                    </div>
                    <div class="framework-card">
                        <span class="framework-card-number">03</span>
                        <div class="framework-card-icon">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#3b82f6" stroke-width="2"><path d="M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"/></svg>
                        </div>
                        <div class="framework-card-title">Preventive Execution</div>
                        <div class="framework-card-desc">Scheduled maintenance, calibration, and testing activities aligned with manufacturer recommendations and operational experience.</div>
                    </div>
                    <div class="framework-card">
                        <span class="framework-card-number">04</span>
                        <div class="framework-card-icon">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#3b82f6" stroke-width="2"><rect x="2" y="3" width="20" height="14" rx="2" ry="2"/><line x1="8" y1="21" x2="16" y2="21"/><line x1="12" y1="17" x2="12" y2="21"/></svg>
                        </div>
                        <div class="framework-card-title">Condition Monitoring</div>
                        <div class="framework-card-desc">Real-time and periodic assessment of equipment health through vibration analysis, thermography, oil analysis, and electrical testing.</div>
                    </div>
                    <div class="framework-card">
                        <span class="framework-card-number">05</span>
                        <div class="framework-card-icon">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#3b82f6" stroke-width="2"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg>
                        </div>
                        <div class="framework-card-title">Risk Assessment</div>
                        <div class="framework-card-desc">Structured evaluation of identified risks using probability-impact matrices, FMEA, and scenario-based analysis.</div>
                    </div>
                    <div class="framework-card">
                        <span class="framework-card-number">06</span>
                        <div class="framework-card-icon">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#3b82f6" stroke-width="2"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>
                        </div>
                        <div class="framework-card-title">Stakeholder Communication</div>
                        <div class="framework-card-desc">Proactive engagement with management, clients, vendors, and regulatory bodies to align expectations and coordinate actions.</div>
                    </div>
                    <div class="framework-card">
                        <span class="framework-card-number">07</span>
                        <div class="framework-card-icon">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#3b82f6" stroke-width="2"><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"/><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"/></svg>
                        </div>
                        <div class="framework-card-title">Knowledge Management</div>
                        <div class="framework-card-desc">Systematic capture, organization, and distribution of operational knowledge through SOPs, training materials, and lessons-learned databases.</div>
                    </div>
                    <div class="framework-card">
                        <span class="framework-card-number">08</span>
                        <div class="framework-card-icon">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#3b82f6" stroke-width="2"><polyline points="23 4 23 10 17 10"/><polyline points="1 20 1 14 7 14"/><path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"/></svg>
                        </div>
                        <div class="framework-card-title">Continuous Improvement</div>
                        <div class="framework-card-desc">Feedback loops that incorporate operational learnings into design standards, procedures, training, and organizational culture.</div>
                    </div>
                </div>

                <h3>4.1 Environmental Scanning</h3>

                <p>
                    Environmental scanning extends beyond the facility boundary to monitor conditions that could impact operations: weather (extreme heat, storms, flooding), utility grid stability (voltage, planned outages, frequency deviations), vendor advisories (firmware, recalls, known defects), and industry intelligence (peer facility outages, emerging failure modes, regulatory changes).
                </p>

                <p>
                    Effective scanning is active filtering and prioritization, not passive consumption. A heat advisory triggers pre-cooling protocols, generator pre-start, and customer notifications. A firmware vulnerability triggers patch assessment and change management. The Uptime Institute's 2023 resiliency survey found that facilities with formalized scanning programs experienced 40% fewer weather-related incidents <a href="#ref-3" class="cite">[3]</a>.
                </p>

                <h3>4.2 Predictive Analysis</h3>

                <p>
                    Predictive analysis transforms telemetry into actionable foresight. Modern data centers generate massive data volumes through <span class="tooltip" data-tip="Building Management System — centralized monitoring of MEP systems">BMS</span>, <span class="tooltip" data-tip="Data Center Infrastructure Management — software for monitoring and managing DC assets">DCIM</span>, and <span class="tooltip" data-tip="Computerized Maintenance Management System — software for maintenance scheduling and tracking">CMMS</span> platforms. The challenge is not data availability but interpretation — establishing baselines, defining thresholds, and distinguishing normal variation from early degradation.
                </p>

                <p>
                    A practical example: a chiller's coefficient of performance (COP) gradually declines over months. The decline is invisible in daily monitoring because each day's reading falls within the acceptable range. But when plotted as a trend, the degradation becomes apparent. Predictive analysis identifies this trend, projects when the COP will breach the minimum acceptable threshold, and triggers a maintenance intervention before the chiller's efficiency degrades to the point where it impacts cooling capacity.
                </p>

                <p>
                    <span class="tooltip" data-tip="Condition-Based Maintenance — maintenance triggered by actual equipment condition rather than schedule">CBM</span> and <span class="tooltip" data-tip="Predictive Maintenance — maintenance based on predicted future condition using data analysis">PdM</span> programs, as described in <span class="tooltip" data-tip="IEEE 3007.2 — Recommended Practice for Maintenance of Industrial Power Systems">IEEE 3007.2</span> <a href="#ref-12" class="cite">[12]</a>, rely on this analytical capability. They shift the maintenance paradigm from time-based schedules to condition-based triggers, optimizing both reliability and cost.
                </p>

                <h3>4.3 Preventive Execution</h3>

                <p>
                    Preventive execution is the disciplined implementation of planned maintenance — scheduled <span class="tooltip" data-tip="Preventive Maintenance — scheduled maintenance to prevent equipment failure">PM</span> activities, quarterly inspections, annual shutdowns. In a proactive framework, execution is not calendar-driven alone. It is informed by environmental scanning (external conditions), predictive analysis (degradation trends), and risk assessment (highest-value interventions).
                </p>

                <p>
                    The quality of preventive execution determines the integrity of Reason's Swiss Cheese defenses <a href="#ref-2" class="cite">[2]</a>. Each maintenance activity either strengthens or weakens a defensive layer. A properly executed <span class="tooltip" data-tip="Uninterruptible Power Supply — battery-backed power protection">UPS</span> battery test confirms backup power reliability. A poorly executed test, or a skipped test, creates an unknown vulnerability. <span class="tooltip" data-tip="Reliability-Centered Maintenance — systematic approach to determining maintenance requirements">RCM</span> methodology provides the analytical framework for determining which preventive activities deliver the greatest reliability benefit relative to their cost and risk.
                </p>

                <h3>4.4 Condition Monitoring</h3>

                <p>
                    Condition monitoring provides real-time and periodic assessment of equipment health beyond standard parameters: vibration analysis (rotating equipment), infrared thermography (electrical connections), oil analysis (transformers, generators), <span class="tooltip" data-tip="Partial Discharge — localized electrical discharge within insulation that does not bridge the gap between conductors">partial discharge</span> testing via UltraTEV and acoustic sensors (medium-voltage switchgear, cable terminations), and battery impedance testing (<span class="tooltip" data-tip="Uninterruptible Power Supply — battery-backed power protection">UPS</span> systems).
                </p>

                <p>
                    Condition monitoring detects latent failures — conditions that exist but have not yet manifested as functional failures. A hot <span class="tooltip" data-tip="Power Distribution Unit — device for distributing electric power in data centers">PDU</span> busbar connection may carry current for months before thermal failure. IR thermography detects the elevated temperature early, enabling planned intervention rather than emergency response during peak load. Similarly, partial discharge activity in MV switchgear can be detected months before insulation breakdown through UltraTEV and acoustic emission sensors, preventing catastrophic arc flash events.
                </p>

                <p>
                    <span class="tooltip" data-tip="ASHRAE Technical Committee 9.9 — develops guidelines for data center thermal management">ASHRAE TC 9.9</span> <a href="#ref-11" class="cite">[11]</a> provides thermal monitoring guidelines that set the framework for environmental condition monitoring within data halls. These guidelines define allowable temperature and humidity envelopes, but the proactive operations team uses them as the starting point for more granular monitoring that identifies micro-trends within the allowable envelope.
                </p>

                <h3>4.5 Risk Assessment</h3>

                <p>
                    Risk assessment integrates outputs from all preceding stages using <span class="tooltip" data-tip="Failure Mode and Effects Analysis — systematic method for identifying potential failure modes">FMEA</span>, Fault Tree Analysis (FTA), and risk matrices to quantify likelihood, impact, and prioritize mitigation.
                </p>

                <p>
                    In a proactive framework, risk assessment is continuous — not a one-time design exercise. When scanning identifies an unusual condition, when analysis reveals degradation, or when monitoring detects a latent defect, the framework determines response urgency. This prevents both under-reaction (ignoring genuine signals) and over-reaction (emergency responses to planned-intervention conditions).
                </p>

                <h3>4.6 Stakeholder Communication</h3>

                <p>
                    Stakeholder communication includes upward reporting (value demonstration, investment justification, risk posture), lateral coordination with vendors (maintenance alignment, technical intelligence sharing), and customer communication (operational transparency, planned activities).
                </p>

                <p>
                    Effective stakeholder communication also serves a Safety-II purpose: it creates the organizational context in which proactive work is recognized and valued. When management understands that the zero-incident quarter resulted from twelve documented preventive interventions rather than from good luck, the investment case for operations becomes self-evident.
                </p>

                <h3>4.7 Knowledge Management</h3>

                <p>
                    Knowledge management preserves operational learning: SOPs, MOPs, EOPs, training materials, annotated equipment manuals, and a searchable lessons-learned database. <span class="tooltip" data-tip="ITIL 4 — IT service management framework by Axelos">ITIL 4</span> <a href="#ref-8" class="cite">[8]</a> provides structured approaches ensuring information is captured and accessible when needed.
                </p>

                <p>
                    The value becomes clear during staff transitions. When a senior engineer departs, their knowledge of equipment quirks, failure patterns, and workarounds leaves with them. A robust KM system preserves this institutional memory so successors benefit from accumulated experience rather than relearning through trial and error.
                </p>

                <h3>4.8 Continuous Improvement</h3>

                <p>
                    Continuous improvement closes the loop — feeding learnings back into updated procedures, revised training, adjusted maintenance intervals, and evolved practices. Dekker's "just culture" <a href="#ref-9" class="cite">[9]</a> provides the foundation: an environment where learning is prioritized over blame, and teams are empowered to implement improvements without fear of punishment.
                </p>

                <p>
                    Continuous improvement is not aspirational. It is measurable. Each improvement can be tracked: how many procedures were updated this quarter? How many training modules were revised based on operational feedback? How many design standards were modified based on operational experience? These metrics transform the abstract concept of "getting better" into tangible evidence of organizational learning.
                </p>

                <!-- Article Image 2 -->
                <figure style="margin: 2rem 0; text-align: center;">
                    <img src="Article/Article_1 02.02.26/1.2.jpg" alt="Quantitative comparison of proactive versus reactive operational strategies in data center engineering" loading="lazy" style="max-width: 100%; height: auto; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.1);" decoding="async">
                </figure>

                <!-- Section 5: Proactive vs Reactive Quantification -->
                <h2 id="section-5">
                    <span class="section-number">5</span>
                    Proactive vs Reactive: Cost Quantification
                </h2>

                <p>
                    The business case for proactive operations rests on a fundamental economic principle: <strong>the cost of prevention is almost always lower than the cost of remediation</strong>. This is not an article of faith. It is a quantifiable reality that can be demonstrated through rigorous cost analysis. The Uptime Institute's 2024 data estimates that the average cost of a significant data center outage now exceeds $250,000, with major outages at large facilities reaching into the millions <a href="#ref-4" class="cite">[4]</a>.
                </p>

                <h3>5.1 Direct Cost Comparison</h3>

                <p>
                    The following table presents a representative comparison between proactive and reactive costs across common data center scenarios. These figures are derived from industry benchmarks and operational experience across Tier III and Tier IV facilities.
                </p>

                <div class="data-table-wrapper">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Scenario</th>
                                <th>Proactive Cost</th>
                                <th>Reactive Cost</th>
                                <th>Ratio</th>
                                <th>Primary Saving</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>UPS Battery Replacement (planned)</td>
                                <td>$12,000 - $18,000</td>
                                <td>$45,000 - $120,000</td>
                                <td>1:4-7x</td>
                                <td>Avoided load transfer risk</td>
                            </tr>
                            <tr>
                                <td>Chiller Compressor Bearing (CBM)</td>
                                <td>$8,000 - $15,000</td>
                                <td>$65,000 - $180,000</td>
                                <td>1:8-12x</td>
                                <td>No cooling loss event</td>
                            </tr>
                            <tr>
                                <td>ATS Contact Maintenance (PM)</td>
                                <td>$3,000 - $5,000</td>
                                <td>$25,000 - $75,000</td>
                                <td>1:8-15x</td>
                                <td>No transfer failure</td>
                            </tr>
                            <tr>
                                <td>Generator Fuel System Service</td>
                                <td>$5,000 - $8,000</td>
                                <td>$50,000 - $200,000</td>
                                <td>1:10-25x</td>
                                <td>No start failure during outage</td>
                            </tr>
                            <tr>
                                <td>Electrical Thermal + PD Scan (IR/UltraTEV)</td>
                                <td>$3,000 - $6,000</td>
                                <td>$100,000 - $500,000+</td>
                                <td>1:33-83x</td>
                                <td>No arc flash / insulation breakdown</td>
                            </tr>
                            <tr>
                                <td>Fire Suppression System Test</td>
                                <td>$4,000 - $6,000</td>
                                <td>$200,000 - $2,000,000+</td>
                                <td>1:50-333x</td>
                                <td>No suppression failure</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <p class="table-source" style="font-size:0.72rem;color:#64748b;font-style:italic;margin:0.4rem 0 1.2rem;">Source: Publicly available industry data and published standards. For educational and research purposes only.</p>

                <div class="info-box warning">
                    <div class="info-box-title">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#d97706" stroke-width="2">
                            <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/>
                            <line x1="12" y1="9" x2="12" y2="13"/>
                            <line x1="12" y1="17" x2="12.01" y2="17"/>
                        </svg>
                        Critical Context
                    </div>
                    <p style="margin: 0; font-size: 0.85rem; line-height: 1.6;">
                        Reactive costs include not only direct repair expenses but also SLA penalties, revenue loss, reputational damage, emergency labor premiums, expedited shipping, and potential regulatory consequences. The Uptime Institute notes that <strong>reputational costs often exceed direct financial losses by 2-3x</strong> but are rarely captured in cost analyses <a href="#ref-4" class="cite">[4]</a>.
                    </p>
                </div>

                <h3>5.2 The <span class="tooltip" data-tip="Mean Time Between Failures — average time between system failures">MTBF</span> / <span class="tooltip" data-tip="Mean Time To Repair — average time required to repair a failed system">MTTR</span> Economics</h3>

                <p>
                    The economic relationship between proactive and reactive operations can be expressed through reliability metrics. Proactive operations systematically increase <span class="tooltip" data-tip="Mean Time Between Failures — average time between system failures">MTBF</span> (by preventing failures) and decrease <span class="tooltip" data-tip="Mean Time To Repair — average time required to repair a failed system">MTTR</span> (by ensuring readiness when failures do occur). The compound effect on availability is dramatic.
                </p>

                <div class="formula-box">
                    <div class="formula-box-title">Availability Equation</div>
                    <div style="font-size: 0.85rem; line-height: 1.8;">
                        Availability = MTBF / (MTBF + MTTR)<br><br>
                        <strong>Example — Reactive operations:</strong><br>
                        MTBF = 2,000 hrs | MTTR = 8 hrs<br>
                        A = 2,000 / (2,000 + 8) = 99.601%<br>
                        Annual downtime = 35.0 hours<br><br>
                        <strong>Example — Proactive operations:</strong><br>
                        MTBF = 8,000 hrs | MTTR = 2 hrs<br>
                        A = 8,000 / (8,000 + 2) = 99.975%<br>
                        Annual downtime = 2.2 hours
                    </div>
                </div>

                <p>
                    The proactive scenario achieves a 16x reduction in annual downtime, not through any single dramatic intervention but through the cumulative effect of thousands of small operational decisions that extend MTBF and reduce MTTR. The Uptime Institute's staffing and training guidelines <a href="#ref-5" class="cite">[5]</a> directly correlate staffing adequacy and training quality with these reliability outcomes.
                </p>

                <h3>5.3 Hidden Costs of Reactive Culture</h3>

                <p>
                    Beyond direct financial impacts, a reactive operational culture incurs hidden costs that are difficult to quantify but significant in impact:
                </p>

                <div class="data-table-wrapper">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Hidden Cost Category</th>
                                <th>Description</th>
                                <th>Estimated Impact</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Staff Burnout</strong></td>
                                <td>Emergency responses, weekend callouts, high-stress firefighting</td>
                                <td>25-40% higher turnover</td>
                            </tr>
                            <tr>
                                <td><strong>Knowledge Loss</strong></td>
                                <td>Experienced staff leave due to burnout, taking institutional knowledge</td>
                                <td>6-12 months productivity gap per departure</td>
                            </tr>
                            <tr>
                                <td><strong>Decision Fatigue</strong></td>
                                <td>Constant crisis mode degrades decision quality</td>
                                <td>15-30% more errors under sustained stress</td>
                            </tr>
                            <tr>
                                <td><strong>Deferred Maintenance</strong></td>
                                <td>Reactive events consume resources meant for preventive work, accelerating <a href="article-5.html" style="color: inherit; text-decoration: underline;">technical debt accumulation</a></td>
                                <td>Compounding reliability decline</td>
                            </tr>
                            <tr>
                                <td><strong>Client Confidence</strong></td>
                                <td>Repeated incidents erode trust, affecting retention and growth</td>
                                <td>10-25% client churn risk</td>
                            </tr>
                            <tr>
                                <td><strong>Insurance Premiums</strong></td>
                                <td>Claims history increases premiums and reduces coverage</td>
                                <td>15-50% premium increase after claims</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <p class="table-source" style="font-size:0.72rem;color:#64748b;font-style:italic;margin:0.4rem 0 1.2rem;">Source: Publicly available industry data and published standards. For educational and research purposes only.</p>

                <p>
                    Including these hidden costs, the case for proactive operations becomes overwhelming. Reactive operations create a self-reinforcing cycle: each incident consumes resources meant for prevention, making the next incident more likely.
                </p>

                <!-- Section 6: Case Context -->
                <h2 id="section-6">
                    <span class="section-number">6</span>
                    Case Context: 10MW Facility Operations
                </h2>

                <p>
                    To ground this framework in reality, consider the operational context from which this journal originates: a 10MW critical data center facility operating at Tier III equivalency. Over a six-month period, the operations team documented twelve prevented incidents, each representing a potential service impact that was detected, assessed, and mitigated before any customer-visible effect occurred.
                </p>

                <div class="info-box success">
                    <div class="info-box-title">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#059669" stroke-width="2">
                            <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
                            <polyline points="22 4 12 14.01 9 11.01"></polyline>
                        </svg>
                        Six-Month Operational Summary
                    </div>
                    <ul style="margin: 0; padding-left: 1.25rem; line-height: 1.8; font-size: 0.85rem;">
                        <li><strong>12 prevented incidents</strong> documented through proactive detection</li>
                        <li><strong>Zero unplanned outages</strong> during the period</li>
                        <li><strong>99.999% availability</strong> maintained across all critical systems</li>
                        <li><strong>$1.2M+ estimated avoided costs</strong> from prevented failures</li>
                        <li><strong><span class="tooltip" data-tip="Power Usage Effectiveness — ratio of total facility energy to IT equipment energy">PUE</span> improvement from 1.65 to 1.48</strong> through operational optimization</li>
                    </ul>
                </div>

                <h3>6.1 The Twelve Prevented Incidents</h3>

                <p>
                    These twelve cases span electrical distribution, cooling, fire protection, and IT systems. Each was detected through proactive monitoring, analyzed using the eight-stage framework, and resolved before becoming an incident.
                </p>

                <div class="data-table-wrapper">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>#</th>
                                <th>System</th>
                                <th>Detection Method</th>
                                <th>Risk Level</th>
                                <th>Estimated Avoided Cost</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>1</td>
                                <td><span class="tooltip" data-tip="Uninterruptible Power Supply — battery-backed power protection">UPS</span> Battery String</td>
                                <td>Impedance trend analysis</td>
                                <td><span class="maturity-badge reactive">Critical</span></td>
                                <td>$120,000 - $250,000</td>
                            </tr>
                            <tr>
                                <td>2</td>
                                <td>Chiller #3 Compressor</td>
                                <td>Vibration analysis anomaly</td>
                                <td><span class="maturity-badge preventive">High</span></td>
                                <td>$85,000 - $180,000</td>
                            </tr>
                            <tr>
                                <td>3</td>
                                <td><span class="tooltip" data-tip="Automatic Transfer Switch — device that switches between power sources">ATS</span>-2A Transfer Contacts</td>
                                <td>Micro-ohm resistance testing</td>
                                <td><span class="maturity-badge reactive">Critical</span></td>
                                <td>$75,000 - $150,000</td>
                            </tr>
                            <tr>
                                <td>4</td>
                                <td>CRAH Unit #7 EC Fan</td>
                                <td>Current draw trending</td>
                                <td><span class="maturity-badge predictive">Medium</span></td>
                                <td>$25,000 - $45,000</td>
                            </tr>
                            <tr>
                                <td>5</td>
                                <td>MV Switchgear Bus Section</td>
                                <td>UltraTEV partial discharge + IR thermography</td>
                                <td><span class="maturity-badge reactive">Critical</span></td>
                                <td>$200,000 - $500,000</td>
                            </tr>
                            <tr>
                                <td>6</td>
                                <td>Generator #2 Fuel Injector</td>
                                <td>Load bank test analysis</td>
                                <td><span class="maturity-badge preventive">High</span></td>
                                <td>$50,000 - $120,000</td>
                            </tr>
                            <tr>
                                <td>7</td>
                                <td>Fire Suppression Zone B</td>
                                <td>Pressure decay monitoring</td>
                                <td><span class="maturity-badge preventive">High</span></td>
                                <td>$30,000 - $80,000</td>
                            </tr>
                            <tr>
                                <td>8</td>
                                <td>Cooling Tower Fill Media</td>
                                <td>Approach temperature trending</td>
                                <td><span class="maturity-badge predictive">Medium</span></td>
                                <td>$40,000 - $90,000</td>
                            </tr>
                            <tr>
                                <td>9</td>
                                <td><span class="tooltip" data-tip="Power Distribution Unit — device for distributing electric power in data centers">PDU</span> Busbar Connection</td>
                                <td>Thermal imaging survey</td>
                                <td><span class="maturity-badge preventive">High</span></td>
                                <td>$60,000 - $150,000</td>
                            </tr>
                            <tr>
                                <td>10</td>
                                <td>11kV Cable Termination (Ring Main)</td>
                                <td>Acoustic partial discharge + <span class="tooltip" data-tip="Transient Earth Voltage — surface discharge detection on metallic enclosures">TEV</span> monitoring</td>
                                <td><span class="maturity-badge reactive">Critical</span></td>
                                <td>$180,000 - $450,000</td>
                            </tr>
                            <tr>
                                <td>11</td>
                                <td>Chilled Water Valve Actuator</td>
                                <td>Response time degradation</td>
                                <td><span class="maturity-badge predictive">Medium</span></td>
                                <td>$20,000 - $55,000</td>
                            </tr>
                            <tr>
                                <td>12</td>
                                <td>Diesel Storage Tank</td>
                                <td>Fuel quality sampling</td>
                                <td><span class="maturity-badge preventive">High</span></td>
                                <td>$35,000 - $100,000</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <p class="table-source" style="font-size:0.72rem;color:#64748b;font-style:italic;margin:0.4rem 0 1.2rem;">Source: Publicly available industry data and published standards. For educational and research purposes only.</p>

                <h3>6.2 The Aggregate Effect</h3>

                <p>
                    The aggregate avoided cost across these twelve interventions ranges from $920,000 to $2,170,000. The total cost of the proactive activities that enabled their detection, including monitoring equipment, training, labor hours, and maintenance materials, was approximately $180,000 over the six-month period. This yields a return on prevention investment of approximately <strong>5:1 to 12:1</strong>, depending on which end of the cost range materializes.
                </p>

                <p>
                    But the financial return understates the true value. Consider what would have happened if even one of the critical-rated items, say the MV switchgear bus section, had progressed to failure. A medium-voltage arc flash event in a data center can result in extended facility downtime (weeks, not hours), equipment damage requiring full replacement, potential personnel injury, regulatory investigation, and permanent customer loss. The prevented incident is not merely a cost saving. It is the preservation of the facility's operational continuity and its license to operate.
                </p>

                <p>
                    Each case will be detailed in subsequent journal entries using the Section 3 format. Together, they demonstrate that proactive operations produce documented, measurable outcomes — not merely the absence of failures.
                </p>

                <!-- Section 7: The Culture Trap -->
                <h2 id="section-7">
                    <span class="section-number">7</span>
                    The Culture Trap: Heroes vs Boring Competence
                </h2>

                <p>
                    There is a deeply embedded cultural bias in organizations that rewards dramatic response over quiet prevention. The engineer who stays up all night restoring a failed system is celebrated as a hero. The engineer who quietly replaced a degrading component three weeks earlier, preventing the failure entirely, receives no recognition because there was no crisis to resolve. This is what we call the Culture Trap, and it is one of the most significant barriers to achieving operational maturity.
                </p>

                <blockquote>
                    "The field of safety has, over the years, built up a belief that we should find and fix failures. But this belief may also have kept us from seeing what goes right, and understanding why." <a href="#ref-1" class="cite">[1]</a>
                </blockquote>

                <h3>7.1 The Firefighter Hero Syndrome</h3>

                <p>
                    In reactive organizations, the highest-status individuals are crisis responders — called at 2:00 AM, knowing every system from troubleshooting every failure, their dramatic saves becoming legends. These individuals are often extraordinarily skilled. The problem is systemic: the organization rewards conditions that produce crises rather than conditions that prevent them.
                </p>

                <p>
                    Sidney Dekker's analysis of organizational culture <a href="#ref-9" class="cite">[9]</a> identifies this as a systemic issue, not a character flaw. When organizations measure success by incident resolution speed (MTTR) rather than incident prevention (MTBF), they create incentive structures that value reactive competence over proactive discipline. The natural consequence is that resources flow toward response capability rather than prevention capability, which in turn increases the frequency of events requiring response.
                </p>

                <h3>7.2 The Boring Competence Paradox</h3>

                <p>
                    Truly excellent operations are boring. The shifts are uneventful. The maintenance schedules are followed. The monitoring screens are green. There are no dramatic stories to tell, because the dramatic situations were prevented before they developed. This "boring competence" is the hallmark of mature operational organizations, but it is deeply unsatisfying to organizational narratives that seek drama, heroism, and visible achievement.
                </p>

                <p>
                    The challenge for operations leaders is to reframe this narrative. Boring competence must be recognized not as the absence of achievement but as the highest form of achievement. The data speaks clearly: the Uptime Institute's research shows that facilities with the lowest incident rates are those with the most disciplined, most documented, most process-driven operational cultures <a href="#ref-3" class="cite">[3]</a>. These are not exciting cultures. They are effective cultures.
                </p>

                <h3>7.3 Breaking the Trap</h3>

                <p>
                    Breaking the Culture Trap requires deliberate organizational intervention across three dimensions:
                </p>

                <ul>
                    <li><strong>Metrics reform:</strong> Shift primary KPIs from reactive measures (incidents, MTTR, SLA breaches) to proactive measures (prevented incidents, PM compliance, training hours, knowledge base updates, maturity scores)</li>
                    <li><strong>Recognition redesign:</strong> Create formal recognition mechanisms for proactive achievements. Celebrate the engineer who detected the degrading bearing, not just the one who replaced it after failure</li>
                    <li><strong>Narrative transformation:</strong> Use the Operational Journal to tell the story of prevention. Make the invisible work visible through documentation, reporting, and stakeholder communication</li>
                </ul>

                <p>
                    Weick and Sutcliffe's concept of "preoccupation with failure" <a href="#ref-7" class="cite">[7]</a> provides the intellectual foundation. In High Reliability Organizations, the absence of failure is never assumed to be evidence of safety. Instead, it triggers deeper investigation: "What are we not seeing? What risks are accumulating beneath the surface of our green dashboards?" This mindset transforms boring competence from a liability (nothing to report) into an asset (everything to investigate).
                </p>

                <!-- Section 8: Maturity Metrics -->
                <h2 id="section-8">
                    <span class="section-number">8</span>
                    Maturity Metrics: The Five-Level Model
                </h2>

                <p>
                    Operational maturity is not binary. Organizations do not simply transition from "reactive" to "proactive." Instead, they progress through identifiable stages, each characterized by specific capabilities, metrics, and organizational behaviors. The five-level maturity model presented here draws from the Capability Maturity Model Integration (CMMI) framework, adapted for data center operations using principles from <span class="tooltip" data-tip="ISO 55001 — International standard for asset management systems">ISO 55001</span> <a href="#ref-6" class="cite">[6]</a>, <span class="tooltip" data-tip="ITIL 4 — IT service management framework by Axelos">ITIL 4</span> <a href="#ref-8" class="cite">[8]</a>, and the Uptime Institute's operational assessment criteria <a href="#ref-3" class="cite">[3]</a>.
                </p>

                <div class="data-table-wrapper">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Level</th>
                                <th>Name</th>
                                <th>Score Range</th>
                                <th>Characteristics</th>
                                <th>Typical MTBF</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><span class="maturity-badge reactive">1</span></td>
                                <td><strong>Reactive</strong></td>
                                <td>0 - 20</td>
                                <td>Ad-hoc responses, no formal processes, heroic individual effort, undocumented procedures</td>
                                <td>&lt; 2,000 hrs</td>
                            </tr>
                            <tr>
                                <td><span class="maturity-badge preventive">2</span></td>
                                <td><strong>Preventive</strong></td>
                                <td>21 - 40</td>
                                <td>Basic PM schedules, some documentation, reactive root cause analysis, limited training</td>
                                <td>2,000 - 5,000 hrs</td>
                            </tr>
                            <tr>
                                <td><span class="maturity-badge predictive">3</span></td>
                                <td><strong>Predictive</strong></td>
                                <td>41 - 60</td>
                                <td>Data-driven maintenance, trend analysis, condition monitoring, formal MoC process, structured training</td>
                                <td>5,000 - 15,000 hrs</td>
                            </tr>
                            <tr>
                                <td><span class="maturity-badge proactive">4</span></td>
                                <td><strong>Proactive</strong></td>
                                <td>61 - 80</td>
                                <td>Integrated risk management, Safety-II thinking, comprehensive knowledge management, continuous improvement</td>
                                <td>15,000 - 40,000 hrs</td>
                            </tr>
                            <tr>
                                <td><span class="maturity-badge generative">5</span></td>
                                <td><strong>Generative</strong></td>
                                <td>81 - 100</td>
                                <td>Organizational learning culture, innovation-driven, industry leadership, resilience engineering embedded</td>
                                <td>&gt; 40,000 hrs</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <p class="table-source" style="font-size:0.72rem;color:#64748b;font-style:italic;margin:0.4rem 0 1.2rem;">Source: Publicly available industry data and published standards. For educational and research purposes only.</p>

                <h3>8.1 Assessment Dimensions</h3>

                <p>
                    The maturity assessment evaluates eight dimensions of operational capability, each weighted according to its impact on overall reliability. These dimensions are not independent; they interact in ways that can either amplify or undermine the overall maturity level. An organization with excellent monitoring but poor knowledge management, for example, may detect problems it cannot effectively resolve because the procedures and training are inadequate.
                </p>

                <ul>
                    <li><strong>Documentation (10%):</strong> Quality, currency, and accessibility of operating procedures, equipment records, and as-built documentation</li>
                    <li><strong>Training (15%):</strong> Comprehensiveness of training programs, including initial qualification, ongoing proficiency, and scenario-based exercises</li>
                    <li><strong>Change Management (15%):</strong> Rigor of <span class="tooltip" data-tip="Management of Change — formal process for evaluating and implementing changes">MoC</span> processes, including risk assessment, stakeholder notification, rollback planning, and post-change verification</li>
                    <li><strong>Monitoring (15%):</strong> Coverage and sophistication of monitoring systems, including <span class="tooltip" data-tip="Building Management System — centralized monitoring of MEP systems">BMS</span>, <span class="tooltip" data-tip="Data Center Infrastructure Management — software for monitoring and managing DC assets">DCIM</span>, alarm management, and trend analysis capability</li>
                    <li><strong>Maintenance (15%):</strong> Integration of preventive, predictive, and condition-based maintenance strategies, PM compliance rates, and spares management</li>
                    <li><strong>Emergency Readiness (10%):</strong> Quality of emergency procedures, drill frequency, response team competency, and communication protocols</li>
                    <li><strong>Continuous Improvement (10%):</strong> Feedback loop effectiveness, lessons learned integration, procedure update frequency, and innovation adoption</li>
                    <li><strong>Leadership (10%):</strong> Management commitment to operational excellence, resource allocation adequacy, safety culture promotion, and strategic vision</li>
                </ul>

                <h3>8.2 Industry Benchmarks</h3>

                <p>
                    Based on industry data from the Uptime Institute and operational assessments across multiple facilities, the following benchmarks provide context for maturity scoring:
                </p>

                <ul>
                    <li><strong>Tier I facilities:</strong> Average composite score of 25 (Preventive level). Basic maintenance programs, limited documentation, reactive incident management</li>
                    <li><strong>Tier II facilities:</strong> Average composite score of 45 (Predictive level). Structured maintenance, developing documentation, some trend analysis</li>
                    <li><strong>Tier III facilities:</strong> Average composite score of 65 (Proactive level). Comprehensive maintenance, formal change management, condition monitoring deployed</li>
                    <li><strong>Tier IV facilities:</strong> Average composite score of 82 (Generative level). Integrated operations, advanced analytics, continuous improvement embedded in culture</li>
                </ul>

                <p>
                    These benchmarks are approximations based on aggregate data and should be used directionally rather than prescriptively. Individual facility performance varies significantly based on organizational factors, staffing quality, and management commitment.
                </p>

                <!-- Section 9: Calculator -->
                <h2 id="section-9">
                    <span class="section-number">9</span>
                    Calculator: Operational Maturity Assessment
                </h2>

                <p>
                    Use the interactive calculator below to assess your facility's operational maturity across the eight dimensions. Rate each dimension on a 1-5 scale, where 1 represents ad-hoc practices and 5 represents fully optimized, industry-leading performance. The calculator will compute your composite maturity score, identify priority improvement areas, and compare your results against industry benchmarks.
                </p>

                <!-- Calculator Widget -->
                <div class="calculator-section" id="maturityCalculator">
                    <h3 class="calculator-title">Operational Maturity Assessment</h3>
                    <p class="calculator-subtitle">Rate each dimension from 1 (Ad-hoc) to 5 (Optimized) to calculate your composite maturity score</p>

                    <!-- Mode Toggle + Action Buttons -->
                    <div class="maturity-toolbar-row">
                        <div class="maturity-mode-bar">
                            <button class="maturity-mode-btn active" id="maturityModeFree" onclick="switchMaturityMode('free')"><i class="fas fa-chart-simple"></i> Free Assessment</button>
                            <button class="maturity-mode-btn" id="maturityModePro" onclick="switchMaturityMode('pro')"><i class="fas fa-microscope"></i> Pro Analysis <span class="gated-badge" id="maturityProBadge">PRO</span></button>
                        </div>
                        <div class="maturity-toolbar-actions">
                            <button class="maturity-export-btn" onclick="exportMaturityPDF()" style="padding:8px 14px;font-size:0.78rem;margin:0;">
                                <i class="fas fa-file-pdf"></i> Export PDF
                            </button>
                        </div>
                    </div>

                    <!-- ─── 8 DIMENSION INPUTS (Visual Card Interface) ─── -->
                    <div class="dim-cards-grid" id="dimCardsGrid"></div>

                    <!-- ─── EXECUTIVE SUMMARY CARDS ─── -->
                    <div class="exec-cards" id="execCards">
                        <div class="exec-card" id="exec-health" style="background:linear-gradient(135deg,rgba(234,179,8,0.15),rgba(234,179,8,0.05));border-color:rgba(234,179,8,0.3);">
                            <div class="exec-card-label">Operational Health</div>
                            <div class="exec-card-value" id="exec-health-val" style="color:#eab308;">50/100</div>
                            <div class="exec-card-sub" id="exec-health-sub" style="color:#eab308;">Benchmark: Tier II</div>
                        </div>
                        <div class="exec-card" id="exec-risk" style="background:linear-gradient(135deg,rgba(234,179,8,0.15),rgba(234,179,8,0.05));border-color:rgba(234,179,8,0.3);">
                            <div class="exec-card-label">Risk Exposure</div>
                            <div class="exec-card-value" id="exec-risk-val" style="color:#eab308;">MODERATE</div>
                            <div class="exec-card-sub" id="exec-risk-sub" style="color:#eab308;">$292K · Est. Annual</div>
                        </div>
                        <div class="exec-card" id="exec-bottleneck" style="background:linear-gradient(135deg,rgba(239,68,68,0.12),rgba(239,68,68,0.04));border-color:rgba(239,68,68,0.25);">
                            <div class="exec-card-label">Critical Bottleneck</div>
                            <div class="exec-card-value" id="exec-bottleneck-val" style="color:#f87171;font-size:1rem;font-weight:800;">CHANGE MGMT</div>
                            <div class="exec-card-sub" id="exec-bottleneck-sub" style="color:#f87171;">Score: 3/5 · Priority: 0.195</div>
                        </div>
                        <div class="exec-card" id="exec-milestone" style="background:linear-gradient(135deg,rgba(59,130,246,0.12),rgba(59,130,246,0.04));border-color:rgba(59,130,246,0.25);">
                            <div class="exec-card-label">Next Milestone</div>
                            <div class="exec-card-value" id="exec-milestone-val" style="color:#60a5fa;">80</div>
                            <div class="exec-card-sub" id="exec-milestone-sub" style="color:#60a5fa;">+11 pts · Proactive</div>
                        </div>
                    </div>

                    <!-- ─── RESULTS ─── -->
                    <div class="calc-results">
                        <div class="calc-result-item">
                            <div class="calc-result-value" id="result-score">50</div>
                            <div class="calc-result-label" style="display:flex;align-items:center;justify-content:center;gap:4px;">Composite Score (0-100)
                                <span class="tooltip-trigger">?<span class="tooltip-content"><div class="tooltip-title">Composite Score</div><div class="tooltip-desc">Normalized score mapping 1-5 weighted average to 0-100 scale.</div><div class="tooltip-formula">((WeightedSum - 1) / 4) &times; 100</div><div class="tooltip-desc" style="margin-top:6px;">Score of 50 = all dimensions at Level 3 (Defined).</div></span></span>
                            </div>
                        </div>
                        <div class="calc-result-item">
                            <div class="calc-result-value" id="result-level">3</div>
                            <div class="calc-result-label" style="display:flex;align-items:center;justify-content:center;gap:4px;">Maturity Level
                                <span class="tooltip-trigger">?<span class="tooltip-content"><div class="tooltip-title">Maturity Level (1-5)</div><div class="tooltip-desc">1 = Reactive (0-20): Firefighting mode<br>2 = Preventive (21-40): Basic PM in place<br>3 = Predictive (41-60): Data-driven decisions<br>4 = Proactive (61-80): Risk anticipation<br>5 = Generative (81-100): Self-improving system</div></span></span>
                            </div>
                        </div>
                        <div class="calc-result-item">
                            <div class="calc-result-value" id="result-label" style="font-size: 1.1rem;">Predictive</div>
                            <div class="calc-result-label" style="display:flex;align-items:center;justify-content:center;gap:4px;">Maturity Category
                                <span class="tooltip-trigger">?<span class="tooltip-content"><div class="tooltip-title">Maturity Category</div><div class="tooltip-desc"><strong>Reactive</strong> — Firefighting, no process, high incident rate<br><strong>Preventive</strong> — Scheduled maintenance, some structure<br><strong>Predictive</strong> — Data-driven, trending, condition monitoring<br><strong>Proactive</strong> — Anticipatory risk management, leading indicators<br><strong>Generative</strong> — Self-improving, Safety-II, organizational learning</div></span></span>
                            </div>
                        </div>
                        <div class="calc-result-item">
                            <div class="calc-result-value" id="result-weighted">3.00</div>
                            <div class="calc-result-label" style="display:flex;align-items:center;justify-content:center;gap:4px;">Weighted Average (1-5)
                                <span class="tooltip-trigger">?<span class="tooltip-content"><div class="tooltip-title">Weighted Average</div><div class="tooltip-desc">Raw weighted mean before normalization. Each dimension score (1-5) multiplied by its percentage weight. Range: 1.00 (all Level 1) to 5.00 (all Level 5).</div></span></span>
                            </div>
                        </div>
                        <div class="calc-result-item">
                            <div class="calc-result-value" id="result-rmi" style="color:#10b981;">50%</div>
                            <div class="calc-result-label" style="display:flex;align-items:center;justify-content:center;gap:4px;">Risk Mitigation Index
                                <span class="tooltip-trigger">?<span class="tooltip-content"><div class="tooltip-title">Risk Mitigation Index (RMI)</div><div class="tooltip-desc">Percentage of potential operational risk currently mitigated, based on weighted impact factors.<br><br><strong>Formula:</strong> RMI = &Sigma;(score &times; weight &times; impact) / &Sigma;(5 &times; weight &times; impact) &times; 100<br><br>100% = all dimensions at Level 5 with maximum risk coverage. &lt;40% = critical exposure.</div></span></span>
                            </div>
                        </div>
                    </div>

                    <!-- Radar Panel — Maturity Profile -->
                    <div class="radar-panel">
                        <div class="radar-panel-header">
                            <div class="radar-panel-title">Maturity Profile</div>
                            <div class="radar-legend">
                                <div class="radar-legend-item"><div class="radar-legend-swatch" style="background:#60a5fa;"></div> Current Maturity</div>
                                <div class="radar-legend-item"><div class="radar-legend-swatch" style="background:#a78bfa;border:1px dashed #c4b5fd;"></div> ISO 55001 Target</div>
                            </div>
                        </div>
                        <div class="radar-chart-container">
                            <canvas id="radarCanvas" width="400" height="400"></canvas>
                        </div>
                        <div class="strategic-insight">
                            <div class="strategic-insight-title">Strategic Insight</div>
                            <div class="strategic-insight-text" id="strategicInsightText">Calculating...</div>
                        </div>
                    </div>

                    <!-- ─── PRO INPUT PANELS ─── -->
                    <div id="maturityProInputs" style="display:none;">

                        <!-- 1. Facility Context -->
                        <div class="pro-panel" id="proFacilityContext">
                            <div class="pro-panel-inner">
                                <div class="pro-panel-title"><i class="fas fa-building"></i> Facility Context
                                    <span class="tooltip-trigger" style="margin-left:auto;">?<span class="tooltip-content"><div class="tooltip-title">Facility Context</div><div class="tooltip-desc">Contextualizes your maturity score against your facility's profile. Larger facilities and higher tiers typically require higher maturity to operate safely. This data appears in your PDF report.</div></span></span>
                                </div>
                                <div class="facility-grid">
                                    <div class="calc-input-group">
                                        <label class="calc-label" style="display:flex;align-items:center;">Capacity (MW)
                                            <span class="tooltip-trigger" style="margin-left:4px;">?<span class="tooltip-content"><div class="tooltip-title">IT Capacity</div><div class="tooltip-desc">Total IT power capacity. Larger facilities (10+ MW) need higher operational maturity due to complexity, blast radius, and regulatory scrutiny.</div></span></span>
                                        </label>
                                        <select class="calc-select" id="pro-capacity" onchange="calculateMaturity()">
                                            <option value="1">1 MW</option><option value="2">2 MW</option><option value="5" selected>5 MW</option><option value="10">10 MW</option><option value="20">20 MW</option><option value="50">50 MW</option><option value="100">100+ MW</option>
                                        </select>
                                    </div>
                                    <div class="calc-input-group">
                                        <label class="calc-label" style="display:flex;align-items:center;">Facility Type
                                            <span class="tooltip-trigger" style="margin-left:4px;">?<span class="tooltip-content"><div class="tooltip-title">Facility Type</div><div class="tooltip-desc"><strong>Enterprise:</strong> Single-tenant, internal IT<br><strong>Colocation:</strong> Multi-tenant, shared infrastructure<br><strong>Hyperscale:</strong> 50+ MW, cloud provider-grade<br><strong>Edge:</strong> Distributed, remote, unmanned</div></span></span>
                                        </label>
                                        <select class="calc-select" id="pro-type" onchange="calculateMaturity()">
                                            <option value="enterprise">Enterprise</option><option value="colocation" selected>Colocation</option><option value="hyperscale">Hyperscale</option><option value="edge">Edge</option>
                                        </select>
                                    </div>
                                    <div class="calc-input-group">
                                        <label class="calc-label" style="display:flex;align-items:center;">Redundancy Tier
                                            <span class="tooltip-trigger" style="margin-left:4px;">?<span class="tooltip-content"><div class="tooltip-title">Uptime Tier Level</div><div class="tooltip-desc"><strong>Tier I:</strong> Basic, no redundancy (99.671%)<br><strong>Tier II:</strong> Redundant components (99.741%)<br><strong>Tier III:</strong> Concurrently maintainable (99.982%)<br><strong>Tier IV:</strong> Fault tolerant (99.995%)</div></span></span>
                                        </label>
                                        <select class="calc-select" id="pro-tier" onchange="calculateMaturity()">
                                            <option value="1">Tier I</option><option value="2">Tier II</option><option value="3" selected>Tier III</option><option value="4">Tier IV</option>
                                        </select>
                                    </div>
                                    <div class="calc-input-group">
                                        <label class="calc-label" style="display:flex;align-items:center;">Operating Model
                                            <span class="tooltip-trigger" style="margin-left:4px;">?<span class="tooltip-content"><div class="tooltip-title">Operating Model</div><div class="tooltip-desc"><strong>In-House:</strong> All staff employed directly<br><strong>Managed Services:</strong> Outsourced to FM provider<br><strong>Hybrid:</strong> Core team in-house, specialists outsourced</div></span></span>
                                        </label>
                                        <select class="calc-select" id="pro-model" onchange="calculateMaturity()">
                                            <option value="inhouse" selected>In-House</option><option value="managed">Managed Services</option><option value="hybrid">Hybrid</option>
                                        </select>
                                    </div>
                                    <div class="calc-input-group">
                                        <label class="calc-label" style="display:flex;align-items:center;">Region
                                            <span class="tooltip-trigger" style="margin-left:4px;">?<span class="tooltip-content"><div class="tooltip-title">Geographic Region</div><div class="tooltip-desc">Affects benchmark comparison. APAC, Americas, and EMEA have different regulatory environments and maturity baselines.</div></span></span>
                                        </label>
                                        <select class="calc-select" id="pro-region" onchange="calculateMaturity()">
                                            <option value="apac" selected>Asia Pacific</option><option value="americas">Americas</option><option value="emea">EMEA</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- 2. Custom Weights -->
                        <div class="pro-panel" id="proCustomWeights">
                            <div class="pro-panel-inner">
                                <div class="pro-panel-title"><i class="fas fa-sliders"></i> Custom Weights
                                    <span class="tooltip-trigger" style="margin-left:auto;">?<span class="tooltip-content"><div class="tooltip-title">Custom Dimension Weights</div><div class="tooltip-desc">Adjust how much each dimension contributes to the final score. Use presets for industry-specific weighting or manually tune each slider. Total must equal 100%. AI/HPC facilities typically weight Monitoring and Maintenance higher.</div></span></span>
                                </div>
                                <div class="weight-preset-bar" id="weightPresetBar"></div>
                                <div class="weight-editor-grid" id="weightEditorGrid"></div>
                                <div class="weight-total" id="weightTotal">Total: 100%</div>
                            </div>
                        </div>

                        <!-- 3. Sub-Dimension Scoring -->
                        <div class="pro-panel" id="proSubDimensions">
                            <div class="pro-panel-inner">
                                <div class="pro-panel-title"><i class="fas fa-layer-group"></i> Sub-Dimension Scoring
                                    <span class="tooltip-trigger" style="margin-left:auto;">?<span class="tooltip-content"><div class="tooltip-title">Sub-Dimension Detail</div><div class="tooltip-desc">Break each dimension into 4-6 specific practices for granular scoring. The average of sub-dimensions automatically updates the parent dimension score. Click each accordion to expand and rate individual practices.</div></span></span>
                                </div>
                                <div id="subDimContainer"></div>
                            </div>
                        </div>
                    </div>

                    <!-- Dimension Bars -->
                    <h4 style="color: #e2e8f0; margin: 2rem 0 1rem; font-size: 0.95rem;">Dimension Scores</h4>
                    <div class="dimension-bars" id="dimensionBars"></div>

                    <!-- Top 3 Priorities -->
                    <h4 style="color: #e2e8f0; margin: 2rem 0 1rem; font-size: 0.95rem; display:flex;align-items:center;gap:6px;">Top 3 Improvement Priorities
                        <span class="tooltip-trigger">?<span class="tooltip-content"><div class="tooltip-title">Priority Score</div><div class="tooltip-desc">Calculated as (5 - Score) &times; Weight &times; Impact Multiplier. Higher score = more leverage from improving this dimension first.</div></span></span>
                    </h4>
                    <div class="priority-list" id="priorityList"></div>

                    <!-- Benchmark Comparison -->
                    <h4 style="color: #e2e8f0; margin: 2rem 0 1rem; font-size: 0.95rem; display:flex;align-items:center;gap:6px;">Benchmark Comparison
                        <span class="tooltip-trigger">?<span class="tooltip-content"><div class="tooltip-title">Industry Benchmarks</div><div class="tooltip-desc">Directional benchmarks from Uptime Institute &amp; industry assessments.<br><br>Tier I ≈ 25 · Tier II ≈ 45 · Tier III ≈ 65 · Tier IV ≈ 82<br><br>Your score is highlighted against these reference points.</div></span></span>
                    </h4>
                    <div class="benchmark-grid" id="benchmarkGrid"></div>
                    <div class="benchmark-meta">
                        <span class="benchmark-meta-tag"><i class="fas fa-code-branch"></i> Model v1.2</span>
                        <span class="benchmark-meta-tag"><i class="fas fa-calendar"></i> Updated Feb 2026</span>
                        <span class="benchmark-meta-tag"><i class="fas fa-book"></i> Sources: Uptime Institute 2023-2024, EN 50600</span>
                        <span class="benchmark-meta-tag"><i class="fas fa-info-circle"></i> Directional benchmarks (median, enterprise + colo)</span>
                    </div>

                    <!-- ISO 55001 Roadmap -->
                    <h4 style="color: #e2e8f0; margin: 2rem 0 0.5rem; font-size: 0.95rem; display:flex;align-items:center;gap:6px;">
                        <i class="fas fa-road" style="color:#3b82f6;"></i> ISO 55001 Asset Management Roadmap
                        <span class="tooltip-trigger">?<span class="tooltip-content"><div class="tooltip-title">ISO 55001 Mapping</div><div class="tooltip-desc">Maps your maturity level to ISO 55001:2014 asset management stages.<br><br><strong>Awareness</strong> (Cl. 4-5): Establishing context, leadership commitment<br><strong>Managed</strong> (Cl. 6-8): Planning, support systems, operational control<br><strong>Optimization</strong> (Cl. 9-10): Performance evaluation, continual improvement<br><br>Each stage corresponds to specific ISO clauses and audit requirements.</div></span></span>
                    </h4>
                    <div class="iso-roadmap-section">
                        <div class="iso-stages" id="isoStages">
                            <div class="iso-stage" id="iso-awareness">
                                <div class="iso-stage-num">1</div>
                                <div class="iso-stage-label">Awareness</div>
                                <div class="iso-stage-clauses">Cl. 4-5: Context &amp; Leadership</div>
                            </div>
                            <div class="iso-stage-connector"><i class="fas fa-chevron-right"></i></div>
                            <div class="iso-stage" id="iso-managed">
                                <div class="iso-stage-num">2</div>
                                <div class="iso-stage-label">Managed</div>
                                <div class="iso-stage-clauses">Cl. 6-8: Planning, Support &amp; Operations</div>
                            </div>
                            <div class="iso-stage-connector"><i class="fas fa-chevron-right"></i></div>
                            <div class="iso-stage" id="iso-optimization">
                                <div class="iso-stage-num">3</div>
                                <div class="iso-stage-label">Optimization</div>
                                <div class="iso-stage-clauses">Cl. 9-10: Performance &amp; Improvement</div>
                            </div>
                        </div>
                        <div class="iso-mapping-note" id="isoMappingNote">Your maturity maps to ISO 55001 Stage 2 (Managed) — formal planning and support systems in place.</div>
                    </div>

                    <div class="privacy-badge" style="margin-top:1.5rem;">
                        <i class="fas fa-shield-halved"></i> PDF generated in your browser — no data is sent to any server
                    </div>

                    <!-- Risk & Cost Translation (CEO View) -->
                    <div class="risk-cost-panel" id="riskCostPanel">
                        <div class="risk-cost-title">
                            <i class="fas fa-coins"></i> Risk &amp; Cost Translation
                            <span class="tooltip-trigger" style="margin-left:auto;">?<span class="tooltip-content"><div class="tooltip-title">Risk & Cost Translation</div><div class="tooltip-desc">Maps your maturity score to estimated annual risk exposure using industry data. >55% of significant outages cost >$100K (Uptime Institute 2024). Lower maturity = higher probability of experiencing costly incidents. Figures are directional estimates with explicit assumptions.</div></span></span>
                        </div>
                        <div class="risk-cost-grid" id="riskCostGrid"></div>
                        <div id="riskCostDrivers"></div>
                        <div style="font-size:0.65rem;color:#64748b;margin-top:8px;font-style:italic;">
                            Assumptions: 10MW facility, $200K avg outage cost (Uptime 2024 median band). Estimates are directional; actual exposure varies by facility type, redundancy, and contract terms.
                        </div>
                    </div>

                    <!-- ─── PRO ANALYSIS PANELS (appear after results/charts) ─── -->
                    <div id="maturityProPanels" style="display:none;">

                        <h4 style="color: #c084fc; margin: 2rem 0 1rem; font-size: 1rem; font-weight: 700; display:flex;align-items:center;gap:8px;"><i class="fas fa-microscope" style="font-size:0.85rem;"></i> Pro Analysis</h4>

                        <!-- 4. Sensitivity Tornado -->
                        <div class="pro-panel" id="proSensitivity">
                            <div class="pro-panel-inner">
                                <div class="pro-panel-title"><i class="fas fa-tornado"></i> Sensitivity Analysis
                                    <span class="tooltip-trigger" style="margin-left:auto;">?<span class="tooltip-content"><div class="tooltip-title">Tornado Chart</div><div class="tooltip-desc">Shows the impact on your composite score if each dimension changes by &plusmn;1 point. Sorted by total range — dimensions at the top have the most leverage. Red = score decrease, Green = score increase.</div></span></span>
                                </div>
                                <div id="tornadoContainer"></div>
                            </div>
                        </div>

                        <!-- 5. Scenario What-If -->
                        <div class="pro-panel" id="proScenario">
                            <div class="pro-panel-inner">
                                <div class="pro-panel-title"><i class="fas fa-flask"></i> Scenario What-If
                                    <span class="tooltip-trigger" style="margin-left:auto;">?<span class="tooltip-content"><div class="tooltip-title">What-If Scenario</div><div class="tooltip-desc">Set target scores for each dimension and see the projected composite score improvement. Useful for building business cases: "If we invest in training (3→4) and monitoring (3→4), our score improves by X points."</div></span></span>
                                </div>
                                <div class="scenario-grid" id="scenarioGrid"></div>
                                <div class="scenario-result-bar" id="scenarioResult" style="display:none;"></div>
                            </div>
                        </div>

                        <!-- 6. Confidence Interval -->
                        <div class="pro-panel" id="proConfidence">
                            <div class="pro-panel-inner">
                                <div class="pro-panel-title"><i class="fas fa-chart-area"></i> Confidence Interval (Monte Carlo)
                                    <span class="tooltip-trigger" style="margin-left:auto;">?<span class="tooltip-content"><div class="tooltip-title">Monte Carlo Simulation</div><div class="tooltip-desc">Runs 10,000 simulations with &plusmn;0.5 random noise on each dimension to estimate score uncertainty. P5/P95 = 90% confidence interval. Narrow CI = high confidence in your score; wide CI = more uncertainty in the assessment.</div></span></span>
                                </div>
                                <div class="confidence-display" id="confidenceDisplay"></div>
                            </div>
                        </div>

                        <!-- 7. Waterfall Chart -->
                        <div class="pro-panel" id="proWaterfall">
                            <div class="pro-panel-inner">
                                <div class="pro-panel-title"><i class="fas fa-chart-bar"></i> Waterfall — Dimension Contributions
                                    <span class="tooltip-trigger" style="margin-left:auto;">?<span class="tooltip-content"><div class="tooltip-title">Waterfall Chart</div><div class="tooltip-desc">Shows each dimension's individual contribution to the composite score, stacked cumulatively. Taller bars = larger contributors. The rightmost bar shows the total. Useful for identifying which dimensions drive the most value.</div></span></span>
                                </div>
                                <div class="waterfall-container">
                                    <canvas id="waterfallCanvas" width="500" height="280"></canvas>
                                </div>
                            </div>
                        </div>

                        <!-- 8. Current vs Target Radar -->
                        <div class="pro-panel" id="proTargetRadar">
                            <div class="pro-panel-inner">
                                <div class="pro-panel-title"><i class="fas fa-bullseye"></i> Current vs Target Radar
                                    <span class="tooltip-trigger" style="margin-left:auto;">?<span class="tooltip-content"><div class="tooltip-title">Dual Radar Chart</div><div class="tooltip-desc">Blue polygon = your current scores. Purple dashed polygon = your target scores (from What-If above). The gap between them visualizes improvement opportunities across all 8 dimensions.</div></span></span>
                                </div>
                                <div class="radar-chart-container">
                                    <canvas id="proRadarCanvas" width="400" height="400"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Section 10: Conclusion -->
                <h2 id="section-10">
                    <span class="section-number">10</span>
                    Conclusion: Making Invisibility Visible
                </h2>

                <p>
                    This article began with a paradox: in critical infrastructure, the better the engineering, the less visible the outcome. We have argued that this invisibility is not an inherent property of operations but a failure of measurement, documentation, and organizational narrative. The work of proactive engineering is real, measurable, and valuable. It simply requires different tools to capture and communicate its impact.
                </p>

                <p>
                    The theoretical foundation provided by Hollnagel's Safety-II framework <a href="#ref-1" class="cite">[1]</a> gives us the language to describe operational success in positive terms rather than merely as the absence of failure. Reason's Swiss Cheese Model <a href="#ref-2" class="cite">[2]</a> gives us the visual metaphor for understanding how proactive activities maintain defensive layers. Weick and Sutcliffe's HRO principles <a href="#ref-7" class="cite">[7]</a> give us the organizational design criteria for building cultures that sustain proactive performance.
                </p>

                <p>
                    The eight-stage framework translates theory into practice. Environmental scanning, predictive analysis, preventive execution, condition monitoring, risk assessment, stakeholder communication, knowledge management, and continuous improvement are not abstract concepts. They are concrete activities that can be scheduled, resourced, executed, measured, and reported. The Operational Journal captures these activities in a structured format that creates evidence of operational competence.
                </p>

                <p>
                    The economic case is compelling. Our analysis demonstrates that proactive operations deliver a 4:1 to 10:1 return on prevention investment, with the potential for dramatically higher returns when critical failures are prevented. The twelve documented cases from a single 10MW facility over six months represent over $1.2 million in avoided costs, achieved through approximately $180,000 in proactive activities.
                </p>

                <blockquote>
                    "When nothing happens, it is not because nothing was done. It is because everything was done. The absence of failure is the presence of engineering."
                </blockquote>

                <p>
                    The culture trap, the organizational bias toward rewarding reactive heroism over proactive discipline, is perhaps the most challenging obstacle. But it is not insurmountable. By shifting metrics, redesigning recognition systems, and transforming the organizational narrative through structured documentation, operations leaders can create environments where boring competence is celebrated as the highest form of professional achievement.
                </p>

                <p>
                    The five-level maturity model provides a roadmap for progressive improvement. No organization becomes generative overnight. But with deliberate effort, structured assessment, and sustained commitment, any operations team can advance from reactive firefighting to proactive engineering excellence. The interactive calculator in Section 9 provides a starting point for self-assessment and a framework for measuring progress over time.
                </p>

                <p>
                    This article is the foundation. Every subsequent entry in the Operations Journal will build upon these frameworks, documenting real operational cases that demonstrate how theory translates into practice. Each entry will follow the structured format described in Section 3: context, signal, analysis, action, outcome, and learning. Together, they will create a body of evidence that makes the invisible visible.
                </p>

                <p>
                    Because when nothing happens in a data center, it is not because the facility runs itself. It is because engineers are working. And that work deserves to be seen.
                </p>

                <div class="info-box">
                    <div class="info-box-title">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#3b82f6" stroke-width="2">
                            <path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"></path>
                            <path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"></path>
                        </svg>
                        Continue the Series
                    </div>
                    <p style="margin: 0; font-size: 0.85rem; line-height: 1.6;">
                        The next article in the Operations Journal, <a href="article-2.html" style="color: #3b82f6; font-weight: 600;">Article #2: Alarm Fatigue Is Not a Human Problem</a>, examines how alarm system design creates the conditions for operator fatigue and explores engineering solutions that reduce noise while preserving signal. Each subsequent article applies the frameworks introduced here to a specific operational challenge.
                    </p>
                </div>

                
                <!-- Independence Disclaimer -->
                <div style="margin:2rem 0 0;padding:1rem 0;border-top:1px solid rgba(255,255,255,0.06);text-align:center;">
                    <p style="font-size:0.72rem;color:#64748b;font-style:italic;line-height:1.6;margin:0;">All content on ResistanceZero is independent personal research derived from publicly available sources. This site does not represent any current or former employer. <a href="terms.html" style="color:#8b5cf6;">Terms &amp; Disclaimer</a></p>
                </div>

<!-- References -->
                <div class="references-section">
                    <h3 class="references-title">References</h3>
                    <div class="references-list">
                        <div class="reference-item" id="ref-1">
                            <span class="reference-number">[1]</span>
                            <div>
                                Hollnagel, E. (2014). <em>Safety-I and Safety-II: The Past and Future of Safety Management.</em> Ashgate Publishing.
                                <div class="reference-source">Foundational work on resilience engineering and the shift from reactive to proactive safety management</div>
                            </div>
                        </div>
                        <div class="reference-item" id="ref-2">
                            <span class="reference-number">[2]</span>
                            <div>
                                Reason, J. (1997). <em>Managing the Risks of Organizational Accidents.</em> Ashgate Publishing.
                                <div class="reference-source">Swiss Cheese Model of accident causation and organizational defense layers</div>
                            </div>
                        </div>
                        <div class="reference-item" id="ref-3">
                            <span class="reference-number">[3]</span>
                            <div>
                                Uptime Institute. (2023). <em>Data Center Resiliency Survey.</em>
                                <div class="reference-source">Annual survey on data center operational resilience, staffing, and incident trends</div>
                            </div>
                        </div>
                        <div class="reference-item" id="ref-4">
                            <span class="reference-number">[4]</span>
                            <div>
                                Uptime Institute. (2024). <em>Annual Outage Analysis.</em>
                                <div class="reference-source">Comprehensive analysis of data center outage causes, costs, and trends</div>
                            </div>
                        </div>
                        <div class="reference-item" id="ref-5">
                            <span class="reference-number">[5]</span>
                            <div>
                                Uptime Institute. (2022). <em>Data Center Staffing and Training Guidelines.</em>
                                <div class="reference-source">Industry guidelines for operational staffing levels and training requirements</div>
                            </div>
                        </div>
                        <div class="reference-item" id="ref-6">
                            <span class="reference-number">[6]</span>
                            <div>
                                ISO 55001:2014. <em>Asset Management — Management Systems — Requirements.</em>
                                <div class="reference-source">International standard for asset management systems and lifecycle optimization</div>
                            </div>
                        </div>
                        <div class="reference-item" id="ref-7">
                            <span class="reference-number">[7]</span>
                            <div>
                                Weick, K.E. &amp; Sutcliffe, K.M. (2007). <em>Managing the Unexpected: Resilient Performance in an Age of Uncertainty.</em> 2nd ed., Jossey-Bass.
                                <div class="reference-source">High Reliability Organization (HRO) theory and practical application</div>
                            </div>
                        </div>
                        <div class="reference-item" id="ref-8">
                            <span class="reference-number">[8]</span>
                            <div>
                                AXELOS. (2019). <em>ITIL 4: Foundation.</em>
                                <div class="reference-source">IT service management framework including knowledge management and continual improvement</div>
                            </div>
                        </div>
                        <div class="reference-item" id="ref-9">
                            <span class="reference-number">[9]</span>
                            <div>
                                Dekker, S. (2014). <em>The Field Guide to Understanding Human Error.</em> 3rd ed., Ashgate Publishing.
                                <div class="reference-source">Just culture framework and systemic analysis of human performance in complex systems</div>
                            </div>
                        </div>
                        <div class="reference-item" id="ref-10">
                            <span class="reference-number">[10]</span>
                            <div>
                                EN 50600 Series. (2019). <em>Information Technology — Data Centre Facilities and Infrastructures.</em>
                                <div class="reference-source">European standard for data center design, construction, and operational management</div>
                            </div>
                        </div>
                        <div class="reference-item" id="ref-11">
                            <span class="reference-number">[11]</span>
                            <div>
                                ASHRAE TC 9.9. (2021). <em>Thermal Guidelines for Data Processing Environments.</em> 5th ed.
                                <div class="reference-source">Industry thermal management guidelines including temperature and humidity envelopes</div>
                            </div>
                        </div>
                        <div class="reference-item" id="ref-12">
                            <span class="reference-number">[12]</span>
                            <div>
                                IEEE 3007.2-2010. <em>Recommended Practice for the Maintenance of Industrial and Commercial Power Systems.</em>
                                <div class="reference-source">Electrical maintenance standards including condition-based and predictive techniques</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Newsletter Signup -->
                <div class="newsletter-signup">
                    <h3>Stay Updated</h3>
                    <p>Get notified when new articles on data center operations and engineering excellence are published.</p>
                    <form class="newsletter-form" onsubmit="return subscribeNewsletter(event)">
                        <input type="email" placeholder="Enter your email" required>
                        <button type="submit">Subscribe</button>
                    </form>
                    <p class="newsletter-privacy">No spam. Unsubscribe anytime.</p>
                </div>

                <!-- Author Bio -->
                <div class="author-bio">
                    <div class="author-bio-image">
                        <img loading="lazy" src="assets/profile-photo.jpg" alt="Bagus Dwi Permana">
                    </div>
                    <div class="author-bio-content">
                        <h4>Bagus Dwi Permana</h4>
                        <p class="author-bio-title">Engineering Operations Manager | Ahli K3 Listrik</p>
                        <p>12+ years professional experience in critical infrastructure and operations. CDFOM certified. Transforming operations through systematic excellence and safety-first engineering.</p>
                        <div class="author-bio-links">
                            <a href="https://www.linkedin.com/in/bagus-dwi-permana-ba90b092" target="_blank">
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/></svg>
                                LinkedIn
                            </a>
                            <a href="https://github.com/baguspermana7-cpu" target="_blank">
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/></svg>
                                GitHub
                            </a>
                            <a href="mailto:baguspermana7@gmail.com">
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg>
                                Email
                            </a>
                        </div>
                    </div>
                </div>

                <!-- Related Articles -->
                <div class="related-articles">
                    <h3>Continue Reading</h3>
                    <div class="related-grid">
                        <a href="article-2.html" class="related-card">
                            <div class="related-card-number">02</div>
                            <div class="related-card-content">
                                <h4>Alarm Fatigue Is Not a Human Problem — It Is a System Design Failure</h4>
                                <p>Understanding alarm management in critical facilities</p>
                            </div>
                        </a>
                        <a href="article-8.html" class="related-card">
                            <div class="related-card-number">08</div>
                            <div class="related-card-content">
                                <h4>Why "No Incident" Is Not Evidence of Safety</h4>
                                <p>Safety culture beyond incident metrics</p>
                            </div>
                        </a>
                        <a href="article-3.html" class="related-card">
                            <div class="related-card-number">03</div>
                            <div class="related-card-content">
                                <h4>How to Achieve 97%+ Maintenance Compliance</h4>
                                <p>Systems engineering approach to maintenance excellence</p>
                            </div>
                        </a>
                    </div>
                </div>

                <!-- Article Navigation -->
                <div class="article-nav" style="justify-content: flex-end;">
                    <a href="article-2.html">
                        Next Article
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M5 12h14M12 5l7 7-7 7"/></svg>
                    </a>
                </div>

            </div>
        </div>
    </article>

    </main>

    <!-- Footer -->
    <footer class="footer footer-enhanced">
        <div class="container">
            <div class="footer-grid">
                <div class="footer-brand">
                    <p class="footer-tagline-main">BUILT FOR MISSION CRITICAL INFRASTRUCTURE<br>MANAGEMENT // 2026</p>
                    <p class="footer-tagline-sub">ALL OPERATIONAL DATASETS PRESERVED.</p>
                    <p class="footer-copyright">&copy; 2026 Bagus Dwi Permana. All rights reserved.</p>
                </div>
                <div class="footer-nav">
                    <h4 class="footer-heading">NAVIGATION</h4>
                    <ul class="footer-links">
                        <li><a href="index.html">Home Dashboard</a></li>
                        <li><a href="articles.html">Technical Journal</a></li>
                        <li><a href="index.html#case-studies">Case Studies</a></li>
                        <li><a href="datacenter-solutions.html">DC Solutions</a></li>
                    </ul>
                </div>
                <div class="footer-connect">
                    <h4 class="footer-heading">CONNECT</h4>
                    <ul class="footer-links">
                        <li><a href="https://www.linkedin.com/in/bagus-dwi-permana-ba90b092" target="_blank" rel="noopener">LinkedIn Profile</a></li>
                        <li><a href="articles.html">Technical Journal</a></li>
                        <li><a href="mailto:baguspermana7@gmail.com">Direct Contact</a></li>
                        <li><a href="https://github.com/baguspermana7-cpu" target="_blank" rel="noopener">GitHub</a></li>
                    </ul>
                </div>
            </div>
        </div>
    </footer>

    <!-- Share Buttons - Floating Sidebar -->
    <aside class="share-buttons" id="shareButtons" aria-label="Share this article">
        <span class="share-label">Share</span>
        <button class="share-btn linkedin" data-tooltip="Share on LinkedIn" onclick="shareLinkedIn()" aria-label="Share on LinkedIn">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                <path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/>
            </svg>
        </button>
        <button class="share-btn twitter" data-tooltip="Share on X" onclick="shareTwitter()" aria-label="Share on X (Twitter)">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                <path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/>
            </svg>
        </button>
        <button class="share-btn whatsapp" data-tooltip="Share on WhatsApp" onclick="shareWhatsApp()" aria-label="Share on WhatsApp">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"/>
            </svg>
        </button>
        <button class="share-btn copy" data-tooltip="Copy link" onclick="copyLink()" aria-label="Copy article link">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="copy-icon">
                <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
            </svg>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="check-icon" style="display:none">
                <polyline points="20 6 9 17 4 12"></polyline>
            </svg>
        </button>
    </aside>

    <script src="script.min.js"></script>

    <!-- Share Buttons Functionality -->
    <script>
        // Share button visibility on scroll
        (function() {
            const shareButtons = document.getElementById('shareButtons');
            const articleHero = document.querySelector('.article-hero');
            if (shareButtons && articleHero) {
                document.body.classList.add('has-share-buttons');
                const observer = new IntersectionObserver((entries) => {
                    entries.forEach(entry => {
                        if (entry.isIntersecting) {
                            shareButtons.classList.remove('visible');
                        } else {
                            shareButtons.classList.add('visible');
                        }
                    });
                }, { threshold: 0.1 });
                observer.observe(articleHero);
            }
        })();

        function getShareData() {
            return {
                title: document.querySelector('meta[property="og:title"]')?.content || document.title,
                text: document.querySelector('meta[property="og:description"]')?.content || '',
                url: window.location.href
            };
        }

        function shareLinkedIn() {
            const data = getShareData();
            window.open(`https://www.linkedin.com/sharing/share-offsite/?url=${encodeURIComponent(data.url)}`, '_blank', 'width=600,height=600');
        }

        function shareTwitter() {
            const data = getShareData();
            const text = `${data.title} by @BagusDPermana`;
            window.open(`https://twitter.com/intent/tweet?text=${encodeURIComponent(text)}&url=${encodeURIComponent(data.url)}`, '_blank', 'width=600,height=400');
        }

        function shareWhatsApp() {
            const data = getShareData();
            const text = `${data.title}\n\n${data.url}`;
            window.open(`https://wa.me/?text=${encodeURIComponent(text)}`, '_blank');
        }

        function copyLink() {
            const btn = document.querySelector('.share-btn.copy');
            const copyIcon = btn.querySelector('.copy-icon');
            const checkIcon = btn.querySelector('.check-icon');
            navigator.clipboard.writeText(window.location.href).then(() => {
                btn.classList.add('copied');
                copyIcon.style.display = 'none';
                checkIcon.style.display = 'block';
                btn.setAttribute('data-tooltip', 'Copied!');
                setTimeout(() => {
                    btn.classList.remove('copied');
                    copyIcon.style.display = 'block';
                    checkIcon.style.display = 'none';
                    btn.setAttribute('data-tooltip', 'Copy link');
                }, 2000);
            });
        }
    </script>

    <!-- Maturity Calculator Script -->
    <script>
    (function() {
        // ═══ CONFIGURATION ═══
        const dimensions = [
            { id: 'doc', label: 'Documentation', weight: 0.10, impact: 1.0, el: 'calc-doc' },
            { id: 'train', label: 'Training', weight: 0.15, impact: 1.2, el: 'calc-train' },
            { id: 'change', label: 'Change Mgmt', weight: 0.15, impact: 1.3, el: 'calc-change' },
            { id: 'monitor', label: 'Monitoring', weight: 0.15, impact: 1.1, el: 'calc-monitor' },
            { id: 'maint', label: 'Maintenance', weight: 0.15, impact: 1.2, el: 'calc-maint' },
            { id: 'emergency', label: 'Emergency', weight: 0.10, impact: 1.4, el: 'calc-emergency' },
            { id: 'improve', label: 'Improvement', weight: 0.10, impact: 1.0, el: 'calc-improve' },
            { id: 'leadership', label: 'Leadership', weight: 0.10, impact: 1.5, el: 'calc-leadership' }
        ];

        const benchmarks = [
            { tier: 'Tier I', avg: 25 },
            { tier: 'Tier II', avg: 45 },
            { tier: 'Tier III', avg: 65 },
            { tier: 'Tier IV', avg: 82 }
        ];

        const weightPresets = {
            default: { label: 'Default', weights: [0.10, 0.15, 0.15, 0.15, 0.15, 0.10, 0.10, 0.10] },
            'ai-hpc': { label: 'AI / HPC', weights: [0.08, 0.12, 0.12, 0.20, 0.20, 0.08, 0.10, 0.10] },
            colocation: { label: 'Colocation', weights: [0.12, 0.10, 0.18, 0.15, 0.15, 0.12, 0.08, 0.10] },
            enterprise: { label: 'Enterprise', weights: [0.10, 0.15, 0.12, 0.12, 0.12, 0.12, 0.12, 0.15] }
        };

        const subDimensions = {
            doc: [
                { id: 'sop', label: 'SOP/MOP Quality', desc: 'Standard & Method of Procedure completeness' },
                { id: 'eop', label: 'EOP Coverage', desc: 'Emergency Operating Procedures for all scenarios' },
                { id: 'asbuilt', label: 'As-Built Accuracy', desc: 'Drawings match physical infrastructure' },
                { id: 'version', label: 'Version Control', desc: 'Document change tracking and audit trails' },
                { id: 'cmms', label: 'CMMS Integration', desc: 'Docs linked to work orders and assets' }
            ],
            train: [
                { id: 'competency', label: 'Competency Program', desc: 'Structured role-based training paths' },
                { id: 'cross', label: 'Cross-Training', desc: 'Multi-skill coverage for redundancy' },
                { id: 'cert', label: 'Certifications', desc: 'Industry certs (CDCP, ATD, K3 Listrik)' },
                { id: 'drill', label: 'Drill Frequency', desc: 'Tabletop and live drill cadence' },
                { id: 'gap', label: 'Skill Gap Analysis', desc: 'Regular assessment and remediation' }
            ],
            change: [
                { id: 'moc', label: 'MOC Process', desc: 'Management of Change formalization' },
                { id: 'risk', label: 'Risk Assessment', desc: 'Pre-change risk scoring methodology' },
                { id: 'cab', label: 'CAB Governance', desc: 'Change Advisory Board effectiveness' },
                { id: 'rollback', label: 'Rollback Plans', desc: 'Documented rollback for every change' },
                { id: 'postchange', label: 'Post-Change Review', desc: 'Verification and lessons learned' }
            ],
            monitor: [
                { id: 'bms', label: 'BMS/DCIM Coverage', desc: 'Sensor density and system coverage' },
                { id: 'alarm', label: 'Alarm Hierarchy', desc: 'Prioritized alarm tiers (info/warn/critical)' },
                { id: 'dashboard', label: 'Dashboards', desc: 'Real-time operational visibility' },
                { id: 'trend', label: 'Trend Analysis', desc: 'Historical pattern recognition' },
                { id: 'predictive', label: 'Predictive Analytics', desc: 'ML/AI-based anomaly detection' }
            ],
            maint: [
                { id: 'pm', label: 'PM Program', desc: 'Preventive maintenance scheduling' },
                { id: 'cmmsutil', label: 'CMMS Utilization', desc: 'Work order completion and tracking' },
                { id: 'pdm', label: 'PdM Integration', desc: 'Predictive maintenance (vibration, thermal)' },
                { id: 'spares', label: 'Spare Parts Strategy', desc: 'Critical spares inventory management' },
                { id: 'vendor', label: 'Vendor Management', desc: 'SLA tracking and performance review' }
            ],
            emergency: [
                { id: 'eopcomp', label: 'EOP Completeness', desc: 'All failure scenarios documented' },
                { id: 'drillreal', label: 'Drill Realism', desc: 'Exercises simulate actual conditions' },
                { id: 'escalation', label: 'Escalation Matrix', desc: 'Clear chain of command and contacts' },
                { id: 'comms', label: 'Communication Protocol', desc: 'Internal and external notification plans' }
            ],
            improve: [
                { id: 'rca', label: 'RCA Depth', desc: 'Root cause analysis methodology (5-Why, Ishikawa)' },
                { id: 'capa', label: 'CAPA Tracking', desc: 'Corrective/preventive action closure rate' },
                { id: 'lessons', label: 'Lessons Learned DB', desc: 'Searchable knowledge base of incidents' },
                { id: 'benchmark', label: 'Benchmarking', desc: 'Regular comparison against industry peers' }
            ],
            leadership: [
                { id: 'commitment', label: 'Mgmt Commitment', desc: 'Visible leadership support for operations' },
                { id: 'resources', label: 'Resource Allocation', desc: 'Adequate staffing, budget, and tools' },
                { id: 'culture', label: 'Safety Culture', desc: 'Just culture, blameless post-mortems' },
                { id: 'alignment', label: 'Cross-Functional', desc: 'IT-Facilities-Business alignment' }
            ]
        };

        const levelLabels = ['Ad-hoc','Repeatable','Defined','Managed','Optimized'];
        const levelDefs = {
            doc: ['No formal docs; tribal knowledge only','Some docs exist but outdated or incomplete','All critical SOPs documented, version-controlled','Docs linked to CMMS, audit trail, regular reviews','Automated doc workflows, real-time as-builts, integrated KB'],
            train: ['OJT only, no structured program','Annual training schedule, basic orientation','Role-based competency matrix, regular drills','Cross-training, skill gap tracking, certifications required','Continuous learning culture, advanced simulation drills'],
            change: ['Changes without formal process or approval','Change requests logged, basic approvals','Formal MOC with risk assessment, CAB reviews','Automated workflows, rollback plans, post-change verification','Predictive impact analysis, zero-downtime windows'],
            monitor: ['Manual readings, no centralized monitoring','BMS installed but limited coverage, alarm fatigue','Full BMS coverage, tiered alarms, basic dashboards','DCIM integrated, trend analysis, KPI dashboards','Predictive analytics (ML/AI), anomaly detection, digital twin'],
            maint: ['Reactive only (fix when broken), no PM schedule','Basic PM schedule, manual tracking','CMMS-driven PM, work order tracking, spare parts','PdM integration (vibration, thermal), vendor SLA tracking','Condition-based maintenance, AI-driven scheduling, RCM'],
            emergency: ['No written EOPs, ad-hoc response','Basic EOPs exist, annual drills','Comprehensive EOPs, quarterly drills, escalation matrix','Realistic drills, measured MTTR, tabletop exercises','Continuous readiness, cross-site drills, improvement loop'],
            improve: ['No formal RCA process, repeat incidents','Basic incident reports, some follow-up','Structured RCA (5-Why, Ishikawa), CAPA tracking','Lessons learned database, proactive CAPA, benchmarking','Self-improving system (Safety-II), cross-industry learning'],
            leadership: ['No executive sponsorship, ops = cost center','Basic management oversight, reactive budget','Dedicated ops leadership, annual budget, safety awareness','Just culture, cross-functional alignment, strategic roadmap','Ops excellence as competitive advantage, generative culture']
        };
        const dimDescriptions = {
            doc: 'SOPs, MOPs, EOPs, as-built drawings, version control, CMMS integration.',
            train: 'Competency programs, cross-training, certifications, drill frequency.',
            change: 'MOC process, risk assessment, CAB governance, rollback procedures.',
            monitor: 'BMS/DCIM coverage, alarm hierarchy, dashboards, trend analysis.',
            maint: 'PM program, CMMS utilization, PdM integration, spare parts strategy.',
            emergency: 'EOP completeness, drill realism, escalation matrix, communication.',
            improve: 'RCA depth, CAPA tracking, lessons learned, benchmarking practices.',
            leadership: 'Management commitment, resource allocation, safety culture, strategic vision.'
        };

        // ═══ STATE ═══
        let isPremiumMaturity = false;
        let maturityMode = 'free';
        let customWeights = dimensions.map(d => d.weight);
        let proBuilt = false;

        // ═══ BUILD DIMENSION CARDS ═══
        function buildDimensionCards() {
            var grid = document.getElementById('dimCardsGrid');
            if (!grid) return;
            grid.innerHTML = dimensions.map(function(d) {
                var defs = levelDefs[d.id];
                var desc = dimDescriptions[d.id];
                var opts = [1,2,3,4,5].map(function(v) {
                    return '<option value="'+v+'"'+(v===3?' selected':'')+'>'+v+'</option>';
                }).join('');
                var btns = [1,2,3,4,5].map(function(v) {
                    return '<button class="dim-score-btn'+(v===3?' active':'')+'" data-val="'+v+'" title="'+levelLabels[v-1]+'">'+v+'</button>';
                }).join('');
                var tooltipDefs = defs.map(function(def, i) {
                    return '<strong>'+(i+1)+' '+levelLabels[i]+':</strong> '+def;
                }).join('<br>');
                var tooltip = '<span class="tooltip-trigger" style="margin-left:auto;flex-shrink:0;">?<span class="tooltip-content">'+
                    '<div class="tooltip-title">'+d.label+' (Weight: '+(d.weight*100)+'%, Impact: '+d.impact+'x)</div>'+
                    '<div class="tooltip-desc">'+desc+'</div>'+
                    '<div class="tooltip-desc" style="margin-top:6px;font-size:11px;">'+tooltipDefs+'</div>'+
                    '</span></span>';
                return '<div class="dim-card" data-dim="'+d.id+'">'+
                    '<div class="dim-card-header"><span class="dim-card-name">'+d.label+'</span>'+tooltip+'<span class="dim-card-weight">'+(d.weight*100)+'%</span></div>'+
                    '<div class="dim-card-desc">'+desc+'</div>'+
                    '<div class="dim-score-btns">'+btns+'</div>'+
                    '<div class="dim-level-def" id="def-'+d.id+'">3 — Defined: '+defs[2]+'</div>'+
                    '<select class="calc-select" id="'+d.el+'" style="display:none" onchange="calculateMaturity()">'+opts+'</select>'+
                    '</div>';
            }).join('');

            grid.addEventListener('click', function(e) {
                var btn = e.target.closest('.dim-score-btn');
                if (!btn) return;
                var card = btn.closest('.dim-card');
                var val = parseInt(btn.getAttribute('data-val'));
                var dimId = card.getAttribute('data-dim');
                var select = card.querySelector('select');
                if (select) select.value = val;
                card.querySelectorAll('.dim-score-btn').forEach(function(b) { b.classList.remove('active'); });
                btn.classList.add('active');
                var defEl = document.getElementById('def-'+dimId);
                if (defEl && levelDefs[dimId]) {
                    defEl.textContent = val+' — '+levelLabels[val-1]+': '+levelDefs[dimId][val-1];
                }
                calculateMaturity();
            });
        }

        // ═══ CORE FUNCTIONS ═══
        function getMaturityLabel(score) {
            if (score <= 20) return { label: 'Reactive', level: 1, color: '#ef4444' };
            if (score <= 40) return { label: 'Preventive', level: 2, color: '#f97316' };
            if (score <= 60) return { label: 'Predictive', level: 3, color: '#eab308' };
            if (score <= 80) return { label: 'Proactive', level: 4, color: '#22c55e' };
            return { label: 'Generative', level: 5, color: '#3b82f6' };
        }

        function getActiveWeights() {
            if (maturityMode === 'pro') return customWeights;
            return dimensions.map(d => d.weight);
        }

        function calculateScoreWithValues(vals, weights) {
            const ws = vals.reduce((s, v, i) => s + v * (weights || getActiveWeights())[i], 0);
            return ((ws - 1) / 4) * 100;
        }

        // ═══ RISK & COST TRANSLATION ═══
        function renderRiskCostPanel(compositeScore, values, maturity) {
            var grid = document.getElementById('riskCostGrid');
            var drivers = document.getElementById('riskCostDrivers');
            if (!grid) return;

            // Risk model: lower maturity = higher outage probability
            // Based on Uptime 2024: >55% outages from ops/human factors
            // Tier III benchmark avg=65; below that = elevated risk
            var baseOutageRate = 2.5; // avg outages/year for lowest maturity
            var maturityFactor = Math.max(0.05, 1 - (compositeScore / 120)); // 0-100 maps to ~1.0-0.17
            var estOutagesPerYear = baseOutageRate * maturityFactor;
            var avgOutageCost = 200000; // $200K median (Uptime 2024)
            var annualExposure = estOutagesPerYear * avgOutageCost;

            // Risk level
            var riskLevel, riskColor;
            if (compositeScore >= 80) { riskLevel = 'LOW'; riskColor = '#10b981'; }
            else if (compositeScore >= 60) { riskLevel = 'MODERATE'; riskColor = '#f59e0b'; }
            else if (compositeScore >= 40) { riskLevel = 'ELEVATED'; riskColor = '#ea580c'; }
            else { riskLevel = 'HIGH'; riskColor = '#ef4444'; }

            // Prevention value: what improving +10 pts would save
            var improvedFactor = Math.max(0.05, 1 - ((compositeScore + 10) / 120));
            var improvedExposure = baseOutageRate * improvedFactor * avgOutageCost;
            var preventionValue = annualExposure - improvedExposure;

            // Top risk drivers (weakest weighted dimensions)
            var sorted = values.slice().sort(function(a, b) { return (a.value * a.weight) - (b.value * b.weight); });
            var topRisks = sorted.filter(function(d) { return d.value <= 3; }).slice(0, 3);

            grid.innerHTML =
                '<div class="risk-cost-card"><div class="risk-cost-card-value" style="color:' + riskColor + ';">' + riskLevel + '</div><div class="risk-cost-card-label">Operational Risk Level</div></div>' +
                '<div class="risk-cost-card"><div class="risk-cost-card-value" style="color:#ef4444;">$' + (annualExposure >= 1000000 ? (annualExposure/1000000).toFixed(1) + 'M' : Math.round(annualExposure/1000) + 'K') + '</div><div class="risk-cost-card-label">Est. Annual Exposure</div></div>' +
                '<div class="risk-cost-card"><div class="risk-cost-card-value" style="color:#f59e0b;">' + estOutagesPerYear.toFixed(1) + '</div><div class="risk-cost-card-label">Est. Incidents/Year</div></div>' +
                '<div class="risk-cost-card"><div class="risk-cost-card-value" style="color:#10b981;">$' + (preventionValue >= 1000000 ? (preventionValue/1000000).toFixed(1) + 'M' : Math.round(preventionValue/1000) + 'K') + '</div><div class="risk-cost-card-label">Value of +10pt Improvement</div></div>';

            if (topRisks.length > 0 && drivers) {
                drivers.innerHTML = '<div style="font-size:0.78rem;font-weight:600;color:#e2e8f0;margin-bottom:6px;"><i class="fas fa-triangle-exclamation" style="color:#f59e0b;margin-right:4px;"></i> Top Risk Drivers</div>' +
                    '<ul class="risk-drivers-list">' + topRisks.map(function(d) {
                        return '<li><strong>' + d.label + '</strong> (Level ' + d.value + '/5) — ' +
                            (d.value <= 1 ? 'Critical gap: no formal process in place' :
                             d.value <= 2 ? 'Developing: process exists but inconsistently applied' :
                             'Baseline: structured but not yet data-driven') + '</li>';
                    }).join('') + '</ul>';
            } else if (drivers) {
                drivers.innerHTML = '<div style="font-size:0.78rem;color:#10b981;"><i class="fas fa-check-circle" style="margin-right:4px;"></i> All dimensions above baseline (Level 3+). Operational risk well-managed.</div>';
            }
        }

        window.calculateMaturity = function() {
            const weights = getActiveWeights();
            const values = dimensions.map((d, i) => ({
                ...d,
                weight: weights[i],
                value: parseInt(document.getElementById(d.el).value)
            }));

            const weightedSum = values.reduce((sum, d) => sum + d.value * d.weight, 0);
            const compositeScore = ((weightedSum - 1) / 4) * 100;
            const maturity = getMaturityLabel(compositeScore);

            document.getElementById('result-score').textContent = Math.round(compositeScore);
            document.getElementById('result-level').textContent = maturity.level;
            document.getElementById('result-label').textContent = maturity.label;
            document.getElementById('result-label').style.color = maturity.color;
            document.getElementById('result-weighted').textContent = weightedSum.toFixed(2);

            // RMI — Risk Mitigation Index
            const rmiNumerator = values.reduce((s, d) => s + d.value * d.weight * d.impact, 0);
            const rmiDenominator = values.reduce((s, d) => s + 5 * d.weight * d.impact, 0);
            const rmi = (rmiNumerator / rmiDenominator) * 100;
            const rmiEl = document.getElementById('result-rmi');
            if (rmiEl) {
                rmiEl.textContent = Math.round(rmi) + '%';
                rmiEl.style.color = rmi >= 80 ? '#10b981' : rmi >= 60 ? '#f59e0b' : rmi >= 40 ? '#ea580c' : '#ef4444';
            }

            // Executive Summary Cards
            (function updateExecCards() {
                const sc = Math.round(compositeScore);
                function hexToRgba(hex, a) {
                    const r = parseInt(hex.slice(1,3),16), g = parseInt(hex.slice(3,5),16), b = parseInt(hex.slice(5,7),16);
                    return `rgba(${r},${g},${b},${a})`;
                }
                // Operational Health
                const healthEl = document.getElementById('exec-health');
                const healthValEl = document.getElementById('exec-health-val');
                const healthSubEl = document.getElementById('exec-health-sub');
                if (healthEl) {
                    healthValEl.textContent = sc + '/100';
                    const closestBench = benchmarks.reduce((prev, b) => Math.abs(sc - b.avg) < Math.abs(sc - prev.avg) ? b : prev);
                    healthSubEl.textContent = (sc >= closestBench.avg ? '\u25B2 Above ' : '\u25BC Below ') + closestBench.tier;
                    const hColor = maturity.color;
                    healthValEl.style.color = hColor;
                    healthSubEl.style.color = hColor;
                    healthEl.style.setProperty('background', `linear-gradient(135deg,${hexToRgba(hColor,0.15)},${hexToRgba(hColor,0.05)})`, 'important');
                    healthEl.style.borderColor = hexToRgba(hColor,0.3);
                }
                // Risk Exposure
                const riskEl = document.getElementById('exec-risk');
                const riskValEl = document.getElementById('exec-risk-val');
                const riskSubEl = document.getElementById('exec-risk-sub');
                if (riskEl) {
                    let rLvl, rClr;
                    if (sc >= 80) { rLvl='LOW'; rClr='#10b981'; }
                    else if (sc >= 60) { rLvl='MODERATE'; rClr='#f59e0b'; }
                    else if (sc >= 40) { rLvl='ELEVATED'; rClr='#ea580c'; }
                    else { rLvl='HIGH'; rClr='#ef4444'; }
                    const mf = Math.max(0.05, 1 - (sc / 120));
                    const ae = 2.5 * mf * 200000;
                    const aeStr = ae >= 1000000 ? '$' + (ae/1000000).toFixed(1) + 'M' : '$' + Math.round(ae/1000) + 'K';
                    riskValEl.textContent = rLvl;
                    riskSubEl.textContent = aeStr + ' \u00B7 Est. Annual';
                    riskValEl.style.color = rClr;
                    riskSubEl.style.color = rClr;
                    riskEl.style.setProperty('background', `linear-gradient(135deg,${hexToRgba(rClr,0.15)},${hexToRgba(rClr,0.05)})`, 'important');
                    riskEl.style.borderColor = hexToRgba(rClr,0.3);
                }
                // Critical Bottleneck
                const bnEl = document.getElementById('exec-bottleneck');
                const bnValEl = document.getElementById('exec-bottleneck-val');
                const bnSubEl = document.getElementById('exec-bottleneck-sub');
                if (bnEl) {
                    const sorted = [...values].sort((a, b) => ((5 - a.value) * a.weight * a.impact) - ((5 - b.value) * b.weight * b.impact)).reverse();
                    const top = sorted[0];
                    const topGap = (5 - top.value) * top.weight * top.impact;
                    if (top.value >= 5) {
                        bnValEl.textContent = 'NONE';
                        bnSubEl.textContent = 'All dimensions at max';
                        bnValEl.style.color = '#10b981';
                        bnSubEl.style.color = '#10b981';
                        bnEl.style.setProperty('background', 'linear-gradient(135deg,rgba(16,185,129,0.12),rgba(16,185,129,0.04))', 'important');
                        bnEl.style.borderColor = 'rgba(16,185,129,0.25)';
                    } else {
                        bnValEl.textContent = top.label.toUpperCase();
                        bnSubEl.textContent = 'Score: ' + top.value + '/5 \u00B7 Priority: ' + topGap.toFixed(3);
                        const bClr = top.value <= 2 ? '#ef4444' : '#f87171';
                        bnValEl.style.color = bClr;
                        bnSubEl.style.color = bClr;
                    }
                }
                // Next Milestone
                const msEl = document.getElementById('exec-milestone');
                const msValEl = document.getElementById('exec-milestone-val');
                const msSubEl = document.getElementById('exec-milestone-sub');
                if (msEl) {
                    const nextLevel = maturity.level < 5 ? maturity.level + 1 : 5;
                    const nextThreshold = maturity.level * 20 + 1;
                    const labels = ['','Preventive','Predictive','Proactive','Generative','Generative'];
                    if (maturity.level >= 5) {
                        msValEl.textContent = '\u2605';
                        msSubEl.textContent = 'Peak · Generative';
                    } else {
                        const gap = nextThreshold - sc;
                        msValEl.textContent = nextThreshold;
                        msSubEl.textContent = '+' + (gap > 0 ? gap : 0) + ' pts \u00B7 ' + labels[nextLevel];
                    }
                }
            })();

            // Strategic Insight
            (function updateStrategicInsight() {
                const el = document.getElementById('strategicInsightText');
                if (!el) return;
                const sc = Math.round(compositeScore);
                const sorted = [...values].sort((a, b) => ((5 - a.value) * a.weight * a.impact) - ((5 - b.value) * b.weight * b.impact)).reverse();
                const topGap = sorted[0];
                const strongest = [...values].sort((a, b) => b.value - a.value)[0];
                let insight = '';
                if (sc >= 80) {
                    insight = 'Facility is <strong style="color:#10b981;">Proactive/Generative</strong>. Operational systems are mature, risk is well-mitigated. Focus on sustaining excellence through audit cycles and knowledge transfer.';
                } else if (sc >= 60) {
                    insight = 'Facility is <strong style="color:#f59e0b;">Managed but Inconsistent</strong>. Processes exist but rely on individual heroics rather than system reliability. Elevating <strong>' + topGap.label + '</strong> will yield the highest ROI for reliability.';
                } else if (sc >= 40) {
                    insight = 'Facility is <strong style="color:#ea580c;">Developing with Gaps</strong>. ' + (values.filter(v => v.value <= 2).length) + ' dimension(s) at critical levels create compounding failure risk. Prioritize <strong>' + topGap.label + '</strong> (Level ' + topGap.value + ') — it has the highest weighted impact on overall maturity.';
                } else {
                    insight = '<strong style="color:#ef4444;">Reactive Mode Detected.</strong> Operations depend entirely on ad-hoc responses. <strong>' + topGap.label + '</strong> is the most urgent gap. Establish minimum viable processes across all 8 dimensions within 90 days.';
                }
                el.innerHTML = insight;
            })();

            // ISO 55001 Roadmap
            var isoAwareness = document.getElementById('iso-awareness');
            var isoManaged = document.getElementById('iso-managed');
            var isoOptimization = document.getElementById('iso-optimization');
            var isoNote = document.getElementById('isoMappingNote');
            if (isoAwareness && isoManaged && isoOptimization) {
                isoAwareness.classList.remove('active');
                isoManaged.classList.remove('active');
                isoOptimization.classList.remove('active');
                if (compositeScore >= 71) {
                    isoOptimization.classList.add('active');
                    isoManaged.classList.add('active');
                    isoAwareness.classList.add('active');
                    if (isoNote) isoNote.textContent = 'Your maturity maps to ISO 55001 Stage 3 (Optimization) — performance evaluation and continual improvement processes established. Ready for ISO 55001 certification audit.';
                } else if (compositeScore >= 41) {
                    isoManaged.classList.add('active');
                    isoAwareness.classList.add('active');
                    if (isoNote) isoNote.textContent = 'Your maturity maps to ISO 55001 Stage 2 (Managed) — formal planning, support systems, and operational controls in place. Focus on Cl. 9-10 (performance evaluation) to advance.';
                } else {
                    isoAwareness.classList.add('active');
                    if (isoNote) isoNote.textContent = 'Your maturity maps to ISO 55001 Stage 1 (Awareness) — establishing organizational context and leadership commitment. Build foundational processes before pursuing certification.';
                }
            }

            const gaps = values.map(d => ({
                label: d.label,
                gap: 5 - d.value,
                priority: (5 - d.value) * d.weight * d.impact,
                value: d.value
            })).sort((a, b) => b.priority - a.priority);

            document.getElementById('dimensionBars').innerHTML = values.map(d => {
                const pct = (d.value / 5) * 100;
                return `<div class="dimension-bar"><div class="dimension-bar-label">${d.label}</div><div class="dimension-bar-track"><div class="dimension-bar-fill" style="width:${pct}%">${d.value}/5</div></div></div>`;
            }).join('');

            const top3 = gaps.filter(g => g.gap > 0).slice(0, 3);
            document.getElementById('priorityList').innerHTML = top3.length > 0 ? top3.map((p, i) => `
                <div class="priority-item"><div class="priority-rank">${i + 1}</div><div><div class="priority-text"><strong>${p.label}</strong> — Current: ${p.value}/5, Gap: ${p.gap}</div><div class="priority-gap">Priority Score: ${p.priority.toFixed(3)}</div></div></div>
            `).join('') : '<div style="color:#94a3b8;font-size:0.85rem;padding:1rem;">All dimensions at maximum.</div>';

            const benchmarkHtml = benchmarks.map(b => {
                const isClosest = Math.abs(compositeScore - b.avg) === Math.min(...benchmarks.map(x => Math.abs(compositeScore - x.avg)));
                return `<div class="benchmark-item ${isClosest ? 'benchmark-marker' : ''}"><div class="benchmark-tier">${b.tier} Avg</div><div class="benchmark-value">${b.avg}</div></div>`;
            }).join('') + `<div class="benchmark-item" style="border:2px solid #3b82f6;"><div class="benchmark-tier">Your Score</div><div class="benchmark-value" style="color:${maturity.color};">${Math.round(compositeScore)}</div></div>`;
            document.getElementById('benchmarkGrid').innerHTML = benchmarkHtml;

            drawRadarChart(values);
            renderRiskCostPanel(compositeScore, values, maturity);

            // Pro extensions
            if (maturityMode === 'pro' && proBuilt) {
                renderSensitivityTornado(values, weights);
                renderConfidenceInterval(values, weights);
                renderScenarioResults(values, weights);
                renderWaterfallChart(values, weights);
                drawProRadarChart(values);
            }
        };

        // ═══ RADAR CHART ═══
        function drawRadarChart(values) {
            const canvas = document.getElementById('radarCanvas');
            if (!canvas) return;
            // ISO 55001 target = Level 4 for all dimensions (proactive baseline)
            const isoTarget = values.map(() => 4);
            drawRadarOnCanvas(canvas, values, isoTarget, 400);
        }

        function drawRadarOnCanvas(canvas, values, targetValues, size) {
            const ctx = canvas.getContext('2d');
            const dpr = window.devicePixelRatio || 1;
            canvas.width = size * dpr;
            canvas.height = size * dpr;
            canvas.style.width = size + 'px';
            canvas.style.height = size + 'px';
            ctx.scale(dpr, dpr);
            const cx = size / 2, cy = size / 2, maxR = size * 0.28;
            const n = values.length, step = (2 * Math.PI) / n, start = -Math.PI / 2;
            ctx.clearRect(0, 0, size, size);

            // Grid rings
            for (let ring = 1; ring <= 5; ring++) {
                const r = (ring / 5) * maxR;
                ctx.beginPath();
                for (let i = 0; i <= n; i++) { const a = start + i * step; const x = cx + r * Math.cos(a); const y = cy + r * Math.sin(a); i === 0 ? ctx.moveTo(x, y) : ctx.lineTo(x, y); }
                ctx.closePath(); ctx.strokeStyle = 'rgba(255,255,255,0.12)'; ctx.lineWidth = 1; ctx.stroke();
                ctx.fillStyle = 'rgba(255,255,255,0.25)'; ctx.font = '10px Inter,sans-serif'; ctx.fillText(ring.toString(), cx + 4, cy - r + 12);
            }
            // Axis lines
            for (let i = 0; i < n; i++) { const a = start + i * step; ctx.beginPath(); ctx.moveTo(cx, cy); ctx.lineTo(cx + maxR * Math.cos(a), cy + maxR * Math.sin(a)); ctx.strokeStyle = 'rgba(255,255,255,0.08)'; ctx.stroke(); }

            // Target polygon (if provided)
            if (targetValues) {
                ctx.beginPath();
                targetValues.forEach((v, i) => { const a = start + i * step; const r = (v / 5) * maxR; const x = cx + r * Math.cos(a); const y = cy + r * Math.sin(a); i === 0 ? ctx.moveTo(x, y) : ctx.lineTo(x, y); });
                ctx.closePath(); ctx.fillStyle = 'rgba(168,85,247,0.15)'; ctx.fill(); ctx.strokeStyle = 'rgba(192,132,252,0.7)'; ctx.lineWidth = 2; ctx.setLineDash([6, 3]); ctx.stroke(); ctx.setLineDash([]);
            }

            // Current polygon
            ctx.beginPath();
            values.forEach((d, i) => { const a = start + i * step; const r = (d.value / 5) * maxR; const x = cx + r * Math.cos(a); const y = cy + r * Math.sin(a); i === 0 ? ctx.moveTo(x, y) : ctx.lineTo(x, y); });
            ctx.closePath(); ctx.fillStyle = 'rgba(59,130,246,0.25)'; ctx.fill(); ctx.strokeStyle = 'rgba(96,165,250,0.9)'; ctx.lineWidth = 2; ctx.stroke();

            // Data points
            values.forEach((d, i) => { const a = start + i * step; const r = (d.value / 5) * maxR; ctx.beginPath(); ctx.arc(cx + r * Math.cos(a), cy + r * Math.sin(a), 4, 0, 2 * Math.PI); ctx.fillStyle = '#60a5fa'; ctx.fill(); ctx.strokeStyle = '#fff'; ctx.lineWidth = 1.5; ctx.stroke(); });

            // Labels (multi-line wrap for long names)
            ctx.fillStyle = '#e2e8f0'; ctx.font = '10px Inter,sans-serif'; ctx.textBaseline = 'middle';
            values.forEach((d, i) => {
                const a = start + i * step; const lR = maxR + 22; const x = cx + lR * Math.cos(a); const y = cy + lR * Math.sin(a);
                if (Math.abs(Math.cos(a)) > 0.8) ctx.textAlign = Math.cos(a) > 0 ? 'left' : 'right'; else ctx.textAlign = 'center';
                const words = d.label.split(' ');
                if (words.length <= 2) { ctx.fillText(d.label, x, y); }
                else { const mid = Math.ceil(words.length / 2); ctx.fillText(words.slice(0, mid).join(' '), x, y - 6); ctx.fillText(words.slice(mid).join(' '), x, y + 6); }
            });
        }

        // ═══ SENSITIVITY TORNADO ═══
        function renderSensitivityTornado(values, weights) {
            const container = document.getElementById('tornadoContainer');
            if (!container) return;
            const baseScore = calculateScoreWithValues(values.map(v => v.value), weights);
            const sensData = [];
            values.forEach((d, i) => {
                const valsLow = values.map(v => v.value); const valsHigh = values.map(v => v.value);
                valsLow[i] = Math.max(1, d.value - 1); valsHigh[i] = Math.min(5, d.value + 1);
                const scoreLow = calculateScoreWithValues(valsLow, weights);
                const scoreHigh = calculateScoreWithValues(valsHigh, weights);
                sensData.push({ label: d.label, low: scoreLow - baseScore, high: scoreHigh - baseScore, range: Math.abs(scoreHigh - scoreLow) });
            });
            sensData.sort((a, b) => b.range - a.range);
            const maxRange = Math.max(...sensData.map(s => Math.max(Math.abs(s.low), Math.abs(s.high))), 1);
            container.innerHTML = sensData.map(s => {
                const negW = Math.abs(s.low) / maxRange * 45;
                const posW = Math.abs(s.high) / maxRange * 45;
                const negLeft = s.low < 0 ? (50 - negW) : 50;
                const posLeft = s.high > 0 ? 50 : (50 - posW);
                return `<div class="tornado-bar-row"><div class="tornado-label">${s.label}</div><div class="tornado-track"><div class="tornado-neg" style="left:${s.low < 0 ? 50 - negW : 50}%;width:${negW}%"></div><div class="tornado-pos" style="left:${s.high > 0 ? 50 : 50 - posW}%;width:${posW}%"></div><div style="position:absolute;left:50%;top:0;bottom:0;width:1px;background:rgba(255,255,255,0.3);"></div></div><div class="tornado-range">${s.range.toFixed(1)}</div></div>`;
            }).join('');
        }

        // ═══ WATERFALL CHART ═══
        function renderWaterfallChart(values, weights) {
            const canvas = document.getElementById('waterfallCanvas');
            if (!canvas) return;
            const ctx = canvas.getContext('2d');
            const dpr = window.devicePixelRatio || 1;
            const w = 500, h = 280;
            canvas.width = w * dpr; canvas.height = h * dpr;
            canvas.style.width = w + 'px'; canvas.style.height = h + 'px';
            ctx.scale(dpr, dpr);
            ctx.clearRect(0, 0, w, h);

            const contributions = values.map((d, i) => ({ label: d.label, contrib: ((d.value * weights[i]) / 4) * 100 }));
            const total = contributions.reduce((s, c) => s + c.contrib, 0);
            const barW = 40, gap = 12, startX = 50, maxH = 200, topPad = 40;
            const scale = maxH / Math.max(total, 100);
            let cumY = topPad + maxH;

            // Axis
            ctx.strokeStyle = 'rgba(255,255,255,0.15)'; ctx.beginPath(); ctx.moveTo(startX - 5, topPad + maxH); ctx.lineTo(startX + (barW + gap) * (contributions.length + 1), topPad + maxH); ctx.stroke();
            const colors = ['#3b82f6','#10b981','#f59e0b','#06b6d4','#8b5cf6','#ef4444','#ec4899','#14b8a6'];

            contributions.forEach((c, i) => {
                const barH = c.contrib * scale;
                const x = startX + i * (barW + gap);
                const y = cumY - barH;
                ctx.fillStyle = colors[i % colors.length];
                ctx.fillRect(x, y, barW, barH);
                // Connector line
                if (i > 0) { ctx.strokeStyle = 'rgba(255,255,255,0.2)'; ctx.setLineDash([3, 2]); ctx.beginPath(); ctx.moveTo(x - gap, y + barH); ctx.lineTo(x, y + barH); ctx.stroke(); ctx.setLineDash([]); }
                cumY = y;
                // Label
                ctx.fillStyle = '#94a3b8'; ctx.font = '9px Inter,sans-serif'; ctx.textAlign = 'center';
                ctx.fillText(c.label.substring(0, 8), x + barW / 2, topPad + maxH + 14);
                ctx.fillStyle = '#e2e8f0'; ctx.font = '10px JetBrains Mono,monospace';
                ctx.fillText(c.contrib.toFixed(1), x + barW / 2, y - 4);
            });

            // Total bar
            const tx = startX + contributions.length * (barW + gap);
            const totalH = total * scale;
            ctx.fillStyle = 'rgba(59,130,246,0.4)'; ctx.fillRect(tx, topPad + maxH - totalH, barW, totalH);
            ctx.strokeStyle = '#60a5fa'; ctx.lineWidth = 2; ctx.strokeRect(tx, topPad + maxH - totalH, barW, totalH);
            ctx.fillStyle = '#94a3b8'; ctx.font = '9px Inter,sans-serif'; ctx.textAlign = 'center';
            ctx.fillText('TOTAL', tx + barW / 2, topPad + maxH + 14);
            ctx.fillStyle = '#60a5fa'; ctx.font = 'bold 11px JetBrains Mono,monospace';
            ctx.fillText(total.toFixed(1), tx + barW / 2, topPad + maxH - totalH - 6);
        }

        // ═══ CONFIDENCE INTERVAL (MONTE CARLO) ═══
        function renderConfidenceInterval(values, weights) {
            const container = document.getElementById('confidenceDisplay');
            if (!container) return;
            const baseVals = values.map(v => v.value);
            const results = [];
            for (let i = 0; i < 10000; i++) {
                const noisy = baseVals.map(v => Math.max(1, Math.min(5, v + (Math.random() - 0.5))));
                results.push(calculateScoreWithValues(noisy, weights));
            }
            results.sort((a, b) => a - b);
            const p5 = results[Math.floor(results.length * 0.05)];
            const p95 = results[Math.floor(results.length * 0.95)];
            const mean = results.reduce((s, v) => s + v, 0) / results.length;
            const median = results[Math.floor(results.length * 0.5)];
            const ciWidth = p95 - p5;

            container.innerHTML = [
                { label: 'P5', value: p5.toFixed(1) },
                { label: 'Mean', value: mean.toFixed(1) },
                { label: 'Median', value: median.toFixed(1) },
                { label: 'P95', value: p95.toFixed(1) },
                { label: '90% CI Width', value: ciWidth.toFixed(1) }
            ].map(s => `<div class="confidence-stat"><div class="confidence-stat-value">${s.value}</div><div class="confidence-stat-label">${s.label}</div></div>`).join('');
        }

        // ═══ SCENARIO WHAT-IF ═══
        function renderScenarioResults(values, weights) {
            const container = document.getElementById('scenarioResult');
            if (!container) return;
            const targetVals = dimensions.map(d => {
                const el = document.getElementById('scenario-' + d.id);
                return el ? parseInt(el.value) : parseInt(document.getElementById(d.el).value);
            });
            const currentScore = calculateScoreWithValues(values.map(v => v.value), weights);
            const targetScore = calculateScoreWithValues(targetVals, weights);
            const delta = targetScore - currentScore;
            const currentMat = getMaturityLabel(currentScore);
            const targetMat = getMaturityLabel(targetScore);
            container.style.display = 'flex';
            container.innerHTML = `
                <div class="sr-current"><div class="sr-value" style="color:${currentMat.color};">${Math.round(currentScore)}</div><div class="sr-label">Current (${currentMat.label})</div></div>
                <div style="font-size:1.5rem;color:#64748b;">&rarr;</div>
                <div class="sr-target"><div class="sr-value" style="color:${targetMat.color};">${Math.round(targetScore)}</div><div class="sr-label">Target (${targetMat.label})</div></div>
                <div style="border-left:1px solid rgba(255,255,255,0.1);padding-left:1rem;"><div class="sr-delta" style="color:${delta >= 0 ? '#22c55e' : '#ef4444'};">${delta >= 0 ? '+' : ''}${delta.toFixed(1)}</div><div class="sr-label">Delta</div></div>
            `;
        }

        // ═══ PRO RADAR (CURRENT vs TARGET) ═══
        function drawProRadarChart(values) {
            const canvas = document.getElementById('proRadarCanvas');
            if (!canvas) return;
            const targetVals = dimensions.map(d => {
                const el = document.getElementById('scenario-' + d.id);
                return el ? parseInt(el.value) : parseInt(document.getElementById(d.el).value);
            });
            drawRadarOnCanvas(canvas, values, targetVals, 400);
        }

        // ═══ WEIGHT EDITOR ═══
        function buildWeightEditor() {
            const presetBar = document.getElementById('weightPresetBar');
            const grid = document.getElementById('weightEditorGrid');
            if (!presetBar || !grid) return;
            presetBar.innerHTML = Object.entries(weightPresets).map(([key, p]) =>
                `<button class="weight-preset-btn${key === 'default' ? ' active' : ''}" data-preset="${key}" onclick="applyWeightPreset('${key}')">${p.label}</button>`
            ).join('');
            grid.innerHTML = dimensions.map((d, i) =>
                `<div class="weight-row"><div class="weight-row-label">${d.label}</div><input type="range" min="0" max="30" step="1" value="${Math.round(customWeights[i] * 100)}" id="weight-${d.id}" oninput="updateWeight(${i}, this.value)"><div class="weight-row-value" id="weight-val-${d.id}">${Math.round(customWeights[i] * 100)}%</div></div>`
            ).join('');
        }

        window.updateWeight = function(idx, val) {
            customWeights[idx] = parseInt(val) / 100;
            document.getElementById('weight-val-' + dimensions[idx].id).textContent = val + '%';
            const total = Math.round(customWeights.reduce((s, w) => s + w, 0) * 100);
            const totalEl = document.getElementById('weightTotal');
            totalEl.textContent = 'Total: ' + total + '%';
            totalEl.className = 'weight-total' + (total !== 100 ? ' invalid' : '');
            calculateMaturity();
        };

        window.applyWeightPreset = function(key) {
            const preset = weightPresets[key];
            if (!preset) return;
            customWeights = [...preset.weights];
            dimensions.forEach((d, i) => {
                const slider = document.getElementById('weight-' + d.id);
                const label = document.getElementById('weight-val-' + d.id);
                if (slider) { slider.value = Math.round(customWeights[i] * 100); }
                if (label) { label.textContent = Math.round(customWeights[i] * 100) + '%'; }
            });
            document.querySelectorAll('.weight-preset-btn').forEach(b => b.classList.remove('active'));
            document.querySelector(`.weight-preset-btn[data-preset="${key}"]`)?.classList.add('active');
            const totalEl = document.getElementById('weightTotal');
            totalEl.textContent = 'Total: 100%'; totalEl.className = 'weight-total';
            calculateMaturity();
        };

        // ═══ SUB-DIMENSION ACCORDIONS ═══
        function buildSubDimensionAccordions() {
            const container = document.getElementById('subDimContainer');
            if (!container) return;
            container.innerHTML = dimensions.map(d => {
                const subs = subDimensions[d.id] || [];
                const parentVal = parseInt(document.getElementById(d.el).value);
                const optionsHtml = [1,2,3,4,5].map(v => `<option value="${v}"${v === parentVal ? ' selected' : ''}>${v}</option>`).join('');
                return `<div class="subdim-accordion">
                    <div class="subdim-header" onclick="toggleSubDim('${d.id}')"><span class="subdim-header-label">${d.label}</span><span style="display:flex;align-items:center;gap:8px;"><span class="subdim-header-avg" id="subdim-avg-${d.id}">${parentVal.toFixed(1)}</span><i class="fas fa-chevron-down" id="subdim-chevron-${d.id}"></i></span></div>
                    <div class="subdim-body" id="subdim-body-${d.id}"><div class="subdim-body-inner">${subs.map(s =>
                        `<div class="subdim-row"><div class="subdim-row-label" title="${s.desc}">${s.label}</div><select id="subdim-${d.id}-${s.id}" onchange="updateSubDimAvg('${d.id}')">${optionsHtml}</select></div>`
                    ).join('')}</div></div>
                </div>`;
            }).join('');
        }

        window.toggleSubDim = function(dimId) {
            const body = document.getElementById('subdim-body-' + dimId);
            const chevron = document.getElementById('subdim-chevron-' + dimId);
            if (body) body.classList.toggle('open');
            if (chevron) chevron.style.transform = body.classList.contains('open') ? 'rotate(180deg)' : '';
        };

        window.updateSubDimAvg = function(dimId) {
            const subs = subDimensions[dimId] || [];
            const vals = subs.map(s => { const el = document.getElementById('subdim-' + dimId + '-' + s.id); return el ? parseInt(el.value) : 3; });
            const avg = vals.reduce((s, v) => s + v, 0) / vals.length;
            const rounded = Math.round(avg);
            document.getElementById(dimensions.find(d => d.id === dimId).el).value = rounded;
            const avgEl = document.getElementById('subdim-avg-' + dimId);
            if (avgEl) avgEl.textContent = avg.toFixed(1);
            // Sync card button states
            var card = document.querySelector('.dim-card[data-dim="' + dimId + '"]');
            if (card) {
                card.querySelectorAll('.dim-score-btn').forEach(function(b) {
                    b.classList.toggle('active', parseInt(b.getAttribute('data-val')) === rounded);
                });
                var defEl = document.getElementById('def-' + dimId);
                if (defEl && levelDefs[dimId]) {
                    defEl.textContent = rounded + ' — ' + levelLabels[rounded-1] + ': ' + levelDefs[dimId][rounded-1];
                }
            }
            calculateMaturity();
        };

        // ═══ SCENARIO GRID ═══
        function buildScenarioGrid() {
            const grid = document.getElementById('scenarioGrid');
            if (!grid) return;
            grid.innerHTML = dimensions.map(d => {
                const current = parseInt(document.getElementById(d.el).value);
                const opts = [1,2,3,4,5].map(v => `<option value="${v}"${v === Math.min(5, current + 1) ? ' selected' : ''}>${v}</option>`).join('');
                return `<div class="scenario-item"><div class="scenario-item-label">${d.label}</div><select id="scenario-${d.id}" onchange="calculateMaturity()">${opts}</select></div>`;
            }).join('');
        }

        // ═══ MODE SWITCHING & GATING ═══
        window.switchMaturityMode = function(mode) {
            if (mode === 'pro' && !isPremiumMaturity) {
                if (window._rzAuth && typeof window._rzAuth.showModal === 'function') window._rzAuth.showModal();
                else if (document.querySelector('.login-overlay')) document.querySelector('.login-overlay').style.display = 'flex';
                else alert('Pro Analysis requires a ResistanceZero PRO subscription. Please log in first.');
                return;
            }
            maturityMode = mode;
            document.getElementById('maturityModeFree').classList.toggle('active', mode === 'free');
            document.getElementById('maturityModePro').classList.toggle('active', mode === 'pro');
            var inputs = document.getElementById('maturityProInputs');
            var panels = document.getElementById('maturityProPanels');
            if (inputs) inputs.style.display = mode === 'pro' ? 'block' : 'none';
            if (panels) panels.style.display = mode === 'pro' ? 'block' : 'none';
            if (mode === 'pro' && !proBuilt) {
                proBuilt = true;
                buildWeightEditor();
                buildSubDimensionAccordions();
                buildScenarioGrid();
            }
            calculateMaturity();
        };

        function applyMaturityGating() {
            const badge = document.getElementById('maturityProBadge');
            if (isPremiumMaturity) {
                if (badge) badge.style.display = 'none';
                document.querySelectorAll('#maturityProPanels .pro-panel .gated-overlay').forEach(o => o.remove());
            } else {
                if (badge) badge.style.display = 'inline-block';
            }
        }

        // ═══ NARRATIVE CONCLUSION GENERATOR ═══
        function generateMaturityNarrative(score, maturity, weightedSum, values, gaps, weights) {
            const sc = Math.round(score);
            const lvl = maturity.level;
            const lbl = maturity.label;
            const sorted = [...values].sort((a, b) => b.value - a.value);
            const strongest = sorted[0];
            const secondStr = sorted[1];
            const weakest = sorted[sorted.length - 1];
            const secondWeak = sorted[sorted.length - 2];
            const topGaps = gaps.filter(g => g.gap > 0).slice(0, 3);
            const atMax = values.filter(v => v.value === 5).length;
            const atMin = values.filter(v => v.value <= 2).length;
            const avgScore = values.reduce((s, v) => s + v.value, 0) / values.length;
            const spread = Math.max(...values.map(v => v.value)) - Math.min(...values.map(v => v.value));

            // Benchmark positioning
            let benchRef = '';
            if (sc >= 82) benchRef = 'exceeds the Tier IV industry benchmark (82), placing this facility among the top-performing organizations globally';
            else if (sc >= 65) benchRef = 'meets or exceeds the Tier III benchmark (65), indicating solid operational discipline with room for further optimization';
            else if (sc >= 45) benchRef = 'aligns with the Tier II benchmark range (45), representing developing operational capabilities with significant improvement potential';
            else if (sc >= 25) benchRef = 'falls within the Tier I benchmark range (25), indicating foundational capabilities that require substantial development';
            else benchRef = 'falls below the Tier I baseline, indicating critical operational gaps that pose immediate risk to facility reliability';

            // Risk assessment matrix
            let riskLevel, riskColor, riskNarrative;
            if (sc >= 80) { riskLevel = 'LOW'; riskColor = '#059669'; riskNarrative = 'The organization demonstrates mature, proactive risk management. Incident probability is minimized through robust preventive systems, predictive capabilities, and a culture of continuous improvement.'; }
            else if (sc >= 60) { riskLevel = 'MODERATE'; riskColor = '#d97706'; riskNarrative = 'Core operational processes are in place, but gaps in specific dimensions create vulnerability windows. The organization responds well to known risks but may struggle with novel failure modes or cascading scenarios.'; }
            else if (sc >= 40) { riskLevel = 'ELEVATED'; riskColor = '#ea580c'; riskNarrative = 'Multiple operational dimensions show developing maturity. The facility depends heavily on individual expertise rather than systematic processes. Human error risk is elevated due to incomplete procedures, training gaps, or monitoring blind spots.'; }
            else { riskLevel = 'HIGH'; riskColor = '#dc2626'; riskNarrative = 'Significant operational risk exists across multiple dimensions. The facility operates in a predominantly reactive mode, with limited preventive measures and high dependency on ad-hoc responses. Immediate intervention is recommended.'; }

            // Improvement impact projection
            let improvementNarrative = '';
            if (topGaps.length > 0) {
                const projections = topGaps.map(g => {
                    const newVals = values.map(v => v.value);
                    const idx = values.findIndex(v => v.label === g.label);
                    const target = Math.min(5, g.value + 1);
                    newVals[idx] = target;
                    const newWS = newVals.reduce((s, v, i) => s + v * weights[i], 0);
                    const newScore = ((newWS - 1) / 4) * 100;
                    const delta = newScore - score;
                    return { label: g.label, from: g.value, to: target, delta: delta.toFixed(1), newScore: Math.round(newScore) };
                });
                improvementNarrative = projections.map(p =>
                    `Improving <strong>${p.label}</strong> from Level ${p.from} to Level ${p.to} would increase the composite score by <strong>+${p.delta} points</strong> to <strong>${p.newScore}/100</strong>.`
                ).join(' ');
            }

            // Dimension balance analysis
            let balanceNarrative;
            if (spread <= 1) balanceNarrative = 'Dimension scores are well-balanced (spread: ' + spread + '), indicating consistent maturity across all operational areas. This is a positive indicator — uneven organizations tend to fail at their weakest link.';
            else if (spread <= 2) balanceNarrative = 'Moderate dimension spread (' + spread + ' points) suggests some unevenness in operational maturity. While strengths exist, the weaker dimensions represent potential failure vectors that should be addressed.';
            else balanceNarrative = 'High dimension spread (' + spread + ' points) reveals significant imbalance. The gap between strongest (' + strongest.label + ' at ' + strongest.value + '/5) and weakest (' + weakest.label + ' at ' + weakest.value + '/5) dimensions creates operational vulnerability — incidents are most likely to originate from the weakest areas.';

            // Maturity stage narrative
            const stageDescriptions = {
                1: 'At Level 1 (Reactive), the organization operates in firefighting mode. There are no standardized processes, and outcomes depend entirely on individual heroics. The immediate priority is establishing basic documentation, minimum viable monitoring, and foundational PM programs.',
                2: 'At Level 2 (Preventive), basic operational structures exist but are inconsistently applied. Scheduled maintenance occurs but may lack rigor. The priority is formalizing processes, building accountability, and transitioning from calendar-based to condition-based decision-making.',
                3: 'At Level 3 (Predictive), the organization has crossed the critical threshold from reactive to data-informed operations. Core processes are defined and followed. The challenge now is deepening analytical capability, expanding cross-training, and building organizational resilience beyond individual competence.',
                4: 'At Level 4 (Proactive), the organization actively anticipates and mitigates risks before they materialize. Strong processes, skilled teams, and robust monitoring create a resilient operational environment. The opportunity is advancing toward generative culture — where the organization learns and adapts continuously.',
                5: 'At Level 5 (Generative), the organization represents best-in-class operational maturity. Safety-II principles are embedded: success is actively engineered, not merely the absence of failure. Focus should shift to sustaining excellence, mentoring the industry, and preparing for next-generation challenges (AI workloads, liquid cooling, edge computing).'
            };

            // Strategic recommendations matrix
            let recommendations = [];
            if (atMin > 0) recommendations.push({ priority: 'CRITICAL', text: atMin + ' dimension(s) scored at Level 1-2 (Ad-hoc/Repeatable). These represent immediate operational risk. Focus on establishing minimum viable processes within 90 days.' });
            if (topGaps.length > 0) recommendations.push({ priority: 'HIGH', text: 'Top priority improvement: <strong>' + topGaps[0].label + '</strong> (currently ' + topGaps[0].value + '/5). This dimension has the highest weighted impact score (' + topGaps[0].priority.toFixed(3) + ') — improving it yields the greatest return on investment.' });
            if (spread >= 3) recommendations.push({ priority: 'HIGH', text: 'Address dimensional imbalance. The ' + spread + '-point spread between highest and lowest dimensions creates chain-of-failure risk. Equalize weaker areas before advancing stronger ones.' });
            if (lvl <= 3 && values.find(v => v.id === 'monitor')?.value <= 3) recommendations.push({ priority: 'MEDIUM', text: 'Monitoring is at Level ' + (values.find(v => v.id === 'monitor')?.value || '?') + '. Invest in BMS/DCIM coverage and alarm hierarchy — you cannot manage what you cannot measure.' });
            if (lvl <= 3 && values.find(v => v.id === 'change')?.value <= 2) recommendations.push({ priority: 'MEDIUM', text: 'Change Management is critically low. 70% of data center outages trace to human error during changes. Implement formal MOC process immediately.' });
            if (values.find(v => v.id === 'leadership')?.value < values.find(v => v.id === 'maint')?.value) recommendations.push({ priority: 'MEDIUM', text: 'Leadership maturity (' + values.find(v => v.id === 'leadership')?.value + '/5) lags behind technical maturity. Operational improvements will stall without executive sponsorship and cultural alignment.' });
            if (atMax >= 6) recommendations.push({ priority: 'LOW', text: 'Maintain excellence across ' + atMax + ' dimensions. Focus on sustaining performance through regular audits, benchmark refreshes, and knowledge transfer programs.' });
            if (lvl >= 4) recommendations.push({ priority: 'LOW', text: 'Consider external validation: Uptime M&O certification, ISO 27001, or ISMS audit to formally recognize your operational maturity.' });

            const recsHTML = recommendations.map(r => {
                const pColor = r.priority === 'CRITICAL' ? '#dc2626' : r.priority === 'HIGH' ? '#ea580c' : r.priority === 'MEDIUM' ? '#d97706' : '#059669';
                return `<tr><td style="padding:6px 8px;border-bottom:1px solid #e5e7eb;"><span style="display:inline-block;padding:2px 8px;border-radius:4px;background:${pColor};color:white;font-size:9px;font-weight:700;">${r.priority}</span></td><td style="padding:6px 8px;border-bottom:1px solid #e5e7eb;font-size:11px;">${r.text}</td></tr>`;
            }).join('');

            return `
            <div style="page-break-before:auto;margin-top:24px;">
                <h2 style="font-size:16px;color:#1e3a5f;border-bottom:3px solid #1e3a5f;padding-bottom:6px;margin-bottom:14px;">Executive Assessment & Recommendations</h2>

                <!-- Risk Badge -->
                <div style="display:flex;gap:12px;margin-bottom:16px;">
                    <div style="flex:0 0 140px;background:${riskColor};color:white;border-radius:10px;padding:16px;text-align:center;">
                        <div style="font-size:10px;opacity:0.8;text-transform:uppercase;letter-spacing:1px;">Operational Risk</div>
                        <div style="font-size:22px;font-weight:800;margin:4px 0;">${riskLevel}</div>
                        <div style="font-size:10px;opacity:0.8;">Score: ${sc}/100</div>
                    </div>
                    <div style="flex:1;font-size:11.5px;line-height:1.65;color:#374151;">
                        <p style="margin:0 0 8px;"><strong>Overall Assessment:</strong> This facility achieves a composite maturity score of <strong style="color:${maturity.color};">${sc}/100</strong> (Level ${lvl} — ${lbl}), which ${benchRef}.</p>
                        <p style="margin:0;">${riskNarrative}</p>
                    </div>
                </div>

                <!-- Maturity Stage Analysis -->
                <div style="background:#f8fafc;border:1px solid #e5e7eb;border-radius:10px;padding:14px;margin-bottom:16px;">
                    <div style="font-size:12px;font-weight:700;color:#1e3a5f;margin-bottom:6px;">Maturity Stage Analysis</div>
                    <p style="font-size:11px;line-height:1.6;color:#374151;margin:0;">${stageDescriptions[lvl]}</p>
                </div>

                <!-- Strengths & Weaknesses -->
                <div style="display:flex;gap:12px;margin-bottom:16px;">
                    <div style="flex:1;background:#ecfdf5;border:1px solid #a7f3d0;border-radius:10px;padding:12px;">
                        <div style="font-size:11px;font-weight:700;color:#065f46;margin-bottom:6px;">Strengths</div>
                        <p style="font-size:11px;color:#374151;margin:0;line-height:1.5;">
                            <strong>${strongest.label}</strong> leads at <strong>${strongest.value}/5</strong> (contributing ${((strongest.value * strongest.weight) / 4 * 100).toFixed(1)} points to composite score)${secondStr.value >= 4 ? ', followed by <strong>' + secondStr.label + '</strong> at <strong>' + secondStr.value + '/5</strong>' : ''}.
                            ${atMax > 0 ? atMax + ' dimension(s) at maximum level (5/5).' : ''}
                        </p>
                    </div>
                    <div style="flex:1;background:#fef2f2;border:1px solid #fecaca;border-radius:10px;padding:12px;">
                        <div style="font-size:11px;font-weight:700;color:#991b1b;margin-bottom:6px;">Vulnerabilities</div>
                        <p style="font-size:11px;color:#374151;margin:0;line-height:1.5;">
                            <strong>${weakest.label}</strong> is the weakest dimension at <strong>${weakest.value}/5</strong>${secondWeak.value <= 3 ? ', with <strong>' + secondWeak.label + '</strong> also requiring attention at <strong>' + secondWeak.value + '/5</strong>' : ''}.
                            ${atMin > 0 ? '<span style="color:#dc2626;font-weight:600;">' + atMin + ' dimension(s) at critical level (1-2).</span>' : ''}
                        </p>
                    </div>
                </div>

                <!-- Dimension Balance -->
                <div style="background:#f8fafc;border:1px solid #e5e7eb;border-radius:10px;padding:14px;margin-bottom:16px;">
                    <div style="font-size:12px;font-weight:700;color:#1e3a5f;margin-bottom:6px;">Dimensional Balance</div>
                    <p style="font-size:11px;line-height:1.6;color:#374151;margin:0;">${balanceNarrative}</p>
                </div>

                <!-- Improvement Projections -->
                ${improvementNarrative ? `
                <div style="background:#eff6ff;border:1px solid #bfdbfe;border-radius:10px;padding:14px;margin-bottom:16px;">
                    <div style="font-size:12px;font-weight:700;color:#1e3a5f;margin-bottom:6px;">Improvement Impact Projections</div>
                    <p style="font-size:11px;line-height:1.6;color:#374151;margin:0;">${improvementNarrative}</p>
                </div>` : ''}

                <!-- Strategic Recommendations -->
                <div style="margin-bottom:16px;">
                    <div style="font-size:12px;font-weight:700;color:#1e3a5f;margin-bottom:8px;">Strategic Recommendations</div>
                    <table style="width:100%;border-collapse:collapse;">
                        <tr style="background:#1e3a5f;color:white;"><th style="padding:6px 8px;text-align:left;font-size:10px;width:80px;">Priority</th><th style="padding:6px 8px;text-align:left;font-size:10px;">Recommendation</th></tr>
                        ${recsHTML}
                    </table>
                </div>

                <!-- Maturity Roadmap -->
                <div style="background:linear-gradient(135deg,#1e3a5f,#2d5a87);border-radius:10px;padding:16px;color:white;">
                    <div style="font-size:12px;font-weight:700;margin-bottom:8px;">Maturity Advancement Roadmap</div>
                    <div style="display:flex;align-items:center;gap:4px;margin-bottom:10px;">
                        ${[1,2,3,4,5].map(l => {
                            const isActive = l === lvl;
                            const isPast = l < lvl;
                            const labels = ['Reactive','Preventive','Predictive','Proactive','Generative'];
                            const bg = isActive ? maturity.color : isPast ? 'rgba(255,255,255,0.3)' : 'rgba(255,255,255,0.08)';
                            return `<div style="flex:1;text-align:center;padding:8px 4px;background:${bg};border-radius:6px;${isActive ? 'border:2px solid white;' : ''}"><div style="font-size:14px;font-weight:800;">${l}</div><div style="font-size:8px;opacity:0.8;">${labels[l-1]}</div></div>`;
                        }).join('<div style="width:12px;height:2px;background:rgba(255,255,255,0.3);"></div>')}
                    </div>
                    <p style="font-size:11px;line-height:1.5;opacity:0.9;margin:0;">
                        ${lvl < 5 ? `<strong>Next milestone:</strong> Level ${lvl + 1} (${['','Preventive','Predictive','Proactive','Generative'][lvl]}) requires a composite score of ${lvl * 20 + 1}+. ` +
                        `Current gap: <strong>${(lvl * 20 + 1) - sc > 0 ? (lvl * 20 + 1) - sc : 0} points</strong>. ` +
                        `Focus on the top ${Math.min(3, topGaps.length)} priority dimensions to close this gap most efficiently.`
                        : 'This facility has achieved the highest maturity level. Focus on sustaining excellence, sharing best practices, and mentoring less mature operations in the portfolio.'}
                    </p>
                </div>
            </div>`;
        }

        // ═══ PDF EXPORT ═══
        window.exportMaturityPDF = function() {
            const weights = getActiveWeights();
            const values = dimensions.map((d, i) => ({
                ...d, weight: weights[i],
                value: parseInt(document.getElementById(d.el).value)
            }));
            const weightedSum = values.reduce((s, d) => s + d.value * d.weight, 0);
            const compositeScore = ((weightedSum - 1) / 4) * 100;
            const maturity = getMaturityLabel(compositeScore);
            const now = new Date();
            const dateStr = now.toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' });

            const rmiNum = values.reduce((s, d) => s + d.value * d.weight * d.impact, 0);
            const rmiDen = values.reduce((s, d) => s + 5 * d.weight * d.impact, 0);
            const rmi = (rmiNum / rmiDen) * 100;

            const gaps = values.map(d => ({
                label: d.label, gap: 5 - d.value, priority: (5 - d.value) * d.weight * d.impact, value: d.value, weight: d.weight
            })).sort((a, b) => b.priority - a.priority);

            // Dimension table
            const dimRows = values.map(d => {
                const pct = (d.value / 5) * 100;
                const contrib = ((d.value * d.weight) / 4) * 100;
                return `<tr><td style="padding:6px 8px;border-bottom:1px solid #e5e7eb;">${d.label}</td>
                    <td style="padding:6px 8px;text-align:center;border-bottom:1px solid #e5e7eb;">${d.value}/5</td>
                    <td style="padding:6px 8px;text-align:right;border-bottom:1px solid #e5e7eb;">${(d.weight * 100).toFixed(0)}%</td>
                    <td style="padding:6px 8px;text-align:right;border-bottom:1px solid #e5e7eb;font-family:monospace;">${contrib.toFixed(1)}</td>
                    <td style="padding:6px 8px;border-bottom:1px solid #e5e7eb;"><div style="background:#e5e7eb;border-radius:4px;height:12px;overflow:hidden;"><div style="width:${pct}%;height:100%;background:linear-gradient(90deg,#3b82f6,#60a5fa);border-radius:4px;"></div></div></td></tr>`;
            }).join('');

            // Priority rows
            const priorityRows = gaps.filter(g => g.gap > 0).slice(0, 5).map((p, i) =>
                `<tr><td style="padding:5px 8px;border-bottom:1px solid #e5e7eb;">${i + 1}</td><td style="padding:5px 8px;border-bottom:1px solid #e5e7eb;font-weight:600;">${p.label}</td><td style="padding:5px 8px;text-align:center;border-bottom:1px solid #e5e7eb;">${p.value}/5</td><td style="padding:5px 8px;text-align:center;border-bottom:1px solid #e5e7eb;">${p.gap}</td><td style="padding:5px 8px;text-align:right;border-bottom:1px solid #e5e7eb;font-family:monospace;">${p.priority.toFixed(3)}</td></tr>`
            ).join('');

            // Benchmark
            const benchRows = benchmarks.map(b => {
                const isClose = Math.abs(compositeScore - b.avg) === Math.min(...benchmarks.map(x => Math.abs(compositeScore - x.avg)));
                return `<tr${isClose ? ' style="background:#eff6ff;"' : ''}><td style="padding:5px 8px;border-bottom:1px solid #e5e7eb;">${b.tier}</td><td style="padding:5px 8px;text-align:center;border-bottom:1px solid #e5e7eb;">${b.avg}</td><td style="padding:5px 8px;text-align:center;border-bottom:1px solid #e5e7eb;">${compositeScore >= b.avg ? 'Above' : 'Below'}</td></tr>`;
            }).join('');

            // Radar SVG for PDF — wider with label padding
            function radarSVG(vals, size) {
                const pad = 70; // extra padding for labels
                const totalW = size + pad*2, totalH = size + pad*2;
                const cx = totalW/2, cy = totalH/2, maxR = size*0.32;
                const n = vals.length, step = (2*Math.PI)/n, start = -Math.PI/2;
                let svg = `<svg width="${totalW}" height="${totalH}" xmlns="http://www.w3.org/2000/svg" style="background:#0f172a;border-radius:12px;">`;
                // Title
                svg += `<text x="${cx}" y="18" fill="#64748b" font-size="9" font-family="Arial,sans-serif" text-anchor="middle">MATURITY PROFILE</text>`;
                // Grid rings + ring labels
                for (let ring = 1; ring <= 5; ring++) {
                    const r = (ring/5)*maxR; let pts = '';
                    for (let i = 0; i < n; i++) { const a = start+i*step; pts += `${cx+r*Math.cos(a)},${cy+r*Math.sin(a)} `; }
                    svg += `<polygon points="${pts}" fill="none" stroke="rgba(255,255,255,0.10)" stroke-width="1"/>`;
                    svg += `<text x="${cx+4}" y="${cy-r+10}" fill="rgba(255,255,255,0.25)" font-size="8" font-family="Arial,sans-serif">${ring}</text>`;
                }
                // Axis lines
                vals.forEach((v,i) => { const a = start+i*step; const r = maxR; svg += `<line x1="${cx}" y1="${cy}" x2="${cx+r*Math.cos(a)}" y2="${cy+r*Math.sin(a)}" stroke="rgba(255,255,255,0.06)" stroke-width="1"/>`; });
                // ISO 55001 Target polygon (Level 4 = Proactive baseline)
                let targetPts = '';
                vals.forEach((v, i) => { const a = start+i*step; const r = (4/5)*maxR; targetPts += `${cx+r*Math.cos(a)},${cy+r*Math.sin(a)} `; });
                svg += `<polygon points="${targetPts}" fill="rgba(168,85,247,0.08)" stroke="rgba(192,132,252,0.5)" stroke-width="1.5" stroke-dasharray="6,3"/>`;
                // Data polygon fill + stroke
                let dataPts = '';
                vals.forEach((v, i) => { const a = start+i*step; const r = (v.value/5)*maxR; dataPts += `${cx+r*Math.cos(a)},${cy+r*Math.sin(a)} `; });
                svg += `<polygon points="${dataPts}" fill="rgba(59,130,246,0.25)" stroke="rgba(96,165,250,0.9)" stroke-width="2"/>`;
                // Data dots
                vals.forEach((v, i) => { const a = start+i*step; const r = (v.value/5)*maxR; svg += `<circle cx="${cx+r*Math.cos(a)}" cy="${cy+r*Math.sin(a)}" r="3" fill="#60a5fa" stroke="white" stroke-width="1"/>`; });
                // Labels with score badge
                vals.forEach((v, i) => {
                    const a = start+i*step; const lR = maxR+20;
                    const x = cx+lR*Math.cos(a); const y = cy+lR*Math.sin(a);
                    let anchor = 'middle'; if (Math.cos(a) > 0.3) anchor='start'; else if (Math.cos(a) < -0.3) anchor='end';
                    // Score circle
                    const bx = anchor==='start' ? x-12 : anchor==='end' ? x+12 : x;
                    const by = Math.abs(Math.sin(a)) > 0.8 ? (Math.sin(a) > 0 ? y+14 : y-10) : y;
                    svg += `<circle cx="${bx}" cy="${by-1}" r="8" fill="rgba(59,130,246,0.3)" stroke="rgba(96,165,250,0.5)" stroke-width="1"/>`;
                    svg += `<text x="${bx}" y="${by+2}" fill="#60a5fa" font-size="9" font-weight="700" font-family="Arial,sans-serif" text-anchor="middle">${v.value}</text>`;
                    // Label text
                    const lx = anchor==='start' ? bx+14 : anchor==='end' ? bx-14 : x;
                    const ly = Math.abs(Math.sin(a)) > 0.8 ? by : y;
                    svg += `<text x="${lx}" y="${ly+3}" fill="#cbd5e1" font-size="9" font-family="Arial,sans-serif" text-anchor="${anchor}">${v.label}</text>`;
                });
                svg += '</svg>';
                return svg;
            }

            // Gap Analysis horizontal bar chart SVG for PDF
            function gapBarSVG(vals, gaps, compositeScore, maturityLabel) {
                const w = 340, barH = 22, gap = 6, topPad = 36, bottomPad = 30;
                const sortedGaps = [...gaps].sort((a, b) => b.priority - a.priority);
                const h = topPad + sortedGaps.length * (barH + gap) + bottomPad;
                const labelW = 90, barStart = labelW + 8, barMaxW = w - barStart - 40;
                let svg = `<svg width="${w}" height="${h}" xmlns="http://www.w3.org/2000/svg" style="background:#0f172a;border-radius:12px;">`;
                svg += `<text x="${w/2}" y="18" fill="#64748b" font-size="9" font-family="Arial,sans-serif" text-anchor="middle">GAP &amp; PRIORITY ANALYSIS</text>`;
                // Scale markers
                for (let s = 1; s <= 5; s++) {
                    const x = barStart + (s/5)*barMaxW;
                    svg += `<line x1="${x}" y1="${topPad-4}" x2="${x}" y2="${topPad + sortedGaps.length*(barH+gap)-gap}" stroke="rgba(255,255,255,0.06)" stroke-width="1"/>`;
                    svg += `<text x="${x}" y="${topPad-8}" fill="rgba(255,255,255,0.3)" font-size="7" font-family="Arial,sans-serif" text-anchor="middle">${s}</text>`;
                }
                // Bars
                const colors = {5:'#22c55e',4:'#3b82f6',3:'#f59e0b',2:'#ea580c',1:'#ef4444'};
                sortedGaps.forEach((g, i) => {
                    const y = topPad + i * (barH + gap);
                    const scoreW = (g.value/5) * barMaxW;
                    const gapW = (g.gap/5) * barMaxW;
                    // Label
                    svg += `<text x="${labelW}" y="${y+barH/2+3}" fill="#cbd5e1" font-size="9" font-family="Arial,sans-serif" text-anchor="end">${g.label}</text>`;
                    // Background (max)
                    svg += `<rect x="${barStart}" y="${y}" width="${barMaxW}" height="${barH}" rx="4" fill="rgba(255,255,255,0.04)"/>`;
                    // Score fill
                    svg += `<rect x="${barStart}" y="${y}" width="${scoreW}" height="${barH}" rx="4" fill="${colors[g.value] || '#3b82f6'}" opacity="0.7"/>`;
                    // Gap zone (striped)
                    if (g.gap > 0) {
                        svg += `<rect x="${barStart+scoreW}" y="${y}" width="${gapW}" height="${barH}" rx="0" fill="rgba(239,68,68,0.12)"/>`;
                        svg += `<text x="${barStart+scoreW+gapW/2}" y="${y+barH/2+3}" fill="#f87171" font-size="7" font-family="Arial,sans-serif" text-anchor="middle" opacity="0.8">-${g.gap}</text>`;
                    }
                    // Score value
                    svg += `<text x="${barStart+scoreW-4}" y="${y+barH/2+3}" fill="white" font-size="9" font-weight="700" font-family="Arial,sans-serif" text-anchor="end">${g.value}</text>`;
                    // Priority score
                    svg += `<text x="${barStart+barMaxW+4}" y="${y+barH/2+3}" fill="#94a3b8" font-size="8" font-family="monospace" text-anchor="start">${g.priority.toFixed(2)}</text>`;
                });
                // Legend
                const ly = topPad + sortedGaps.length * (barH + gap) + 8;
                svg += `<rect x="${barStart}" y="${ly}" width="8" height="8" rx="2" fill="#3b82f6" opacity="0.7"/>`;
                svg += `<text x="${barStart+12}" y="${ly+7}" fill="#94a3b8" font-size="7" font-family="Arial,sans-serif">Current Score</text>`;
                svg += `<rect x="${barStart+80}" y="${ly}" width="8" height="8" rx="2" fill="rgba(239,68,68,0.3)"/>`;
                svg += `<text x="${barStart+92}" y="${ly+7}" fill="#94a3b8" font-size="7" font-family="Arial,sans-serif">Gap to Level 5</text>`;
                svg += `<text x="${w-6}" y="${ly+7}" fill="#64748b" font-size="7" font-family="Arial,sans-serif" text-anchor="end">Priority →</text>`;
                svg += '</svg>';
                return svg;
            }

            // Facility context (if pro mode)
            let facilityHTML = '';
            if (maturityMode === 'pro') {
                const cap = document.getElementById('pro-capacity')?.value || '-';
                const type = document.getElementById('pro-type')?.value || '-';
                const tier = document.getElementById('pro-tier')?.value || '-';
                const model = document.getElementById('pro-model')?.value || '-';
                const region = document.getElementById('pro-region')?.value || '-';
                facilityHTML = `<div style="margin-bottom:18px;"><h2 style="font-size:14px;color:#1e3a5f;border-bottom:2px solid #3b82f6;padding-bottom:5px;margin-bottom:10px;">Facility Context</h2>
                <table style="width:100%;font-size:11px;"><tr><td style="padding:4px 0;color:#6b7280;">Capacity</td><td style="padding:4px 0;font-weight:600;">${cap} MW</td><td style="padding:4px 0;color:#6b7280;">Type</td><td style="padding:4px 0;font-weight:600;">${type}</td></tr>
                <tr><td style="padding:4px 0;color:#6b7280;">Tier</td><td style="padding:4px 0;font-weight:600;">Tier ${tier}</td><td style="padding:4px 0;color:#6b7280;">Model</td><td style="padding:4px 0;font-weight:600;">${model}</td></tr>
                <tr><td style="padding:4px 0;color:#6b7280;">Region</td><td style="padding:4px 0;font-weight:600;">${region.toUpperCase()}</td><td></td><td></td></tr></table></div>`;
            }

            const printHTML = `<!DOCTYPE html><html><head><meta charset="UTF-8"><title>Maturity Report — ${dateStr}</title>
            <style>@media print{body{-webkit-print-color-adjust:exact;print-color-adjust:exact;}@page{margin:15mm;}}</style></head>
            <body style="font-family:Arial,Helvetica,sans-serif;max-width:820px;margin:0 auto;padding:36px;color:#1f2937;">
                <div style="display:flex;justify-content:space-between;align-items:center;border-bottom:3px solid #1e3a5f;padding-bottom:14px;margin-bottom:20px;">
                    <div><h1 style="font-size:20px;color:#1e3a5f;margin:0;">Operational Maturity Assessment Report</h1><p style="font-size:11px;color:#6b7280;margin:4px 0 0;">Generated ${dateStr} · resistancezero.com</p></div>
                    <div style="text-align:right;">
                        <div style="font-size:32px;font-weight:800;color:${maturity.color};font-family:monospace;">${Math.round(compositeScore)}</div>
                        <div style="font-size:12px;color:#6b7280;">${maturity.label} (Level ${maturity.level})</div>
                    </div>
                </div>

                <!-- Executive Overview Cards -->
                ${(function(){
                    var sc = Math.round(compositeScore);
                    var rLvl, rClr;
                    if (sc >= 80) { rLvl='LOW'; rClr='#059669'; }
                    else if (sc >= 60) { rLvl='MODERATE'; rClr='#d97706'; }
                    else if (sc >= 40) { rLvl='ELEVATED'; rClr='#ea580c'; }
                    else { rLvl='HIGH'; rClr='#dc2626'; }
                    var mf = Math.max(0.05, 1 - (sc / 120));
                    var ae = 2.5 * mf * 200000;
                    var aeStr = ae >= 1000000 ? '$' + (ae/1000000).toFixed(1) + 'M' : '$' + Math.round(ae/1000) + 'K';
                    var topGap = gaps.filter(function(g){ return g.gap > 0; })[0];
                    var nextThreshold = maturity.level < 5 ? maturity.level * 20 + 1 : 100;
                    var nextLabel = ['','Preventive','Predictive','Proactive','Generative','Generative'][maturity.level < 5 ? maturity.level + 1 : 5];
                    var gapPts = nextThreshold - sc;
                    return '<div style="display:flex;gap:10px;margin-bottom:14px;">' +
                        '<div style="flex:1;background:' + maturity.color + ';color:white;border-radius:10px;padding:14px 10px;text-align:center;">' +
                            '<div style="font-size:8px;text-transform:uppercase;letter-spacing:1.5px;opacity:0.8;">Operational Health</div>' +
                            '<div style="font-size:26px;font-weight:900;margin:4px 0;">' + sc + '/100</div>' +
                            '<div style="font-size:9px;opacity:0.85;">' + maturity.label + ' (Level ' + maturity.level + ')</div>' +
                        '</div>' +
                        '<div style="flex:1;background:' + rClr + ';color:white;border-radius:10px;padding:14px 10px;text-align:center;">' +
                            '<div style="font-size:8px;text-transform:uppercase;letter-spacing:1.5px;opacity:0.8;">Risk Exposure</div>' +
                            '<div style="font-size:22px;font-weight:900;margin:4px 0;">' + rLvl + '</div>' +
                            '<div style="font-size:9px;opacity:0.85;">' + aeStr + ' \u00B7 Est. Annual</div>' +
                        '</div>' +
                        '<div style="flex:1;background:#1e293b;color:white;border-radius:10px;padding:14px 10px;text-align:center;">' +
                            '<div style="font-size:8px;text-transform:uppercase;letter-spacing:1.5px;opacity:0.6;">Critical Bottleneck</div>' +
                            (topGap ? '<div style="font-size:14px;font-weight:900;margin:4px 0;color:#f87171;">' + topGap.label.toUpperCase() + '</div>' +
                                '<div style="font-size:9px;color:#94a3b8;">Score: ' + topGap.value + '/5 \u00B7 Priority: ' + topGap.priority.toFixed(3) + '</div>'
                            : '<div style="font-size:14px;font-weight:900;margin:4px 0;color:#10b981;">NONE</div><div style="font-size:9px;color:#94a3b8;">All dimensions at max</div>') +
                        '</div>' +
                        '<div style="flex:1;background:#1e3a5f;color:white;border-radius:10px;padding:14px 10px;text-align:center;">' +
                            '<div style="font-size:8px;text-transform:uppercase;letter-spacing:1.5px;opacity:0.6;">Next Milestone</div>' +
                            (maturity.level < 5 ? '<div style="font-size:26px;font-weight:900;margin:4px 0;">' + nextThreshold + '</div>' +
                                '<div style="font-size:9px;opacity:0.85;">+' + (gapPts > 0 ? gapPts : 0) + ' pts \u00B7 ' + nextLabel + '</div>'
                            : '<div style="font-size:26px;font-weight:900;margin:4px 0;">\u2605</div><div style="font-size:9px;opacity:0.85;">Peak \u00B7 Generative</div>') +
                        '</div>' +
                    '</div>';
                })()}

                <!-- Executive Summary KPI -->
                <div style="display:flex;gap:12px;margin-bottom:14px;">
                    <div style="flex:1;background:${maturity.color};color:white;border-radius:10px;padding:16px;text-align:center;">
                        <div style="font-size:11px;opacity:0.8;">Composite Score</div>
                        <div style="font-size:28px;font-weight:800;">${Math.round(compositeScore)}/100</div>
                    </div>
                    <div style="flex:1;background:#1e3a5f;color:white;border-radius:10px;padding:16px;text-align:center;">
                        <div style="font-size:11px;opacity:0.8;">Maturity Level</div>
                        <div style="font-size:22px;font-weight:700;">Level ${maturity.level}</div>
                        <div style="font-size:12px;opacity:0.9;">${maturity.label}</div>
                    </div>
                    <div style="flex:1;background:#f8fafc;border:1px solid #e5e7eb;border-radius:10px;padding:16px;text-align:center;">
                        <div style="font-size:11px;color:#6b7280;">Weighted Average</div>
                        <div style="font-size:22px;font-weight:700;color:#1e3a5f;font-family:monospace;">${weightedSum.toFixed(2)}</div>
                        <div style="font-size:11px;color:#6b7280;">out of 5.00</div>
                    </div>
                    <div style="flex:1;background:${rmi >= 80 ? '#ecfdf5' : rmi >= 60 ? '#fffbeb' : rmi >= 40 ? '#fff7ed' : '#fef2f2'};border:1px solid ${rmi >= 80 ? '#a7f3d0' : rmi >= 60 ? '#fde68a' : rmi >= 40 ? '#fed7aa' : '#fecaca'};border-radius:10px;padding:16px;text-align:center;">
                        <div style="font-size:11px;color:#6b7280;">Risk Mitigation Index</div>
                        <div style="font-size:22px;font-weight:700;color:${rmi >= 80 ? '#059669' : rmi >= 60 ? '#d97706' : rmi >= 40 ? '#ea580c' : '#dc2626'};font-family:monospace;">${Math.round(rmi)}%</div>
                        <div style="font-size:11px;color:#6b7280;">${rmi >= 80 ? 'Well-Mitigated' : rmi >= 60 ? 'Moderate Coverage' : rmi >= 40 ? 'Gaps Identified' : 'Critical Exposure'}</div>
                    </div>
                </div>

                <!-- RISK CLASSIFICATION BANNER -->
                ${(function(){
                    var sc = Math.round(compositeScore);
                    var riskLvl, riskBg, riskIcon, riskTag;
                    if (sc >= 80) { riskLvl='LOW'; riskBg='#059669'; riskIcon='\u2705'; riskTag='Operational risk within acceptable tolerance.'; }
                    else if (sc >= 60) { riskLvl='MODERATE'; riskBg='#d97706'; riskIcon='\u26A0\uFE0F'; riskTag='Vulnerability windows exist — targeted mitigation required.'; }
                    else if (sc >= 40) { riskLvl='ELEVATED'; riskBg='#ea580c'; riskIcon='\u26A0\uFE0F'; riskTag='Multiple gaps create compounding failure risk.'; }
                    else { riskLvl='CRITICAL'; riskBg='#dc2626'; riskIcon='\uD83D\uDED1'; riskTag='Immediate executive intervention required.'; }
                    var gapCount = values.filter(function(v){ return v.value <= 2; }).length;
                    var leakStatus, leakColor;
                    if (gapCount === 0 && sc >= 70) { leakStatus='MINIMAL'; leakColor='#059669'; }
                    else if (gapCount <= 1 && sc >= 50) { leakStatus='DETECTED'; leakColor='#d97706'; }
                    else { leakStatus='SIGNIFICANT'; leakColor='#dc2626'; }
                    var isoReady, isoColor;
                    if (sc >= 71) { isoReady='READY'; isoColor='#059669'; }
                    else if (sc >= 41) { isoReady='PARTIAL'; isoColor='#d97706'; }
                    else { isoReady='NOT READY'; isoColor='#dc2626'; }
                    var baseOutageRate = 2.5;
                    var maturityFactor = Math.max(0.05, 1 - (sc / 120));
                    var estOutages = baseOutageRate * maturityFactor;
                    var annualExposure = estOutages * 200000;
                    var exposureStr = annualExposure >= 1000000 ? '$' + (annualExposure/1000000).toFixed(1) + 'M' : '$' + Math.round(annualExposure/1000) + 'K';
                    var topWeakness = gaps.filter(function(g){ return g.gap > 0; })[0];
                    var bottomLine = '';
                    if (sc >= 80) bottomLine = 'This facility operates at industry-leading maturity. Operational processes are robust, risk exposure is minimized, and the organization is positioned for ISO 55001 certification. Sustain performance through continuous audit and benchmarking.';
                    else if (sc >= 60) bottomLine = 'Core operational processes are established but ' + (topWeakness ? '<strong>' + topWeakness.label + '</strong> (Level ' + topWeakness.value + ')' : 'key dimensions') + ' creates residual exposure of <strong>' + exposureStr + '/year</strong> in estimated outage cost. A targeted 10-point improvement in priority dimensions would transition this facility from Predictive to Proactive maturity within 6\u201312 months.';
                    else if (sc >= 40) bottomLine = 'This facility has <strong>' + gapCount + ' dimension(s) at critical levels</strong> (Level 1\u20132), driving an estimated annual risk exposure of <strong>' + exposureStr + '</strong>. ' + (topWeakness ? 'The highest-impact vulnerability is <strong>' + topWeakness.label + '</strong> (Level ' + topWeakness.value + '/5, priority score ' + topWeakness.priority.toFixed(2) + '). ' : '') + 'Without intervention, operational incidents are statistically likely within the next 12 months. A 90-day remediation sprint on the top 3 priority dimensions is recommended.';
                    else bottomLine = '<strong style="color:#dc2626;">IMMEDIATE ACTION REQUIRED.</strong> This facility scores below Tier I baseline, with <strong>' + gapCount + ' critical-level dimensions</strong> and an estimated annual exposure of <strong>' + exposureStr + '</strong>. The organization operates in reactive mode\u2014dependent on individual heroics rather than systematic processes. ' + (topWeakness ? 'Begin with <strong>' + topWeakness.label + '</strong>: establish minimum viable documentation and assign an accountable owner within 30 days.' : 'Establish emergency operational procedures within 30 days.');
                    return '<div style="background:linear-gradient(135deg,' + riskBg + ',' + riskBg + 'dd);border-radius:12px;padding:18px 20px;margin-bottom:14px;color:white;">' +
                        '<div style="display:flex;align-items:center;gap:16px;margin-bottom:12px;">' +
                            '<div style="text-align:center;min-width:140px;">' +
                                '<div style="font-size:9px;text-transform:uppercase;letter-spacing:2px;opacity:0.8;">Operational Risk</div>' +
                                '<div style="font-size:30px;font-weight:900;letter-spacing:2px;margin:2px 0;">' + riskLvl + '</div>' +
                                '<div style="font-size:10px;opacity:0.85;">' + riskTag + '</div>' +
                            '</div>' +
                            '<div style="width:1px;height:50px;background:rgba(255,255,255,0.3);"></div>' +
                            '<div style="flex:1;display:flex;gap:12px;">' +
                                '<div style="flex:1;text-align:center;background:rgba(255,255,255,0.12);border-radius:8px;padding:10px 8px;">' +
                                    '<div style="font-size:9px;text-transform:uppercase;letter-spacing:1px;opacity:0.8;">Efficiency Leakage</div>' +
                                    '<div style="font-size:18px;font-weight:800;margin:2px 0;">' + leakStatus + '</div>' +
                                    '<div style="font-size:9px;opacity:0.8;">' + gapCount + ' dim. below Level 3</div>' +
                                '</div>' +
                                '<div style="flex:1;text-align:center;background:rgba(255,255,255,0.12);border-radius:8px;padding:10px 8px;">' +
                                    '<div style="font-size:9px;text-transform:uppercase;letter-spacing:1px;opacity:0.8;">ISO 55001 Readiness</div>' +
                                    '<div style="font-size:18px;font-weight:800;margin:2px 0;">' + isoReady + '</div>' +
                                    '<div style="font-size:9px;opacity:0.8;">Asset Mgmt Compliance</div>' +
                                '</div>' +
                                '<div style="flex:1;text-align:center;background:rgba(255,255,255,0.12);border-radius:8px;padding:10px 8px;">' +
                                    '<div style="font-size:9px;text-transform:uppercase;letter-spacing:1px;opacity:0.8;">Annual Exposure</div>' +
                                    '<div style="font-size:18px;font-weight:800;margin:2px 0;">' + exposureStr + '</div>' +
                                    '<div style="font-size:9px;opacity:0.8;">~' + estOutages.toFixed(1) + ' incidents/yr</div>' +
                                '</div>' +
                            '</div>' +
                        '</div>' +
                        '<div style="background:rgba(0,0,0,0.15);border-radius:8px;padding:12px 14px;">' +
                            '<div style="font-size:10px;text-transform:uppercase;letter-spacing:1.5px;font-weight:700;margin-bottom:6px;opacity:0.85;">Executive Summary</div>' +
                            '<p style="font-size:11.5px;line-height:1.7;margin:0;">' + bottomLine + '</p>' +
                        '</div>' +
                    '</div>';
                })()}

                <!-- ISO 55001 Roadmap -->
                <div style="margin-bottom:20px;">
                    <h2 style="font-size:14px;color:#1e3a5f;border-bottom:2px solid #6366f1;padding-bottom:5px;margin-bottom:10px;">ISO 55001 Asset Management Roadmap</h2>
                    <div style="display:flex;gap:8px;align-items:center;">
                        ${[{num:'1',label:'Awareness',cl:'Cl. 4-5',min:0},{num:'2',label:'Managed',cl:'Cl. 6-8',min:41},{num:'3',label:'Optimization',cl:'Cl. 9-10',min:71}].map(function(s) {
                            var isActive = compositeScore >= s.min;
                            return '<div style="flex:1;padding:12px;text-align:center;border-radius:10px;border:2px solid '+(isActive ? '#3b82f6' : '#e5e7eb')+';background:'+(isActive ? '#eff6ff' : '#f8fafc')+';">'+
                                '<div style="font-size:18px;font-weight:800;color:'+(isActive ? '#2563eb' : '#94a3b8')+';">'+s.num+'</div>'+
                                '<div style="font-size:11px;font-weight:600;color:'+(isActive ? '#1e3a5f' : '#94a3b8')+';">'+s.label+'</div>'+
                                '<div style="font-size:9px;color:#6b7280;margin-top:2px;">'+s.cl+'</div></div>';
                        }).join('<div style="color:#94a3b8;font-size:14px;">→</div>')}
                    </div>
                    <p style="font-size:10px;color:#6b7280;margin-top:6px;font-style:italic;">
                        ${compositeScore >= 71 ? 'Stage 3 (Optimization): Performance evaluation and continual improvement established. Ready for ISO 55001 certification.' :
                          compositeScore >= 41 ? 'Stage 2 (Managed): Formal planning and operational controls in place. Focus on performance evaluation to advance.' :
                          'Stage 1 (Awareness): Establishing context and leadership commitment. Build foundational processes before certification.'}
                    </p>
                </div>

                ${facilityHTML}

                <!-- Charts: Radar + Gap Analysis side by side -->
                <div style="display:flex;gap:12px;margin-bottom:8px;align-items:flex-start;">
                    <div style="flex:1;text-align:center;">
                        <div style="font-size:12px;font-weight:700;color:#1e3a5f;margin-bottom:4px;">Maturity Profile</div>
                        <div style="display:flex;justify-content:center;gap:14px;margin-bottom:6px;font-size:9px;color:#6b7280;">
                            <span>\u25A0 <span style="color:#3b82f6;">\u2501\u2501</span> Current Maturity</span>
                            <span>\u25A1 <span style="color:#a78bfa;">- - -</span> ISO 55001 Target</span>
                        </div>
                        ${radarSVG(values, 280)}
                    </div>
                    <div style="flex:1;text-align:center;">${gapBarSVG(values, gaps, compositeScore, maturity.label)}</div>
                </div>
                <!-- Strategic Insight -->
                ${(function(){
                    var sc = Math.round(compositeScore);
                    var topGap = gaps.filter(function(g){ return g.gap > 0; })[0];
                    var insight = '';
                    if (sc >= 80) insight = 'Facility is <strong>Proactive/Generative</strong>. Operational systems are mature, risk is well-mitigated. Focus on sustaining excellence through audit cycles and knowledge transfer.';
                    else if (sc >= 60) insight = 'Facility is <strong>Managed but Inconsistent</strong>. Processes exist but rely on individual heroics rather than system reliability.' + (topGap ? ' Elevating <strong>' + topGap.label + '</strong> will yield the highest ROI for reliability.' : '');
                    else if (sc >= 40) insight = 'Facility is <strong>Developing with Gaps</strong>.' + (topGap ? ' Prioritize <strong>' + topGap.label + '</strong> (Level ' + topGap.value + ') \u2014 it has the highest weighted impact on overall maturity.' : '') + ' Multiple dimensions require systematic process establishment.';
                    else insight = '<strong style="color:#dc2626;">Reactive Mode Detected.</strong>' + (topGap ? ' <strong>' + topGap.label + '</strong> is the most urgent gap.' : '') + ' Establish minimum viable processes across all 8 dimensions within 90 days.';
                    return '<div style="background:#f0fdf4;border:1px solid #bbf7d0;border-radius:10px;padding:12px 14px;margin-bottom:20px;">' +
                        '<div style="font-size:11px;font-weight:700;color:#059669;margin-bottom:4px;">Strategic Insight</div>' +
                        '<p style="font-size:11px;line-height:1.6;color:#374151;margin:0;">' + insight + '</p></div>';
                })()}

                <!-- Dimension Scores -->
                <h2 style="font-size:14px;color:#1e3a5f;border-bottom:2px solid #3b82f6;padding-bottom:5px;margin-bottom:10px;">Dimension Scores</h2>
                <table style="width:100%;border-collapse:collapse;font-size:11px;">
                    <tr style="background:#1e3a5f;color:white;"><th style="padding:6px 8px;text-align:left;">Dimension</th><th style="padding:6px 8px;text-align:center;">Score</th><th style="padding:6px 8px;text-align:right;">Weight</th><th style="padding:6px 8px;text-align:right;">Contribution</th><th style="padding:6px 8px;min-width:100px;">Bar</th></tr>
                    ${dimRows}
                    <tr style="background:#1e3a5f;color:white;font-weight:700;"><td style="padding:6px 8px;">TOTAL</td><td style="padding:6px 8px;text-align:center;">${weightedSum.toFixed(2)}</td><td style="padding:6px 8px;text-align:right;">100%</td><td style="padding:6px 8px;text-align:right;font-family:monospace;">${compositeScore.toFixed(1)}</td><td></td></tr>
                </table>

                <!-- Improvement Priorities -->
                <h2 style="font-size:14px;color:#1e3a5f;border-bottom:2px solid #f59e0b;padding-bottom:5px;margin:18px 0 10px;">Improvement Priorities</h2>
                <table style="width:100%;border-collapse:collapse;font-size:11px;">
                    <tr style="background:#f59e0b;color:white;"><th style="padding:5px 8px;text-align:left;">#</th><th style="padding:5px 8px;text-align:left;">Dimension</th><th style="padding:5px 8px;text-align:center;">Current</th><th style="padding:5px 8px;text-align:center;">Gap</th><th style="padding:5px 8px;text-align:right;">Priority</th></tr>
                    ${priorityRows}
                </table>

                <!-- Benchmark Comparison -->
                <h2 style="font-size:14px;color:#1e3a5f;border-bottom:2px solid #10b981;padding-bottom:5px;margin:18px 0 10px;">Benchmark Comparison</h2>
                <table style="width:100%;border-collapse:collapse;font-size:11px;">
                    <tr style="background:#10b981;color:white;"><th style="padding:5px 8px;text-align:left;">Tier</th><th style="padding:5px 8px;text-align:center;">Typical Score</th><th style="padding:5px 8px;text-align:center;">Your Position</th></tr>
                    ${benchRows}
                    <tr style="background:#eff6ff;font-weight:700;"><td style="padding:5px 8px;">Your Score</td><td style="padding:5px 8px;text-align:center;font-family:monospace;color:${maturity.color};">${Math.round(compositeScore)}</td><td style="padding:5px 8px;text-align:center;">${maturity.label}</td></tr>
                </table>

                ${generateMaturityNarrative(compositeScore, maturity, weightedSum, values, gaps, weights)}

                <div style="margin-top:36px;padding-top:14px;border-top:1px solid #e5e7eb;font-size:10px;color:#9ca3af;text-align:center;">
                    <p>Assessment based on self-reported scores. Actual maturity may vary based on audit findings and operational evidence.</p>
                    <p style="margin-top:4px;">Generated by Operational Maturity Calculator · resistancezero.com · &copy; ${now.getFullYear()} Bagus Dwi Permana</p>
                </div>
</body></html>`;

            const w = window.open('', '_blank');
            w.document.write(printHTML);
            w.document.close();
            w.focus();
            setTimeout(() => w.print(), 500);
        };

        // ═══ TOOLTIP SYSTEM ═══
        function initMaturityTooltips() {
            const tooltipEl = document.createElement('div');
            tooltipEl.id = 'maturity-tooltip-container';
            document.body.appendChild(tooltipEl);

            document.querySelectorAll('.tooltip-trigger').forEach(trigger => {
                const content = trigger.querySelector('.tooltip-content');
                if (!content) return;
                trigger.addEventListener('mouseenter', () => {
                    tooltipEl.innerHTML = content.innerHTML;
                    const rect = trigger.getBoundingClientRect();
                    const tw = 320;
                    let left = rect.right + 12;
                    let top = rect.top + rect.height / 2;
                    if (left + tw > window.innerWidth - 20) left = rect.left - tw - 12;
                    if (left < 20) left = 20;
                    const th = tooltipEl.offsetHeight || 150;
                    top = top - th / 2;
                    if (top < 20) top = 20;
                    if (top + th > window.innerHeight - 20) top = window.innerHeight - th - 20;
                    tooltipEl.style.left = left + 'px';
                    tooltipEl.style.top = top + 'px';
                    tooltipEl.classList.add('visible');
                });
                trigger.addEventListener('mouseleave', () => { tooltipEl.classList.remove('visible'); });
            });
        }

        // ═══ SESSION CHECK ═══
        (function checkMaturitySession() {
            var session = localStorage.getItem('rz_premium_session');
            if (session) {
                try {
                    var data = JSON.parse(session);
                    if (data && data.email) {
                        var valid = false;
                        if (data.expires) { valid = new Date(data.expires) > new Date(); }
                        else if (data.ts) { valid = (Date.now() - data.ts) < 30 * 86400000; }
                        if (valid) { isPremiumMaturity = true; }
                    }
                } catch(e) {}
            }
            applyMaturityGating();
        })();

        // Listen for auth changes
        window.addEventListener('rz-auth-change', function(e) {
            if (e.detail && e.detail.action === 'login') {
                isPremiumMaturity = true;
                applyMaturityGating();
                // Auto-switch to Pro if user just logged in
                switchMaturityMode('pro');
            } else if (e.detail && e.detail.action === 'logout') {
                isPremiumMaturity = false;
                maturityMode = 'free';
                switchMaturityMode('free');
                applyMaturityGating();
            }
        });

        // ═══ INIT ═══
        buildDimensionCards();
        calculateMaturity();
        initMaturityTooltips();
    })();
    </script>
<script>
function subscribeNewsletter(e){e.preventDefault();var email=e.target.querySelector('input[type="email"]').value.trim();if(!email)return false;var subs=JSON.parse(localStorage.getItem('rz_newsletter_subscribers')||'[]');if(subs.find(function(s){return s.email===email})){alert('Already subscribed!');return false}subs.push({email:email,date:new Date().toISOString(),source:location.pathname.split('/').pop(),status:'active'});localStorage.setItem('rz_newsletter_subscribers',JSON.stringify(subs));e.target.innerHTML='<p style="color:#fff;font-weight:600;">&#10003; Subscribed successfully!</p>';return false}
</script>
<script src="auth.js"></script>
<script src="rz-tracker.js"></script>

<!-- ═══ Feature 22: Reading Progress Bar ═══ -->
<script>
(function() {
    var bar = document.getElementById('scrollProgress');
    if (!bar) return;
    var ticking = false;
    function updateProgress() {
        var scrollTop = window.scrollY || document.documentElement.scrollTop;
        var docHeight = document.documentElement.scrollHeight - window.innerHeight;
        var pct = docHeight > 0 ? (scrollTop / docHeight) * 100 : 0;
        bar.style.width = Math.min(pct, 100) + '%';
        ticking = false;
    }
    window.addEventListener('scroll', function() {
        if (!ticking) { requestAnimationFrame(updateProgress); ticking = true; }
    }, { passive: true });
    updateProgress();
})();
</script>

<!-- ═══ Feature 23: TOC Sidebar ═══ -->
<script>
(function() {
    var sections = document.querySelectorAll('h2[id^="section-"]');
    if (!sections.length) return;

    var sidebarList = document.getElementById('tocSidebarList');
    var mobileList = document.getElementById('tocMobileList');
    var sidebar = document.getElementById('tocSidebar');
    var tocToggle = document.getElementById('tocMobileToggle');
    var tocDrawer = document.getElementById('tocMobileDrawer');
    var tocBackdrop = document.getElementById('tocMobileBackdrop');
    var tocClose = document.getElementById('tocDrawerClose');

    // Build TOC items from H2 headings
    var tocData = [];
    sections.forEach(function(h2) {
        var id = h2.getAttribute('id');
        var num = id.replace('section-', '');
        var text = h2.textContent.replace(/^\s*\d+\s*/, '').trim();
        tocData.push({ id: id, num: num, text: text });
    });

    function buildList(container, isMobile) {
        tocData.forEach(function(item) {
            var li = document.createElement('li');
            if (!isMobile) li.className = 'toc-sidebar-item';
            var a = document.createElement('a');
            a.href = '#' + item.id;
            a.setAttribute('data-section', item.id);
            if (isMobile) {
                a.textContent = item.num + '. ' + item.text;
            } else {
                a.className = 'toc-sidebar-link';
                a.innerHTML = '<span class="toc-sidebar-num">' + item.num + '</span>' + item.text;
            }
            a.addEventListener('click', function(e) {
                e.preventDefault();
                var target = document.getElementById(item.id);
                if (target) {
                    window.scrollTo({ top: target.offsetTop - 80, behavior: 'smooth' });
                }
                if (isMobile) closeMobileDrawer();
            });
            li.appendChild(a);
            container.appendChild(li);
        });
    }

    buildList(sidebarList, false);
    buildList(mobileList, true);

    // IntersectionObserver for active section highlighting
    var currentSection = null;
    var observer = new IntersectionObserver(function(entries) {
        entries.forEach(function(entry) {
            if (entry.isIntersecting) {
                currentSection = entry.target.getAttribute('id');
                highlightActive(currentSection);
            }
        });
    }, { rootMargin: '-80px 0px -70% 0px', threshold: 0 });

    sections.forEach(function(s) { observer.observe(s); });

    function highlightActive(sectionId) {
        // Desktop sidebar
        sidebarList.querySelectorAll('.toc-sidebar-link').forEach(function(a) {
            a.classList.toggle('active', a.getAttribute('data-section') === sectionId);
        });
        // Mobile list
        mobileList.querySelectorAll('a').forEach(function(a) {
            a.classList.toggle('active', a.getAttribute('data-section') === sectionId);
        });
    }

    // Show/hide sidebar based on article content visibility
    var articleContent = document.querySelector('.article-content');
    if (articleContent && sidebar) {
        var sidebarObserver = new IntersectionObserver(function(entries) {
            entries.forEach(function(entry) {
                sidebar.classList.toggle('visible', entry.isIntersecting);
            });
        }, { rootMargin: '0px', threshold: 0.01 });
        sidebarObserver.observe(articleContent);
    }

    // Mobile drawer toggle
    function openMobileDrawer() {
        tocDrawer.classList.add('active');
        tocBackdrop.classList.add('active');
        document.body.style.overflow = 'hidden';
    }
    function closeMobileDrawer() {
        tocDrawer.classList.remove('active');
        tocBackdrop.classList.remove('active');
        document.body.style.overflow = '';
    }

    if (tocToggle) tocToggle.addEventListener('click', openMobileDrawer);
    if (tocClose) tocClose.addEventListener('click', closeMobileDrawer);
    if (tocBackdrop) tocBackdrop.addEventListener('click', closeMobileDrawer);
})();
</script>

<!-- ═══ Feature 21: Global Search ═══ -->
<script>
(function() {
    var searchBtn = document.getElementById('navSearchBtn');
    var overlay = document.getElementById('searchOverlay');
    var modal = document.getElementById('searchModal');
    var input = document.getElementById('searchInput');
    var resultsEl = document.getElementById('searchResults');
    var fuse = null;
    var searchData = null;
    var focusedIdx = -1;

    function openSearch() {
        overlay.classList.add('active');
        modal.classList.add('active');
        input.value = '';
        input.focus();
        focusedIdx = -1;
        resultsEl.innerHTML = '<div class="search-empty">Type to search across all content</div>';
        // Load index on first open
        if (!searchData) {
            fetch('search-index.json')
                .then(function(r) { return r.json(); })
                .then(function(data) {
                    searchData = data;
                    fuse = new Fuse(data, {
                        keys: [
                            { name: 'title', weight: 0.4 },
                            { name: 'description', weight: 0.25 },
                            { name: 'keywords', weight: 0.25 },
                            { name: 'category', weight: 0.1 }
                        ],
                        threshold: 0.35,
                        includeScore: true,
                        minMatchCharLength: 2
                    });
                })
                .catch(function() {});
        }
    }

    function closeSearch() {
        overlay.classList.remove('active');
        modal.classList.remove('active');
        input.blur();
    }

    function getIconClass(cat) {
        cat = (cat || '').toLowerCase();
        if (cat === 'calculator') return 'calc';
        if (cat === 'tool') return 'tool';
        return '';
    }

    function getIconLabel(item) {
        if (item.url && item.url.indexOf('article-') === 0) {
            return item.url.replace('article-', '').replace('.html', '').padStart(2, '0');
        }
        var cat = (item.category || '').toLowerCase();
        if (cat === 'calculator') return '&#9889;';
        if (cat === 'tool') return '&#9881;';
        return '&#9733;';
    }

    function renderResults(results) {
        if (!results.length) {
            resultsEl.innerHTML = '<div class="search-empty">No results found</div>';
            focusedIdx = -1;
            return;
        }
        var html = '';
        results.slice(0, 8).forEach(function(r, i) {
            var item = r.item;
            var iconCls = getIconClass(item.category);
            html += '<a href="' + item.url + '" class="search-result-item" data-idx="' + i + '">'
                + '<div class="search-result-icon ' + iconCls + '">' + getIconLabel(item) + '</div>'
                + '<div class="search-result-info">'
                + '<div class="search-result-category">' + (item.category || '') + '</div>'
                + '<div class="search-result-title">' + item.title + '</div>'
                + '<div class="search-result-desc">' + item.description + '</div>'
                + '</div></a>';
        });
        resultsEl.innerHTML = html;
        focusedIdx = -1;
    }

    function updateFocus() {
        var items = resultsEl.querySelectorAll('.search-result-item');
        items.forEach(function(el, i) {
            el.classList.toggle('focused', i === focusedIdx);
            if (i === focusedIdx) el.scrollIntoView({ block: 'nearest' });
        });
    }

    // Event listeners
    if (searchBtn) searchBtn.addEventListener('click', openSearch);
    if (overlay) overlay.addEventListener('click', closeSearch);

    document.addEventListener('keydown', function(e) {
        // Ctrl+K or Cmd+K to open search
        if ((e.ctrlKey || e.metaKey) && e.key === 'k') {
            e.preventDefault();
            if (modal.classList.contains('active')) closeSearch();
            else openSearch();
            return;
        }
        if (!modal.classList.contains('active')) return;

        if (e.key === 'Escape') {
            closeSearch();
            return;
        }
        var items = resultsEl.querySelectorAll('.search-result-item');
        if (e.key === 'ArrowDown') {
            e.preventDefault();
            focusedIdx = Math.min(focusedIdx + 1, items.length - 1);
            updateFocus();
        } else if (e.key === 'ArrowUp') {
            e.preventDefault();
            focusedIdx = Math.max(focusedIdx - 1, 0);
            updateFocus();
        } else if (e.key === 'Enter' && focusedIdx >= 0 && items[focusedIdx]) {
            e.preventDefault();
            items[focusedIdx].click();
        }
    });

    if (input) {
        input.addEventListener('input', function() {
            var query = input.value.trim();
            if (query.length < 2 || !fuse) {
                resultsEl.innerHTML = '<div class="search-empty">Type to search across all content</div>';
                focusedIdx = -1;
                return;
            }
            var results = fuse.search(query);
            renderResults(results);
        });
    }
})();
</script>

<!-- Cookie Consent Banner -->
<div class="cookie-banner hidden" id="cookieBanner">
    <p>We use cookies for analytics to improve your experience. <a href="privacy.html">Learn more</a></p>
    <div class="cookie-actions">
        <button class="cookie-accept" id="cookieAccept">Accept</button>
        <button class="cookie-decline" id="cookieDecline">Decline</button>
    </div>
</div>

<!-- Scroll to Top -->
<button class="scroll-top-btn" id="scrollTopBtn" aria-label="Scroll to top">
    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><polyline points="18 15 12 9 6 15"/></svg>
</button>

<script>
(function(){
    // Cookie Banner
    var cb = document.getElementById('cookieBanner');
    var consent = localStorage.getItem('rz_cookie_consent');
    if (!consent && cb) {
        cb.classList.remove('hidden');
    }
    var acceptBtn = document.getElementById('cookieAccept');
    var declineBtn = document.getElementById('cookieDecline');
    if (acceptBtn) acceptBtn.addEventListener('click', function(){
        localStorage.setItem('rz_cookie_consent', 'accepted');
        cb.classList.add('hidden');
    });
    if (declineBtn) declineBtn.addEventListener('click', function(){
        localStorage.setItem('rz_cookie_consent', 'declined');
        cb.classList.add('hidden');
        // Disable GA
        window['ga-disable-G-GED7FX8RTV'] = true;
    });

    // Scroll to Top
    var sBtn = document.getElementById('scrollTopBtn');
    if (sBtn) {
        var ticking = false;
        window.addEventListener('scroll', function(){
            if (!ticking) {
                window.requestAnimationFrame(function(){
                    if (window.scrollY > 500) {
                        sBtn.classList.add('visible');
                    } else {
                        sBtn.classList.remove('visible');
                    }
                    ticking = false;
                });
                ticking = true;
            }
        });
        sBtn.addEventListener('click', function(){
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });
    }
})();
</script>

</body>
</html>
